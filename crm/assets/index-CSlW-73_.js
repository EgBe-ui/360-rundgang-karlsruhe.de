var Vm=Object.defineProperty;var Km=(t,e,n)=>e in t?Vm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var zt=(t,e,n)=>Km(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Eo,Jt,Ep,Pa,hd,Lp,Cp,Tp,ah,ku,Nu,Ip,Bl={},Ml=[],Jm=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Lo=Array.isArray;function vi(t,e){for(var n in e)t[n]=e[n];return t}function sh(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Pp(t,e,n){var r,a,i,o={};for(i in e)i=="key"?r=e[i]:i=="ref"?a=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?Eo.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)o[i]===void 0&&(o[i]=t.defaultProps[i]);return uo(t,o,r,a,null)}function uo(t,e,n,r,a){var i={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Ep,__i:-1,__u:0};return a==null&&Jt.vnode!=null&&Jt.vnode(i),i}function xt(t){return t.children}function ho(t,e){this.props=t,this.context=e}function Ss(t,e){if(e==null)return t.__?Ss(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Ss(t):null}function Ym(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,r=[],a=[],i=vi({},e);i.__v=e.__v+1,Jt.vnode&&Jt.vnode(i),oh(t.__P,i,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,r,n??Ss(e),!!(32&e.__u),a),i.__v=e.__v,i.__.__k[i.__i]=i,Dp(r,i,a),e.__e=e.__=null,i.__e!=n&&Op(i)}}function Op(t){if((t=t.__)!=null&&t.__c!=null)return t.__e=t.__c.base=null,t.__k.some(function(e){if(e!=null&&e.__e!=null)return t.__e=t.__c.base=e.__e}),Op(t)}function Eu(t){(!t.__d&&(t.__d=!0)&&Pa.push(t)&&!Ul.__r++||hd!=Jt.debounceRendering)&&((hd=Jt.debounceRendering)||Lp)(Ul)}function Ul(){for(var t,e=1;Pa.length;)Pa.length>e&&Pa.sort(Cp),t=Pa.shift(),e=Pa.length,Ym(t);Ul.__r=0}function Rp(t,e,n,r,a,i,o,l,c,h,f){var m,b,p,_,w,S,x,T=r&&r.__k||Ml,R=e.length;for(c=Xm(n,e,T,c,R),m=0;m<R;m++)(p=n.__k[m])!=null&&(b=p.__i!=-1&&T[p.__i]||Bl,p.__i=m,S=oh(t,p,b,a,i,o,l,c,h,f),_=p.__e,p.ref&&b.ref!=p.ref&&(b.ref&&lh(b.ref,null,p),f.push(p.ref,p.__c||_,p)),w==null&&_!=null&&(w=_),(x=!!(4&p.__u))||b.__k===p.__k?c=Fp(p,c,t,x):typeof p.type=="function"&&S!==void 0?c=S:_&&(c=_.nextSibling),p.__u&=-7);return n.__e=w,c}function Xm(t,e,n,r,a){var i,o,l,c,h,f=n.length,m=f,b=0;for(t.__k=new Array(a),i=0;i<a;i++)(o=e[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=t.__k[i]=uo(null,o,null,null,null):Lo(o)?o=t.__k[i]=uo(xt,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=t.__k[i]=uo(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):t.__k[i]=o,c=i+b,o.__=t,o.__b=t.__b+1,l=null,(h=o.__i=Zm(o,n,c,m))!=-1&&(m--,(l=n[h])&&(l.__u|=2)),l==null||l.__v==null?(h==-1&&(a>f?b--:a<f&&b++),typeof o.type!="function"&&(o.__u|=4)):h!=c&&(h==c-1?b--:h==c+1?b++:(h>c?b--:b++,o.__u|=4))):t.__k[i]=null;if(m)for(i=0;i<f;i++)(l=n[i])!=null&&(2&l.__u)==0&&(l.__e==r&&(r=Ss(l)),Bp(l,l));return r}function Fp(t,e,n,r){var a,i;if(typeof t.type=="function"){for(a=t.__k,i=0;a&&i<a.length;i++)a[i]&&(a[i].__=t,e=Fp(a[i],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=Ss(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Lu(t,e){return e=e||[],t==null||typeof t=="boolean"||(Lo(t)?t.some(function(n){Lu(n,e)}):e.push(t)),e}function Zm(t,e,n,r){var a,i,o,l=t.key,c=t.type,h=e[n],f=h!=null&&(2&h.__u)==0;if(h===null&&l==null||f&&l==h.key&&c==h.type)return n;if(r>(f?1:0)){for(a=n-1,i=n+1;a>=0||i<e.length;)if((h=e[o=a>=0?a--:i++])!=null&&(2&h.__u)==0&&l==h.key&&c==h.type)return o}return-1}function dd(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Jm.test(e)?n:n+"px"}function ll(t,e,n,r,a){var i,o;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||dd(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||dd(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(Tp,"$1")),o=e.toLowerCase(),e=o in t||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?r?n.u=r.u:(n.u=ah,t.addEventListener(e,i?Nu:ku,i)):t.removeEventListener(e,i?Nu:ku,i);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function fd(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ah++;else if(e.t<n.u)return;return n(Jt.event?Jt.event(e):e)}}}function oh(t,e,n,r,a,i,o,l,c,h){var f,m,b,p,_,w,S,x,T,R,E,U,Z,O,J,F=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(c=!!(32&n.__u),i=[l=e.__e=n.__e]),(f=Jt.__b)&&f(e);e:if(typeof F=="function")try{if(x=e.props,T="prototype"in F&&F.prototype.render,R=(f=F.contextType)&&r[f.__c],E=f?R?R.props.value:f.__:r,n.__c?S=(m=e.__c=n.__c).__=m.__E:(T?e.__c=m=new F(x,E):(e.__c=m=new ho(x,E),m.constructor=F,m.render=e0),R&&R.sub(m),m.state||(m.state={}),m.__n=r,b=m.__d=!0,m.__h=[],m._sb=[]),T&&m.__s==null&&(m.__s=m.state),T&&F.getDerivedStateFromProps!=null&&(m.__s==m.state&&(m.__s=vi({},m.__s)),vi(m.__s,F.getDerivedStateFromProps(x,m.__s))),p=m.props,_=m.state,m.__v=e,b)T&&F.getDerivedStateFromProps==null&&m.componentWillMount!=null&&m.componentWillMount(),T&&m.componentDidMount!=null&&m.__h.push(m.componentDidMount);else{if(T&&F.getDerivedStateFromProps==null&&x!==p&&m.componentWillReceiveProps!=null&&m.componentWillReceiveProps(x,E),e.__v==n.__v||!m.__e&&m.shouldComponentUpdate!=null&&m.shouldComponentUpdate(x,m.__s,E)===!1){e.__v!=n.__v&&(m.props=x,m.state=m.__s,m.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(C){C&&(C.__=e)}),Ml.push.apply(m.__h,m._sb),m._sb=[],m.__h.length&&o.push(m);break e}m.componentWillUpdate!=null&&m.componentWillUpdate(x,m.__s,E),T&&m.componentDidUpdate!=null&&m.__h.push(function(){m.componentDidUpdate(p,_,w)})}if(m.context=E,m.props=x,m.__P=t,m.__e=!1,U=Jt.__r,Z=0,T)m.state=m.__s,m.__d=!1,U&&U(e),f=m.render(m.props,m.state,m.context),Ml.push.apply(m.__h,m._sb),m._sb=[];else do m.__d=!1,U&&U(e),f=m.render(m.props,m.state,m.context),m.state=m.__s;while(m.__d&&++Z<25);m.state=m.__s,m.getChildContext!=null&&(r=vi(vi({},r),m.getChildContext())),T&&!b&&m.getSnapshotBeforeUpdate!=null&&(w=m.getSnapshotBeforeUpdate(p,_)),O=f!=null&&f.type===xt&&f.key==null?jp(f.props.children):f,l=Rp(t,Lo(O)?O:[O],e,n,r,a,i,o,l,c,h),m.base=e.__e,e.__u&=-161,m.__h.length&&o.push(m),S&&(m.__E=m.__=null)}catch(C){if(e.__v=null,c||i!=null)if(C.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;i[i.indexOf(l)]=null,e.__e=l}else{for(J=i.length;J--;)sh(i[J]);Cu(e)}else e.__e=n.__e,e.__k=n.__k,C.then||Cu(e);Jt.__e(C,e,n)}else i==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=Qm(n.__e,e,n,r,a,i,o,c,h);return(f=Jt.diffed)&&f(e),128&e.__u?void 0:l}function Cu(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(Cu))}function Dp(t,e,n){for(var r=0;r<n.length;r++)lh(n[r],n[++r],n[++r]);Jt.__c&&Jt.__c(e,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(i){i.call(a)})}catch(i){Jt.__e(i,a.__v)}})}function jp(t){return typeof t!="object"||t==null||t.__b>0?t:Lo(t)?t.map(jp):vi({},t)}function Qm(t,e,n,r,a,i,o,l,c){var h,f,m,b,p,_,w,S=n.props||Bl,x=e.props,T=e.type;if(T=="svg"?a="http://www.w3.org/2000/svg":T=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),i!=null){for(h=0;h<i.length;h++)if((p=i[h])&&"setAttribute"in p==!!T&&(T?p.localName==T:p.nodeType==3)){t=p,i[h]=null;break}}if(t==null){if(T==null)return document.createTextNode(x);t=document.createElementNS(a,T,x.is&&x),l&&(Jt.__m&&Jt.__m(e,i),l=!1),i=null}if(T==null)S===x||l&&t.data==x||(t.data=x);else{if(i=i&&Eo.call(t.childNodes),!l&&i!=null)for(S={},h=0;h<t.attributes.length;h++)S[(p=t.attributes[h]).name]=p.value;for(h in S)p=S[h],h=="dangerouslySetInnerHTML"?m=p:h=="children"||h in x||h=="value"&&"defaultValue"in x||h=="checked"&&"defaultChecked"in x||ll(t,h,null,p,a);for(h in x)p=x[h],h=="children"?b=p:h=="dangerouslySetInnerHTML"?f=p:h=="value"?_=p:h=="checked"?w=p:l&&typeof p!="function"||S[h]===p||ll(t,h,p,S[h],a);if(f)l||m&&(f.__html==m.__html||f.__html==t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(m&&(t.innerHTML=""),Rp(e.type=="template"?t.content:t,Lo(b)?b:[b],e,n,r,T=="foreignObject"?"http://www.w3.org/1999/xhtml":a,i,o,i?i[0]:n.__k&&Ss(n,0),l,c),i!=null)for(h=i.length;h--;)sh(i[h]);l||(h="value",T=="progress"&&_==null?t.removeAttribute("value"):_!=null&&(_!==t[h]||T=="progress"&&!_||T=="option"&&_!=S[h])&&ll(t,h,_,S[h],a),h="checked",w!=null&&w!=t[h]&&ll(t,h,w,S[h],a))}return t}function lh(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(a){Jt.__e(a,n)}}function Bp(t,e,n){var r,a;if(Jt.unmount&&Jt.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||lh(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){Jt.__e(i,e)}r.base=r.__P=null}if(r=t.__k)for(a=0;a<r.length;a++)r[a]&&Bp(r[a],e,n||typeof t.type!="function");n||sh(t.__e),t.__c=t.__=t.__e=void 0}function e0(t,e,n){return this.constructor(t,n)}function t0(t,e,n){var r,a,i,o;e==document&&(e=document.documentElement),Jt.__&&Jt.__(t,e),a=(r=!1)?null:e.__k,i=[],o=[],oh(e,t=e.__k=Pp(xt,null,[t]),a||Bl,Bl,e.namespaceURI,a?null:e.firstChild?Eo.call(e.childNodes):null,i,a?a.__e:e.firstChild,r,o),Dp(i,t,o)}function n0(t,e,n){var r,a,i,o,l=vi({},t.props);for(i in t.type&&t.type.defaultProps&&(o=t.type.defaultProps),e)i=="key"?r=e[i]:i=="ref"?a=e[i]:l[i]=e[i]===void 0&&o!=null?o[i]:e[i];return arguments.length>2&&(l.children=arguments.length>3?Eo.call(arguments,2):n),uo(t.type,l,r||t.key,a||t.ref,null)}function ch(t){function e(n){var r,a;return this.getChildContext||(r=new Set,(a={})[e.__c]=this,this.getChildContext=function(){return a},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&r.forEach(function(o){o.__e=!0,Eu(o)})},this.sub=function(i){r.add(i);var o=i.componentWillUnmount;i.componentWillUnmount=function(){r&&r.delete(i),o&&o.call(i)}}),n.children}return e.__c="__cC"+Ip++,e.__=t,e.Provider=e.__l=(e.Consumer=function(n,r){return n.children(r)}).contextType=e,e}Eo=Ml.slice,Jt={__e:function(t,e,n,r){for(var a,i,o;e=e.__;)if((a=e.__c)&&!a.__)try{if((i=a.constructor)&&i.getDerivedStateFromError!=null&&(a.setState(i.getDerivedStateFromError(t)),o=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(t,r||{}),o=a.__d),o)return a.__E=a}catch(l){t=l}throw t}},Ep=0,ho.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=vi({},this.state),typeof t=="function"&&(t=t(vi({},n),this.props)),t&&vi(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Eu(this))},ho.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Eu(this))},ho.prototype.render=xt,Pa=[],Lp=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Cp=function(t,e){return t.__v.__b-e.__v.__b},Ul.__r=0,Tp=/(PointerCapture)$|Capture$/i,ah=0,ku=fd(!1),Nu=fd(!0),Ip=0;var r0=0;function s(t,e,n,r,a,i){e||(e={});var o,l,c=e;if("ref"in c)for(l in c={},e)l=="ref"?o=e[l]:c[l]=e[l];var h={type:t,props:c,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--r0,__i:-1,__u:0,__source:a,__self:i};if(typeof t=="function"&&(o=t.defaultProps))for(l in o)c[l]===void 0&&(c[l]=o[l]);return Jt.vnode&&Jt.vnode(h),h}var As,ln,Bc,pd,vo=0,Mp=[],Ln=Jt,gd=Ln.__b,md=Ln.__r,vd=Ln.diffed,bd=Ln.__c,yd=Ln.unmount,_d=Ln.__;function Yl(t,e){Ln.__h&&Ln.__h(ln,t,vo||e),vo=0;var n=ln.__H||(ln.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function be(t){return vo=1,i0(zp,t)}function i0(t,e,n){var r=Yl(As++,2);if(r.t=t,!r.__c&&(r.__=[zp(void 0,e),function(l){var c=r.__N?r.__N[0]:r.__[0],h=r.t(c,l);c!==h&&(r.__N=[h,r.__[1]],r.__c.setState({}))}],r.__c=ln,!ln.__f)){var a=function(l,c,h){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(b){return b.__c});if(f.every(function(b){return!b.__N}))return!i||i.call(this,l,c,h);var m=r.__c.props!==l;return f.some(function(b){if(b.__N){var p=b.__[0];b.__=b.__N,b.__N=void 0,p!==b.__[0]&&(m=!0)}}),i&&i.call(this,l,c,h)||m};ln.__f=!0;var i=ln.shouldComponentUpdate,o=ln.componentWillUpdate;ln.componentWillUpdate=function(l,c,h){if(this.__e){var f=i;i=void 0,a(l,c,h),i=f}o&&o.call(this,l,c,h)},ln.shouldComponentUpdate=a}return r.__N||r.__}function jt(t,e){var n=Yl(As++,3);!Ln.__s&&$p(n.__H,e)&&(n.__=t,n.u=e,ln.__H.__h.push(n))}function a0(t){return vo=5,Up(function(){return{current:t}},[])}function Up(t,e){var n=Yl(As++,7);return $p(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Nt(t,e){return vo=8,Up(function(){return t},e)}function qp(t){var e=ln.context[t.__c],n=Yl(As++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(ln)),e.props.value):t.__}function s0(){for(var t;t=Mp.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(Cl),e.__h.some(Tu),e.__h=[]}catch(n){e.__h=[],Ln.__e(n,t.__v)}}}Ln.__b=function(t){ln=null,gd&&gd(t)},Ln.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),_d&&_d(t,e)},Ln.__r=function(t){md&&md(t),As=0;var e=(ln=t.__c).__H;e&&(Bc===ln?(e.__h=[],ln.__h=[],e.__.some(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.some(Cl),e.__h.some(Tu),e.__h=[],As=0)),Bc=ln},Ln.diffed=function(t){vd&&vd(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Mp.push(e)!==1&&pd===Ln.requestAnimationFrame||((pd=Ln.requestAnimationFrame)||o0)(s0)),e.__H.__.some(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Bc=ln=null},Ln.__c=function(t,e){e.some(function(n){try{n.__h.some(Cl),n.__h=n.__h.filter(function(r){return!r.__||Tu(r)})}catch(r){e.some(function(a){a.__h&&(a.__h=[])}),e=[],Ln.__e(r,n.__v)}}),bd&&bd(t,e)},Ln.unmount=function(t){yd&&yd(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(r){try{Cl(r)}catch(a){e=a}}),n.__H=void 0,e&&Ln.__e(e,n.__v))};var wd=typeof requestAnimationFrame=="function";function o0(t){var e,n=function(){clearTimeout(r),wd&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);wd&&(e=requestAnimationFrame(n))}function Cl(t){var e=ln,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),ln=e}function Tu(t){var e=ln;t.__c=t.__(),ln=e}function $p(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function zp(t,e){return typeof e=="function"?e(t):e}function Xl(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function l0(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(f){try{h(r.next(f))}catch(m){o(m)}}function c(f){try{h(r.throw(f))}catch(m){o(m)}}function h(f){f.done?i(f.value):a(f.value).then(l,c)}h((r=r.apply(t,e||[])).next())})}const c0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class uh extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class u0 extends uh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class xd extends uh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Sd extends uh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Iu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Iu||(Iu={}));class h0{constructor(e,{headers:n={},customFetch:r,region:a=Iu.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=c0(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return l0(this,arguments,void 0,function*(n,r={}){var a;let i,o;try{const{headers:l,method:c,body:h,signal:f,timeout:m}=r;let b={},{region:p}=r;p||(p=this.region);const _=new URL(`${this.url}/${n}`);p&&p!=="any"&&(b["x-region"]=p,_.searchParams.set("forceFunctionRegion",p));let w;h&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",w=h):typeof h=="string"?(b["Content-Type"]="text/plain",w=h):typeof FormData<"u"&&h instanceof FormData?w=h:(b["Content-Type"]="application/json",w=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?w=JSON.stringify(h):w=h;let S=f;m&&(o=new AbortController,i=setTimeout(()=>o.abort(),m),f?(S=o.signal,f.addEventListener("abort",()=>o.abort())):S=o.signal);const x=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),l),body:w,signal:S}).catch(U=>{throw new u0(U)}),T=x.headers.get("x-relay-error");if(T&&T==="true")throw new xd(x);if(!x.ok)throw new Sd(x);let R=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),E;return R==="application/json"?E=yield x.json():R==="application/octet-stream"||R==="application/pdf"?E=yield x.blob():R==="text/event-stream"?E=x:R==="multipart/form-data"?E=yield x.formData():E=yield x.text(),{data:E,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof Sd||l instanceof xd?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var d0=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},f0=class{constructor(t){var e,n,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(r=t.urlLengthLimit)!==null&&r!==void 0?r:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,c=null,h=i.status,f=i.statusText;if(i.ok){var m,b;if(n.method!=="HEAD"){var p;const x=await i.text();x===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?l=x:l=JSON.parse(x))}const w=(m=n.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),S=(b=i.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");w&&S&&S.length>1&&(c=parseInt(S[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,h=406,f="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var _;const w=await i.text();try{o=JSON.parse(w),Array.isArray(o)&&i.status===404&&(l=[],o=null,h=200,f="OK")}catch{i.status===404&&w===""?(h=204,f="No Content"):o={message:w}}if(o&&n.isMaybeSingle&&(!(o==null||(_=o.details)===null||_===void 0)&&_.includes("0 rows"))&&(o=null,h=200,f="OK"),o&&n.shouldThrowOnError)throw new d0(o)}return{error:o,data:l,count:c,status:h,statusText:f}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let l="",c="",h="";const f=i==null?void 0:i.cause;if(f){var m,b,p,_;const x=(m=f==null?void 0:f.message)!==null&&m!==void 0?m:"",T=(b=f==null?void 0:f.code)!==null&&b!==void 0?b:"";l=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(_=f==null?void 0:f.name)!==null&&_!==void 0?_:"Error"}: ${x}`,T&&(l+=` (${T})`),f!=null&&f.stack&&(l+=`
${f.stack}`)}else{var w;l=(w=i==null?void 0:i.stack)!==null&&w!==void 0?w:""}const S=this.url.toString().length;return(i==null?void 0:i.name)==="AbortError"||(i==null?void 0:i.code)==="ABORT_ERR"?(h="",c="Request was aborted (timeout or manual cancellation)",S>this.urlLengthLimit&&(c+=`. Note: Your request URL is ${S} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((f==null?void 0:f.name)==="HeadersOverflowError"||(f==null?void 0:f.code)==="UND_ERR_HEADERS_OVERFLOW")&&(h="",c="HTTP headers exceeded server limits (typically 16KB)",S>this.urlLengthLimit&&(c+=`. Your request URL is ${S} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:c,code:h},data:null,count:null,status:0,statusText:""}})),a.then(t,e)}returns(){return this}overrideTypes(){return this}},p0=class extends f0{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:a=r}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:a=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Ad=new RegExp("[,()]");var hs=class extends p0{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Ad.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Ad.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let a="";r==="plain"?a="pl":r==="phrase"?a="ph":r==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},g0=class{constructor(t,{headers:e={},schema:n,fetch:r,urlLengthLimit:a=8e3}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r,this.urlLengthLimit=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:r}=e??{},a=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(h=>/\s/.test(h)&&!i?"":(h==='"'&&(i=!i),h)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",o),r&&c.append("Prefer",`count=${r}`),new hs({method:a,url:l,headers:c,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),n||o.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);i.searchParams.set("columns",c.join(","))}}return new hs({method:a,url:i,headers:o,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:a=!0}={}){var i;const o="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),r&&c.append("Prefer",`count=${r}`),a||c.append("Prefer","missing=default"),Array.isArray(t)){const h=t.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(h.length>0){const f=[...new Set(h)].map(m=>`"${m}"`);l.searchParams.set("columns",f.join(","))}}return new hs({method:o,url:l,headers:c,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var n;const r="PATCH",{url:a,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new hs({method:r,url:a,headers:i,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const n="DELETE",{url:r,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new hs({method:n,url:r,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function bo(t){"@babel/helpers - typeof";return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bo(t)}function m0(t,e){if(bo(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(bo(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v0(t){var e=m0(t,"string");return bo(e)=="symbol"?e:e+""}function b0(t,e,n){return(e=v0(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function cl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kd(Object(n),!0).forEach(function(r){b0(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kd(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var y0=class Hp{constructor(e,{headers:n={},schema:r,fetch:a,timeout:i,urlLengthLimit:o=8e3}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.urlLengthLimit=o;const l=a??globalThis.fetch;i!==void 0&&i>0?this.fetch=(c,h)=>{const f=new AbortController,m=setTimeout(()=>f.abort(),i),b=h==null?void 0:h.signal;if(b){if(b.aborted)return clearTimeout(m),l(c,h);const p=()=>{clearTimeout(m),f.abort()};return b.addEventListener("abort",p,{once:!0}),l(c,cl(cl({},h),{},{signal:f.signal})).finally(()=>{clearTimeout(m),b.removeEventListener("abort",p)})}return l(c,cl(cl({},h),{},{signal:f.signal})).finally(()=>clearTimeout(m))}:this.fetch=l}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new g0(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Hp(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,n={},{head:r=!1,get:a=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let h;const f=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(f)),m=r&&Object.values(n).some(f);m?(l="POST",h=n):r||a?(l=r?"HEAD":"GET",Object.entries(n).filter(([p,_])=>_!==void 0).map(([p,_])=>[p,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([p,_])=>{c.searchParams.append(p,_)})):(l="POST",h=n);const b=new Headers(this.headers);return m?b.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&b.set("Prefer",`count=${i}`),new hs({method:l,url:c,headers:b,schema:this.schemaName,body:h,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class _0{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const a=r.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const w0="2.97.0",x0=`realtime-js/${w0}`,S0="1.0.0",Wp="2.0.0",Nd=Wp,Pu=1e4,A0=1e3,k0=100;var sa;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(sa||(sa={}));var Dn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Dn||(Dn={}));var ei;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ei||(ei={}));var Ou;(function(t){t.websocket="websocket"})(Ou||(Ou={}));var Oa;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Oa||(Oa={}));class N0{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const a=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var n,r;const a=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,r){var a,i;const o=e.topic,l=(a=e.ref)!==null&&a!==void 0?a:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",h=e.payload.event,f=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(f).length===0?"":JSON.stringify(f);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const b=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+h.length+m.length,p=new ArrayBuffer(this.HEADER_LENGTH+b);let _=new DataView(p),w=0;_.setUint8(w++,this.KINDS.userBroadcastPush),_.setUint8(w++,c.length),_.setUint8(w++,l.length),_.setUint8(w++,o.length),_.setUint8(w++,h.length),_.setUint8(w++,m.length),_.setUint8(w++,n),Array.from(c,x=>_.setUint8(w++,x.charCodeAt(0))),Array.from(l,x=>_.setUint8(w++,x.charCodeAt(0))),Array.from(o,x=>_.setUint8(w++,x.charCodeAt(0))),Array.from(h,x=>_.setUint8(w++,x.charCodeAt(0))),Array.from(m,x=>_.setUint8(w++,x.charCodeAt(0)));var S=new Uint8Array(p.byteLength+r.byteLength);return S.set(new Uint8Array(p),0),S.set(new Uint8Array(r),p.byteLength),S.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[a,i,o,l,c]=r;return n({join_ref:a,ref:i,topic:o,event:l,payload:c})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),a=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,a)}}_decodeUserBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),l=n.getUint8(4);let c=this.HEADER_LENGTH+4;const h=r.decode(e.slice(c,c+a));c=c+a;const f=r.decode(e.slice(c,c+i));c=c+i;const m=r.decode(e.slice(c,c+o));c=c+o;const b=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(r.decode(b)):b,_={type:this.BROADCAST_EVENT,event:f,payload:p};return o>0&&(_.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:_}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class Gp{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Qt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Qt||(Qt={}));const Ed=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=E0(o,t,e,a),i),{}):{}},E0=(t,e,n,r)=>{const a=e.find(l=>l.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!r.includes(i)?Vp(i,o):Ru(o)},Vp=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return I0(e,n)}switch(t){case Qt.bool:return L0(e);case Qt.float4:case Qt.float8:case Qt.int2:case Qt.int4:case Qt.int8:case Qt.numeric:case Qt.oid:return C0(e);case Qt.json:case Qt.jsonb:return T0(e);case Qt.timestamp:return P0(e);case Qt.abstime:case Qt.date:case Qt.daterange:case Qt.int4range:case Qt.int8range:case Qt.money:case Qt.reltime:case Qt.text:case Qt.time:case Qt.timestamptz:case Qt.timetz:case Qt.tsrange:case Qt.tstzrange:return Ru(e);default:return Ru(e)}},Ru=t=>t,L0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},C0=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},T0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},I0=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Vp(e,l))}return t},P0=t=>typeof t=="string"?t.replace(" ","T"):t,Kp=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Mc{constructor(e,n,r={},a=Pu){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ld;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ld||(Ld={}));class fo{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fo.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=fo.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=fo.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(i,(h,f)=>{o[h]||(c[h]=f)}),this.map(o,(h,f)=>{const m=i[h];if(m){const b=f.map(S=>S.presence_ref),p=m.map(S=>S.presence_ref),_=f.filter(S=>p.indexOf(S.presence_ref)<0),w=m.filter(S=>b.indexOf(S.presence_ref)<0);_.length>0&&(l[h]=_),w.length>0&&(c[h]=w)}else l[h]=f}),this.syncDiff(i,{joins:l,leaves:c},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var h;const f=(h=e[l])!==null&&h!==void 0?h:[];if(e[l]=this.cloneDeep(c),f.length>0){const m=e[l].map(p=>p.presence_ref),b=f.filter(p=>m.indexOf(p.presence_ref)<0);e[l].unshift(...b)}r(l,f,c)}),this.map(o,(l,c)=>{let h=e[l];if(!h)return;const f=c.map(m=>m.presence_ref);h=h.filter(m=>f.indexOf(m.presence_ref)<0),e[l]=h,a(l,h,c),h.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Cd;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Cd||(Cd={}));var po;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(po||(po={}));var Bi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Bi||(Bi={}));class ms{constructor(e,n={config:{}},r){var a,i;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Dn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Mc(this,ei.join,this.params,this.timeout),this.rejoinTimer=new Gp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Dn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Dn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Dn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ei.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new fo(this),this.broadcastEndpointURL=Kp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Dn.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,h=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[po.PRESENCE]&&this.bindings[po.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},b={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:h,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Bi.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Bi.CLOSED)),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var _;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Bi.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(_=w==null?void 0:w.length)!==null&&_!==void 0?_:0,x=[];for(let T=0;T<S;T++){const R=w[T],{filter:{event:E,schema:U,table:Z,filter:O}}=R,J=p&&p[T];if(J&&J.event===E&&ms.isFilterValueEqual(J.schema,U)&&ms.isFilterValueEqual(J.table,Z)&&ms.isFilterValueEqual(J.filter,O))x.push(Object.assign(Object.assign({},R),{id:J.id}));else{this.unsubscribe(),this.state=Dn.errored,e==null||e(Bi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(Bi.SUBSCRIBED);return}}).receive("error",p=>{this.state=Dn.errored,e==null||e(Bi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Bi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Dn.joined&&e===po.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var a;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const h=await l.json();c=h.error||h.message||c}catch{}return Promise.reject(new Error(c))}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=h.body)===null||a===void 0?void 0:a.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const h=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Dn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ei.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Mc(this,ei.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Dn.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Mc(this,e,n,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>k0){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:h,join:f}=ei;if(r&&[l,c,h,f].indexOf(o)>=0&&r!==this._joinRef())return;let b=this._onMessage(o,n,r);if(n&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var _,w,S;return((_=p.filter)===null||_===void 0?void 0:_.event)==="*"||((S=(w=p.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(p=>p.callback(b,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var _,w,S,x,T,R;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const E=p.id,U=(_=p.filter)===null||_===void 0?void 0:_.event;return E&&((w=n.ids)===null||w===void 0?void 0:w.includes(E))&&(U==="*"||(U==null?void 0:U.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const E=(T=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return E==="*"||E===((R=n==null?void 0:n.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof b=="object"&&"ids"in b){const _=b.data,{schema:w,table:S,commit_timestamp:x,type:T,errors:R}=_;b=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:x,eventType:T,new:{},old:{},errors:R}),this._getPayloadRecords(_))}p.callback(b,r)})}_isClosed(){return this.state===Dn.closed}_isJoined(){return this.state===Dn.joined}_isJoining(){return this.state===Dn.joining}_isLeaving(){return this.state===Dn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ms.isEqual(a.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ei.close,{},e)}_onError(e){this._on(ei.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ed(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ed(e.columns,e.old_record)),n}}const Uc=()=>{},ul={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},O0=[1e3,2e3,5e3,1e4],R0=1e4,F0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class D0{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Pu,this.transport=null,this.heartbeatIntervalMs=ul.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Uc,this.ref=0,this.reconnectTimer=null,this.vsn=Nd,this.logger=Uc,this.conn=null,this.sendBuffer=[],this.serializer=new N0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Ou.websocket}`,this.httpEndpoint=Kp(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_0.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case sa.connecting:return Oa.Connecting;case sa.open:return Oa.Open;case sa.closing:return Oa.Closing;default:return Oa.Closed}}isConnected(){return this.connectionState()===Oa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new ms(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(A0,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ul.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",h)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:a,payload:i,ref:o}=n,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${a} ${l}`.trim(),i),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(a,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===sa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===sa.open||this.conn.readyState===sa.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(ei.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([F0],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(a=>{const i={access_token:n,version:x0};n&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(ei.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Gp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ul.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,a,i,o,l,c,h,f,m,b,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Pu,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:ul.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Uc,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:Nd,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:(_=>O0[_-1]||R0),this.vsn){case S0:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:((_,w)=>w(JSON.stringify(_))),this.decode=(m=e==null?void 0:e.decode)!==null&&m!==void 0?m:((_,w)=>w(JSON.parse(_)));break;case Wp:this.encode=(b=e==null?void 0:e.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var yo=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function j0(t,e,n){const r=new URL(e,t);if(n)for(const[a,i]of Object.entries(n))i!==void 0&&r.searchParams.set(a,i);return r.toString()}async function B0(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function M0(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:a,body:i,headers:o}){const l=j0(t.baseUrl,r,a),c=await B0(t.auth),h=await e(l,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),f=await h.text(),m=(h.headers.get("content-type")||"").includes("application/json"),b=m&&f?JSON.parse(f):f;if(!h.ok){const p=m?b:void 0,_=p==null?void 0:p.error;throw new yo((_==null?void 0:_.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:_==null?void 0:_.type,icebergCode:_==null?void 0:_.code,details:p})}return{status:h.status,headers:h.headers,data:b}}}}function hl(t){return t.join("")}var U0=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:hl(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${hl(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${hl(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${hl(t.namespace)}`}),!0}catch(e){if(e instanceof yo&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof yo&&n.status===409)return;throw n}}};function ns(t){return t.join("")}var q0=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ns(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof yo&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof yo&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},$0=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=M0({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new U0(this.client,e),this.tableOps=new q0(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Zl=class extends Error{constructor(t,e="storage",n,r){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=r}};function Ql(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var dl=class extends Zl{constructor(t,e,n,r="storage"){super(t,r,e,n),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Jp=class extends Zl{constructor(t,e,n="storage"){super(t,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const z0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),H0=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Fu=t=>{if(Array.isArray(t))return t.map(n=>Fu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Fu(r)}),e},W0=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function _o(t){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_o(t)}function G0(t,e){if(_o(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(_o(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V0(t){var e=G0(t,"string");return _o(e)=="symbol"?e:e+""}function K0(t,e,n){return(e=V0(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Td(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Td(Object(n),!0).forEach(function(r){K0(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Td(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const Id=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},J0=async(t,e,n,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const a=t,i=a.status||500;if(typeof a.json=="function")a.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";e(new dl(Id(o),i,l,r))}).catch(()=>{if(r==="vectors"){const o=i+"";e(new dl(a.statusText||`HTTP ${i} error`,i,o,r))}else{const o=i+"";e(new dl(a.statusText||`HTTP ${i} error`,i,o,r))}});else{const o=i+"";e(new dl(a.statusText||`HTTP ${i} error`,i,o,r))}}else e(new Jp(Id(t),t,r))},Y0=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||t==="HEAD"||!r?ot(ot({},a),n):(H0(r)?(a.headers=ot({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),ot(ot({},a),n))};async function Qs(t,e,n,r,a,i,o){return new Promise((l,c)=>{t(n,Y0(e,r,a,i)).then(h=>{if(!h.ok)throw h;if(r!=null&&r.noResolveJson)return h;if(o==="vectors"){const f=h.headers.get("content-type");if(h.headers.get("content-length")==="0"||h.status===204)return{};if(!f||!f.includes("application/json"))return{}}return h.json()}).then(h=>l(h)).catch(h=>J0(h,c,r,o))})}function Yp(t="storage"){return{get:async(e,n,r,a)=>Qs(e,"GET",n,r,a,void 0,t),post:async(e,n,r,a,i)=>Qs(e,"POST",n,a,i,r,t),put:async(e,n,r,a,i)=>Qs(e,"PUT",n,a,i,r,t),head:async(e,n,r,a)=>Qs(e,"HEAD",n,ot(ot({},r),{},{noResolveJson:!0}),a,void 0,t),remove:async(e,n,r,a,i)=>Qs(e,"DELETE",n,a,i,r,t)}}const X0=Yp("storage"),{get:wo,post:Qr,put:Du,head:Z0,remove:hh}=X0,Lr=Yp("vectors");var Ns=class{constructor(t,e={},n,r="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=z0(n),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=ot(ot({},this.headers),{},{[t]:e}),this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ql(n))return{data:null,error:n};throw n}}},Q0=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ql(e))return{data:null,error:e};throw e}}};let Xp;Xp=Symbol.toStringTag;var e1=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Xp]="BlobDownloadBuilder",this.promise=null}asStream(){return new Q0(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ql(e))return{data:null,error:e};throw e}}};const t1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var n1=class extends Ns{constructor(t,e={},n,r){super(t,e,r,"storage"),this.bucketId=n}async uploadOrUpdate(t,e,n,r){var a=this;return a.handleOperation(async()=>{let i;const o=ot(ot({},Pd),r);let l=ot(ot({},a.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",a.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),r!=null&&r.headers&&(l=ot(ot({},l),r.headers));const h=a._removeEmptyFolders(e),f=a._getFinalPath(h),m=await(t=="PUT"?Du:Qr)(a.fetch,`${a.url}/object/${f}`,i,ot({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{path:h,id:m.Id,fullPath:m.Key}})}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var a=this;const i=a._removeEmptyFolders(t),o=a._getFinalPath(i),l=new URL(a.url+`/object/upload/sign/${o}`);return l.searchParams.set("token",e),a.handleOperation(async()=>{let c;const h=ot({upsert:Pd.upsert},r),f=ot(ot({},a.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",h.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",h.cacheControl)):(c=n,f["cache-control"]=`max-age=${h.cacheControl}`,f["content-type"]=h.contentType),{path:i,fullPath:(await Du(a.fetch,l.toString(),c,{headers:f})).Key}})}async createSignedUploadUrl(t,e){var n=this;return n.handleOperation(async()=>{let r=n._getFinalPath(t);const a=ot({},n.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const i=await Qr(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(n.url+i.url),l=o.searchParams.get("token");if(!l)throw new Zl("No token returned by API");return{signedUrl:o.toString(),path:t,token:l}})}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;return r.handleOperation(async()=>await Qr(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}))}async copy(t,e,n){var r=this;return r.handleOperation(async()=>({path:(await Qr(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(t,e,n){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(t),i=await Qr(r.fetch,`${r.url}/object/sign/${a}`,ot({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${r.url}${i.signedURL}${o}`)}})}async createSignedUrls(t,e,n){var r=this;return r.handleOperation(async()=>{const a=await Qr(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a.map(o=>ot(ot({},o),{},{signedUrl:o.signedURL?encodeURI(`${r.url}${o.signedURL}${i}`):null}))})}download(t,e,n){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=a?`?${a}`:"",o=this._getFinalPath(t),l=()=>wo(this.fetch,`${this.url}/${r}/${o}${i}`,{headers:this.headers,noResolveJson:!0},n);return new e1(l,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);return e.handleOperation(async()=>Fu(await wo(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})))}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await Z0(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ql(r)&&r instanceof Jp){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&r.push(a);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&r.push(o);let l=r.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${l}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await hh(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,n){var r=this;return r.handleOperation(async()=>{const a=ot(ot(ot({},t1),e),{},{prefix:t||""});return await Qr(r.fetch,`${r.url}/object/list/${r.bucketId}`,a,{headers:r.headers},n)})}async listV2(t,e){var n=this;return n.handleOperation(async()=>{const r=ot({},t);return await Qr(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const r1="2.97.0",Co={"X-Client-Info":`storage-js/${r1}`};var i1=class extends Ns{constructor(t,e={},n,r){const a=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const i=a.href.replace(/\/$/,""),o=ot(ot({},Co),e);super(i,o,n,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=e.listBucketOptionsToQueryString(t);return await wo(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await wo(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var n=this;return n.handleOperation(async()=>await Qr(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async updateBucket(t,e){var n=this;return n.handleOperation(async()=>await Du(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await Qr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await hh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},a1=class extends Ns{constructor(t,e={},n){const r=t.replace(/\/$/,""),a=ot(ot({},Co),e);super(r,a,n,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Qr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),a=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return await wo(e.fetch,a,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await hh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!W0(t))throw new Zl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new $0({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(a,l),error:null}}catch(c){if(r)throw c;return{data:null,error:c}}}}})}},s1=class extends Ns{constructor(t,e={},n){const r=t.replace(/\/$/,""),a=ot(ot({},Co),{},{"Content-Type":"application/json"},e);super(r,a,n,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var n=this;return n.handleOperation(async()=>await Lr.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var n=this;return n.handleOperation(async()=>await Lr.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{})}},o1=class extends Ns{constructor(t,e={},n){const r=t.replace(/\/$/,""),a=ot(ot({},Co),{},{"Content-Type":"application/json"},e);super(r,a,n,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},l1=class extends Ns{constructor(t,e={},n){const r=t.replace(/\/$/,""),a=ot(ot({},Co),{},{"Content-Type":"application/json"},e);super(r,a,n,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Lr.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},c1=class extends l1{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new u1(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},u1=class extends s1{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new h1(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},h1=class extends o1{constructor(t,e,n,r,a){super(t,e,a),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,ot(ot({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},d1=class extends i1{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new n1(this.url,this.headers,t,this.fetch)}get vectors(){return new c1(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new a1(this.url+"/iceberg",this.headers,this.fetch)}};const Zp="2.97.0",ds=30*1e3,ju=3,qc=ju*ds,f1="http://localhost:9999",p1="supabase.auth.token",g1={"X-Client-Info":`gotrue-js/${Zp}`},Bu="X-Supabase-Api-Version",Qp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,v1=600*1e3;class xo extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ye(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class b1 extends xo{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function y1(t){return Ye(t)&&t.name==="AuthApiError"}class Ra extends xo{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ui extends xo{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Nr extends Ui{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $c(t){return Ye(t)&&t.name==="AuthSessionMissingError"}class rs extends Ui{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fl extends Ui{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class pl extends Ui{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _1(t){return Ye(t)&&t.name==="AuthImplicitGrantRedirectError"}class Od extends Ui{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class w1 extends Ui{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Mu extends Ui{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function zc(t){return Ye(t)&&t.name==="AuthRetryableFetchError"}class Rd extends Ui{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Uu extends Ui{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ql="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fd=` 	
\r=`.split(""),x1=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Fd.length;e+=1)t[Fd[e].charCodeAt(0)]=-2;for(let e=0;e<ql.length;e+=1)t[ql[e].charCodeAt(0)]=e;return t})();function Dd(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ql[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ql[r]),e.queuedBits-=6}}function eg(t,e,n){const r=x1[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function jd(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{k1(o,r,n)};for(let o=0;o<t.length;o+=1)eg(t.charCodeAt(o),a,i);return e.join("")}function S1(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function A1(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}S1(r,e)}}function k1(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function bs(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)eg(t.charCodeAt(a),n,r);return new Uint8Array(e)}function N1(t){const e=[];return A1(t,n=>e.push(n)),new Uint8Array(e)}function Da(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>Dd(a,n,r)),Dd(null,n,r),e.join("")}function E1(t){return Math.round(Date.now()/1e3)+t}function L1(){return Symbol("auth-callback")}const Wn=()=>typeof window<"u"&&typeof document<"u",Ea={tested:!1,writable:!1},tg=()=>{if(!Wn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ea.tested)return Ea.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ea.tested=!0,Ea.writable=!0}catch{Ea.tested=!0,Ea.writable=!1}return Ea.writable};function C1(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const ng=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),T1=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",fs=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},La=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Hn=async(t,e)=>{await t.removeItem(e)};class ec{constructor(){this.promise=new ec.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}ec.promiseConstructor=Promise;function gl(t){const e=t.split(".");if(e.length!==3)throw new Uu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!m1.test(e[r]))throw new Uu("JWT not in base64url format");return{header:JSON.parse(jd(e[0])),payload:JSON.parse(jd(e[1])),signature:bs(e[2]),raw:{header:e[0],payload:e[1]}}}async function I1(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function P1(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function O1(t){return("0"+t.toString(16)).substr(-2)}function R1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,O1).join("")}async function F1(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function D1(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await F1(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function is(t,e,n=!1){const r=R1();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await fs(t,`${e}-code-verifier`,a);const i=await D1(r);return[i,r===i?"plain":"s256"]}const j1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B1(t){const e=t.headers.get(Bu);if(!e||!e.match(j1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function M1(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function U1(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const q1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function as(t){if(!q1.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Hc(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $1(t,e){return new Proxy(t,{get:(n,r,a)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,a)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,a)}})}function Bd(t){return JSON.parse(JSON.stringify(t))}const Ta=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),z1=[502,503,504];async function Md(t){var e;if(!T1(t))throw new Mu(Ta(t),0);if(z1.includes(t.status))throw new Mu(Ta(t),t.status);let n;try{n=await t.json()}catch(i){throw new Ra(Ta(i),i)}let r;const a=B1(t);if(a&&a.getTime()>=Qp["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Rd(Ta(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Nr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Rd(Ta(n),t.status,n.weak_password.reasons);throw new b1(Ta(n),t.status||500,r)}const H1=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function lt(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Bu]||(i[Bu]=Qp["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await W1(t,e,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function W1(t,e,n,r,a,i){const o=H1(e,r,a,i);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new Mu(Ta(c),0)}if(l.ok||await Md(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await Md(c)}}function Yr(t){var e;let n=null;K1(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=E1(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Ud(t){const e=Yr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function oa(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function G1(t){return{data:t,error:null}}function V1(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,o=Xl(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function qd(t){return t}function K1(t){return t.access_token&&t.refresh_token&&t.expires_in}const Wc=["global","local","others"];class J1{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=ng(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=Wc[0]){if(Wc.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wc.join(", ")}`);try{return await lt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await lt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:oa})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Xl(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await lt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:V1,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ye(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:oa})}catch(n){if(Ye(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,o,l,c;try{const h={nextPage:null,lastPage:0,total:0},f=await lt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:qd});if(f.error)throw f.error;const m=await f.json(),b=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(_.split(";")[1].split("=")[1]);h[`${S}Page`]=w}),h.total=parseInt(b)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Ye(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){as(e);try{return await lt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:oa})}catch(n){if(Ye(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){as(e);try{return await lt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:oa})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){as(e);try{return await lt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:oa})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){as(e.userId);try{const{data:n,error:r}=await lt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(Ye(n))return{data:null,error:n};throw n}}async _deleteFactor(e){as(e.userId),as(e.id);try{return{data:await lt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,a,i,o,l,c;try{const h={nextPage:null,lastPage:0,total:0},f=await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:qd});if(f.error)throw f.error;const m=await f.json(),b=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(_.split(";")[1].split("=")[1]);h[`${S}Page`]=w}),h.total=parseInt(b)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Ye(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ye(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ye(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await lt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ye(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await lt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ye(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ye(n))return{data:null,error:n};throw n}}}function $d(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const ss={debug:!!(globalThis&&tg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class zd extends rg{}async function Y1(t,e,n){ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;e>0&&setTimeout(()=>{r.abort(),ss.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve();try{return await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new zd(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ss.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}catch(a){throw(a==null?void 0:a.name)==="AbortError"?new zd(`Acquiring an exclusive Navigator LockManager lock "${t}" timed out waiting ${e}ms`):a}}function X1(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ig(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Z1(t){return parseInt(t,16)}function Q1(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function e2(t){var e;const{chainId:n,domain:r,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:h,scheme:f,uri:m,version:b}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=ig(t.address),_=f?`${f}://${r}`:r,w=t.statement?`${t.statement}
`:"",S=`${_} wants you to sign in with your Ethereum account:
${p}

${w}`;let x=`URI: ${m}
Version: ${b}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),h){let T=`
Resources:`;for(const R of h){if(!R||typeof R!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${R}`);T+=`
- ${R}`}x+=T}return`${S}
${x}`}class En extends Error{constructor({message:e,code:n,cause:r,name:a}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=a??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class $l extends En{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function t2({error:t,options:e}){var n,r,a;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new En({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new En({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new En({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new En({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new En({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new En({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new En({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new En({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(ag(o)){if(i.rp.id!==o)return new En({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new En({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new En({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new En({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new En({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function n2({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new En({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new En({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(ag(r)){if(n.rpId!==r)return new En({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new En({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new En({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new En({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class r2{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const i2=new r2;function a2(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,a=Xl(t,["challenge","user","excludeCredentials"]),i=bs(e).buffer,o=Object.assign(Object.assign({},n),{id:bs(n.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const h=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},h),{id:bs(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return l}function s2(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=Xl(t,["challenge","allowCredentials"]),a=bs(e).buffer,i=Object.assign(Object.assign({},r),{challenge:a});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const l=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:bs(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function o2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Da(new Uint8Array(t.response.attestationObject)),clientDataJSON:Da(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function l2(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Da(new Uint8Array(a.authenticatorData)),clientDataJSON:Da(new Uint8Array(a.clientDataJSON)),signature:Da(new Uint8Array(a.signature)),userHandle:a.userHandle?Da(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ag(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Hd(){var t,e;return!!(Wn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function c2(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $l("Browser returned unexpected credential type",e)}:{data:null,error:new $l("Empty credential response",e)}}catch(e){return{data:null,error:t2({error:e,options:t})}}}async function u2(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $l("Browser returned unexpected credential type",e)}:{data:null,error:new $l("Empty credential response",e)}}catch(e){return{data:null,error:n2({error:e,options:t})}}}const h2={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},d2={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function zl(...t){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),n=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),r={};for(const a of t)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(n(o))r[i]=o;else if(e(o)){const l=r[i];e(l)?r[i]=zl(l,o):r[i]=zl(o)}else r[i]=o}return r}function f2(t,e){return zl(h2,t,e||{})}function p2(t,e){return zl(d2,t,e||{})}class g2{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:a},i){var o;try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!l)return{data:null,error:c};const h=a??i2.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:f}=l.webauthn.credential_options.publicKey;if(!f.name){const m=r;if(m)f.name=`${f.id}:${m}`;else{const p=(await this.client.getUser()).data.user,_=((o=p==null?void 0:p.user_metadata)===null||o===void 0?void 0:o.name)||(p==null?void 0:p.email)||(p==null?void 0:p.id)||"User";f.name=`${f.id}:${_}`}}f.displayName||(f.displayName=f.name)}switch(l.webauthn.type){case"create":{const f=f2(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:m,error:b}=await c2({publicKey:f,signal:h});return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}case"request":{const f=p2(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:m,error:b}=await u2(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:f,signal:h}));return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}}}catch(l){return Ye(l)?{data:null,error:l}:{data:null,error:new Ra("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!n)return{data:null,error:new xo("rpId is required for WebAuthn authentication")};try{if(!Hd())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:n,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return Ye(o)?{data:null,error:o}:{data:null,error:new Ra("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!n)return{data:null,error:new xo("rpId is required for WebAuthn registration")};try{if(!Hd())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(f=>{var m;return(m=f.data)===null||m===void 0?void 0:m.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===e&&b.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:l};const{data:c,error:h}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:a},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:n,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:h}}catch(o){return Ye(o)?{data:null,error:o}:{data:null,error:new Ra("Unexpected error in register",o)}}}}X1();const m2={url:f1,storageKey:p1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:g1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function Wd(t,e,n){return await n()}const os={};class So{get jwks(){var e,n;return(n=(e=os[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){os[this.storageKey]=Object.assign(Object.assign({},os[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=os[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){os[this.storageKey]=Object.assign(Object.assign({},os[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},m2),e);if(this.storageKey=i.storageKey,this.instanceID=(n=So.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,So.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Wn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new J1({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=ng(i.fetch),this.lock=i.lock||Wd,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Wn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Y1:this.lock=Wd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new g2(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:tg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$d(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=$d(this.memoryStorage)),Wn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}i.skipAutoInitialize||this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Zp}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(Wn()&&(n=C1(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),Wn()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),_1(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ye(n)?this._returnResult({error:n}):this._returnResult({error:new Ra("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Yr}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:h,session:c},error:null})}catch(i){if(Ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:f,password:m,options:b}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await is(this.storage,this.storageKey)),i=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b==null?void 0:b.emailRedirectTo,body:{email:f,password:m,data:(n=b==null?void 0:b.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken},code_challenge:p,code_challenge_method:_},xform:Yr})}else if("phone"in e){const{phone:f,password:m,options:b}=e;i=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(r=b==null?void 0:b.data)!==null&&r!==void 0?r:{},channel:(a=b==null?void 0:b.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},xform:Yr})}else throw new fl("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await Hn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:h,session:c},error:null})}catch(i){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:l}=e;n=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ud})}else if("phone"in e){const{phone:i,password:o,options:l}=e;n=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ud})}else throw new fl("You must provide either an email or phone number and a password");const{data:r,error:a}=n;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!r||!r.session||!r.user){const i=new rs;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(Ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,a,i,o,l,c,h,f,m,b;let p,_;if("message"in e)p=e.message,_=e.signature;else{const{chain:w,wallet:S,statement:x,options:T}=e;let R;if(Wn())if(typeof S=="object")R=S;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")R=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=S}const E=new URL((n=T==null?void 0:T.url)!==null&&n!==void 0?n:window.location.href),U=await R.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!U||U.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const Z=ig(U[0]);let O=(r=T==null?void 0:T.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!O){const F=await R.request({method:"eth_chainId"});O=Z1(F)}const J={domain:E.host,address:Z,statement:x,uri:E.href,version:"1",chainId:O,nonce:(a=T==null?void 0:T.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=T==null?void 0:T.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=T==null?void 0:T.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=T==null?void 0:T.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(h=T==null?void 0:T.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(f=T==null?void 0:T.signInWithEthereum)===null||f===void 0?void 0:f.resources};p=e2(J),_=await R.request({method:"personal_sign",params:[Q1(p),Z]})}try{const{data:w,error:S}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:_},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Yr});if(S)throw S;if(!w||!w.session||!w.user){const x=new rs;return this._returnResult({data:{user:null,session:null},error:x})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(Ye(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var n,r,a,i,o,l,c,h,f,m,b,p;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:S,wallet:x,statement:T,options:R}=e;let E;if(Wn())if(typeof x=="object")E=x;else{const Z=window;if("solana"in Z&&typeof Z.solana=="object"&&("signIn"in Z.solana&&typeof Z.solana.signIn=="function"||"signMessage"in Z.solana&&typeof Z.solana.signMessage=="function"))E=Z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(R!=null&&R.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=x}const U=new URL((n=R==null?void 0:R.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in E&&E.signIn){const Z=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},R==null?void 0:R.signInWithSolana),{version:"1",domain:U.host,uri:U.href}),T?{statement:T}:null));let O;if(Array.isArray(Z)&&Z[0]&&typeof Z[0]=="object")O=Z[0];else if(Z&&typeof Z=="object"&&"signedMessage"in Z&&"signature"in Z)O=Z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)_=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),w=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${U.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${U.href}`,`Issued At: ${(a=(r=R==null?void 0:R.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=R==null?void 0:R.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${R.signInWithSolana.notBefore}`]:[],...!((o=R==null?void 0:R.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${R.signInWithSolana.expirationTime}`]:[],...!((l=R==null?void 0:R.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${R.signInWithSolana.chainId}`]:[],...!((c=R==null?void 0:R.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${R.signInWithSolana.nonce}`]:[],...!((h=R==null?void 0:R.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${R.signInWithSolana.requestId}`]:[],...!((m=(f=R==null?void 0:R.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||m===void 0)&&m.length?["Resources",...R.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const Z=await E.signMessage(new TextEncoder().encode(_),"utf8");if(!Z||!(Z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=Z}}try{const{data:S,error:x}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:Da(w)},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Yr});if(x)throw x;if(!S||!S.session||!S.user){const T=new rs;return this._returnResult({data:{user:null,session:null},error:T})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:x})}catch(S){if(Ye(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const n=await La(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new w1;const{data:i,error:o}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Yr});if(await Hn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new rs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:o}=e,l=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Yr}),{data:c,error:h}=l;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c||!c.session||!c.user){const f=new rs;return this._returnResult({data:{user:null,session:null},error:f})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:h})}catch(n){if(Ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let h=null,f=null;this.flowType==="pkce"&&([h,f]=await is(this.storage,this.storageKey));const{error:m}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:h,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:l,options:c}=e,{data:h,error:f}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:f})}throw new fl("You must provide either an email or phone number.")}catch(l){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await lt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Yr});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,h=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:h,session:c},error:null})}catch(a){if(Ye(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var n,r,a,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await is(this.storage,this.storageKey));const h=await lt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:G1});return!((i=h.data)===null||i===void 0)&&i.url&&Wn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(l){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Nr;const{error:a}=await lt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Ye(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await lt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:l}=await lt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new fl("You must provide either an email or phone number and a type")}catch(n){if(Ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await La(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<qc:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await La(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Hc()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=$1(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:oa}):await this._useSession(async n=>{var r,a,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nr}:await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:oa})})}catch(n){if(Ye(n))return $c(n)&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Nr;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await is(this.storage,this.storageKey));const{data:h,error:f}=await lt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:oa});if(f)throw f;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nr;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:o}=gl(e.access_token);if(o.exp&&(r=o.exp,a=r<=n),a){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Ye(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Nr;const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Wn())throw new pl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new pl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Od("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new pl("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Od("No code detected.");const{data:T,error:R}=await this._exchangeCodeForSession(e.code);if(R)throw R;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:h}=e;if(!i||!l||!o||!h)throw new pl("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(l);let b=f+m;c&&(b=parseInt(c));const p=b-f;p*1e3<=ds&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${m}s`);const _=b-m;f-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,b,f):f-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,b,f);const{data:w,error:S}=await this._getUser(i);if(S)throw S;const x={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:m,expires_at:b,refresh_token:o,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:e.type},error:null})}catch(r){if(Ye(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await La(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i&&!$c(i))return this._returnResult({error:i});const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(y1(l)&&(l.status===404||l.status===401||l.status===403)||$c(l)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=L1(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await is(this.storage,this.storageKey,!0));try{return await lt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var o,l,c,h,f;const{data:m,error:b}=i;if(b)throw b;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await lt(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(h=m.session)===null||h===void 0?void 0:h.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return Wn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(Ye(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:a,data:{session:i}}=n;if(a)throw a;const{options:o,provider:l,token:c,access_token:h,nonce:f}=e,m=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:h,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Yr}),{data:b,error:p}=m;return p?this._returnResult({data:{user:null,session:null},error:p}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new rs}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:p}))}catch(a){if(await Hn(this.storage,`${this.storageKey}-code-verifier`),Ye(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)throw o;return await lt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await P1(async a=>(a>0&&await I1(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await lt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Yr})),(a,i)=>{const o=200*Math.pow(2,a);return i&&zc(i)&&Date.now()+o-r<ds})}catch(r){if(this._debug(n,"error",r),Ye(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Wn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await La(this.storage,this.storageKey);if(a&&this.userStorage){let o=await La(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await fs(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Hc()}else if(a&&!a.user&&!a.user){const o=await La(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Hn(this.storage,this.storageKey+"-user"),await fs(this.storage,this.storageKey,a)):a.user=Hc()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const i=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<qc;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${qc}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),zc(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ec;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Ye(i)){const o={data:null,error:i};return zc(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Hn(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await fs(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const i=Bd(a);await fs(this.storage,this.storageKey,i)}else{const a=Bd(n);await fs(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Hn(this.storage,this.storageKey),await Hn(this.storage,this.storageKey+"-code-verifier"),await Hn(this.storage,this.storageKey+"-user"),this.userStorage&&await Hn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ds);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/ds);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ds}ms, refresh threshold is ${ju} ticks`),a<=ju&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await is(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?this._returnResult({data:null,error:i}):await lt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:h}=await lt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?o2(e.webauthn.credential_response):l2(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await lt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await lt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:a2(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:s2(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var n,r,a,i;if(e)try{const{payload:p}=gl(e);let _=null;p.aal&&(_=p.aal);let w=_;const{data:{user:S},error:x}=await this.getUser(e);if(x)return this._returnResult({data:null,error:x});((r=(n=S==null?void 0:S.factors)===null||n===void 0?void 0:n.filter(E=>E.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(w="aal2");const R=p.amr||[];return{data:{currentLevel:_,nextLevel:w,currentAuthenticationMethods:R},error:null}}catch(p){if(Ye(p))return this._returnResult({data:null,error:p});throw p}const{data:{session:o},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=gl(o.access_token);let h=null;c.aal&&(h=c.aal);let f=h;((i=(a=o.user.factors)===null||a===void 0?void 0:a.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(f="aal2");const b=c.amr||[];return{data:{currentLevel:h,nextLevel:f,currentAuthenticationMethods:b},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:a}=n;return a?this._returnResult({data:null,error:a}):r?await lt(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Nr})})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Nr});const o=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(Ye(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Nr});const o=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(Ye(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await lt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Nr})})}catch(e){if(Ye(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:a}=n;return a?this._returnResult({data:null,error:a}):r?(await lt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Nr})})}catch(n){if(Ye(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+v1>a)return r;const{data:i,error:o}=await lt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:p,error:_}=await this.getSession();if(_||!p.session)return this._returnResult({data:null,error:_});r=p.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=gl(r);n!=null&&n.allowExpired||M1(i.exp);const h=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!h){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:a,signature:o},error:null}}const f=U1(a.alg),m=await crypto.subtle.importKey("jwk",h,f,!0,["verify"]);if(!await crypto.subtle.verify(f,m,o,N1(`${l}.${c}`)))throw new Uu("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(Ye(r))return this._returnResult({data:null,error:r});throw r}}}So.nextInstanceID={};const v2=So,b2="2.97.0";let co="";typeof Deno<"u"?co="deno":typeof document<"u"?co="web":typeof navigator<"u"&&navigator.product==="ReactNative"?co="react-native":co="node";const y2={"X-Client-Info":`supabase-js-${co}/${b2}`},_2={headers:y2},w2={schema:"public"},x2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},S2={};function Ao(t){"@babel/helpers - typeof";return Ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ao(t)}function A2(t,e){if(Ao(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ao(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function k2(t){var e=A2(t,"string");return Ao(e)=="symbol"?e:e+""}function N2(t,e,n){return(e=k2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function pn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Gd(Object(n),!0).forEach(function(r){N2(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gd(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const E2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),L2=()=>Headers,C2=(t,e,n)=>{const r=E2(n),a=L2();return async(i,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let h=new a(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",t),h.has("Authorization")||h.set("Authorization",`Bearer ${c}`),r(i,pn(pn({},o),{},{headers:h}))}};function T2(t){return t.endsWith("/")?t:t+"/"}function I2(t,e){var n,r;const{db:a,auth:i,realtime:o,global:l}=t,{db:c,auth:h,realtime:f,global:m}=e,b={db:pn(pn({},c),a),auth:pn(pn({},h),i),realtime:pn(pn({},f),o),storage:{},global:pn(pn(pn({},m),l),{},{headers:pn(pn({},(n=m==null?void 0:m.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?b.accessToken=t.accessToken:delete b.accessToken,b}function P2(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(T2(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var O2=class extends v2{constructor(t){super(t)}},R2=class{constructor(t,e,n){var r,a;this.supabaseUrl=t,this.supabaseKey=e;const i=P2(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:w2,realtime:S2,auth:pn(pn({},x2),{},{storageKey:o}),global:_2},c=I2(n??{},l);if(this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=c.auth)!==null&&h!==void 0?h:{},this.headers,c.global.fetch)}this.fetch=C2(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(pn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new y0(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch,timeout:c.db.timeout,urlLengthLimit:c.db.urlLengthLimit}),this.storage=new d1(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new h0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:a,storageKey:i,flowType:o,lock:l,debug:c,throwOnError:h},f,m){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new O2({url:this.authUrl.href,headers:pn(pn({},b),f),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:a,flowType:o,lock:l,debug:c,throwOnError:h,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new D0(this.realtimeUrl.href,pn(pn({},t),{},{params:pn(pn({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const F2=(t,e,n)=>new R2(t,e,n);function D2(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}D2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const j2="https://ujuxhijcomgkqfwaovow.supabase.co",B2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqdXhoaWpjb21na3Fmd2Fvdm93Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3NTg0NzgsImV4cCI6MjA4NzMzNDQ3OH0.pZuqL4HDtt5Z8yFf7tQNe5hTEz_W0_zyIV-lPebV_1Q",ke=F2(j2,B2),sg=ch(null);function M2({children:t}){const[e,n]=be(null),[r,a]=be(!0);jt(()=>{ke.auth.getSession().then(({data:{session:c}})=>{n((c==null?void 0:c.user)??null),a(!1)});const{data:{subscription:l}}=ke.auth.onAuthStateChange((c,h)=>{n((h==null?void 0:h.user)??null)});return()=>l.unsubscribe()},[]);const i=Nt(async(l,c)=>{const{error:h}=await ke.auth.signInWithPassword({email:l,password:c});if(h)throw h},[]),o=Nt(async()=>{await ke.auth.signOut()},[]);return s(sg.Provider,{value:{user:e,loading:r,signIn:i,signOut:o},children:t})}function tc(){const t=qp(sg);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const og=ch(null);function U2({children:t}){const[e,n]=be([]),r=Nt((i,o="info")=>{const l=Date.now();n(c=>[...c,{id:l,message:i,type:o}]),setTimeout(()=>{n(c=>c.filter(h=>h.id!==l))},3e3)},[]),a={success:i=>r(i,"success"),error:i=>r(i,"error"),info:i=>r(i,"info")};return s(og.Provider,{value:a,children:[t,s("div",{class:"toast-container",children:e.map(i=>s("div",{class:`toast toast-${i.type}`,children:i.message},i.id))})]})}function lr(){return qp(og)}var q2={};function ml(t,e){for(var n in e)t[n]=e[n];return t}function $2(t,e,n){var r,a=/(?:\?([^#]*))?(#.*)?$/,i=t.match(a),o={};if(i&&i[1])for(var l=i[1].split("&"),c=0;c<l.length;c++){var h=l[c].split("=");o[decodeURIComponent(h[0])]=decodeURIComponent(h.slice(1).join("="))}t=qu(t.replace(a,"")),e=qu(e||"");for(var f=Math.max(t.length,e.length),m=0;m<f;m++)if(e[m]&&e[m].charAt(0)===":"){var b=e[m].replace(/(^:|[+*?]+$)/g,""),p=(e[m].match(/[+*?]+$/)||q2)[0]||"",_=~p.indexOf("+"),w=~p.indexOf("*"),S=t[m]||"";if(!S&&!w&&(p.indexOf("?")<0||_)){r=!1;break}if(o[b]=decodeURIComponent(S),_||w){o[b]=t.slice(m).map(decodeURIComponent).join("/");break}}else if(e[m]!==t[m]){r=!1;break}return(n.default===!0||r!==!1)&&o}function z2(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:t.index-e.index}function H2(t,e){return t.index=e,t.rank=(function(n){return n.props.default?0:qu(n.props.path).map(W2).join("")})(t),t.props}function qu(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")}function W2(t){return t.charAt(0)==":"?1+"*+?".indexOf(t.charAt(t.length-1))||4:5}var G2={},ja=[],Vd=[],Er=null,lg={url:dh()},V2=ch(lg);function dh(){var t;return""+((t=Er&&Er.location?Er.location:Er&&Er.getCurrentLocation?Er.getCurrentLocation():typeof location<"u"?location:G2).pathname||"")+(t.search||"")}function Ve(t,e){return e===void 0&&(e=!1),typeof t!="string"&&t.url&&(e=t.replace,t=t.url),(function(n){for(var r=ja.length;r--;)if(ja[r].canRoute(n))return!0;return!1})(t)&&(function(n,r){r===void 0&&(r="push"),Er&&Er[r]?Er[r](n):typeof history<"u"&&history[r+"State"]&&history[r+"State"](null,null,n)})(t,e?"replace":"push"),cg(t)}function cg(t){for(var e=!1,n=0;n<ja.length;n++)ja[n].routeTo(t)&&(e=!0);return e}function K2(t){if(t&&t.getAttribute){var e=t.getAttribute("href"),n=t.getAttribute("target");if(e&&e.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return Ve(e)}}function J2(t){return t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault(),!1}function Y2(t){if(!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button)){var e=t.target;do if(e.localName==="a"&&e.getAttribute("href")){if(e.hasAttribute("data-native")||e.hasAttribute("native"))return;if(K2(e))return J2(t)}while(e=e.parentNode)}}var Kd=!1;function ug(t){t.history&&(Er=t.history),this.state={url:t.url||dh()}}ml(ug.prototype=new ho,{shouldComponentUpdate:function(t){return t.static!==!0||t.url!==this.props.url||t.onChange!==this.props.onChange},canRoute:function(t){var e=Lu(this.props.children);return this.g(e,t)!==void 0},routeTo:function(t){this.setState({url:t});var e=this.canRoute(t);return this.p||this.forceUpdate(),e},componentWillMount:function(){this.p=!0},componentDidMount:function(){var t=this;Kd||(Kd=!0,Er||addEventListener("popstate",function(){cg(dh())}),addEventListener("click",Y2)),ja.push(this),Er&&(this.u=Er.listen(function(e){var n=e.location||e;t.routeTo(""+(n.pathname||"")+(n.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),ja.splice(ja.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(t,e){t=t.filter(H2).sort(z2);for(var n=0;n<t.length;n++){var r=t[n],a=$2(e,r.props.path,r.props);if(a)return[r,a]}},render:function(t,e){var n,r,a=t.onChange,i=e.url,o=this.c,l=this.g(Lu(t.children),i);if(l&&(r=n0(l[0],ml(ml({url:i,matches:n=l[1]},n),{key:void 0,ref:void 0}))),i!==(o&&o.url)){ml(lg,o=this.c={url:i,previous:o&&o.url,current:r,path:r?r.props.path:null,matches:n}),o.router=this,o.active=r?[r]:[];for(var c=Vd.length;c--;)Vd[c]({});typeof a=="function"&&a(o)}return Pp(V2.Provider,{value:o},r)}});function X2({children:t}){const{signOut:e}=tc(),[n,r]=be(!1),[a,i]=be(typeof window<"u"?window.location.pathname:"/crm/");jt(()=>{const c=()=>i(window.location.pathname);return window.addEventListener("popstate",c),()=>window.removeEventListener("popstate",c)},[]);function o(c){r(!1),Ve(c),i(c)}return s("div",{class:"app-layout",children:[s("button",{class:"mobile-toggle",onClick:()=>r(!n),"aria-label":"Menu",children:n?"":""}),s("aside",{class:`sidebar ${n?"open":""}`,children:[s("div",{class:"sidebar-brand",onClick:()=>o("/crm/"),style:"cursor:pointer",children:"Beck360 CRM"}),s("nav",{class:"sidebar-nav",children:[{path:"/crm/",label:"Dashboard",icon:""},{path:"/crm/pipeline",label:"Pipeline",icon:""},{path:"/crm/contacts",label:"Kontakte",icon:""},{path:"/crm/companies",label:"Firmen",icon:""},{path:"/crm/invoices",label:"Rechnungen",icon:""},{path:"/crm/expenses",label:"Ausgaben",icon:""},{path:"/crm/reports",label:"Berichte",icon:""},{path:"/crm/campaigns",label:"Kampagnen",icon:""},{path:"/crm/settings",label:"Einstellungen",icon:""}].map(c=>s("a",{class:`nav-item ${(c.path==="/crm/"?a==="/crm/":a.startsWith(c.path))?"active":""}`,href:c.path,onClick:h=>{h.preventDefault(),o(c.path)},children:[s("span",{class:"nav-icon",children:c.icon}),c.label]},c.path))}),s("div",{class:"sidebar-footer",children:s("button",{class:"btn btn-secondary btn-sm",style:"width: 100%",onClick:e,children:"Abmelden"})})]}),n&&s("div",{style:"position:fixed;inset:0;background:rgba(0,0,0,0.4);z-index:99",onClick:()=>r(!1)}),s("main",{class:"main-content",children:t})]})}function Z2(){const{signIn:t}=tc(),[e,n]=be(""),[r,a]=be(""),[i,o]=be(null),[l,c]=be(!1);async function h(f){f.preventDefault(),o(null),c(!0);try{await t(e,r)}catch(m){o(m.message==="Invalid login credentials"?"Ungueltige Anmeldedaten":m.message)}c(!1)}return s("div",{class:"login-page",children:s("form",{class:"login-card",onSubmit:h,children:[s("div",{class:"login-title",children:"Beck360 CRM"}),s("div",{class:"login-subtitle",children:"Anmelden"}),i&&s("div",{class:"login-error",children:i}),s("div",{class:"form-group",children:[s("label",{for:"login-email",children:"E-Mail"}),s("input",{id:"login-email",type:"email",value:e,onInput:f=>n(f.target.value),required:!0,autocomplete:"email"})]}),s("div",{class:"form-group",children:[s("label",{for:"login-password",children:"Passwort"}),s("input",{id:"login-password",type:"password",value:r,onInput:f=>a(f.target.value),required:!0,autocomplete:"current-password"})]}),s("button",{type:"submit",class:"btn btn-primary",style:"width: 100%; justify-content: center",disabled:l,children:l?"Anmelden...":"Anmelden"})]})})}function Q2(){const[t,e]=be({totalContacts:0,newLeadsThisMonth:0,pipelineValue:0,wonDeals:0,conversionRate:0,dealsByStage:{}}),[n,r]=be([]),[a,i]=be(!0),o=Nt(async()=>{i(!0);const l=new Date,c=new Date(l.getFullYear(),l.getMonth(),1).toISOString(),[{count:h},{count:f},{data:m},{data:b},{data:p},{data:_}]=await Promise.all([ke.from("contacts").select("*",{count:"exact",head:!0}).is("deleted_at",null),ke.from("contacts").select("*",{count:"exact",head:!0}).is("deleted_at",null).gte("created_at",c),ke.from("deals").select("value, stage").is("deleted_at",null).not("stage","in",'("won","lost")'),ke.from("deals").select("value").is("deleted_at",null).eq("stage","won"),ke.from("deals").select("stage").is("deleted_at",null),ke.from("activities").select("*").order("created_at",{ascending:!1}).limit(10)]),w=(m||[]).reduce((E,U)=>E+(U.value||0),0),S=(b||[]).length,x=(p||[]).length,T=x>0?Math.round(S/x*100):0,R={};for(const E of p||[])R[E.stage]=(R[E.stage]||0)+1;e({totalContacts:h||0,newLeadsThisMonth:f||0,pipelineValue:w,wonDeals:S,conversionRate:T,dealsByStage:R}),r(_||[]),i(!1)},[]);return jt(()=>{o()},[o]),{stats:t,recentActivities:n,loading:a,refetch:o}}const ks={invoice:{label:"Rechnung",prefix:"R"},quote:{label:"Angebot",prefix:"A"}},Zn={draft:{label:"Entwurf",color:"#6366f1"},sent:{label:"Versendet",color:"#f59e0b"},paid:{label:"Bezahlt",color:"#10b981"},overdue:{label:"Ueberfaellig",color:"#ef4444"},cancelled:{label:"Storniert",color:"#64748b"}};function Tl(t,e,n){var h;const r=new Date,a=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0"),l=((h=ks[t])==null?void 0:h.prefix)||"R",c=Jd(e)||Jd(n)||"XX";return`${l}-${a}-${i}-${o}-${c}`}function Jd(t){if(!t||!t.trim())return"";const e=t.trim(),n=e.split(/\s+/);return n.length>=2?n.map(r=>r[0]).join("").toUpperCase().slice(0,4):e.slice(0,3).toUpperCase()}function ev(t,e=0,n=19){const r=t.reduce((c,h)=>c+(parseFloat(h.quantity)||0)*(parseFloat(h.unit_price)||0),0),a=r*(parseFloat(e)||0)/100,i=r-a,o=i*(parseFloat(n)||0)/100,l=i+o;return{subtotal:eo(r),discount_amount:eo(a),net_amount:eo(i),vat_amount:eo(o),total_amount:eo(l)}}function eo(t){return Math.round(t*100)/100}function fh({type:t=null,status:e=null,companyId:n=null,dealId:r=null}={}){const[a,i]=be([]),[o,l]=be(!0),c=Nt(async()=>{l(!0);let h=ke.from("invoices").select(`
        *,
        company:companies(id, name),
        contact:contacts(id, first_name, last_name)
      `).is("deleted_at",null).order("created_at",{ascending:!1});t&&(h=h.eq("type",t)),e&&(h=h.eq("status",e)),n&&(h=h.eq("company_id",n)),r&&(h=h.eq("deal_id",r));const{data:f,error:m}=await h;m||i(f||[]),l(!1)},[t,e,n,r]);return jt(()=>{c()},[c]),{invoices:a,loading:o,refetch:c}}function hg(t){const[e,n]=be(null),[r,a]=be([]),[i,o]=be(!0),l=Nt(async()=>{if(!t)return;o(!0);const[{data:h},{data:f}]=await Promise.all([ke.from("invoices").select(`
          *,
          company:companies(id, name),
          contact:contacts(id, first_name, last_name, email, phone)
        `).eq("id",t).is("deleted_at",null).single(),ke.from("invoice_items").select("*").eq("invoice_id",t).order("position",{ascending:!0})]);n(h),a(f||[]),o(!1)},[t]);jt(()=>{l()},[l]);const c=Nt(async h=>{const{error:f}=await ke.from("invoices").update(h).eq("id",t);return f||await l(),{error:f}},[t,l]);return{invoice:e,items:r,loading:i,refetch:l,update:c}}async function tv(t,e){const{data:n}=await ke.auth.getUser(),r=n.user.id,{data:a,error:i}=await ke.from("invoices").insert({...t,owner_id:r}).select().single();if(i)return{error:i};if(e&&e.length>0){const c=e.map((f,m)=>({invoice_id:a.id,position:m+1,description:f.description,sub_description:f.sub_description||null,quantity:parseFloat(f.quantity)||1,unit_price:parseFloat(f.unit_price)||0})),{error:h}=await ke.from("invoice_items").insert(c);if(h)return{data:a,error:h}}const o=t.type==="quote"?"quote_created":"invoice_created",l=t.type==="quote"?"Angebot":"Rechnung";return await ke.from("activities").insert({owner_id:r,deal_id:t.deal_id||null,contact_id:t.contact_id||null,company_id:t.company_id||null,type:o,description:`${l} erstellt: ${t.invoice_number}`,metadata:{invoice_id:a.id,invoice_number:t.invoice_number}}),{data:a,error:null}}async function nv(t,e,n){const{error:r}=await ke.from("invoices").update(e).eq("id",t);if(r)return{error:r};if(await ke.from("invoice_items").delete().eq("invoice_id",t),n&&n.length>0){const a=n.map((o,l)=>({invoice_id:t,position:l+1,description:o.description,sub_description:o.sub_description||null,quantity:parseFloat(o.quantity)||1,unit_price:parseFloat(o.unit_price)||0})),{error:i}=await ke.from("invoice_items").insert(a);if(i)return{error:i}}return{error:null}}async function rv(t){const{data:e}=await ke.auth.getUser(),n=e.user.id,[{data:r},{data:a}]=await Promise.all([ke.from("invoices").select("*").eq("id",t).single(),ke.from("invoice_items").select("*").eq("invoice_id",t).order("position")]);if(!r)return{error:{message:"Angebot nicht gefunden"}};const i=new Date,o=Tl("invoice",r.customer_company,r.customer_name),{id:l,created_at:c,updated_at:h,...f}=r,{data:m,error:b}=await ke.from("invoices").insert({...f,type:"invoice",invoice_number:o,status:"draft",invoice_date:i.toISOString().slice(0,10),due_date:new Date(i.getTime()+14*864e5).toISOString().slice(0,10),converted_from_quote_id:t,paid_date:null,paid_amount:0}).select().single();if(b)return{error:b};if(a&&a.length>0){const p=a.map(_=>({invoice_id:m.id,position:_.position,description:_.description,sub_description:_.sub_description,quantity:_.quantity,unit_price:_.unit_price}));await ke.from("invoice_items").insert(p)}return await ke.from("activities").insert({owner_id:n,deal_id:r.deal_id||null,contact_id:r.contact_id||null,company_id:r.company_id||null,type:"quote_converted",description:`Angebot ${r.invoice_number} in Rechnung ${o} umgewandelt`,metadata:{quote_id:t,invoice_id:m.id}}),{data:m,error:null}}function nc(){const[t,e]=be(null),[n,r]=be(!0),a=Nt(async()=>{r(!0);const{data:o}=await ke.from("business_settings").select("*").limit(1).single();e(o),r(!1)},[]);jt(()=>{a()},[a]);const i=Nt(async o=>{const{data:l}=await ke.auth.getUser();if(t){const{error:c}=await ke.from("business_settings").update(o).eq("id",t.id);return c||await a(),{error:c}}else{const{error:c}=await ke.from("business_settings").insert({...o,owner_id:l.user.id});return c||await a(),{error:c}}},[t,a]);return{settings:t,loading:n,save:i,refetch:a}}function iv(){const[t,e]=be({openCount:0,openAmount:0,monthRevenue:0}),[n,r]=be(!0),a=Nt(async()=>{r(!0);const i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1).toISOString().slice(0,10),[{data:l},{data:c}]=await Promise.all([ke.from("invoices").select("total_amount").eq("type","invoice").is("deleted_at",null).in("status",["sent","overdue"]),ke.from("invoices").select("total_amount").eq("type","invoice").is("deleted_at",null).eq("status","paid").gte("paid_date",o)]),h=(l||[]).length,f=(l||[]).reduce((b,p)=>b+(parseFloat(p.total_amount)||0),0),m=(c||[]).reduce((b,p)=>b+(parseFloat(p.total_amount)||0),0);e({openCount:h,openAmount:f,monthRevenue:m}),r(!1)},[]);return jt(()=>{a()},[a]),{stats:t,loading:n}}async function av(t){const{error:e}=await ke.from("invoices").update({deleted_at:new Date().toISOString()}).eq("id",t);return{error:e}}function ph({contactId:t=null,dealId:e=null,companyId:n=null,limit:r=50}={}){const[a,i]=be([]),[o,l]=be(!0),c=Nt(async()=>{l(!0);let h=ke.from("activities").select("*").order("created_at",{ascending:!1}).limit(r);t&&(h=h.eq("contact_id",t)),e&&(h=h.eq("deal_id",e)),n&&(h=h.eq("company_id",n));const{data:f,error:m}=await h;m||i(f||[]),l(!1)},[t,e,n,r]);return jt(()=>{c()},[c]),{activities:a,loading:o,refetch:c}}async function dg(t){const{data:e}=await ke.auth.getUser();return ke.from("activities").insert({...t,owner_id:e.user.id}).select().single()}function sv(){const[t,e]=be([]),[n,r]=be(!0),a=Nt(async()=>{r(!0);const{data:o}=await ke.from("activities").select(`
        *,
        contact:contacts(id, first_name, last_name),
        deal:deals(id, title)
      `).eq("type","task").eq("completed",!1).not("due_date","is",null).order("due_date",{ascending:!0});e(o||[]),r(!1)},[]);jt(()=>{a()},[a]);const i=Nt(async o=>{const{error:l}=await ke.from("activities").update({completed:!0}).eq("id",o);return l||await a(),{error:l}},[a]);return{tasks:t,loading:n,refetch:a,complete:i}}function Ca({label:t,value:e,color:n}){return s("div",{class:"card",children:[s("div",{class:"kpi-value",style:n?`color: ${n}`:"",children:e}),s("div",{class:"kpi-label",children:t})]})}function jn(t){return t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function vl(t){return t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function je(t){return t==null?"":new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(t)}function ov(t){if(!t)return"";const e=new Date,n=new Date(t),r=e-n,a=Math.floor(r/6e4),i=Math.floor(r/36e5),o=Math.floor(r/864e5);return a<1?"gerade eben":a<60?`vor ${a} Min.`:i<24?`vor ${i} Std.`:o<7?`vor ${o} Tag${o>1?"en":""}`:jn(t)}const ti={new:{label:"Neu",color:"#6366f1"},contacted:{label:"Kontaktiert",color:"#f59e0b"},qualified:{label:"Qualifiziert",color:"#3b82f6"},proposal:{label:"Angebot",color:"#8b5cf6"},won:{label:"Gewonnen",color:"#10b981"},lost:{label:"Verloren",color:"#ef4444"}},$u={"360-tour":"360 Rundgang","drone-photo":"Drohnenfoto","drone-video":"Drohnenvideo","drone-inspection":"PV-Inspektion",streetview:"Google Street View",bundle:"Paket",other:"Sonstiges"},Ma={"360-rundgang":"360-Rundgang",firmenrundgang:"Firmenrundgang",manual:"Manuell",referral:"Empfehlung",other:"Sonstiges"},gh={note:{label:"Notiz",icon:""},call:{label:"Anruf",icon:""},email:{label:"E-Mail",icon:""},meeting:{label:"Treffen",icon:""},form_submission:{label:"Formular",icon:""},stage_change:{label:"Stage",icon:""},created:{label:"Erstellt",icon:""},task:{label:"Aufgabe",icon:""},invoice_created:{label:"Rechnung",icon:""},invoice_sent:{label:"Rechnung versendet",icon:""},quote_created:{label:"Angebot",icon:""},quote_converted:{label:"Angebot umgewandelt",icon:""}},la={draft:{label:"Entwurf",color:"#6366f1"},sending:{label:"Wird gesendet",color:"#f59e0b"},sent:{label:"Versendet",color:"#10b981"}},Yd=[{id:"follow-up",name:"Angebot nachfassen",subject:"Ihr 360-Rundgang  Noch Fragen offen?",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>vor Kurzem haben wir ueber einen 360-Rundgang fuer {{firma}} gesprochen. Haben Sie noch Fragen zu unserem Angebot?</p>
    <p>Ich stehe Ihnen gerne fuer ein kurzes Gespraech zur Verfuegung.</p>
    <p style="margin-top:24px;">
      <a href="https://360-rundgang-karlsruhe.de" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Termin vereinbaren</a>
    </p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360  360 Rundgaenge & Drohnenaufnahmen<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"new-service",name:"Neue Dienstleistung vorstellen",subject:"Neu bei Beck360: Erweiterte 360-Loesungen",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>wir haben unser Angebot erweitert! Neben professionellen 360-Rundgaengen bieten wir jetzt auch Drohnenaufnahmen und virtuelle Touren an.</p>
    <p><strong>Ihre Vorteile:</strong></p>
    <ul>
      <li>Interaktive 360-Rundgaenge fuer Ihre Raeumlichkeiten</li>
      <li>Professionelle Drohnenfotos und -videos</li>
      <li>Google Street View Integration</li>
    </ul>
    <p style="margin-top:24px;">
      <a href="https://360-rundgang-karlsruhe.de" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Mehr erfahren</a>
    </p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"review",name:"Um Bewertung bitten",subject:"Wie war Ihre Erfahrung mit Beck360?",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>vielen Dank, dass Sie sich fuer Beck360 entschieden haben! Wir hoffen, Sie sind mit dem Ergebnis zufrieden.</p>
    <p>Wuerden Sie uns mit einer kurzen Google-Bewertung unterstuetzen? Das dauert nur 1 Minute und hilft uns enorm.</p>
    <p style="margin-top:24px;">
      <a href="https://g.page/r/CQyourGoogleReviewLink/review" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Jetzt bewerten</a>
    </p>
    <p style="margin-top:24px;">Herzlichen Dank!<br><strong>Eugen Beck</strong><br>Beck360<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"blank",name:"Leere Vorlage",subject:"",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p><!-- Ihr Inhalt hier --></p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360  360 Rundgaenge & Drohnenaufnahmen<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`}],Hl={office:"Buero & Ausstattung",software:"Software & Lizenzen",marketing:"Marketing & Werbung",travel:"Reise & Fahrtkosten",equipment:"Geraete & Technik",insurance:"Versicherungen",telecom:"Telefon & Internet",professional:"Beratung & Dienstleistung",vehicle:"Fahrzeug",training:"Weiterbildung",other:"Sonstiges"},lv={bank_transfer:"Ueberweisung",cash:"Bar",credit_card:"Kreditkarte",paypal:"PayPal",direct_debit:"Lastschrift"},Wl=["Januar","Februar","Maerz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],rc=["Hotel / Pension","Gastronomie","Fitnessstudio","Einzelhandel","Autohaus","Gesundheit / Arztpraxis","Eventlocation","Coworking","Immobilien","Handwerk","Bildung","Sonstige"];function mh({activity:t}){const e=gh[t.type]||{label:t.type,icon:""};return s("div",{class:"timeline-item",children:s("div",{class:"timeline-content",children:[s("div",{class:"timeline-header",children:[s("span",{class:"timeline-icon",children:e.icon}),s("span",{class:"timeline-type",children:e.label}),s("span",{class:"timeline-time",children:ov(t.created_at)})]}),s("div",{class:"timeline-text",children:t.description})]})})}function ic({stage:t}){const e=ti[t]||{label:t,color:"#64748b"};return s("span",{class:"stage-badge",style:`color: ${e.color}; background: ${e.color}1a`,children:e.label})}function Xd(){const{stats:t,recentActivities:e,loading:n}=Q2(),{stats:r}=iv(),{tasks:a,complete:i}=sv();return n?s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Dashboard"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]}):s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Dashboard"}),s("div",{style:"display:flex;gap:0.5rem",children:[s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/contacts/new"),children:"+ Kontakt"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/deals/new"),children:"+ Deal"})]})]}),s("div",{class:"page-body",children:[s("div",{class:"grid-4",style:"margin-bottom: 1.5rem",children:[s(Ca,{label:"Kontakte gesamt",value:t.totalContacts}),s(Ca,{label:"Neue Leads (Monat)",value:t.newLeadsThisMonth,color:"var(--info)"}),s(Ca,{label:"Pipeline-Wert",value:je(t.pipelineValue),color:"var(--primary-light)"}),s(Ca,{label:"Conversion-Rate",value:`${t.conversionRate}%`,color:"var(--success)"})]}),s("div",{class:"grid-3",style:"margin-bottom: 1.5rem",children:[s(Ca,{label:"Offene Rechnungen",value:r.openCount,color:"var(--warning)"}),s(Ca,{label:"Offener Betrag",value:je(r.openAmount),color:"var(--error)"}),s(Ca,{label:"Umsatz (Monat)",value:je(r.monthRevenue),color:"var(--success)"})]}),s("div",{class:"grid-2",style:"margin-bottom: 1.5rem",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:[s("span",{class:"card-title",children:"Pipeline-Uebersicht"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:"Oeffnen"})]}),s("div",{style:"display:flex;flex-direction:column;gap:0.5rem",children:Object.entries(ti).filter(([o])=>o!=="won"&&o!=="lost").map(([o,l])=>s("div",{style:"display:flex;align-items:center;justify-content:space-between;padding:0.4rem 0",children:[s(ic,{stage:o}),s("span",{style:"font-weight:600",children:t.dealsByStage[o]||0})]},o))})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Faellige Aufgaben"})}),a.length===0?s("div",{class:"empty-state",style:"padding:1rem",children:s("div",{class:"empty-state-text",children:"Keine faelligen Aufgaben"})}):s("div",{style:"display:flex;flex-direction:column;gap:0.5rem",children:a.slice(0,5).map(o=>s("div",{style:"display:flex;align-items:center;justify-content:space-between;padding:0.4rem 0;border-bottom:1px solid var(--border)",children:[s("div",{children:[s("div",{style:"font-size:0.85rem",children:o.description}),s("div",{style:"font-size:0.75rem;color:var(--text-dim)",children:["Faellig: ",jn(o.due_date),o.contact&&`  ${o.contact.first_name} ${o.contact.last_name}`]})]}),s("button",{class:"btn btn-sm btn-secondary",onClick:()=>i(o.id),children:"Erledigt"})]},o.id))})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Letzte Aktivitaeten"})}),e.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Noch keine Aktivitaeten"})]}):s("div",{class:"timeline",children:e.map(o=>s(mh,{activity:o},o.id))})]})]})]})}function vh({stage:t=null,contactId:e=null,companyId:n=null}={}){const[r,a]=be([]),[i,o]=be(!0),l=Nt(async()=>{o(!0);let c=ke.from("deals").select(`
        *,
        contact:contacts(id, first_name, last_name, email),
        company:companies(id, name)
      `).is("deleted_at",null).order("created_at",{ascending:!1});t&&(c=c.eq("stage",t)),e&&(c=c.eq("contact_id",e)),n&&(c=c.eq("company_id",n));const{data:h,error:f}=await c;f||a((h||[]).map(m=>{var b;return{...m,contact_name:m.contact?`${m.contact.first_name||""} ${m.contact.last_name||""}`.trim()||m.contact.email:null,company_name:((b=m.company)==null?void 0:b.name)||null}})),o(!1)},[t,e,n]);return jt(()=>{l()},[l]),{deals:r,loading:i,refetch:l}}function cv(t){const[e,n]=be(null),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:c}=await ke.from("deals").select(`
        *,
        contact:contacts(id, first_name, last_name, email, phone),
        company:companies(id, name)
      `).eq("id",t).single();n(c),a(!1)},[t]);jt(()=>{i()},[i]);const o=Nt(async c=>{const{error:h}=await ke.from("deals").update(c).eq("id",t);return h||await i(),{error:h}},[t,i]),l=Nt(async c=>{const h=e==null?void 0:e.stage,{error:f}=await ke.from("deals").update({stage:c,stage_changed_at:new Date().toISOString()}).eq("id",t);if(!f){const{data:m}=await ke.auth.getUser();await ke.from("activities").insert({owner_id:m.user.id,deal_id:t,contact_id:e==null?void 0:e.contact_id,type:"stage_change",description:`Stage geaendert: ${h}  ${c}`,metadata:{old_stage:h,new_stage:c}}),await i()}return{error:f}},[t,e,i]);return{deal:e,loading:r,refetch:i,update:o,changeStage:l}}async function uv(t){const{data:e}=await ke.auth.getUser(),{data:n,error:r}=await ke.from("deals").insert({...t,owner_id:e.user.id}).select().single();return r||await ke.from("activities").insert({owner_id:e.user.id,deal_id:n.id,contact_id:t.contact_id||null,type:"created",description:`Deal erstellt: ${t.title}`}),{data:n,error:r}}async function Zd(t,e,n,r){const{error:a}=await ke.from("deals").update({stage:e,stage_changed_at:new Date().toISOString()}).eq("id",t);if(!a){const{data:i}=await ke.auth.getUser();await ke.from("activities").insert({owner_id:i.user.id,deal_id:t,contact_id:r||null,type:"stage_change",description:`Stage geaendert: ${n}  ${e}`,metadata:{old_stage:n,new_stage:e}})}return{error:a}}const hv=["new","contacted","qualified","proposal","won","lost"];function dv({deal:t,onDragStart:e,onClick:n,onStageChange:r}){return s("div",{class:"deal-card",draggable:!0,onDragStart:a=>{a.dataTransfer.setData("text/plain",t.id),a.currentTarget.classList.add("dragging"),e&&e(t)},onDragEnd:a=>a.currentTarget.classList.remove("dragging"),onClick:()=>n&&n(t),children:[s("div",{class:"deal-card-title",children:t.title}),s("div",{class:"deal-card-meta",children:[s("span",{children:t.contact_name||""}),s("span",{children:t.value?je(t.value):""})]}),r&&s("select",{class:"deal-card-stage-select",value:t.stage,onClick:a=>a.stopPropagation(),onChange:a=>{a.stopPropagation(),r(t,a.target.value)},children:hv.map(a=>s("option",{value:a,children:ti[a].label},a))})]})}const Qd=["new","contacted","qualified","proposal","won","lost"];function fv(){const{deals:t,loading:e,refetch:n}=vh(),r=lr(),[a,i]=be(null),o={};for(const h of Qd)o[h]=t.filter(f=>f.stage===h);const l=Nt(async(h,f)=>{h.preventDefault(),i(null);const m=h.dataTransfer.getData("text/plain"),b=t.find(_=>_.id===m);if(!b||b.stage===f)return;const{error:p}=await Zd(m,f,b.stage,b.contact_id);p?r.error("Fehler beim Aendern der Stage"):(r.success(`Deal nach "${ti[f].label}" verschoben`),n())},[t,n,r]),c=Nt(async(h,f)=>{if(h.stage===f)return;const{error:m}=await Zd(h.id,f,h.stage,h.contact_id);m?r.error("Fehler beim Aendern der Stage"):(r.success(`Deal nach "${ti[f].label}" verschoben`),n())},[n,r]);return e?s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Pipeline"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]}):s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Pipeline"}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/deals/new"),children:"+ Neuer Deal"})]}),s("div",{class:"page-body",children:s("div",{class:"pipeline",children:Qd.map(h=>s("div",{class:"pipeline-column",children:[s("div",{class:"pipeline-column-header",style:`border-top: 3px solid ${ti[h].color}`,children:[s("span",{children:ti[h].label}),s("span",{class:"pipeline-column-count",children:o[h].length})]}),s("div",{class:`pipeline-column-body ${a===h?"drag-over":""}`,onDragOver:f=>{f.preventDefault(),i(h)},onDragLeave:()=>i(null),onDrop:f=>l(f,h),children:o[h].length===0?s("div",{style:"text-align:center;padding:1rem;color:var(--text-dim);font-size:0.8rem",children:"Keine Deals"}):o[h].map(f=>s(dv,{deal:f,onClick:()=>Ve(`/crm/deals/${f.id}`),onStageChange:c},f.id))})]},h))})})]})}function bh({search:t="",source:e=null}={}){const[n,r]=be([]),[a,i]=be(!0),o=Nt(async()=>{i(!0);let l=ke.from("contacts").select("*, company:companies(id, name)").is("deleted_at",null).order("created_at",{ascending:!1});e&&(l=l.eq("source",e)),t&&(l=l.or(`first_name.ilike.%${t}%,last_name.ilike.%${t}%,email.ilike.%${t}%`));const{data:c,error:h}=await l;h||r(c||[]),i(!1)},[t,e]);return jt(()=>{o()},[o]),{contacts:n,loading:a,refetch:o}}function pv(t){const[e,n]=be(null),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:c}=await ke.from("contacts").select("*, company:companies(id, name)").eq("id",t).single();n(c),a(!1)},[t]);jt(()=>{i()},[i]);const o=Nt(async c=>{const{error:h}=await ke.from("contacts").update(c).eq("id",t);return h||await i(),{error:h}},[t,i]),l=Nt(async()=>ke.from("contacts").update({deleted_at:new Date().toISOString()}).eq("id",t),[t]);return{contact:e,loading:r,refetch:i,update:o,softDelete:l}}async function yh(t){const{data:e}=await ke.auth.getUser(),{data:n,error:r}=await ke.from("contacts").insert({...t,owner_id:e.user.id}).select().single();return r||await ke.from("activities").insert({owner_id:e.user.id,contact_id:n.id,type:"created",description:"Kontakt manuell erstellt"}),{data:n,error:r}}function fg({value:t,onInput:e,placeholder:n="Suchen..."}){return s("input",{type:"search",class:"search-input",placeholder:n,value:t,onInput:r=>e(r.target.value)})}function _h({filters:t,active:e,onSelect:n}){return s("div",{class:"filter-pills",children:[s("button",{class:`filter-pill ${e?"":"active"}`,onClick:()=>n(null),children:"Alle"}),t.map(r=>s("button",{class:`filter-pill ${e===r.value?"active":""}`,onClick:()=>n(r.value),children:r.label},r.value))]})}function Ua({title:t,onClose:e,children:n,footer:r,className:a}){const i=Nt(o=>{o.key==="Escape"&&e()},[e]);return jt(()=>(document.addEventListener("keydown",i),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",i),document.body.style.overflow=""}),[i]),s("div",{class:"modal-overlay",onClick:o=>{o.target===o.currentTarget&&e()},children:s("div",{class:`modal${a?" "+a:""}`,role:"dialog","aria-modal":"true",children:[s("div",{class:"modal-header",children:[s("span",{children:t}),s("button",{class:"btn-icon",onClick:e,"aria-label":"Schliessen",children:""})]}),s("div",{class:"modal-body",children:n}),r&&s("div",{class:"modal-footer",children:r})]})})}function gv({search:t="",industry:e=null}={}){const[n,r]=be([]),[a,i]=be(!0),o=Nt(async()=>{i(!0);let l=ke.from("companies").select("*").is("deleted_at",null).order("created_at",{ascending:!1});e&&(l=l.eq("industry",e)),t&&(l=l.or(`name.ilike.%${t}%,city.ilike.%${t}%`));const{data:c,error:h}=await l;h||r(c||[]),i(!1)},[t,e]);return jt(()=>{o()},[o]),{companies:n,loading:a,refetch:o}}function mv(t){const[e,n]=be(null),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:c}=await ke.from("companies").select("*").eq("id",t).is("deleted_at",null).single();n(c),a(!1)},[t]);jt(()=>{i()},[i]);const o=Nt(async c=>{const{error:h}=await ke.from("companies").update(c).eq("id",t);return h||await i(),{error:h}},[t,i]),l=Nt(async()=>{const{error:c}=await ke.from("companies").update({deleted_at:new Date().toISOString()}).eq("id",t);return{error:c}},[t]);return{company:e,loading:r,refetch:i,update:o,softDelete:l}}async function wh(t){const{data:e}=await ke.auth.getUser();return ke.from("companies").insert({...t,owner_id:e.user.id}).select().single()}function ef(t,e){const n=[];let r="",a=!1;for(let i=0;i<t.length;i++){const o=t[i];a?o==='"'&&t[i+1]==='"'?(r+='"',i++):o==='"'?a=!1:r+=o:o==='"'?a=!0:o===e?(n.push(r.trim()),r=""):r+=o}return n.push(r.trim()),n}function vv(t){const e=(t.match(/;/g)||[]).length,n=(t.match(/,/g)||[]).length;return e>=n?";":","}function bv(t,e){const n={};return t.forEach((r,a)=>{n[r]=e[a]||""}),{companyName:n.Firma||"",firstName:n["Ansprechpartner Vorname"]||"",lastName:n["Ansprechpartner Nachname"]||"",email:n["E-Mail"]||n.Email||"",street:n.Strasse||"",zip:n.PLZ||"",city:n.Stadt||"",industry:n.Branche||"",vatId:n["USt-IdNr"]||"",notes:n.Notiz||""}}function yv(){const[t,e]=be(null),[n,r]=be(!1),[a,i]=be({current:0,total:0}),[o,l]=be(null),c=Nt(m=>{const b=m.split(/\r?\n/).filter(R=>R.trim());if(b.length<2)return null;const p=vv(b[0]),_=ef(b[0],p),w=b.slice(1).map(R=>bv(_,ef(R,p))),S=[...new Set(w.map(R=>R.companyName).filter(Boolean))],x=w.filter(R=>R.firstName||R.lastName),T={rows:w,companyNames:S,contactCount:x.length};return e(T),l(null),T},[]),h=Nt(async()=>{if(!t)return;r(!0),l(null);const{rows:m,companyNames:b}=t,p=b.length+m.filter(F=>F.firstName||F.lastName).length;i({current:0,total:p});let _={companies:0,contacts:0},w={companies:0,contacts:0},S=[],x=0;const{data:T}=await ke.from("companies").select("id, name").is("deleted_at",null),R=new Map((T||[]).map(F=>[F.name.toLowerCase(),F.id])),E=new Map;for(const F of b){const C=F.toLowerCase();if(R.has(C))E.set(F,R.get(C)),w.companies++;else{const A=m.find(V=>V.companyName===F),D=[A.street,A.zip,A.city].filter(Boolean).join(", "),{data:j,error:$}=await wh({name:F,address:D||null,city:A.city||null,industry:A.industry||null});$?S.push(`Firma "${F}": ${$.message}`):(E.set(F,j.id),_.companies++)}x++,i({current:x,total:p})}const{data:U}=await ke.from("contacts").select("id, first_name, last_name, company_id").is("deleted_at",null),Z=(F,C,A)=>`${(F||"").toLowerCase()}|${(C||"").toLowerCase()}|${A||""}`,O=new Set((U||[]).map(F=>Z(F.first_name,F.last_name,F.company_id)));for(const F of m){if(!F.firstName&&!F.lastName)continue;const C=E.get(F.companyName)||null,A=Z(F.firstName,F.lastName,C);if(O.has(A)){w.contacts++,x++,i({current:x,total:p});continue}const D=F.email||`${(F.firstName||"kontakt").toLowerCase()}.${(F.lastName||"").toLowerCase()}@platzhalter.de`.replace(/\s+/g,""),{error:j}=await yh({first_name:F.firstName||null,last_name:F.lastName||null,email:D,company_id:C,source:"manual"});j?S.push(`Kontakt "${F.firstName} ${F.lastName}": ${j.message}`):(_.contacts++,O.add(A)),x++,i({current:x,total:p})}const J={created:_,skipped:w,errors:S};return l(J),r(!1),J},[t]),f=Nt(()=>{e(null),l(null),i({current:0,total:0})},[]);return{parseCSV:c,importContacts:h,parsed:t,importing:n,progress:a,results:o,reset:f}}function _v({onClose:t,onSuccess:e}){const n=a0(null),[r,a]=be(""),{parseCSV:i,importContacts:o,parsed:l,importing:c,progress:h,results:f,reset:m}=yv(),b=S=>{const x=S.target.files[0];if(!x)return;a(x.name);const T=new FileReader;T.onload=R=>i(R.target.result),T.readAsText(x,"UTF-8")},p=async()=>{const S=await o();S&&S.errors.length===0&&(e==null||e())},_=()=>{m(),t()};return s(Ua,{title:"CSV Import",onClose:_,footer:f?s("button",{class:"btn btn-primary btn-sm",onClick:_,children:"Schliessen"}):s(xt,{children:[s("button",{class:"btn btn-secondary btn-sm",onClick:_,disabled:c,children:"Abbrechen"}),l&&s("button",{class:"btn btn-primary btn-sm",onClick:p,disabled:c,children:c?"Importiere...":"Importieren"})]}),className:"modal-wide",children:[!l&&!f&&s("div",{children:[s("p",{style:"font-size:0.85rem;color:var(--text-muted);margin-bottom:1rem",children:"CSV-Datei mit Semikolon- oder Komma-Trennung hochladen. Erwartete Spalten: Firma, Ansprechpartner Vorname/Nachname, Strasse, PLZ, Stadt, Branche, Notiz."}),s("label",{class:"import-file-label",style:"display:flex;align-items:center;justify-content:center;gap:0.5rem;padding:2rem;border:2px dashed var(--border);border-radius:var(--radius-lg);cursor:pointer;color:var(--text-muted);font-size:0.85rem;transition:border-color 0.15s",children:[s("span",{children:r||"CSV-Datei auswaehlen..."}),s("input",{ref:n,type:"file",accept:".csv,.txt",onChange:b,style:"display:none"})]})]}),l&&!f&&s("div",{children:[s("div",{style:"display:flex;gap:1rem;margin-bottom:1rem",children:[s("div",{class:"card",style:"flex:1;padding:0.75rem;text-align:center",children:[s("div",{style:"font-size:1.25rem;font-weight:700;color:var(--primary)",children:l.companyNames.length}),s("div",{style:"font-size:0.75rem;color:var(--text-muted)",children:"Firmen"})]}),s("div",{class:"card",style:"flex:1;padding:0.75rem;text-align:center",children:[s("div",{style:"font-size:1.25rem;font-weight:700;color:var(--primary)",children:l.contactCount}),s("div",{style:"font-size:0.75rem;color:var(--text-muted)",children:"Kontakte"})]})]}),c&&s("div",{style:"margin-bottom:1rem",children:[s("div",{style:"display:flex;justify-content:space-between;font-size:0.75rem;color:var(--text-muted);margin-bottom:0.25rem",children:[s("span",{children:"Importiere..."}),s("span",{children:[h.current,"/",h.total]})]}),s("div",{style:"height:6px;background:var(--border);border-radius:3px;overflow:hidden",children:s("div",{style:`height:100%;background:var(--primary);border-radius:3px;transition:width 0.2s;width:${h.total?h.current/h.total*100:0}%`})})]}),s("div",{class:"card",style:"padding:0;max-height:240px;overflow-y:auto",children:s("table",{style:"font-size:0.8rem",children:[s("thead",{children:s("tr",{children:[s("th",{style:"padding:0.5rem 0.6rem",children:"Firma"}),s("th",{style:"padding:0.5rem 0.6rem",children:"Vorname"}),s("th",{style:"padding:0.5rem 0.6rem",children:"Nachname"}),s("th",{style:"padding:0.5rem 0.6rem",children:"Stadt"}),s("th",{style:"padding:0.5rem 0.6rem",children:"Branche"})]})}),s("tbody",{children:l.rows.map((S,x)=>s("tr",{children:[s("td",{style:"padding:0.4rem 0.6rem",children:S.companyName}),s("td",{style:"padding:0.4rem 0.6rem",children:S.firstName||""}),s("td",{style:"padding:0.4rem 0.6rem",children:S.lastName||""}),s("td",{style:"padding:0.4rem 0.6rem",children:S.city}),s("td",{style:"padding:0.4rem 0.6rem",children:S.industry})]},x))})]})})]}),f&&s("div",{children:[s("div",{style:"display:flex;gap:1rem;margin-bottom:1rem",children:[s("div",{class:"card",style:"flex:1;padding:0.75rem;text-align:center",children:[s("div",{style:"font-size:1.25rem;font-weight:700;color:var(--success)",children:f.created.companies}),s("div",{style:"font-size:0.75rem;color:var(--text-muted)",children:"Firmen erstellt"})]}),s("div",{class:"card",style:"flex:1;padding:0.75rem;text-align:center",children:[s("div",{style:"font-size:1.25rem;font-weight:700;color:var(--success)",children:f.created.contacts}),s("div",{style:"font-size:0.75rem;color:var(--text-muted)",children:"Kontakte erstellt"})]})]}),(f.skipped.companies>0||f.skipped.contacts>0)&&s("p",{style:"font-size:0.8rem;color:var(--text-muted);margin-bottom:0.5rem",children:[[f.skipped.companies>0&&`${f.skipped.companies} Firma(en)`,f.skipped.contacts>0&&`${f.skipped.contacts} Kontakt(e)`].filter(Boolean).join(" und ")," bereits vorhanden (uebersprungen)"]}),f.errors.length>0&&s("div",{style:"margin-top:0.75rem",children:[s("p",{style:"font-size:0.8rem;color:var(--error);font-weight:600;margin-bottom:0.25rem",children:"Fehler:"}),f.errors.map((S,x)=>s("p",{style:"font-size:0.8rem;color:var(--error)",children:S},x))]})]})]})}const wv=Object.entries(Ma).map(([t,e])=>({value:t,label:e}));function xv(){const[t,e]=be(""),[n,r]=be(null),[a,i]=be(!1),[o,l]=be(new Set),[c,h]=be(!1),{contacts:f,loading:m,refetch:b}=bh({search:t,source:n}),p=lr(),_=(T,R)=>{R.stopPropagation(),l(E=>{const U=new Set(E);return U.has(T)?U.delete(T):U.add(T),U})},w=()=>{o.size===f.length?l(new Set):l(new Set(f.map(T=>T.id)))},S=async()=>{if(o.size===0)return;const T=o.size;if(!confirm(`${T} Kontakt(e) wirklich loeschen?`))return;h(!0);const R=[...o],E=new Date().toISOString(),{error:U}=await ke.from("contacts").update({deleted_at:E}).in("id",R);U?p.error("Fehler beim Loeschen"):(p.success(`${T} Kontakt(e) geloescht`),l(new Set),b()),h(!1)};function x(){if(f.length===0)return;const T=";",R=["Vorname","Nachname","E-Mail","Telefon","Position","Firma","Quelle","Erstellt"],E=f.map(F=>{var C;return[F.first_name||"",F.last_name||"",F.email||"",F.phone||"",F.position||"",((C=F.company)==null?void 0:C.name)||"",Ma[F.source]||F.source||"",F.created_at?F.created_at.slice(0,10):""].map(A=>`"${String(A).replace(/"/g,'""')}"`).join(T)}),U="\uFEFF"+[R.join(T),...E].join(`\r
`),Z=new Blob([U],{type:"text/csv;charset=utf-8;"}),O=URL.createObjectURL(Z),J=document.createElement("a");J.href=O,J.download=`kontakte-${new Date().toISOString().slice(0,10)}.csv`,J.click(),URL.revokeObjectURL(O)}return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Kontakte"}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap;justify-content:flex-end",children:[o.size>0&&s("button",{class:"btn btn-danger btn-sm",onClick:S,disabled:c,children:c?"Loesche...":`${o.size} loeschen`}),s("button",{class:"btn btn-secondary btn-sm hide-mobile-sm",onClick:x,disabled:f.length===0,children:"CSV Export"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>i(!0),children:"Import"}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/contacts/new"),children:"+ Neu"})]})]}),s("div",{class:"page-body",children:[s("div",{class:"search-bar",children:s(fg,{value:t,onInput:e,placeholder:"Name oder E-Mail suchen..."})}),s("div",{style:"margin-bottom: 1rem",children:s(_h,{filters:wv,active:n,onSelect:r})}),m?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):f.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Kontakte gefunden"})]}):s("div",{class:"card",children:s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{style:"width:40px",children:s("input",{type:"checkbox",checked:o.size===f.length&&f.length>0,onChange:w,style:"width:16px;height:16px;cursor:pointer"})}),s("th",{children:"Name"}),s("th",{children:"E-Mail"}),s("th",{children:"Firma"}),s("th",{children:"Quelle"}),s("th",{children:"Erstellt"})]})}),s("tbody",{children:f.map(T=>{var R,E;return s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/contacts/${T.id}`),children:[s("td",{"data-label":"",onClick:U=>U.stopPropagation(),style:"width:40px",children:s("input",{type:"checkbox",checked:o.has(T.id),onChange:U=>_(T.id,U),style:"width:16px;height:16px;cursor:pointer"})}),s("td",{"data-label":"Name",style:"font-weight:500",children:T.first_name||T.last_name?`${T.first_name||""} ${T.last_name||""}`.trim():""}),s("td",{"data-label":"E-Mail",children:(R=T.email)!=null&&R.endsWith("@platzhalter.de")?s("span",{style:"color:var(--text-dim);font-style:italic",children:T.email}):T.email}),s("td",{"data-label":"Firma",children:((E=T.company)==null?void 0:E.name)||""}),s("td",{"data-label":"Quelle",children:s("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem",children:Ma[T.source]||T.source})}),s("td",{"data-label":"Erstellt",style:"color:var(--text-dim)",children:jn(T.created_at)})]},T.id)})})]})})})]}),a&&s(_v,{onClose:()=>i(!1),onSuccess:()=>{p.success("Import abgeschlossen"),b()}})]})}function Sv({id:t}){var Z;const{contact:e,loading:n,update:r,softDelete:a}=pv(t),{deals:i}=vh({contactId:t}),{activities:o,refetch:l}=ph({contactId:t}),c=lr(),[h,f]=be(!1),[m,b]=be({}),[p,_]=be(!1),[w,S]=be({type:"note",description:"",due_date:""});if(n)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Kontakt"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]});if(!e)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Nicht gefunden"})}),s("div",{class:"page-body",children:s("div",{class:"empty-state",children:s("div",{class:"empty-state-text",children:"Kontakt nicht gefunden"})})})]});function x(){b({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",position:e.position||""}),f(!0)}async function T(){const{error:O}=await r(m);O?c.error("Fehler beim Speichern"):(c.success("Kontakt aktualisiert"),f(!1))}async function R(){const O=i.length,J=O>0?`Dieser Kontakt hat ${O} verknuepfte(n) Deal(s). Kontakt wirklich loeschen?`:"Kontakt wirklich loeschen?";if(!confirm(J))return;const{error:F}=await a();F?c.error("Fehler beim Loeschen"):(c.success("Kontakt geloescht"),Ve("/crm/contacts"))}async function E(O){O.preventDefault();const{error:J}=await dg({contact_id:t,type:w.type,description:w.description,due_date:w.type==="task"&&w.due_date?w.due_date:null});J?c.error("Fehler beim Erstellen"):(c.success("Aktivitaet hinzugefuegt"),_(!1),S({type:"note",description:"",due_date:""}),l())}const U=`${e.first_name||""} ${e.last_name||""}`.trim()||e.email;return s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/contacts"),children:""}),s("h1",{class:"page-title",children:U})]}),s("div",{style:"display:flex;gap:0.5rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>_(!0),children:"+ Aktivitaet"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve(`/crm/deals/new?contact_id=${t}`),children:"+ Deal"}),!h&&s("button",{class:"btn btn-secondary btn-sm",onClick:x,children:"Bearbeiten"}),s("button",{class:"btn btn-danger btn-sm",onClick:R,children:"Loeschen"})]})]}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Stammdaten"})}),h?s("div",{children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Vorname"}),s("input",{value:m.first_name,onInput:O=>b({...m,first_name:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Nachname"}),s("input",{value:m.last_name,onInput:O=>b({...m,last_name:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"E-Mail"}),s("input",{type:"email",value:m.email,onInput:O=>b({...m,email:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Telefon"}),s("input",{value:m.phone,onInput:O=>b({...m,phone:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Position"}),s("input",{value:m.position,onInput:O=>b({...m,position:O.target.value})})]})]}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>f(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary btn-sm",onClick:T,children:"Speichern"})]})]}):s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Vorname"}),s("span",{class:"detail-value",children:e.first_name||""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Nachname"}),s("span",{class:"detail-value",children:e.last_name||""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"E-Mail"}),s("span",{class:"detail-value",children:(Z=e.email)!=null&&Z.endsWith("@platzhalter.de")?s("span",{style:"color:var(--text-dim);font-style:italic",title:"Platzhalter  bitte echte E-Mail eintragen",children:e.email}):s("a",{href:`mailto:${e.email}`,children:e.email})})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Telefon"}),s("span",{class:"detail-value",children:e.phone?s("a",{href:`tel:${e.phone}`,children:e.phone}):""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Position"}),s("span",{class:"detail-value",children:e.position||""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Firma"}),s("span",{class:"detail-value",children:e.company?s("a",{href:"#",onClick:O=>{O.preventDefault(),Ve(`/crm/companies/${e.company.id}`)},children:e.company.name}):""})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Deals (",i.length,")"]})}),i.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Deals"}):s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Titel"}),s("th",{children:"Stage"}),s("th",{children:"Wert"})]})}),s("tbody",{children:i.map(O=>s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/deals/${O.id}`),children:[s("td",{children:O.title}),s("td",{children:s(ic,{stage:O.stage})}),s("td",{children:O.value?je(O.value):""})]},O.id))})]})})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Aktivitaeten"})}),o.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Aktivitaeten"}):s("div",{class:"timeline",children:o.map(O=>s(mh,{activity:O},O.id))})]})]}),s("div",{class:"detail-sidebar",children:s("div",{class:"card",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Quelle"}),s("span",{class:"detail-value",children:Ma[e.source]||e.source})]}),e.source_detail&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Detail"}),s("span",{class:"detail-value",children:e.source_detail})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"DSGVO-Einwilligung"}),s("span",{class:"detail-value",children:e.gdpr_consent?"Ja":"Nein"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt am"}),s("span",{class:"detail-value",children:jn(e.created_at)})]})]})})]})}),p&&s(Ua,{title:"Aktivitaet hinzufuegen",onClose:()=>_(!1),children:s("form",{onSubmit:E,children:[s("div",{class:"form-group",children:[s("label",{children:"Typ"}),s("select",{value:w.type,onChange:O=>S({...w,type:O.target.value}),children:Object.entries(gh).filter(([O])=>!["form_submission","stage_change","created"].includes(O)).map(([O,J])=>s("option",{value:O,children:[J.icon," ",J.label]},O))})]}),s("div",{class:"form-group",children:[s("label",{children:"Beschreibung"}),s("textarea",{value:w.description,onInput:O=>S({...w,description:O.target.value}),required:!0})]}),w.type==="task"&&s("div",{class:"form-group",children:[s("label",{children:"Faellig am"}),s("input",{type:"date",value:w.due_date,onInput:O=>S({...w,due_date:O.target.value})})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>_(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",children:"Speichern"})]})]})})]})}function Av(){const t=lr(),[e,n]=be(!1),[r,a]=be({first_name:"",last_name:"",email:"",phone:"",position:"",source:"manual",source_detail:"",company_name:"",gdpr_consent:!1});function i(l,c){a(h=>({...h,[l]:c}))}async function o(l){l.preventDefault(),n(!0);try{let c=null;if(r.company_name.trim()){const{data:m,error:b}=await wh({name:r.company_name.trim()});if(b)throw b;c=m.id}const{data:h,error:f}=await yh({first_name:r.first_name,last_name:r.last_name,email:r.email,phone:r.phone||null,position:r.position||null,source:r.source,source_detail:r.source_detail||null,company_id:c,gdpr_consent:r.gdpr_consent,gdpr_consent_at:r.gdpr_consent?new Date().toISOString():null});if(f)throw f;t.success("Kontakt erstellt"),Ve(`/crm/contacts/${h.id}`)}catch(c){t.error(c.message||"Fehler beim Erstellen")}n(!1)}return s(xt,{children:[s("div",{class:"page-header",children:s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/contacts"),children:""}),s("h1",{class:"page-title",children:"Neuer Kontakt"})]})}),s("div",{class:"page-body",children:s("div",{class:"card",style:"max-width: 640px",children:s("form",{onSubmit:o,children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Vorname"}),s("input",{value:r.first_name,onInput:l=>i("first_name",l.target.value)})]}),s("div",{class:"form-group",children:[s("label",{children:"Nachname"}),s("input",{value:r.last_name,onInput:l=>i("last_name",l.target.value)})]}),s("div",{class:"form-group",children:[s("label",{children:"E-Mail *"}),s("input",{type:"email",required:!0,value:r.email,onInput:l=>i("email",l.target.value)})]}),s("div",{class:"form-group",children:[s("label",{children:"Telefon"}),s("input",{type:"tel",value:r.phone,onInput:l=>i("phone",l.target.value)})]}),s("div",{class:"form-group",children:[s("label",{children:"Position"}),s("input",{value:r.position,onInput:l=>i("position",l.target.value),placeholder:"z.B. Geschaeftsfuehrer"})]}),s("div",{class:"form-group",children:[s("label",{children:"Firma"}),s("input",{value:r.company_name,onInput:l=>i("company_name",l.target.value),placeholder:"Firmenname"})]}),s("div",{class:"form-group",children:[s("label",{children:"Quelle"}),s("select",{value:r.source,onChange:l=>i("source",l.target.value),children:Object.entries(Ma).map(([l,c])=>s("option",{value:l,children:c},l))})]}),s("div",{class:"form-group",children:[s("label",{children:"Quelle (Detail)"}),s("input",{value:r.source_detail,onInput:l=>i("source_detail",l.target.value),placeholder:"z.B. Blog: Hotels"})]}),s("div",{class:"form-group form-group-full",children:s("label",{style:"display:flex;align-items:center;gap:0.5rem;text-transform:none;font-size:0.85rem;cursor:pointer",children:[s("input",{type:"checkbox",checked:r.gdpr_consent,onChange:l=>i("gdpr_consent",l.target.checked),style:"width:auto"}),"DSGVO-Einwilligung erteilt"]})})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/contacts"),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",disabled:e,children:e?"Erstelle...":"Kontakt erstellen"})]})]})})})]})}const kv=rc.map(t=>({value:t,label:t}));function Nv(){const[t,e]=be(""),[n,r]=be(null),{companies:a,loading:i,refetch:o}=gv({search:t,industry:n}),[l,c]=be(!1),[h,f]=be({name:"",industry:"",city:"",website:""}),[m,b]=be(new Set),[p,_]=be(!1),w=lr(),S=(E,U)=>{U.stopPropagation(),b(Z=>{const O=new Set(Z);return O.has(E)?O.delete(E):O.add(E),O})},x=()=>{m.size===a.length?b(new Set):b(new Set(a.map(E=>E.id)))},T=async()=>{if(m.size===0)return;const E=m.size,U=[...m],{data:Z}=await ke.from("contacts").select("id").in("company_id",U).is("deleted_at",null),O=(Z||[]).length,J=O>0?`${E} Firma(en) loeschen? ${O} verknuepfte(r) Kontakt(e) verlieren die Firmenzuordnung.`:`${E} Firma(en) wirklich loeschen?`;if(!confirm(J))return;_(!0);const F=new Date().toISOString(),{error:C}=await ke.from("companies").update({deleted_at:F}).in("id",U);C?w.error("Fehler beim Loeschen"):(w.success(`${E} Firma(en) geloescht`),b(new Set),o()),_(!1)};async function R(E){E.preventDefault();const{data:U,error:Z}=await wh({name:h.name,industry:h.industry||null,city:h.city||null,website:h.website||null});Z?w.error("Fehler beim Erstellen"):(w.success("Firma erstellt"),c(!1),f({name:"",industry:"",city:"",website:""}),o())}return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Firmen"}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap;justify-content:flex-end",children:[m.size>0&&s("button",{class:"btn btn-danger btn-sm",onClick:T,disabled:p,children:p?"Loesche...":`${m.size} loeschen`}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>c(!0),children:"+ Neue Firma"})]})]}),s("div",{class:"page-body",children:[s("div",{class:"search-bar",children:s(fg,{value:t,onInput:e,placeholder:"Firma oder Stadt suchen..."})}),s("div",{style:"margin-bottom: 1rem",children:s(_h,{filters:kv,active:n,onSelect:r})}),i?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):a.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Firmen gefunden"})]}):s("div",{class:"card",children:s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{style:"width:40px",children:s("input",{type:"checkbox",checked:m.size===a.length&&a.length>0,onChange:x,style:"width:16px;height:16px;cursor:pointer"})}),s("th",{children:"Name"}),s("th",{children:"Branche"}),s("th",{children:"Stadt"}),s("th",{children:"Website"}),s("th",{children:"Erstellt"})]})}),s("tbody",{children:a.map(E=>s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/companies/${E.id}`),children:[s("td",{"data-label":"",onClick:U=>U.stopPropagation(),style:"width:40px",children:s("input",{type:"checkbox",checked:m.has(E.id),onChange:U=>S(E.id,U),style:"width:16px;height:16px;cursor:pointer"})}),s("td",{"data-label":"Name",style:"font-weight:500",children:E.name}),s("td",{"data-label":"Branche",children:E.industry||""}),s("td",{"data-label":"Stadt",children:E.city||""}),s("td",{"data-label":"Website",children:E.website?s("a",{href:E.website,target:"_blank",rel:"noopener",onClick:U=>U.stopPropagation(),children:E.website}):""}),s("td",{"data-label":"Erstellt",style:"color:var(--text-dim)",children:jn(E.created_at)})]},E.id))})]})})})]}),l&&s(Ua,{title:"Neue Firma",onClose:()=>c(!1),children:s("form",{onSubmit:R,children:[s("div",{class:"form-group",children:[s("label",{children:"Firmenname *"}),s("input",{required:!0,value:h.name,onInput:E=>f({...h,name:E.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Branche"}),s("select",{value:h.industry,onChange:E=>f({...h,industry:E.target.value}),children:[s("option",{value:"",children:" Auswaehlen "}),rc.map(E=>s("option",{value:E,children:E},E))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Stadt"}),s("input",{value:h.city,onInput:E=>f({...h,city:E.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Website"}),s("input",{value:h.website,onInput:E=>f({...h,website:E.target.value}),placeholder:"https://"})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>c(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",children:"Erstellen"})]})]})})]})}function Ev({id:t}){const{company:e,loading:n,update:r,softDelete:a}=mv(t),{contacts:i,refetch:o}=bh(),{deals:l}=vh({companyId:t}),{invoices:c}=fh({companyId:t});ph({companyId:t});const h=lr(),[f,m]=be(!1),[b,p]=be({}),[_,w]=be(!1),[S,x]=be({first_name:"",last_name:"",email:"",phone:"",source:"manual"}),T=i.filter(O=>O.company_id===t);if(n)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Firma"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]});if(!e)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Nicht gefunden"})}),s("div",{class:"page-body",children:s("div",{class:"empty-state",children:s("div",{class:"empty-state-text",children:"Firma nicht gefunden"})})})]});function R(){p({name:e.name||"",industry:e.industry||"",website:e.website||"",address:e.address||"",city:e.city||"",notes:e.notes||""}),m(!0)}async function E(O){O.preventDefault();const{error:J}=await yh({first_name:S.first_name||null,last_name:S.last_name||null,email:S.email||null,phone:S.phone||null,source:S.source||"manual",company_id:t});J?h.error("Fehler beim Erstellen"):(h.success("Kontakt erstellt"),w(!1),x({first_name:"",last_name:"",email:"",phone:"",source:"manual"}),o())}async function U(){const{error:O}=await r(b);O?h.error("Fehler beim Speichern"):(h.success("Firma aktualisiert"),m(!1))}async function Z(){const O=T.length,J=O>0?`Firma "${e.name}" hat ${O} verknuepfte(n) Kontakt(e). Wirklich loeschen?`:`Firma "${e.name}" wirklich loeschen?`;if(!confirm(J))return;const{error:F}=await a();F?h.error("Fehler beim Loeschen"):(h.success("Firma geloescht"),Ve("/crm/companies"))}return s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/companies"),children:""}),s("h1",{class:"page-title",children:e.name})]}),s("div",{style:"display:flex;gap:0.5rem",children:[!f&&s("button",{class:"btn btn-secondary btn-sm",onClick:R,children:"Bearbeiten"}),s("button",{class:"btn btn-danger btn-sm",onClick:Z,children:"Loeschen"})]})]}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Firmendaten"})}),f?s("div",{children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Name"}),s("input",{value:b.name,onInput:O=>p({...b,name:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Branche"}),s("select",{value:b.industry,onChange:O=>p({...b,industry:O.target.value}),children:[s("option",{value:"",children:""}),rc.map(O=>s("option",{value:O,children:O},O))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Website"}),s("input",{value:b.website,onInput:O=>p({...b,website:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Stadt"}),s("input",{value:b.city,onInput:O=>p({...b,city:O.target.value})})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Adresse"}),s("input",{value:b.address,onInput:O=>p({...b,address:O.target.value})})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Notizen"}),s("textarea",{value:b.notes,onInput:O=>p({...b,notes:O.target.value})})]})]}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>m(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary btn-sm",onClick:U,children:"Speichern"})]})]}):s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Name"}),s("span",{class:"detail-value",children:e.name})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Branche"}),s("span",{class:"detail-value",children:e.industry||""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Website"}),s("span",{class:"detail-value",children:e.website?s("a",{href:e.website,target:"_blank",rel:"noopener",children:e.website}):""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Stadt"}),s("span",{class:"detail-value",children:e.city||""})]}),s("div",{class:"detail-field form-group-full",children:[s("span",{class:"detail-label",children:"Adresse"}),s("span",{class:"detail-value",children:e.address||""})]}),e.notes&&s("div",{class:"detail-field form-group-full",children:[s("span",{class:"detail-label",children:"Notizen"}),s("span",{class:"detail-value",children:e.notes})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:[s("span",{class:"card-title",children:["Kontakte (",T.length,")"]}),!_&&s("button",{class:"btn btn-secondary btn-sm",onClick:()=>w(!0),children:"+ Kontakt"})]}),_&&s("form",{onSubmit:E,style:"margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid var(--border)",children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Vorname"}),s("input",{value:S.first_name,onInput:O=>x({...S,first_name:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Nachname"}),s("input",{value:S.last_name,onInput:O=>x({...S,last_name:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"E-Mail"}),s("input",{type:"email",value:S.email,onInput:O=>x({...S,email:O.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Telefon"}),s("input",{value:S.phone,onInput:O=>x({...S,phone:O.target.value})})]})]}),s("div",{class:"form-actions",style:"margin-top:0.5rem;border-top:none;padding-top:0",children:[s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:()=>w(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary btn-sm",children:"Erstellen"})]})]}),T.length===0&&!_?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Kontakte"}):T.length>0&&s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Name"}),s("th",{children:"E-Mail"}),s("th",{children:"Position"})]})}),s("tbody",{children:T.map(O=>s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/contacts/${O.id}`),children:[s("td",{children:`${O.first_name||""} ${O.last_name||""}`.trim()||""}),s("td",{children:O.email}),s("td",{children:O.position||""})]},O.id))})]})})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Deals (",l.length,")"]})}),l.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Deals"}):s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Titel"}),s("th",{children:"Stage"}),s("th",{children:"Wert"})]})}),s("tbody",{children:l.map(O=>s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/deals/${O.id}`),children:[s("td",{children:O.title}),s("td",{children:s(ic,{stage:O.stage})}),s("td",{children:O.value?je(O.value):""})]},O.id))})]})})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Rechnungen / Angebote (",c.length,")"]})}),c.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Rechnungen"}):s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Nummer"}),s("th",{children:"Typ"}),s("th",{children:"Status"}),s("th",{style:"text-align:right",children:"Betrag"})]})}),s("tbody",{children:c.map(O=>{var J,F,C,A;return s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${O.id}`),children:[s("td",{style:"font-weight:600",children:O.invoice_number}),s("td",{children:(J=ks[O.type])==null?void 0:J.label}),s("td",{children:s("span",{class:"stage-badge",style:`color:${(F=Zn[O.status])==null?void 0:F.color};background:${(C=Zn[O.status])==null?void 0:C.color}20`,children:(A=Zn[O.status])==null?void 0:A.label})}),s("td",{style:"text-align:right",children:je(O.total_amount)})]},O.id)})})]})})]})]}),s("div",{class:"detail-sidebar",children:s("div",{class:"card",children:s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt am"}),s("span",{class:"detail-value",children:jn(e.created_at)})]})})})]})})]})}function Lv({id:t}){const{deal:e,loading:n,update:r,changeStage:a}=cv(t),{activities:i,refetch:o}=ph({dealId:t}),{invoices:l}=fh({dealId:t}),c=lr(),[h,f]=be(!1),[m,b]=be({}),[p,_]=be(!1),[w,S]=be({type:"note",description:"",due_date:""});if(n)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Deal"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]});if(!e)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Nicht gefunden"})}),s("div",{class:"page-body",children:s("div",{class:"empty-state",children:s("div",{class:"empty-state-text",children:"Deal nicht gefunden"})})})]});function x(){b({title:e.title||"",value:e.value||"",service_type:e.service_type||"",expected_close:e.expected_close||"",lost_reason:e.lost_reason||""}),f(!0)}async function T(){const{error:U}=await r({...m,value:m.value?parseFloat(m.value):null,service_type:m.service_type||null,expected_close:m.expected_close||null,lost_reason:m.lost_reason||null});U?c.error("Fehler beim Speichern"):(c.success("Deal aktualisiert"),f(!1))}async function R(U){const{error:Z}=await a(U);Z?c.error("Fehler beim Aendern"):(c.success(`Stage auf "${ti[U].label}" geaendert`),o())}async function E(U){U.preventDefault();const{error:Z}=await dg({deal_id:t,contact_id:e.contact_id||null,type:w.type,description:w.description,due_date:w.type==="task"&&w.due_date?w.due_date:null});Z?c.error("Fehler beim Erstellen"):(c.success("Aktivitaet hinzugefuegt"),_(!1),S({type:"note",description:"",due_date:""}),o())}return s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:""}),s("h1",{class:"page-title",children:e.title}),s(ic,{stage:e.stage})]}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>_(!0),children:"+ Aktivitaet"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve(`/crm/invoices/new?type=quote&deal_id=${t}`),children:"+ Angebot"}),e.stage==="won"&&s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve(`/crm/invoices/new?type=invoice&deal_id=${t}`),children:"+ Rechnung"}),!h&&s("button",{class:"btn btn-secondary btn-sm",onClick:x,children:"Bearbeiten"})]})]}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Deal-Infos"})}),h?s("div",{children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group form-group-full",children:[s("label",{children:"Titel"}),s("input",{value:m.title,onInput:U=>b({...m,title:U.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Wert (EUR)"}),s("input",{type:"number",step:"0.01",value:m.value,onInput:U=>b({...m,value:U.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Service-Typ"}),s("select",{value:m.service_type,onChange:U=>b({...m,service_type:U.target.value}),children:[s("option",{value:"",children:""}),Object.entries($u).map(([U,Z])=>s("option",{value:U,children:Z},U))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Erwarteter Abschluss"}),s("input",{type:"date",value:m.expected_close,onInput:U=>b({...m,expected_close:U.target.value})})]}),e.stage==="lost"&&s("div",{class:"form-group",children:[s("label",{children:"Verlustgrund"}),s("input",{value:m.lost_reason,onInput:U=>b({...m,lost_reason:U.target.value})})]})]}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>f(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary btn-sm",onClick:T,children:"Speichern"})]})]}):s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Titel"}),s("span",{class:"detail-value",children:e.title})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Wert"}),s("span",{class:"detail-value",children:e.value?je(e.value):""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Service"}),s("span",{class:"detail-value",children:e.service_type?$u[e.service_type]:""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erwarteter Abschluss"}),s("span",{class:"detail-value",children:jn(e.expected_close)})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Kontakt"}),s("span",{class:"detail-value",children:e.contact?s("a",{href:"#",onClick:U=>{U.preventDefault(),Ve(`/crm/contacts/${e.contact.id}`)},children:`${e.contact.first_name||""} ${e.contact.last_name||""}`.trim()||e.contact.email}):""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Firma"}),s("span",{class:"detail-value",children:e.company?s("a",{href:"#",onClick:U=>{U.preventDefault(),Ve(`/crm/companies/${e.company.id}`)},children:e.company.name}):""})]}),e.lost_reason&&s("div",{class:"detail-field form-group-full",children:[s("span",{class:"detail-label",children:"Verlustgrund"}),s("span",{class:"detail-value",children:e.lost_reason})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Stage aendern"})}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:Object.entries(ti).map(([U,Z])=>s("button",{class:`btn btn-sm ${e.stage===U?"btn-primary":"btn-secondary"}`,onClick:()=>e.stage!==U&&R(U),disabled:e.stage===U,style:e.stage===U?`background:${Z.color}`:"",children:Z.label},U))})]}),l.length>0&&s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Rechnungen / Angebote (",l.length,")"]})}),s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Nummer"}),s("th",{children:"Typ"}),s("th",{children:"Status"}),s("th",{style:"text-align:right",children:"Betrag"})]})}),s("tbody",{children:l.map(U=>{var Z,O,J,F;return s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${U.id}`),children:[s("td",{style:"font-weight:600",children:U.invoice_number}),s("td",{children:(Z=ks[U.type])==null?void 0:Z.label}),s("td",{children:s("span",{class:"stage-badge",style:`color:${(O=Zn[U.status])==null?void 0:O.color};background:${(J=Zn[U.status])==null?void 0:J.color}20`,children:(F=Zn[U.status])==null?void 0:F.label})}),s("td",{style:"text-align:right",children:je(U.total_amount)})]},U.id)})})]})})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Aktivitaeten"})}),i.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Aktivitaeten"}):s("div",{class:"timeline",children:i.map(U=>s(mh,{activity:U},U.id))})]})]}),s("div",{class:"detail-sidebar",children:s("div",{class:"card",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Stage geaendert am"}),s("span",{class:"detail-value",children:jn(e.stage_changed_at)})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt am"}),s("span",{class:"detail-value",children:jn(e.created_at)})]})]})})]})}),p&&s(Ua,{title:"Aktivitaet hinzufuegen",onClose:()=>_(!1),children:s("form",{onSubmit:E,children:[s("div",{class:"form-group",children:[s("label",{children:"Typ"}),s("select",{value:w.type,onChange:U=>S({...w,type:U.target.value}),children:Object.entries(gh).filter(([U])=>!["form_submission","stage_change","created"].includes(U)).map(([U,Z])=>s("option",{value:U,children:[Z.icon," ",Z.label]},U))})]}),s("div",{class:"form-group",children:[s("label",{children:"Beschreibung"}),s("textarea",{value:w.description,onInput:U=>S({...w,description:U.target.value}),required:!0})]}),w.type==="task"&&s("div",{class:"form-group",children:[s("label",{children:"Faellig am"}),s("input",{type:"date",value:w.due_date,onInput:U=>S({...w,due_date:U.target.value})})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>_(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",children:"Speichern"})]})]})})]})}function Cv(){const t=lr(),{contacts:e}=bh(),[n,r]=be(!1),i=new URLSearchParams(typeof window<"u"?window.location.search:"").get("contact_id")||"",[o,l]=be({title:"",contact_id:i,service_type:"",value:"",expected_close:""});function c(f,m){l(b=>({...b,[f]:m}))}async function h(f){f.preventDefault(),r(!0);try{let m=null;if(o.contact_id){const _=e.find(w=>w.id===o.contact_id);m=(_==null?void 0:_.company_id)||null}const{data:b,error:p}=await uv({title:o.title,contact_id:o.contact_id||null,company_id:m,service_type:o.service_type||null,value:o.value?parseFloat(o.value):null,expected_close:o.expected_close||null});if(p)throw p;t.success("Deal erstellt"),Ve(`/crm/deals/${b.id}`)}catch(m){t.error(m.message||"Fehler beim Erstellen")}r(!1)}return s(xt,{children:[s("div",{class:"page-header",children:s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:""}),s("h1",{class:"page-title",children:"Neuer Deal"})]})}),s("div",{class:"page-body",children:s("div",{class:"card",style:"max-width: 640px",children:s("form",{onSubmit:h,children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group form-group-full",children:[s("label",{children:"Titel *"}),s("input",{required:!0,value:o.title,onInput:f=>c("title",f.target.value),placeholder:"z.B. 360-Tour Restaurant Bellini"})]}),s("div",{class:"form-group",children:[s("label",{children:"Kontakt"}),s("select",{value:o.contact_id,onChange:f=>c("contact_id",f.target.value),children:[s("option",{value:"",children:" Auswaehlen "}),e.map(f=>s("option",{value:f.id,children:`${f.first_name||""} ${f.last_name||""}`.trim()||f.email},f.id))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Service-Typ"}),s("select",{value:o.service_type,onChange:f=>c("service_type",f.target.value),children:[s("option",{value:"",children:" Auswaehlen "}),Object.entries($u).map(([f,m])=>s("option",{value:f,children:m},f))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Wert (EUR)"}),s("input",{type:"number",step:"0.01",min:"0",value:o.value,onInput:f=>c("value",f.target.value),placeholder:"z.B. 1200"})]}),s("div",{class:"form-group",children:[s("label",{children:"Erwarteter Abschluss"}),s("input",{type:"date",value:o.expected_close,onInput:f=>c("expected_close",f.target.value)})]})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/pipeline"),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",disabled:n,children:n?"Erstelle...":"Deal erstellen"})]})]})})})]})}function Tv(){const{user:t}=tc(),e=lr(),{settings:n,save:r,loading:a}=nc(),[i,o]=be({password:"",confirm:""}),[l,c]=be(!1),[h,f]=be({}),[m,b]=be(!1),[p,_]=be(!1),[w,S]=be(!1),[x,T]=be(!1),[R,E]=be({default_invoice_intro:"",default_quote_intro:"",payment_reference_note:""});jt(()=>{n&&(f({company_name:n.company_name||"",owner_name:n.owner_name||"",address_line1:n.address_line1||"",address_zip:n.address_zip||"",address_city:n.address_city||"",phone:n.phone||"",email:n.email||"",website:n.website||"",tax_id:n.tax_id||"",vat_id:n.vat_id||"",bank_name:n.bank_name||"",bank_iban:n.bank_iban||"",bank_bic:n.bank_bic||"",default_payment_days:n.default_payment_days||14,vat_rate:n.vat_rate||19,default_closing_text:n.default_closing_text||""}),E({default_invoice_intro:n.default_invoice_intro||"Vielen Dank fuer Ihren Auftrag. Ich berechne Ihnen fuer folgende Leistungen:",default_quote_intro:n.default_quote_intro||"Vielen Dank fuer Ihr Interesse. Gerne unterbreite ich Ihnen folgendes Angebot:",payment_reference_note:n.payment_reference_note||"Bitte verwenden Sie die Rechnungsnummer als Verwendungszweck."}))},[n]);async function U(C){C.preventDefault(),_(!0);const{error:A}=await r({...h,default_payment_days:parseInt(h.default_payment_days)||14,vat_rate:parseFloat(h.vat_rate)||19});A?e.error("Fehler: "+A.message):(e.success("Geschaeftsdaten gespeichert"),b(!1)),_(!1)}async function Z(C){C.preventDefault(),T(!0);const{error:A}=await r(R);A?e.error("Fehler: "+A.message):(e.success("Rechnungsvorlage gespeichert"),S(!1)),T(!1)}async function O(C){if(C.preventDefault(),i.password!==i.confirm){e.error("Passwoerter stimmen nicht ueberein");return}if(i.password.length<8){e.error("Passwort muss mindestens 8 Zeichen lang sein");return}c(!0);const{error:A}=await ke.auth.updateUser({password:i.password});A?e.error("Fehler: "+A.message):(e.success("Passwort geaendert"),o({password:"",confirm:""})),c(!1)}async function J(){const{data:C,error:A}=await ke.from("contacts").select("first_name, last_name, email, phone, source, created_at").is("deleted_at",null).order("created_at",{ascending:!1});if(A){e.error("Export fehlgeschlagen");return}const D=["Vorname,Nachname,E-Mail,Telefon,Quelle,Erstellt",...C.map(oe=>[oe.first_name,oe.last_name,oe.email,oe.phone,oe.source,oe.created_at].map(le=>`"${(le||"").toString().replace(/"/g,'""')}"`).join(","))].join(`
`),j=new Blob(["\uFEFF"+D],{type:"text/csv;charset=utf-8"}),$=URL.createObjectURL(j),V=document.createElement("a");V.href=$,V.download=`beck360-kontakte-${new Date().toISOString().slice(0,10)}.csv`,V.click(),URL.revokeObjectURL($),e.success("Export erstellt")}async function F(){if(!confirm("Alle geloeschten Kontakte endgueltig entfernen? Dies kann nicht rueckgaengig gemacht werden."))return;const{error:C}=await ke.from("contacts").delete().not("deleted_at","is",null);C?e.error("Fehler: "+C.message):e.success("Geloeschte Kontakte endgueltig entfernt")}return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Einstellungen"})}),s("div",{class:"page-body",children:s("div",{style:"display:flex;flex-direction:column;gap:1.5rem;max-width:640px",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Konto"})}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"E-Mail"}),s("span",{class:"detail-value",children:t==null?void 0:t.email})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"User ID"}),s("span",{class:"detail-value",style:"font-size:0.75rem;color:var(--text-dim);word-break:break-all",children:t==null?void 0:t.id})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:[s("span",{class:"card-title",children:"Geschaeftsdaten"}),!m&&s("button",{class:"btn btn-secondary btn-sm",onClick:()=>b(!0),children:"Bearbeiten"})]}),a?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):m?s("form",{onSubmit:U,children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Firmenname"}),s("input",{value:h.company_name,onInput:C=>f({...h,company_name:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Inhaber"}),s("input",{value:h.owner_name,onInput:C=>f({...h,owner_name:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Adresse"}),s("input",{value:h.address_line1,onInput:C=>f({...h,address_line1:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"PLZ"}),s("input",{value:h.address_zip,onInput:C=>f({...h,address_zip:C.target.value}),style:"max-width:120px"})]}),s("div",{class:"form-group",children:[s("label",{children:"Stadt"}),s("input",{value:h.address_city,onInput:C=>f({...h,address_city:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Telefon"}),s("input",{value:h.phone,onInput:C=>f({...h,phone:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"E-Mail"}),s("input",{type:"email",value:h.email,onInput:C=>f({...h,email:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Website"}),s("input",{value:h.website,onInput:C=>f({...h,website:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Steuernummer"}),s("input",{value:h.tax_id,onInput:C=>f({...h,tax_id:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"USt-IdNr."}),s("input",{value:h.vat_id,onInput:C=>f({...h,vat_id:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Bank"}),s("input",{value:h.bank_name,onInput:C=>f({...h,bank_name:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"IBAN"}),s("input",{value:h.bank_iban,onInput:C=>f({...h,bank_iban:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"BIC"}),s("input",{value:h.bank_bic,onInput:C=>f({...h,bank_bic:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Zahlungsziel (Tage)"}),s("input",{type:"number",value:h.default_payment_days,onInput:C=>f({...h,default_payment_days:C.target.value}),style:"max-width:100px"})]}),s("div",{class:"form-group",children:[s("label",{children:"MwSt-Satz (%)"}),s("input",{type:"number",step:"0.01",value:h.vat_rate,onInput:C=>f({...h,vat_rate:C.target.value}),style:"max-width:100px"})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Standard-Schlusstext"}),s("textarea",{value:h.default_closing_text,onInput:C=>f({...h,default_closing_text:C.target.value})})]})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:()=>b(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:p,children:p?"Speichern...":"Speichern"})]})]}):s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Firma"}),s("span",{class:"detail-value",children:(n==null?void 0:n.company_name)||"BECK360"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Inhaber"}),s("span",{class:"detail-value",children:(n==null?void 0:n.owner_name)||"Eugen Beck"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Adresse"}),s("span",{class:"detail-value",children:[(n==null?void 0:n.address_line1)||"Eichenweg 1",", ",(n==null?void 0:n.address_zip)||"76275"," ",(n==null?void 0:n.address_city)||"Ettlingen"]})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Telefon"}),s("span",{class:"detail-value",children:(n==null?void 0:n.phone)||"0173-4682501"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"IBAN"}),s("span",{class:"detail-value",children:(n==null?void 0:n.bank_iban)||"DE92 5486 2500 0001 1389 95"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"MwSt."}),s("span",{class:"detail-value",children:[(n==null?void 0:n.vat_rate)||19,"%"]})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:[s("span",{class:"card-title",children:"Rechnungsvorlage"}),!w&&s("button",{class:"btn btn-secondary btn-sm",onClick:()=>S(!0),children:"Bearbeiten"})]}),a?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):w?s("form",{onSubmit:Z,children:[s("div",{class:"form-group",children:[s("label",{children:"Standard-Einleitung Rechnung"}),s("textarea",{value:R.default_invoice_intro,onInput:C=>E({...R,default_invoice_intro:C.target.value}),rows:2})]}),s("div",{class:"form-group",children:[s("label",{children:"Standard-Einleitung Angebot"}),s("textarea",{value:R.default_quote_intro,onInput:C=>E({...R,default_quote_intro:C.target.value}),rows:2})]}),s("div",{class:"form-group",children:[s("label",{children:"Verwendungszweck-Hinweis"}),s("input",{value:R.payment_reference_note,onInput:C=>E({...R,payment_reference_note:C.target.value})})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:()=>S(!1),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:x,children:x?"Speichern...":"Speichern"})]})]}):s("div",{style:"display:flex;flex-direction:column;gap:0.75rem",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Einleitung Rechnung"}),s("span",{class:"detail-value",style:"white-space:pre-wrap",children:R.default_invoice_intro})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Einleitung Angebot"}),s("span",{class:"detail-value",style:"white-space:pre-wrap",children:R.default_quote_intro})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Verwendungszweck"}),s("span",{class:"detail-value",children:R.payment_reference_note})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Passwort aendern"})}),s("form",{onSubmit:O,children:[s("div",{class:"form-group",children:[s("label",{children:"Neues Passwort"}),s("input",{type:"password",value:i.password,onInput:C=>o({...i,password:C.target.value}),minLength:8,required:!0,autocomplete:"new-password"})]}),s("div",{class:"form-group",children:[s("label",{children:"Passwort bestaetigen"}),s("input",{type:"password",value:i.confirm,onInput:C=>o({...i,confirm:C.target.value}),minLength:8,required:!0,autocomplete:"new-password"})]}),s("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:l,children:l?"Speichern...":"Passwort aendern"})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"DSGVO-Tools"})}),s("div",{style:"display:flex;flex-direction:column;gap:0.75rem",children:[s("div",{children:[s("div",{style:"font-size:0.85rem;margin-bottom:0.35rem",children:"Kontakte als CSV exportieren"}),s("button",{class:"btn btn-secondary btn-sm",onClick:J,children:"CSV Export"})]}),s("div",{children:[s("div",{style:"font-size:0.85rem;margin-bottom:0.35rem",children:"Geloeschte Kontakte endgueltig entfernen (Recht auf Loeschung)"}),s("button",{class:"btn btn-danger btn-sm",onClick:F,children:"Endgueltig loeschen"})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"System-Info"})}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Version"}),s("span",{class:"detail-value",children:"1.0.0"})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Datenbank"}),s("span",{class:"detail-value",children:"Supabase (Frankfurt, EU)"})]})]})]})})]})}function Iv({status:t=null}={}){const[e,n]=be([]),[r,a]=be(!0),i=Nt(async()=>{a(!0);let o=ke.from("campaigns").select("*").is("deleted_at",null).order("created_at",{ascending:!1});t&&(o=o.eq("status",t));const{data:l,error:c}=await o;c||n(l||[]),a(!1)},[t]);return jt(()=>{i()},[i]),{campaigns:e,loading:r,refetch:i}}function Pv(t){const[e,n]=be(null),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:c}=await ke.from("campaigns").select("*").eq("id",t).single();n(c),a(!1)},[t]);jt(()=>{i()},[i]);const o=Nt(async c=>{const{error:h}=await ke.from("campaigns").update(c).eq("id",t);return h||await i(),{error:h}},[t,i]),l=Nt(async()=>ke.from("campaigns").update({deleted_at:new Date().toISOString()}).eq("id",t),[t]);return{campaign:e,loading:r,refetch:i,update:o,remove:l}}function Ov(t){const[e,n]=be([]),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:o}=await ke.from("campaign_recipients").select("*, contact:contacts(first_name, last_name, email)").eq("campaign_id",t).order("created_at",{ascending:!1});n(o||[]),a(!1)},[t]);return jt(()=>{i()},[i]),{recipients:e,loading:r,refetch:i}}async function Gc(t){const{data:e}=await ke.auth.getUser();return ke.from("campaigns").insert({...t,owner_id:e.user.id}).select().single()}async function pg({source:t,stage:e,industry:n}){let r=ke.from("contacts").select("id, first_name, last_name, email, source, company:companies(name, industry)").is("deleted_at",null).eq("gdpr_consent",!0).not("email","is",null);t&&(r=r.eq("source",t));const{data:a,error:i}=await r;if(i)return{data:[],error:i};let o=a||[];if(n&&(o=o.filter(l=>{var c;return((c=l.company)==null?void 0:c.industry)===n})),e){const{data:l}=await ke.from("deals").select("contact_id").eq("stage",e).is("deleted_at",null),c=new Set((l||[]).map(h=>h.contact_id).filter(Boolean));o=o.filter(h=>c.has(h.id))}return{data:o,error:null}}async function zu(t,e){if(await ke.from("campaign_recipients").delete().eq("campaign_id",t),e.length===0)return{error:null};const n=e.map(r=>({campaign_id:t,contact_id:r.id,email:r.email}));return ke.from("campaign_recipients").insert(n)}async function Hu(t,{testEmail:e}={}){const{data:{session:n}}=await ke.auth.getSession();if(!n)throw new Error("Not authenticated");const r={campaign_id:t};e&&(r.test_email=e);const a=await fetch("/api/campaign-send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify(r)}),i=await a.json();if(!a.ok)throw new Error(i.error||"Send failed");return i}const Rv=Object.entries(la).map(([t,{label:e}])=>({value:t,label:e}));function Fv(){const[t,e]=be(null),{campaigns:n,loading:r}=Iv({status:t});return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Kampagnen"}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/campaigns/new"),children:"+ Neue Kampagne"})]}),s("div",{class:"page-body",children:[s("div",{style:"margin-bottom: 1rem",children:s(_h,{filters:Rv,active:t,onSelect:e})}),r?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):n.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Kampagnen gefunden"})]}):s("div",{class:"card",children:s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Name"}),s("th",{children:"Betreff"}),s("th",{children:"Status"}),s("th",{children:"Gesendet"}),s("th",{children:"Geoeffnet"}),s("th",{children:"Datum"})]})}),s("tbody",{children:n.map(a=>{var i,o,l;return s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/campaigns/${a.id}`),children:[s("td",{"data-label":"Name",style:"font-weight:500",children:a.name}),s("td",{"data-label":"Betreff",children:a.subject}),s("td",{"data-label":"Status",children:s("span",{class:"stage-badge",style:`background:${((i=la[a.status])==null?void 0:i.color)||"#6366f1"}15;color:${((o=la[a.status])==null?void 0:o.color)||"#6366f1"};`,children:((l=la[a.status])==null?void 0:l.label)||a.status})}),s("td",{"data-label":"Gesendet",children:a.total_sent||0}),s("td",{"data-label":"Geoeffnet",children:a.total_opened||0}),s("td",{"data-label":"Datum",style:"color:var(--text-dim)",children:jn(a.sent_at||a.created_at)})]},a.id)})})]})})})]})]})}/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:gg,setPrototypeOf:tf,isFrozen:Dv,getPrototypeOf:jv,getOwnPropertyDescriptor:Bv}=Object;let{freeze:sr,seal:qr,create:Wu}=Object,{apply:Gu,construct:Vu}=typeof Reflect<"u"&&Reflect;sr||(sr=function(e){return e});qr||(qr=function(e){return e});Gu||(Gu=function(e,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];return e.apply(n,a)});Vu||(Vu=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return new e(...r)});const bl=or(Array.prototype.forEach),Mv=or(Array.prototype.lastIndexOf),nf=or(Array.prototype.pop),to=or(Array.prototype.push),Uv=or(Array.prototype.splice),Il=or(String.prototype.toLowerCase),Vc=or(String.prototype.toString),Kc=or(String.prototype.match),no=or(String.prototype.replace),qv=or(String.prototype.indexOf),$v=or(String.prototype.trim),Xr=or(Object.prototype.hasOwnProperty),ar=or(RegExp.prototype.test),ro=zv(TypeError);function or(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return Gu(t,e,r)}}function zv(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Vu(t,n)}}function Lt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Il;tf&&tf(t,null);let r=e.length;for(;r--;){let a=e[r];if(typeof a=="string"){const i=n(a);i!==a&&(Dv(e)||(e[r]=i),a=i)}t[a]=!0}return t}function Hv(t){for(let e=0;e<t.length;e++)Xr(t,e)||(t[e]=null);return t}function pi(t){const e=Wu(null);for(const[n,r]of gg(t))Xr(t,n)&&(Array.isArray(r)?e[n]=Hv(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=pi(r):e[n]=r);return e}function io(t,e){for(;t!==null;){const r=Bv(t,e);if(r){if(r.get)return or(r.get);if(typeof r.value=="function")return or(r.value)}t=jv(t)}function n(){return null}return n}const rf=sr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Jc=sr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Yc=sr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Wv=sr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xc=sr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Gv=sr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),af=sr(["#text"]),sf=sr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Zc=sr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),of=sr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),yl=sr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Vv=qr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Kv=qr(/<%[\w\W]*|[\w\W]*%>/gm),Jv=qr(/\$\{[\w\W]*/gm),Yv=qr(/^data-[\-\w.\u00B7-\uFFFF]+$/),Xv=qr(/^aria-[\-\w]+$/),mg=qr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Zv=qr(/^(?:\w+script|data):/i),Qv=qr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vg=qr(/^html$/i),eb=qr(/^[a-z][.\w]*(-[.\w]+)+$/i);var lf=Object.freeze({__proto__:null,ARIA_ATTR:Xv,ATTR_WHITESPACE:Qv,CUSTOM_ELEMENT:eb,DATA_ATTR:Yv,DOCTYPE_NAME:vg,ERB_EXPR:Kv,IS_ALLOWED_URI:mg,IS_SCRIPT_OR_DATA:Zv,MUSTACHE_EXPR:Vv,TMPLIT_EXPR:Jv});const ao={element:1,text:3,progressingInstruction:7,comment:8,document:9},tb=function(){return typeof window>"u"?null:window},nb=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const a="data-tt-policy-suffix";n&&n.hasAttribute(a)&&(r=n.getAttribute(a));const i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},cf=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function bg(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tb();const e=Ue=>bg(Ue);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==ao.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,a=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:h,NamedNodeMap:f=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:m,DOMParser:b,trustedTypes:p}=t,_=c.prototype,w=io(_,"cloneNode"),S=io(_,"remove"),x=io(_,"nextSibling"),T=io(_,"childNodes"),R=io(_,"parentNode");if(typeof o=="function"){const Ue=n.createElement("template");Ue.content&&Ue.content.ownerDocument&&(n=Ue.content.ownerDocument)}let E,U="";const{implementation:Z,createNodeIterator:O,createDocumentFragment:J,getElementsByTagName:F}=n,{importNode:C}=r;let A=cf();e.isSupported=typeof gg=="function"&&typeof R=="function"&&Z&&Z.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:j,TMPLIT_EXPR:$,DATA_ATTR:V,ARIA_ATTR:oe,IS_SCRIPT_OR_DATA:le,ATTR_WHITESPACE:ae,CUSTOM_ELEMENT:de}=lf;let{IS_ALLOWED_URI:Le}=lf,pe=null;const I=Lt({},[...rf,...Jc,...Yc,...Xc,...af]);let z=null;const K=Lt({},[...sf,...Zc,...of,...yl]);let Y=Object.seal(Wu(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,re=null;const he=Object.seal(Wu(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let fe=!0,me=!0,Ae=!1,Oe=!0,Te=!1,Me=!0,q=!1,Ce=!1,dt=!1,ze=!1,we=!1,Ke=!1,Re=!0,Qe=!1;const Ie="user-content-";let it=!0,nt=!1,at={},ut=null;const pt=Lt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $e=null;const mt=Lt({},["audio","video","img","source","image","track"]);let He=null;const rn=Lt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Et="http://www.w3.org/1998/Math/MathML",bt="http://www.w3.org/2000/svg",ct="http://www.w3.org/1999/xhtml";let Dt=ct,et=!1,Bt=null;const st=Lt({},[Et,bt,ct],Vc);let ht=Lt({},["mi","mo","mn","ms","mtext"]),Ut=Lt({},["annotation-xml"]);const kt=Lt({},["title","style","font","a","script"]);let tt=null;const Ft=["application/xhtml+xml","text/html"],_i="text/html";let Ct=null,Gn=null;const Tr=n.createElement("form"),rt=function(ee){return ee instanceof RegExp||ee instanceof Function},mr=function(){let ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Gn&&Gn===ee)){if((!ee||typeof ee!="object")&&(ee={}),ee=pi(ee),tt=Ft.indexOf(ee.PARSER_MEDIA_TYPE)===-1?_i:ee.PARSER_MEDIA_TYPE,Ct=tt==="application/xhtml+xml"?Vc:Il,pe=Xr(ee,"ALLOWED_TAGS")?Lt({},ee.ALLOWED_TAGS,Ct):I,z=Xr(ee,"ALLOWED_ATTR")?Lt({},ee.ALLOWED_ATTR,Ct):K,Bt=Xr(ee,"ALLOWED_NAMESPACES")?Lt({},ee.ALLOWED_NAMESPACES,Vc):st,He=Xr(ee,"ADD_URI_SAFE_ATTR")?Lt(pi(rn),ee.ADD_URI_SAFE_ATTR,Ct):rn,$e=Xr(ee,"ADD_DATA_URI_TAGS")?Lt(pi(mt),ee.ADD_DATA_URI_TAGS,Ct):mt,ut=Xr(ee,"FORBID_CONTENTS")?Lt({},ee.FORBID_CONTENTS,Ct):pt,Q=Xr(ee,"FORBID_TAGS")?Lt({},ee.FORBID_TAGS,Ct):pi({}),re=Xr(ee,"FORBID_ATTR")?Lt({},ee.FORBID_ATTR,Ct):pi({}),at=Xr(ee,"USE_PROFILES")?ee.USE_PROFILES:!1,fe=ee.ALLOW_ARIA_ATTR!==!1,me=ee.ALLOW_DATA_ATTR!==!1,Ae=ee.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=ee.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=ee.SAFE_FOR_TEMPLATES||!1,Me=ee.SAFE_FOR_XML!==!1,q=ee.WHOLE_DOCUMENT||!1,ze=ee.RETURN_DOM||!1,we=ee.RETURN_DOM_FRAGMENT||!1,Ke=ee.RETURN_TRUSTED_TYPE||!1,dt=ee.FORCE_BODY||!1,Re=ee.SANITIZE_DOM!==!1,Qe=ee.SANITIZE_NAMED_PROPS||!1,it=ee.KEEP_CONTENT!==!1,nt=ee.IN_PLACE||!1,Le=ee.ALLOWED_URI_REGEXP||mg,Dt=ee.NAMESPACE||ct,ht=ee.MATHML_TEXT_INTEGRATION_POINTS||ht,Ut=ee.HTML_INTEGRATION_POINTS||Ut,Y=ee.CUSTOM_ELEMENT_HANDLING||{},ee.CUSTOM_ELEMENT_HANDLING&&rt(ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&rt(ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&typeof ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Y.allowCustomizedBuiltInElements=ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(me=!1),we&&(ze=!0),at&&(pe=Lt({},af),z=[],at.html===!0&&(Lt(pe,rf),Lt(z,sf)),at.svg===!0&&(Lt(pe,Jc),Lt(z,Zc),Lt(z,yl)),at.svgFilters===!0&&(Lt(pe,Yc),Lt(z,Zc),Lt(z,yl)),at.mathMl===!0&&(Lt(pe,Xc),Lt(z,of),Lt(z,yl))),ee.ADD_TAGS&&(typeof ee.ADD_TAGS=="function"?he.tagCheck=ee.ADD_TAGS:(pe===I&&(pe=pi(pe)),Lt(pe,ee.ADD_TAGS,Ct))),ee.ADD_ATTR&&(typeof ee.ADD_ATTR=="function"?he.attributeCheck=ee.ADD_ATTR:(z===K&&(z=pi(z)),Lt(z,ee.ADD_ATTR,Ct))),ee.ADD_URI_SAFE_ATTR&&Lt(He,ee.ADD_URI_SAFE_ATTR,Ct),ee.FORBID_CONTENTS&&(ut===pt&&(ut=pi(ut)),Lt(ut,ee.FORBID_CONTENTS,Ct)),ee.ADD_FORBID_CONTENTS&&(ut===pt&&(ut=pi(ut)),Lt(ut,ee.ADD_FORBID_CONTENTS,Ct)),it&&(pe["#text"]=!0),q&&Lt(pe,["html","head","body"]),pe.table&&(Lt(pe,["tbody"]),delete Q.tbody),ee.TRUSTED_TYPES_POLICY){if(typeof ee.TRUSTED_TYPES_POLICY.createHTML!="function")throw ro('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ee.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ro('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=ee.TRUSTED_TYPES_POLICY,U=E.createHTML("")}else E===void 0&&(E=nb(p,a)),E!==null&&typeof U=="string"&&(U=E.createHTML(""));sr&&sr(ee),Gn=ee}},Ir=Lt({},[...Jc,...Yc,...Wv]),Qn=Lt({},[...Xc,...Gv]),cr=function(ee){let Ne=R(ee);(!Ne||!Ne.tagName)&&(Ne={namespaceURI:Dt,tagName:"template"});const Fe=Il(ee.tagName),Wt=Il(Ne.tagName);return Bt[ee.namespaceURI]?ee.namespaceURI===bt?Ne.namespaceURI===ct?Fe==="svg":Ne.namespaceURI===Et?Fe==="svg"&&(Wt==="annotation-xml"||ht[Wt]):!!Ir[Fe]:ee.namespaceURI===Et?Ne.namespaceURI===ct?Fe==="math":Ne.namespaceURI===bt?Fe==="math"&&Ut[Wt]:!!Qn[Fe]:ee.namespaceURI===ct?Ne.namespaceURI===bt&&!Ut[Wt]||Ne.namespaceURI===Et&&!ht[Wt]?!1:!Qn[Fe]&&(kt[Fe]||!Ir[Fe]):!!(tt==="application/xhtml+xml"&&Bt[ee.namespaceURI]):!1},Pt=function(ee){to(e.removed,{element:ee});try{R(ee).removeChild(ee)}catch{S(ee)}},Yt=function(ee,Ne){try{to(e.removed,{attribute:Ne.getAttributeNode(ee),from:Ne})}catch{to(e.removed,{attribute:null,from:Ne})}if(Ne.removeAttribute(ee),ee==="is")if(ze||we)try{Pt(Ne)}catch{}else try{Ne.setAttribute(ee,"")}catch{}},xn=function(ee){let Ne=null,Fe=null;if(dt)ee="<remove></remove>"+ee;else{const en=Kc(ee,/^[\r\n\t ]+/);Fe=en&&en[0]}tt==="application/xhtml+xml"&&Dt===ct&&(ee='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ee+"</body></html>");const Wt=E?E.createHTML(ee):ee;if(Dt===ct)try{Ne=new b().parseFromString(Wt,tt)}catch{}if(!Ne||!Ne.documentElement){Ne=Z.createDocument(Dt,"template",null);try{Ne.documentElement.innerHTML=et?U:Wt}catch{}}const cn=Ne.body||Ne.documentElement;return ee&&Fe&&cn.insertBefore(n.createTextNode(Fe),cn.childNodes[0]||null),Dt===ct?F.call(Ne,q?"html":"body")[0]:q?Ne.documentElement:cn},ai=function(ee){return O.call(ee.ownerDocument||ee,ee,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Pr=function(ee){return ee instanceof m&&(typeof ee.nodeName!="string"||typeof ee.textContent!="string"||typeof ee.removeChild!="function"||!(ee.attributes instanceof f)||typeof ee.removeAttribute!="function"||typeof ee.setAttribute!="function"||typeof ee.namespaceURI!="string"||typeof ee.insertBefore!="function"||typeof ee.hasChildNodes!="function")},ur=function(ee){return typeof l=="function"&&ee instanceof l};function Sn(Ue,ee,Ne){bl(Ue,Fe=>{Fe.call(e,ee,Ne,Gn)})}const hr=function(ee){let Ne=null;if(Sn(A.beforeSanitizeElements,ee,null),Pr(ee))return Pt(ee),!0;const Fe=Ct(ee.nodeName);if(Sn(A.uponSanitizeElement,ee,{tagName:Fe,allowedTags:pe}),Me&&ee.hasChildNodes()&&!ur(ee.firstElementChild)&&ar(/<[/\w!]/g,ee.innerHTML)&&ar(/<[/\w!]/g,ee.textContent)||ee.nodeType===ao.progressingInstruction||Me&&ee.nodeType===ao.comment&&ar(/<[/\w]/g,ee.data))return Pt(ee),!0;if(!(he.tagCheck instanceof Function&&he.tagCheck(Fe))&&(!pe[Fe]||Q[Fe])){if(!Q[Fe]&&er(Fe)&&(Y.tagNameCheck instanceof RegExp&&ar(Y.tagNameCheck,Fe)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(Fe)))return!1;if(it&&!ut[Fe]){const Wt=R(ee)||ee.parentNode,cn=T(ee)||ee.childNodes;if(cn&&Wt){const en=cn.length;for(let Cn=en-1;Cn>=0;--Cn){const un=w(cn[Cn],!0);un.__removalCount=(ee.__removalCount||0)+1,Wt.insertBefore(un,x(ee))}}}return Pt(ee),!0}return ee instanceof c&&!cr(ee)||(Fe==="noscript"||Fe==="noembed"||Fe==="noframes")&&ar(/<\/no(script|embed|frames)/i,ee.innerHTML)?(Pt(ee),!0):(Te&&ee.nodeType===ao.text&&(Ne=ee.textContent,bl([D,j,$],Wt=>{Ne=no(Ne,Wt," ")}),ee.textContent!==Ne&&(to(e.removed,{element:ee.cloneNode()}),ee.textContent=Ne)),Sn(A.afterSanitizeElements,ee,null),!1)},dr=function(ee,Ne,Fe){if(Re&&(Ne==="id"||Ne==="name")&&(Fe in n||Fe in Tr))return!1;if(!(me&&!re[Ne]&&ar(V,Ne))){if(!(fe&&ar(oe,Ne))){if(!(he.attributeCheck instanceof Function&&he.attributeCheck(Ne,ee))){if(!z[Ne]||re[Ne]){if(!(er(ee)&&(Y.tagNameCheck instanceof RegExp&&ar(Y.tagNameCheck,ee)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(ee))&&(Y.attributeNameCheck instanceof RegExp&&ar(Y.attributeNameCheck,Ne)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(Ne,ee))||Ne==="is"&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&ar(Y.tagNameCheck,Fe)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(Fe))))return!1}else if(!He[Ne]){if(!ar(Le,no(Fe,ae,""))){if(!((Ne==="src"||Ne==="xlink:href"||Ne==="href")&&ee!=="script"&&qv(Fe,"data:")===0&&$e[ee])){if(!(Ae&&!ar(le,no(Fe,ae,"")))){if(Fe)return!1}}}}}}}return!0},er=function(ee){return ee!=="annotation-xml"&&Kc(ee,de)},si=function(ee){Sn(A.beforeSanitizeAttributes,ee,null);const{attributes:Ne}=ee;if(!Ne||Pr(ee))return;const Fe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:z,forceKeepAttr:void 0};let Wt=Ne.length;for(;Wt--;){const cn=Ne[Wt],{name:en,namespaceURI:Cn,value:un}=cn,Rr=Ct(en),qi=un;let sn=en==="value"?qi:$v(qi);if(Fe.attrName=Rr,Fe.attrValue=sn,Fe.keepAttr=!0,Fe.forceKeepAttr=void 0,Sn(A.uponSanitizeAttribute,ee,Fe),sn=Fe.attrValue,Qe&&(Rr==="id"||Rr==="name")&&(Yt(en,ee),sn=Ie+sn),Me&&ar(/((--!?|])>)|<\/(style|title|textarea)/i,sn)){Yt(en,ee);continue}if(Rr==="attributename"&&Kc(sn,"href")){Yt(en,ee);continue}if(Fe.forceKeepAttr)continue;if(!Fe.keepAttr){Yt(en,ee);continue}if(!Oe&&ar(/\/>/i,sn)){Yt(en,ee);continue}Te&&bl([D,j,$],da=>{sn=no(sn,da," ")});const ha=Ct(ee.nodeName);if(!dr(ha,Rr,sn)){Yt(en,ee);continue}if(E&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!Cn)switch(p.getAttributeType(ha,Rr)){case"TrustedHTML":{sn=E.createHTML(sn);break}case"TrustedScriptURL":{sn=E.createScriptURL(sn);break}}if(sn!==qi)try{Cn?ee.setAttributeNS(Cn,en,sn):ee.setAttribute(en,sn),Pr(ee)?Pt(ee):nf(e.removed)}catch{Yt(en,ee)}}Sn(A.afterSanitizeAttributes,ee,null)},Or=function Ue(ee){let Ne=null;const Fe=ai(ee);for(Sn(A.beforeSanitizeShadowDOM,ee,null);Ne=Fe.nextNode();)Sn(A.uponSanitizeShadowNode,Ne,null),hr(Ne),si(Ne),Ne.content instanceof i&&Ue(Ne.content);Sn(A.afterSanitizeShadowDOM,ee,null)};return e.sanitize=function(Ue){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ne=null,Fe=null,Wt=null,cn=null;if(et=!Ue,et&&(Ue="<!-->"),typeof Ue!="string"&&!ur(Ue))if(typeof Ue.toString=="function"){if(Ue=Ue.toString(),typeof Ue!="string")throw ro("dirty is not a string, aborting")}else throw ro("toString is not a function");if(!e.isSupported)return Ue;if(Ce||mr(ee),e.removed=[],typeof Ue=="string"&&(nt=!1),nt){if(Ue.nodeName){const un=Ct(Ue.nodeName);if(!pe[un]||Q[un])throw ro("root node is forbidden and cannot be sanitized in-place")}}else if(Ue instanceof l)Ne=xn("<!---->"),Fe=Ne.ownerDocument.importNode(Ue,!0),Fe.nodeType===ao.element&&Fe.nodeName==="BODY"||Fe.nodeName==="HTML"?Ne=Fe:Ne.appendChild(Fe);else{if(!ze&&!Te&&!q&&Ue.indexOf("<")===-1)return E&&Ke?E.createHTML(Ue):Ue;if(Ne=xn(Ue),!Ne)return ze?null:Ke?U:""}Ne&&dt&&Pt(Ne.firstChild);const en=ai(nt?Ue:Ne);for(;Wt=en.nextNode();)hr(Wt),si(Wt),Wt.content instanceof i&&Or(Wt.content);if(nt)return Ue;if(ze){if(we)for(cn=J.call(Ne.ownerDocument);Ne.firstChild;)cn.appendChild(Ne.firstChild);else cn=Ne;return(z.shadowroot||z.shadowrootmode)&&(cn=C.call(r,cn,!0)),cn}let Cn=q?Ne.outerHTML:Ne.innerHTML;return q&&pe["!doctype"]&&Ne.ownerDocument&&Ne.ownerDocument.doctype&&Ne.ownerDocument.doctype.name&&ar(vg,Ne.ownerDocument.doctype.name)&&(Cn="<!DOCTYPE "+Ne.ownerDocument.doctype.name+`>
`+Cn),Te&&bl([D,j,$],un=>{Cn=no(Cn,un," ")}),E&&Ke?E.createHTML(Cn):Cn},e.setConfig=function(){let Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mr(Ue),Ce=!0},e.clearConfig=function(){Gn=null,Ce=!1},e.isValidAttribute=function(Ue,ee,Ne){Gn||mr({});const Fe=Ct(Ue),Wt=Ct(ee);return dr(Fe,Wt,Ne)},e.addHook=function(Ue,ee){typeof ee=="function"&&to(A[Ue],ee)},e.removeHook=function(Ue,ee){if(ee!==void 0){const Ne=Mv(A[Ue],ee);return Ne===-1?void 0:Uv(A[Ue],Ne,1)[0]}return nf(A[Ue])},e.removeHooks=function(Ue){A[Ue]=[]},e.removeAllHooks=function(){A=cf()},e}var xh=bg();const rb=Object.freeze(Object.defineProperty({__proto__:null,default:xh},Symbol.toStringTag,{value:"Module"}));function ib(){const t=lr(),[e,n]=be({name:"",subject:"",body_html:""}),[r,a]=be({source:"",stage:"",industry:""}),[i,o]=be(0),[l,c]=be([]),[h,f]=be(!1),[m,b]=be(!1),[p,_]=be(!1),[w,S]=be(!1),[x,T]=be(""),[R,E]=be(!1);function U(j,$){n(V=>({...V,[j]:$}))}function Z(j,$){a(V=>({...V,[j]:$}))}function O(j){const $=Yd.find(V=>V.id===j);$&&n(V=>({...V,subject:$.subject||V.subject,body_html:$.body}))}const J=Nt(async()=>{f(!0);const{data:j}=await pg({source:r.source||null,stage:r.stage||null,industry:r.industry||null});c(j),o(j.length),f(!1)},[r.source,r.stage,r.industry]);jt(()=>{J()},[J]);async function F(){if(!e.name||!e.subject||!e.body_html){t.error("Name, Betreff und Inhalt sind Pflichtfelder");return}b(!0);try{const{data:j,error:$}=await Gc({name:e.name,subject:e.subject,body_html:e.body_html,filters:r});if($)throw $;await zu(j.id,l),t.success("Kampagne gespeichert"),Ve(`/crm/campaigns/${j.id}`)}catch(j){t.error(j.message||"Fehler beim Speichern")}b(!1)}async function C(){if(!e.name||!e.subject||!e.body_html){t.error("Name, Betreff und Inhalt sind Pflichtfelder");return}if(i===0){t.error("Keine Empfaenger ausgewaehlt");return}b(!0);try{const{data:j,error:$}=await Gc({name:e.name,subject:e.subject,body_html:e.body_html,filters:r});if($)throw $;await zu(j.id,l);const V=await Hu(j.id);t.success(`Kampagne gesendet an ${V.total_sent} Empfaenger`),Ve(`/crm/campaigns/${j.id}`)}catch(j){t.error(j.message||"Fehler beim Senden")}b(!1),S(!1)}async function A(){if(!x){t.error("Bitte Test-E-Mail-Adresse eingeben");return}if(!e.subject||!e.body_html){t.error("Betreff und Inhalt muessen ausgefuellt sein");return}E(!0);try{const{data:j,error:$}=await Gc({name:e.name||"Test-Kampagne",subject:e.subject,body_html:e.body_html,filters:r});if($)throw $;await Hu(j.id,{testEmail:x}),t.success(`Test-Mail an ${x} gesendet`)}catch(j){t.error(j.message||"Test-Mail fehlgeschlagen")}E(!1)}const D=e.body_html.replace(/\{\{vorname\}\}/gi,"Max").replace(/\{\{nachname\}\}/gi,"Mustermann").replace(/\{\{firma\}\}/gi,"Musterfirma GmbH").replace(/\{\{email\}\}/gi,"max@example.de");return s(xt,{children:[s("div",{class:"page-header",children:s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/campaigns"),children:""}),s("h1",{class:"page-title",children:"Neue Kampagne"})]})}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Kampagne"})}),s("div",{class:"form-grid",children:[s("div",{class:"form-group form-group-full",children:[s("label",{children:"Name (intern)"}),s("input",{value:e.name,onInput:j=>U("name",j.target.value),placeholder:"z.B. Follow-up Februar 2026"})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Betreff"}),s("input",{value:e.subject,onInput:j=>U("subject",j.target.value),placeholder:"Betreff der E-Mail"})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Vorlage waehlen"})}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:Yd.map(j=>s("button",{class:"btn btn-secondary btn-sm",onClick:()=>O(j.id),children:j.name},j.id))})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:[s("span",{class:"card-title",children:"Inhalt (HTML)"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>_(!p),children:p?"Editor":"Vorschau"})]}),s("div",{style:"font-size:0.75rem;color:var(--text-dim);margin-bottom:0.5rem;",children:["Platzhalter: ","{{vorname}}",", ","{{nachname}}",", ","{{firma}}",", ","{{email}}"]}),p?s("div",{style:"border:1px solid var(--border);border-radius:8px;padding:1rem;background:#fff;min-height:300px;",dangerouslySetInnerHTML:{__html:xh.sanitize(D)}}):s("textarea",{value:e.body_html,onInput:j=>U("body_html",j.target.value),style:"width:100%;min-height:300px;font-family:monospace;font-size:0.8rem;border:1px solid var(--border);border-radius:8px;padding:0.75rem;",placeholder:"HTML-Inhalt der E-Mail..."})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Test-Mail senden"})}),s("div",{style:"display:flex;gap:0.5rem;align-items:end;",children:[s("div",{class:"form-group",style:"flex:1;margin:0",children:[s("label",{children:"E-Mail-Adresse"}),s("input",{type:"email",value:x,onInput:j=>T(j.target.value),placeholder:"rundgang@beck360.de"})]}),s("button",{class:"btn btn-secondary btn-sm",onClick:A,disabled:R,style:"white-space:nowrap;",children:R?"Sende...":"Test senden"})]})]})]}),s("div",{class:"detail-sidebar",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Empfaenger-Filter"})}),s("div",{class:"form-group",children:[s("label",{children:"Quelle"}),s("select",{value:r.source,onChange:j=>Z("source",j.target.value),children:[s("option",{value:"",children:"Alle Quellen"}),Object.entries(Ma).map(([j,$])=>s("option",{value:j,children:$},j))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Deal-Stage"}),s("select",{value:r.stage,onChange:j=>Z("stage",j.target.value),children:[s("option",{value:"",children:"Alle Stages"}),Object.entries(ti).map(([j,$])=>s("option",{value:j,children:$.label},j))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Branche"}),s("select",{value:r.industry,onChange:j=>Z("industry",j.target.value),children:[s("option",{value:"",children:"Alle Branchen"}),rc.map(j=>s("option",{value:j,children:j},j))]})]}),s("div",{style:"margin-top:1rem;padding:0.75rem;background:var(--bg-subtle,#f1f5f9);border-radius:8px;text-align:center;",children:h?s("span",{style:"color:var(--text-dim);font-size:0.85rem",children:"Lade..."}):s(xt,{children:[s("div",{style:"font-size:1.5rem;font-weight:700;",children:i}),s("div",{style:"font-size:0.75rem;color:var(--text-dim)",children:"Empfaenger (nur mit DSGVO-Einwilligung)"})]})})]}),s("div",{class:"card",children:s("div",{style:"display:flex;flex-direction:column;gap:0.5rem;",children:[s("button",{class:"btn btn-secondary",onClick:F,disabled:m,children:m?"Speichere...":"Als Entwurf speichern"}),s("button",{class:"btn btn-primary",onClick:()=>S(!0),disabled:m||i===0,children:"Speichern & Senden"})]})})]})]})}),w&&s(Ua,{title:"Kampagne senden?",onClose:()=>S(!1),children:[s("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',s("strong",{children:e.name}),'" wird an ',s("strong",{children:[i," Empfaenger"]})," gesendet. Dieser Vorgang kann nicht rueckgaengig gemacht werden."]}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary",onClick:()=>S(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary",onClick:C,disabled:m,children:m?"Sende...":"Jetzt senden"})]})]})]})}const Qc={pending:{label:"Ausstehend",color:"#6366f1"},sent:{label:"Gesendet",color:"#3b82f6"},opened:{label:"Geoeffnet",color:"#10b981"},clicked:{label:"Geklickt",color:"#059669"},bounced:{label:"Bounce",color:"#ef4444"},unsubscribed:{label:"Abgemeldet",color:"#94a3b8"}};function ab({id:t}){var C,A,D,j,$;const{campaign:e,loading:n,update:r,refetch:a,remove:i}=Pv(t),{recipients:o,loading:l,refetch:c}=Ov(t),h=lr(),[f,m]=be(!1),[b,p]=be({}),[_,w]=be(!1),[S,x]=be(!1),[T,R]=be(!1);if(n)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Kampagne"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]});if(!e)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Nicht gefunden"})}),s("div",{class:"page-body",children:s("div",{class:"empty-state",children:s("div",{class:"empty-state-text",children:"Kampagne nicht gefunden"})})})]});function E(){p({name:e.name||"",subject:e.subject||"",body_html:e.body_html||""}),m(!0)}async function U(){const{error:V}=await r(b);V?h.error("Fehler beim Speichern"):(h.success("Kampagne aktualisiert"),m(!1))}async function Z(){x(!0);try{if(e.status==="draft"&&e.filters){const{data:oe}=await pg(e.filters);await zu(e.id,oe),await c()}const V=await Hu(e.id);h.success(`Kampagne gesendet an ${V.total_sent} Empfaenger`),a(),c()}catch(V){h.error(V.message||"Senden fehlgeschlagen")}x(!1),w(!1)}async function O(){const{error:V}=await i();V?h.error("Fehler beim Loeschen"):(h.success("Kampagne geloescht"),Ve("/crm/campaigns"))}const J=e.total_sent>0?Math.round(e.total_opened/e.total_sent*100):0,F=e.total_sent>0?Math.round(e.total_clicked/e.total_sent*100):0;return s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/campaigns"),children:""}),s("h1",{class:"page-title",children:e.name}),s("span",{class:"stage-badge",style:`background:${((C=la[e.status])==null?void 0:C.color)||"#6366f1"}15;color:${((A=la[e.status])==null?void 0:A.color)||"#6366f1"};`,children:((D=la[e.status])==null?void 0:D.label)||e.status})]}),s("div",{style:"display:flex;gap:0.5rem",children:e.status==="draft"&&s(xt,{children:[!f&&s("button",{class:"btn btn-secondary btn-sm",onClick:E,children:"Bearbeiten"}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>w(!0),children:"Senden"}),s("button",{class:"btn btn-danger btn-sm",onClick:()=>R(!0),children:"Loeschen"})]})})]}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[e.status==="sent"&&s("div",{style:"display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1rem;",children:[s("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[s("div",{class:"kpi-value",children:e.total_sent}),s("div",{class:"kpi-label",children:"Gesendet"})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[s("div",{class:"kpi-value",children:[e.total_opened," ",s("span",{style:"font-size:0.85rem;color:var(--text-dim)",children:["(",J,"%)"]})]}),s("div",{class:"kpi-label",children:"Geoeffnet"})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[s("div",{class:"kpi-value",children:[e.total_clicked," ",s("span",{style:"font-size:0.85rem;color:var(--text-dim)",children:["(",F,"%)"]})]}),s("div",{class:"kpi-label",children:"Geklickt"})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Kampagnen-Details"})}),f?s("div",{children:[s("div",{class:"form-grid",children:[s("div",{class:"form-group form-group-full",children:[s("label",{children:"Name"}),s("input",{value:b.name,onInput:V=>p({...b,name:V.target.value})})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Betreff"}),s("input",{value:b.subject,onInput:V=>p({...b,subject:V.target.value})})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Inhalt (HTML)"}),s("textarea",{value:b.body_html,onInput:V=>p({...b,body_html:V.target.value}),style:"width:100%;min-height:200px;font-family:monospace;font-size:0.8rem;"})]})]}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>m(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary btn-sm",onClick:U,children:"Speichern"})]})]}):s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Betreff"}),s("span",{class:"detail-value",children:e.subject})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt am"}),s("span",{class:"detail-value",children:vl(e.created_at)})]}),e.sent_at&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Gesendet am"}),s("span",{class:"detail-value",children:vl(e.sent_at)})]}),e.filters&&s("div",{class:"detail-field form-group-full",children:[s("span",{class:"detail-label",children:"Filter"}),s("span",{class:"detail-value",style:"font-size:0.85rem",children:[e.filters.source&&s("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem;margin-right:0.25rem",children:Ma[e.filters.source]||e.filters.source}),e.filters.stage&&s("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem;margin-right:0.25rem",children:((j=ti[e.filters.stage])==null?void 0:j.label)||e.filters.stage}),e.filters.industry&&s("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem",children:e.filters.industry}),!e.filters.source&&!e.filters.stage&&!e.filters.industry&&"Alle Kontakte"]})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"E-Mail-Vorschau"})}),s("div",{style:"border:1px solid var(--border);border-radius:8px;padding:1rem;background:#fff;max-height:400px;overflow:auto;",dangerouslySetInnerHTML:{__html:xh.sanitize(e.body_html)}})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Empfaenger (",o.length,")"]})}),l?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):o.length===0?s("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Empfaenger"}):s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Name"}),s("th",{children:"E-Mail"}),s("th",{children:"Status"}),s("th",{children:"Geoeffnet"}),s("th",{children:"Geklickt"})]})}),s("tbody",{children:o.map(V=>{var oe,le,ae;return s("tr",{children:[s("td",{children:V.contact?s("a",{href:"#",onClick:de=>{de.preventDefault(),Ve(`/crm/contacts/${V.contact_id}`)},children:`${V.contact.first_name||""} ${V.contact.last_name||""}`.trim()||V.email}):V.email}),s("td",{children:V.email}),s("td",{children:s("span",{class:"stage-badge",style:`background:${((oe=Qc[V.status])==null?void 0:oe.color)||"#6366f1"}15;color:${((le=Qc[V.status])==null?void 0:le.color)||"#6366f1"};`,children:((ae=Qc[V.status])==null?void 0:ae.label)||V.status})}),s("td",{style:"color:var(--text-dim)",children:V.opened_at?vl(V.opened_at):""}),s("td",{style:"color:var(--text-dim)",children:V.clicked_at?vl(V.clicked_at):""})]},V.id)})})]})})]})]}),s("div",{class:"detail-sidebar",children:s("div",{class:"card",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Status"}),s("span",{class:"detail-value",children:($=la[e.status])==null?void 0:$.label})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt"}),s("span",{class:"detail-value",children:jn(e.created_at)})]}),e.sent_at&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Gesendet"}),s("span",{class:"detail-value",children:jn(e.sent_at)})]})]})})]})}),_&&s(Ua,{title:"Kampagne senden?",onClose:()=>w(!1),children:[s("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',s("strong",{children:e.name}),'" wird jetzt versendet. Nur Kontakte mit DSGVO-Einwilligung erhalten die E-Mail.']}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary",onClick:()=>w(!1),children:"Abbrechen"}),s("button",{class:"btn btn-primary",onClick:Z,disabled:S,children:S?"Sende...":"Jetzt senden"})]})]}),T&&s(Ua,{title:"Kampagne loeschen?",onClose:()=>R(!1),children:[s("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',s("strong",{children:e.name}),'" wird unwiderruflich geloescht.']}),s("div",{class:"form-actions",children:[s("button",{class:"btn btn-secondary",onClick:()=>R(!1),children:"Abbrechen"}),s("button",{class:"btn btn-danger",onClick:O,children:"Loeschen"})]})]})]})}function sb(){const[t,e]=be(null),[n,r]=be(null),{invoices:a,loading:i}=fh({type:t,status:n});return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Rechnungen & Angebote"}),s("div",{style:"display:flex;gap:0.5rem",children:[s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/invoices/new?type=invoice"),children:"+ Rechnung"}),s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices/new?type=quote"),children:"+ Angebot"})]})]}),s("div",{class:"page-body",children:[s("div",{class:"search-bar",children:[s("div",{class:"filter-pills",children:[s("button",{class:`filter-pill ${t?"":"active"}`,onClick:()=>e(null),children:"Alle"}),Object.entries(ks).map(([o,l])=>s("button",{class:`filter-pill ${t===o?"active":""}`,onClick:()=>e(t===o?null:o),children:l.label},o))]}),s("div",{class:"filter-pills",children:Object.entries(Zn).map(([o,l])=>s("button",{class:`filter-pill ${n===o?"active":""}`,onClick:()=>r(n===o?null:o),children:l.label},o))})]}),i?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):a.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Rechnungen oder Angebote"})]}):s("div",{class:"card",children:s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Nummer"}),s("th",{children:"Typ"}),s("th",{children:"Kunde"}),s("th",{children:"Datum"}),s("th",{children:"Status"}),s("th",{style:"text-align:right",children:"Betrag"})]})}),s("tbody",{children:a.map(o=>{var l,c,h,f;return s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${o.id}`),children:[s("td",{"data-label":"Nummer",style:"font-weight:600",children:o.invoice_number}),s("td",{"data-label":"Typ",children:s("span",{style:`font-size:0.75rem;padding:0.15rem 0.5rem;border-radius:999px;background:${o.type==="quote"?"rgba(139,92,246,0.15);color:#a78bfa":"rgba(59,130,246,0.15);color:#60a5fa"}`,children:(l=ks[o.type])==null?void 0:l.label})}),s("td",{"data-label":"Kunde",children:o.customer_company||o.customer_name||""}),s("td",{"data-label":"Datum",children:jn(o.invoice_date)}),s("td",{"data-label":"Status",children:s("span",{class:"stage-badge",style:`color:${(c=Zn[o.status])==null?void 0:c.color};background:${(h=Zn[o.status])==null?void 0:h.color}20`,children:(f=Zn[o.status])==null?void 0:f.label})}),s("td",{"data-label":"Betrag",style:"text-align:right;font-weight:600",children:je(o.total_amount)})]},o.id)})})]})})})]})]})}function ob({items:t,onChange:e}){function n(o,l,c){const h=t.map((f,m)=>m===o?{...f,[l]:c}:f);e(h)}function r(){e([...t,{description:"",sub_description:"",quantity:1,unit_price:0}])}function a(o){e(t.filter((l,c)=>c!==o))}function i(o){return(parseFloat(o)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+" "}return s("div",{children:[s("div",{class:"table-wrapper",children:s("table",{class:"line-items-table",children:[s("thead",{children:s("tr",{children:[s("th",{style:"width:40%",children:"Bezeichnung"}),s("th",{style:"width:15%",children:"Menge"}),s("th",{style:"width:20%",children:"Einzelpreis"}),s("th",{style:"width:15%;text-align:right",children:"Gesamt"}),s("th",{style:"width:10%"})]})}),s("tbody",{children:t.map((o,l)=>{const c=(parseFloat(o.quantity)||0)*(parseFloat(o.unit_price)||0);return s("tr",{children:[s("td",{children:[s("input",{value:o.description,onInput:h=>n(l,"description",h.target.value),placeholder:"Leistung / Produkt",required:!0}),s("input",{value:o.sub_description||"",onInput:h=>n(l,"sub_description",h.target.value),placeholder:"Zusatzinfo (optional)",style:"margin-top:0.25rem;font-size:0.8rem;color:var(--text-muted)"})]}),s("td",{children:s("input",{type:"number",step:"0.01",min:"0",value:o.quantity,onInput:h=>n(l,"quantity",h.target.value),style:"text-align:right"})}),s("td",{children:s("input",{type:"number",step:"0.01",min:"0",value:o.unit_price,onInput:h=>n(l,"unit_price",h.target.value),style:"text-align:right"})}),s("td",{style:"text-align:right;white-space:nowrap;font-weight:500",children:i(c)}),s("td",{style:"text-align:center",children:s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:()=>a(l),title:"Entfernen",children:"x"})})]},l)})})]})}),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:r,style:"margin-top:0.75rem",children:"+ Position"})]})}function lb(){const t=lr(),{settings:e}=nc(),n=new URLSearchParams(window.location.search),r=n.get("type")||"invoice",a=n.get("deal_id"),i=n.get("quote_id"),o=n.get("edit"),{invoice:l,items:c,loading:h}=hg(o),[f,m]=be(!1),[b,p]=be([]),[_,w]=be([]),[S,x]=be({type:r,invoice_number:"",invoice_date:new Date().toISOString().slice(0,10),due_date:"",company_id:"",contact_id:"",deal_id:a||"",customer_company:"",customer_name:"",customer_street:"",customer_zip:"",customer_city:"",customer_number:"",discount_percent:0,vat_rate:19,payment_terms:"Diese Rechnung ist zahlbar innerhalb von 14 Tagen ohne Abzug auf das unten angegebene Bankkonto.",closing_message:"",intro_text:"",notes:""}),[T,R]=be([{description:"",sub_description:"",quantity:1,unit_price:0}]);jt(()=>{ke.from("companies").select("id, name, address, city").is("deleted_at",null).order("name").then(({data:C})=>p(C||[])),ke.from("contacts").select("id, first_name, last_name, email, company_id").is("deleted_at",null).order("last_name").then(({data:C})=>w(C||[]))},[]),jt(()=>{if(e&&!o&&!i){const C=new Date;C.setDate(C.getDate()+(e.default_payment_days||14)),x(A=>{const j=A.type==="quote"?e.default_quote_intro||"Vielen Dank fuer Ihr Interesse. Gerne unterbreite ich Ihnen folgendes Angebot:":e.default_invoice_intro||"Vielen Dank fuer Ihren Auftrag. Ich berechne Ihnen fuer folgende Leistungen:";return{...A,vat_rate:parseFloat(e.vat_rate)||19,due_date:A.due_date||C.toISOString().slice(0,10),closing_message:A.closing_message||e.default_closing_text||"",intro_text:A.intro_text||j}})}},[e,o,i]),jt(()=>{!a||o||ke.from("deals").select("*, contact:contacts(id, first_name, last_name), company:companies(id, name, address, city)").eq("id",a).single().then(({data:C})=>{if(!C)return;const A=C.contact?`${C.contact.first_name||""} ${C.contact.last_name||""}`.trim():"";x(D=>{var j,$,V,oe,le,ae;return{...D,deal_id:C.id,company_id:((j=C.company)==null?void 0:j.id)||"",contact_id:(($=C.contact)==null?void 0:$.id)||"",customer_company:((V=C.company)==null?void 0:V.name)||"",customer_name:A,customer_street:((oe=C.company)==null?void 0:oe.address)||"",customer_city:((le=C.company)==null?void 0:le.city)||"",invoice_number:Tl(r,(ae=C.company)==null?void 0:ae.name,A)}})})},[a,r,o]),jt(()=>{i&&Promise.all([ke.from("invoices").select("*").eq("id",i).single(),ke.from("invoice_items").select("*").eq("invoice_id",i).order("position")]).then(([{data:C},{data:A}])=>{C&&(x(D=>({...D,type:"invoice",invoice_number:Tl("invoice",C.customer_company,C.customer_name),company_id:C.company_id||"",contact_id:C.contact_id||"",deal_id:C.deal_id||"",customer_company:C.customer_company||"",customer_name:C.customer_name||"",customer_street:C.customer_street||"",customer_zip:C.customer_zip||"",customer_city:C.customer_city||"",customer_number:C.customer_number||"",discount_percent:C.discount_percent||0,vat_rate:C.vat_rate||19,payment_terms:C.payment_terms||D.payment_terms,closing_message:C.closing_message||D.closing_message,intro_text:C.intro_text||"",notes:C.notes||""})),A&&A.length>0&&R(A.map(D=>({description:D.description,sub_description:D.sub_description||"",quantity:D.quantity,unit_price:D.unit_price}))))})},[i]),jt(()=>{!o||h||!l||(x({type:l.type,invoice_number:l.invoice_number,invoice_date:l.invoice_date,due_date:l.due_date||"",company_id:l.company_id||"",contact_id:l.contact_id||"",deal_id:l.deal_id||"",customer_company:l.customer_company||"",customer_name:l.customer_name||"",customer_street:l.customer_street||"",customer_zip:l.customer_zip||"",customer_city:l.customer_city||"",customer_number:l.customer_number||"",discount_percent:l.discount_percent||0,vat_rate:l.vat_rate||19,payment_terms:l.payment_terms||"",closing_message:l.closing_message||"",intro_text:l.intro_text||"",notes:l.notes||""}),c.length>0&&R(c.map(C=>({description:C.description,sub_description:C.sub_description||"",quantity:C.quantity,unit_price:C.unit_price}))))},[o,h,l,c]),jt(()=>{o||i||!S.customer_name&&!S.customer_company||x(C=>({...C,invoice_number:Tl(C.type,C.customer_company,C.customer_name)}))},[S.type,S.customer_name,S.customer_company,o,i]);function E(C){const A=b.find(D=>D.id===C);x(D=>({...D,company_id:C,customer_company:(A==null?void 0:A.name)||D.customer_company,customer_street:(A==null?void 0:A.address)||D.customer_street,customer_city:(A==null?void 0:A.city)||D.customer_city}))}function U(C){const A=_.find(j=>j.id===C);if(!A)return;const D=`${A.first_name||""} ${A.last_name||""}`.trim();x(j=>({...j,contact_id:C,customer_name:D,company_id:A.company_id||j.company_id})),A.company_id&&!S.company_id&&E(A.company_id)}const Z=ev(T,S.discount_percent,S.vat_rate),O=S.type==="quote",J=o?`${O?"Angebot":"Rechnung"} bearbeiten`:i?"Rechnung aus Angebot erstellen":`Neue${O?"s Angebot":" Rechnung"} erstellen`;async function F(C){if(C.preventDefault(),T.length===0||!T.some(j=>j.description)){t.error("Mindestens eine Position erforderlich");return}m(!0);const A={...S,company_id:S.company_id||null,contact_id:S.contact_id||null,deal_id:S.deal_id||null,subtotal:Z.subtotal,net_amount:Z.net_amount,vat_amount:Z.vat_amount,total_amount:Z.total_amount,due_date:S.due_date||null};let D;o?(D=await nv(o,A,T),D.error||(t.success("Gespeichert"),Ve(`/crm/invoices/${o}`))):(i&&(A.converted_from_quote_id=i),D=await tv(A,T),D.error||(t.success(`${O?"Angebot":"Rechnung"} erstellt`),Ve(`/crm/invoices/${D.data.id}`))),D.error&&t.error("Fehler: "+D.error.message),m(!1)}return o&&h?s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Laden..."})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]}):s(xt,{children:[s("div",{class:"page-header",children:s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices"),children:""}),s("h1",{class:"page-title",children:J})]})}),s("div",{class:"page-body",children:s("form",{onSubmit:F,style:"max-width:900px",children:[s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Dokument"})}),s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Typ"}),s("select",{value:S.type,onChange:C=>x({...S,type:C.target.value}),disabled:!!o||!!i,children:[s("option",{value:"invoice",children:"Rechnung"}),s("option",{value:"quote",children:"Angebot"})]})]}),s("div",{class:"form-group",children:[s("label",{children:O?"Angebotsnr.":"Rechnungsnr."}),s("input",{value:S.invoice_number,onInput:C=>x({...S,invoice_number:C.target.value}),required:!0})]}),s("div",{class:"form-group",children:[s("label",{children:"Datum"}),s("input",{type:"date",value:S.invoice_date,onInput:C=>x({...S,invoice_date:C.target.value}),required:!0})]}),s("div",{class:"form-group",children:[s("label",{children:O?"Gueltig bis":"Faellig am"}),s("input",{type:"date",value:S.due_date,onInput:C=>x({...S,due_date:C.target.value})})]})]})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Kunde"})}),s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Firma (CRM)"}),s("select",{value:S.company_id,onChange:C=>E(C.target.value),children:[s("option",{value:"",children:" Firma waehlen "}),b.map(C=>s("option",{value:C.id,children:C.name},C.id))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Kontakt (CRM)"}),s("select",{value:S.contact_id,onChange:C=>U(C.target.value),children:[s("option",{value:"",children:" Kontakt waehlen "}),_.map(C=>s("option",{value:C.id,children:`${C.first_name||""} ${C.last_name||""}`.trim()||C.email},C.id))]})]}),s("div",{class:"form-group",children:[s("label",{children:"Firmenname (Rechnung)"}),s("input",{value:S.customer_company,onInput:C=>x({...S,customer_company:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Ansprechpartner"}),s("input",{value:S.customer_name,onInput:C=>x({...S,customer_name:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Strasse"}),s("input",{value:S.customer_street,onInput:C=>x({...S,customer_street:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"PLZ"}),s("input",{value:S.customer_zip,onInput:C=>x({...S,customer_zip:C.target.value}),style:"max-width:120px"})]}),s("div",{class:"form-group",children:[s("label",{children:"Stadt"}),s("input",{value:S.customer_city,onInput:C=>x({...S,customer_city:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Kundennummer"}),s("input",{value:S.customer_number,onInput:C=>x({...S,customer_number:C.target.value}),placeholder:"Optional"})]})]})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Positionen"})}),s(ob,{items:T,onChange:R})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Betraege"})}),s("div",{style:"display:flex;gap:1.5rem;align-items:flex-start",children:[s("div",{style:"flex:1",children:[s("div",{class:"form-group",style:"max-width:200px",children:[s("label",{children:"Rabatt (%)"}),s("input",{type:"number",step:"0.01",min:"0",max:"100",value:S.discount_percent,onInput:C=>x({...S,discount_percent:C.target.value}),style:"text-align:right"})]}),s("div",{class:"form-group",style:"max-width:200px",children:[s("label",{children:"MwSt. (%)"}),s("input",{type:"number",step:"0.01",min:"0",value:S.vat_rate,onInput:C=>x({...S,vat_rate:C.target.value}),style:"text-align:right"})]})]}),s("div",{class:"invoice-totals",children:[s("div",{class:"invoice-totals-row",children:[s("span",{children:"Zwischensumme"}),s("span",{children:je(Z.subtotal)})]}),parseFloat(S.discount_percent)>0&&s("div",{class:"invoice-totals-row",children:[s("span",{children:["Rabatt (-",S.discount_percent,"%)"]}),s("span",{children:["-",je(Z.discount_amount)]})]}),s("div",{class:"invoice-totals-row",children:[s("span",{children:"Nettobetrag"}),s("span",{children:je(Z.net_amount)})]}),s("div",{class:"invoice-totals-row",children:[s("span",{children:[S.vat_rate,"% MwSt."]}),s("span",{children:je(Z.vat_amount)})]}),s("div",{class:"invoice-totals-row",style:"font-weight:700;font-size:1.1rem;border-top:2px solid var(--border);padding-top:0.5rem",children:[s("span",{children:"Gesamtbetrag"}),s("span",{children:je(Z.total_amount)})]})]})]})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Texte"})}),s("div",{class:"form-group",children:[s("label",{children:"Einleitungstext"}),s("textarea",{value:S.intro_text,onInput:C=>x({...S,intro_text:C.target.value}),rows:2,placeholder:O?"Angebots-Einleitung...":"Rechnungs-Einleitung..."})]}),s("div",{class:"form-group",children:[s("label",{children:"Zahlungsbedingungen"}),s("textarea",{value:S.payment_terms,onInput:C=>x({...S,payment_terms:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Schlussnachricht"}),s("textarea",{value:S.closing_message,onInput:C=>x({...S,closing_message:C.target.value})})]}),s("div",{class:"form-group",children:[s("label",{children:"Interne Notizen"}),s("textarea",{value:S.notes,onInput:C=>x({...S,notes:C.target.value}),placeholder:"Nur intern sichtbar"})]})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/invoices"),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",disabled:f,children:f?"Speichern...":o?"Speichern":"Erstellen"})]})]})})]})}const cb="modulepreload",ub=function(t){return"/crm/"+t},uf={},eu=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let o=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=o(n.map(h=>{if(h=ub(h),h in uf)return;uf[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const b=document.createElement("link");if(b.rel=f?"stylesheet":cb,f||(b.as="script"),b.crossOrigin="",b.href=h,c&&b.setAttribute("nonce",c),document.head.appendChild(b),f)return new Promise((p,_)=>{b.addEventListener("load",p),b.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function Ht(t){"@babel/helpers - typeof";return Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(t)}var ni=Uint8Array,Cr=Uint16Array,Sh=Int32Array,Ah=new ni([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kh=new ni([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hf=new ni([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yg=function(t,e){for(var n=new Cr(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var a=new Sh(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)a[i]=i-n[r]<<5|r;return{b:n,r:a}},_g=yg(Ah,2),hb=_g.b,Ku=_g.r;hb[28]=258,Ku[258]=28;var db=yg(kh,0),df=db.r,Ju=new Cr(32768);for(var nn=0;nn<32768;++nn){var ra=(nn&43690)>>1|(nn&21845)<<1;ra=(ra&52428)>>2|(ra&13107)<<2,ra=(ra&61680)>>4|(ra&3855)<<4,Ju[nn]=((ra&65280)>>8|(ra&255)<<8)>>1}var go=(function(t,e,n){for(var r=t.length,a=0,i=new Cr(e);a<r;++a)t[a]&&++i[t[a]-1];var o=new Cr(e);for(a=1;a<e;++a)o[a]=o[a-1]+i[a-1]<<1;var l;if(n){l=new Cr(1<<e);var c=15-e;for(a=0;a<r;++a)if(t[a])for(var h=a<<4|t[a],f=e-t[a],m=o[t[a]-1]++<<f,b=m|(1<<f)-1;m<=b;++m)l[Ju[m]>>c]=h}else for(l=new Cr(r),a=0;a<r;++a)t[a]&&(l[a]=Ju[o[t[a]-1]++]>>15-t[a]);return l}),qa=new ni(288);for(var nn=0;nn<144;++nn)qa[nn]=8;for(var nn=144;nn<256;++nn)qa[nn]=9;for(var nn=256;nn<280;++nn)qa[nn]=7;for(var nn=280;nn<288;++nn)qa[nn]=8;var Gl=new ni(32);for(var nn=0;nn<32;++nn)Gl[nn]=5;var fb=go(qa,9,0),pb=go(Gl,5,0),wg=function(t){return(t+7)/8|0},gb=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new ni(t.subarray(e,n))},Di=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},so=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},tu=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var a=n.length,i=n.slice();if(!a)return{t:Sg,l:0};if(a==1){var o=new ni(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(U,Z){return U.f-Z.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],h=0,f=1,m=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=a-1;)l=n[n[h].f<n[m].f?h++:m++],c=n[h!=f&&n[h].f<n[m].f?h++:m++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var b=i[0].s,r=1;r<a;++r)i[r].s>b&&(b=i[r].s);var p=new Cr(b+1),_=Yu(n[f-1],p,0);if(_>e){var r=0,w=0,S=_-e,x=1<<S;for(i.sort(function(Z,O){return p[O.s]-p[Z.s]||Z.f-O.f});r<a;++r){var T=i[r].s;if(p[T]>e)w+=x-(1<<_-p[T]),p[T]=e;else break}for(w>>=S;w>0;){var R=i[r].s;p[R]<e?w-=1<<e-p[R]++-1:++r}for(;r>=0&&w;--r){var E=i[r].s;p[E]==e&&(--p[E],++w)}_=e}return{t:new ni(p),l:_}},Yu=function(t,e,n){return t.s==-1?Math.max(Yu(t.l,e,n+1),Yu(t.r,e,n+1)):e[t.s]=n},ff=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Cr(++e),r=0,a=t[0],i=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=t[l]}return{c:n.subarray(0,r),n:e}},oo=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},xg=function(t,e,n){var r=n.length,a=wg(e+2);t[a]=r&255,t[a+1]=r>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var i=0;i<r;++i)t[a+i+4]=n[i];return(a+4+r)*8},pf=function(t,e,n,r,a,i,o,l,c,h,f){Di(e,f++,n),++a[256];for(var m=tu(a,15),b=m.t,p=m.l,_=tu(i,15),w=_.t,S=_.l,x=ff(b),T=x.c,R=x.n,E=ff(w),U=E.c,Z=E.n,O=new Cr(19),J=0;J<T.length;++J)++O[T[J]&31];for(var J=0;J<U.length;++J)++O[U[J]&31];for(var F=tu(O,7),C=F.t,A=F.l,D=19;D>4&&!C[hf[D-1]];--D);var j=h+5<<3,$=oo(a,qa)+oo(i,Gl)+o,V=oo(a,b)+oo(i,w)+o+14+3*D+oo(O,C)+2*O[16]+3*O[17]+7*O[18];if(c>=0&&j<=$&&j<=V)return xg(e,f,t.subarray(c,c+h));var oe,le,ae,de;if(Di(e,f,1+(V<$)),f+=2,V<$){oe=go(b,p,0),le=b,ae=go(w,S,0),de=w;var Le=go(C,A,0);Di(e,f,R-257),Di(e,f+5,Z-1),Di(e,f+10,D-4),f+=14;for(var J=0;J<D;++J)Di(e,f+3*J,C[hf[J]]);f+=3*D;for(var pe=[T,U],I=0;I<2;++I)for(var z=pe[I],J=0;J<z.length;++J){var K=z[J]&31;Di(e,f,Le[K]),f+=C[K],K>15&&(Di(e,f,z[J]>>5&127),f+=z[J]>>12)}}else oe=fb,le=qa,ae=pb,de=Gl;for(var J=0;J<l;++J){var Y=r[J];if(Y>255){var K=Y>>18&31;so(e,f,oe[K+257]),f+=le[K+257],K>7&&(Di(e,f,Y>>23&31),f+=Ah[K]);var Q=Y&31;so(e,f,ae[Q]),f+=de[Q],Q>3&&(so(e,f,Y>>5&8191),f+=kh[Q])}else so(e,f,oe[Y]),f+=le[Y]}return so(e,f,oe[256]),f+le[256]},mb=new Sh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sg=new ni(0),vb=function(t,e,n,r,a,i){var o=i.z||t.length,l=new ni(r+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(r,l.length-a),h=i.l,f=(i.r||0)&7;if(e){f&&(c[0]=i.r>>3);for(var m=mb[e-1],b=m>>13,p=m&8191,_=(1<<n)-1,w=i.p||new Cr(32768),S=i.h||new Cr(_+1),x=Math.ceil(n/3),T=2*x,R=function(Me){return(t[Me]^t[Me+1]<<x^t[Me+2]<<T)&_},E=new Sh(25e3),U=new Cr(288),Z=new Cr(32),O=0,J=0,F=i.i||0,C=0,A=i.w||0,D=0;F+2<o;++F){var j=R(F),$=F&32767,V=S[j];if(w[$]=V,S[j]=$,A<=F){var oe=o-F;if((O>7e3||C>24576)&&(oe>423||!h)){f=pf(t,c,0,E,U,Z,J,C,D,F-D,f),C=O=J=0,D=F;for(var le=0;le<286;++le)U[le]=0;for(var le=0;le<30;++le)Z[le]=0}var ae=2,de=0,Le=p,pe=$-V&32767;if(oe>2&&j==R(F-pe))for(var I=Math.min(b,oe)-1,z=Math.min(32767,F),K=Math.min(258,oe);pe<=z&&--Le&&$!=V;){if(t[F+ae]==t[F+ae-pe]){for(var Y=0;Y<K&&t[F+Y]==t[F+Y-pe];++Y);if(Y>ae){if(ae=Y,de=pe,Y>I)break;for(var Q=Math.min(pe,Y-2),re=0,le=0;le<Q;++le){var he=F-pe+le&32767,fe=w[he],me=he-fe&32767;me>re&&(re=me,V=he)}}}$=V,V=w[$],pe+=$-V&32767}if(de){E[C++]=268435456|Ku[ae]<<18|df[de];var Ae=Ku[ae]&31,Oe=df[de]&31;J+=Ah[Ae]+kh[Oe],++U[257+Ae],++Z[Oe],A=F+ae,++O}else E[C++]=t[F],++U[t[F]]}}for(F=Math.max(F,A);F<o;++F)E[C++]=t[F],++U[t[F]];f=pf(t,c,h,E,U,Z,J,C,D,F-D,f),h||(i.r=f&7|c[f/8|0]<<3,f-=7,i.h=S,i.p=w,i.i=F,i.w=A)}else{for(var F=i.w||0;F<o+h;F+=65535){var Te=F+65535;Te>=o&&(c[f/8|0]=h,Te=o),f=xg(c,f+1,t.subarray(F,Te))}i.i=o}return gb(l,0,r+wg(f)+a)},Ag=function(){var t=1,e=0;return{p:function(n){for(var r=t,a=e,i=n.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)a+=r+=n[o];r=(r&65535)+15*(r>>16),a=(a&65535)+15*(a>>16)}t=r,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},bb=function(t,e,n,r,a){if(!a&&(a={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new ni(i.length+t.length);o.set(i),o.set(t,i.length),t=o,a.w=i.length}return vb(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,a)},kg=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},yb=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=Ag();a.p(e.dictionary),kg(t,2,a.d())}};function Xu(t,e){e||(e={});var n=Ag();n.p(t);var r=bb(t,e,e.dictionary?6:2,4);return yb(r,e),kg(r,r.length-4,n.d()),r}var _b=typeof TextDecoder<"u"&&new TextDecoder,wb=0;try{_b.decode(Sg,{stream:!0}),wb=1}catch{}function xb(t){if(Array.isArray(t))return t}function Sb(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,i,o,l=[],c=!0,h=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(f){h=!0,a=f}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(h)throw a}}return l}}function gf(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ab(t,e){if(t){if(typeof t=="string")return gf(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gf(t,e):void 0}}function kb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mf(t,e){return xb(t)||Sb(t,e)||Ab(t,e)||kb()}function vf(t,e="utf8"){return new TextDecoder(e).decode(t)}const Nb=new TextEncoder;function Eb(t){return Nb.encode(t)}const Lb=1024*8,Cb=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),nu={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Nh{constructor(e=Lb,n={}){zt(this,"buffer");zt(this,"byteLength");zt(this,"byteOffset");zt(this,"length");zt(this,"offset");zt(this,"lastWrittenByte");zt(this,"littleEndian");zt(this,"_data");zt(this,"_mark");zt(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const a=n.offset?n.offset>>>0:0,i=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof Nh)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,a=new Uint8Array(r);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=nu[n].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+r);if(this.littleEndian===Cb&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+r));l.reverse();const c=new nu[n](l.buffer);return this.offset+=r,c.reverse(),c}const o=new nu[n](i);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return vf(this.readBytes(e))}decodeText(e=1,n="utf8"){return vf(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(Eb(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Es(t){let e=t.length;for(;--e>=0;)t[e]=0}const Tb=3,Ib=258,Ng=29,Pb=256,Ob=Pb+1+Ng,Eg=30,Rb=512,Fb=new Array((Ob+2)*2);Es(Fb);const Db=new Array(Eg*2);Es(Db);const jb=new Array(Rb);Es(jb);const Bb=new Array(Ib-Tb+1);Es(Bb);const Mb=new Array(Ng);Es(Mb);const Ub=new Array(Eg);Es(Ub);const qb=(t,e,n,r)=>{let a=t&65535|0,i=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do a=a+e[r++]|0,i=i+a|0;while(--o);a%=65521,i%=65521}return a|i<<16|0};var Zu=qb;const $b=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},zb=new Uint32Array($b()),Hb=(t,e,n,r)=>{const a=zb,i=r+n;t^=-1;for(let o=r;o<i;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var fi=Hb,Qu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lg={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Wb=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Gb=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Wb(n,r)&&(t[r]=n[r])}}return t},Vb=t=>{let e=0;for(let r=0,a=t.length;r<a;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,a=0,i=t.length;r<i;r++){let o=t[r];n.set(o,a),a+=o.length}return n},Cg={assign:Gb,flattenChunks:Vb};let Tg=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Tg=!1}const ko=new Uint8Array(256);for(let t=0;t<256;t++)ko[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ko[254]=ko[254]=1;var Kb=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,a,i,o=t.length,l=0;for(a=0;a<o;a++)n=t.charCodeAt(a),(n&64512)===55296&&a+1<o&&(r=t.charCodeAt(a+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),i=0,a=0;i<l;a++)n=t.charCodeAt(a),(n&64512)===55296&&a+1<o&&(r=t.charCodeAt(a+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),n<128?e[i++]=n:n<2048?(e[i++]=192|n>>>6,e[i++]=128|n&63):n<65536?(e[i++]=224|n>>>12,e[i++]=128|n>>>6&63,e[i++]=128|n&63):(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63,e[i++]=128|n>>>6&63,e[i++]=128|n&63);return e};const Jb=(t,e)=>{if(e<65534&&t.subarray&&Tg)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var Yb=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,a;const i=new Array(n*2);for(a=0,r=0;r<n;){let o=t[r++];if(o<128){i[a++]=o;continue}let l=ko[o];if(l>4){i[a++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|t[r++]&63,l--;if(l>1){i[a++]=65533;continue}o<65536?i[a++]=o:(o-=65536,i[a++]=55296|o>>10&1023,i[a++]=56320|o&1023)}return Jb(i,a)},Xb=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+ko[t[n]]>e?n:e},eh={string2buf:Kb,buf2string:Yb,utf8border:Xb};function Zb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Qb=Zb;const _l=16209,e5=16191;var t5=function(e,n){let r,a,i,o,l,c,h,f,m,b,p,_,w,S,x,T,R,E,U,Z,O,J,F,C;const A=e.state;r=e.next_in,F=e.input,a=r+(e.avail_in-5),i=e.next_out,C=e.output,o=i-(n-e.avail_out),l=i+(e.avail_out-257),c=A.dmax,h=A.wsize,f=A.whave,m=A.wnext,b=A.window,p=A.hold,_=A.bits,w=A.lencode,S=A.distcode,x=(1<<A.lenbits)-1,T=(1<<A.distbits)-1;e:do{_<15&&(p+=F[r++]<<_,_+=8,p+=F[r++]<<_,_+=8),R=w[p&x];t:for(;;){if(E=R>>>24,p>>>=E,_-=E,E=R>>>16&255,E===0)C[i++]=R&65535;else if(E&16){U=R&65535,E&=15,E&&(_<E&&(p+=F[r++]<<_,_+=8),U+=p&(1<<E)-1,p>>>=E,_-=E),_<15&&(p+=F[r++]<<_,_+=8,p+=F[r++]<<_,_+=8),R=S[p&T];n:for(;;){if(E=R>>>24,p>>>=E,_-=E,E=R>>>16&255,E&16){if(Z=R&65535,E&=15,_<E&&(p+=F[r++]<<_,_+=8,_<E&&(p+=F[r++]<<_,_+=8)),Z+=p&(1<<E)-1,Z>c){e.msg="invalid distance too far back",A.mode=_l;break e}if(p>>>=E,_-=E,E=i-o,Z>E){if(E=Z-E,E>f&&A.sane){e.msg="invalid distance too far back",A.mode=_l;break e}if(O=0,J=b,m===0){if(O+=h-E,E<U){U-=E;do C[i++]=b[O++];while(--E);O=i-Z,J=C}}else if(m<E){if(O+=h+m-E,E-=m,E<U){U-=E;do C[i++]=b[O++];while(--E);if(O=0,m<U){E=m,U-=E;do C[i++]=b[O++];while(--E);O=i-Z,J=C}}}else if(O+=m-E,E<U){U-=E;do C[i++]=b[O++];while(--E);O=i-Z,J=C}for(;U>2;)C[i++]=J[O++],C[i++]=J[O++],C[i++]=J[O++],U-=3;U&&(C[i++]=J[O++],U>1&&(C[i++]=J[O++]))}else{O=i-Z;do C[i++]=C[O++],C[i++]=C[O++],C[i++]=C[O++],U-=3;while(U>2);U&&(C[i++]=C[O++],U>1&&(C[i++]=C[O++]))}}else if((E&64)===0){R=S[(R&65535)+(p&(1<<E)-1)];continue n}else{e.msg="invalid distance code",A.mode=_l;break e}break}}else if((E&64)===0){R=w[(R&65535)+(p&(1<<E)-1)];continue t}else if(E&32){A.mode=e5;break e}else{e.msg="invalid literal/length code",A.mode=_l;break e}break}}while(r<a&&i<l);U=_>>3,r-=U,_-=U<<3,p&=(1<<_)-1,e.next_in=r,e.next_out=i,e.avail_in=r<a?5+(a-r):5-(r-a),e.avail_out=i<l?257+(l-i):257-(i-l),A.hold=p,A.bits=_};const ls=15,bf=852,yf=592,_f=0,ru=1,wf=2,n5=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),r5=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i5=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),a5=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),s5=(t,e,n,r,a,i,o,l)=>{const c=l.bits;let h=0,f=0,m=0,b=0,p=0,_=0,w=0,S=0,x=0,T=0,R,E,U,Z,O,J=null,F;const C=new Uint16Array(ls+1),A=new Uint16Array(ls+1);let D=null,j,$,V;for(h=0;h<=ls;h++)C[h]=0;for(f=0;f<r;f++)C[e[n+f]]++;for(p=c,b=ls;b>=1&&C[b]===0;b--);if(p>b&&(p=b),b===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,l.bits=1,0;for(m=1;m<b&&C[m]===0;m++);for(p<m&&(p=m),S=1,h=1;h<=ls;h++)if(S<<=1,S-=C[h],S<0)return-1;if(S>0&&(t===_f||b!==1))return-1;for(A[1]=0,h=1;h<ls;h++)A[h+1]=A[h]+C[h];for(f=0;f<r;f++)e[n+f]!==0&&(o[A[e[n+f]]++]=f);if(t===_f?(J=D=o,F=20):t===ru?(J=n5,D=r5,F=257):(J=i5,D=a5,F=0),T=0,f=0,h=m,O=i,_=p,w=0,U=-1,x=1<<p,Z=x-1,t===ru&&x>bf||t===wf&&x>yf)return 1;for(;;){j=h-w,o[f]+1<F?($=0,V=o[f]):o[f]>=F?($=D[o[f]-F],V=J[o[f]-F]):($=96,V=0),R=1<<h-w,E=1<<_,m=E;do E-=R,a[O+(T>>w)+E]=j<<24|$<<16|V|0;while(E!==0);for(R=1<<h-1;T&R;)R>>=1;if(R!==0?(T&=R-1,T+=R):T=0,f++,--C[h]===0){if(h===b)break;h=e[n+o[f]]}if(h>p&&(T&Z)!==U){for(w===0&&(w=p),O+=m,_=h-w,S=1<<_;_+w<b&&(S-=C[_+w],!(S<=0));)_++,S<<=1;if(x+=1<<_,t===ru&&x>bf||t===wf&&x>yf)return 1;U=T&Z,a[U]=p<<24|_<<16|O-i|0}}return T!==0&&(a[O+T]=h-w<<24|64<<16|0),l.bits=p,0};var mo=s5;const o5=0,Ig=1,Pg=2,{Z_FINISH:xf,Z_BLOCK:l5,Z_TREES:wl,Z_OK:$a,Z_STREAM_END:c5,Z_NEED_DICT:u5,Z_STREAM_ERROR:$r,Z_DATA_ERROR:Og,Z_MEM_ERROR:Rg,Z_BUF_ERROR:h5,Z_DEFLATED:Sf}=Lg,ac=16180,Af=16181,kf=16182,Nf=16183,Ef=16184,Lf=16185,Cf=16186,Tf=16187,If=16188,Pf=16189,Vl=16190,ji=16191,iu=16192,Of=16193,au=16194,Rf=16195,Ff=16196,Df=16197,jf=16198,xl=16199,Sl=16200,Bf=16201,Mf=16202,Uf=16203,qf=16204,$f=16205,su=16206,zf=16207,Hf=16208,an=16209,Fg=16210,Dg=16211,d5=852,f5=592,p5=15,g5=p5,Wf=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function m5(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ha=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<ac||e.mode>Dg?1:0},jg=t=>{if(Ha(t))return $r;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=ac,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(d5),e.distcode=e.distdyn=new Int32Array(f5),e.sane=1,e.back=-1,$a},Bg=t=>{if(Ha(t))return $r;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,jg(t)},Mg=(t,e)=>{let n;if(Ha(t))return $r;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?$r:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,Bg(t))},Ug=(t,e)=>{if(!t)return $r;const n=new m5;t.state=n,n.strm=t,n.window=null,n.mode=ac;const r=Mg(t,e);return r!==$a&&(t.state=null),r},v5=t=>Ug(t,g5);let Gf=!0,ou,lu;const b5=t=>{if(Gf){ou=new Int32Array(512),lu=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(mo(Ig,t.lens,0,288,ou,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;mo(Pg,t.lens,0,32,lu,0,t.work,{bits:5}),Gf=!1}t.lencode=ou,t.lenbits=9,t.distcode=lu,t.distbits=5},qg=(t,e,n,r)=>{let a;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(e.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>r&&(a=r),i.window.set(e.subarray(n-r,n-r+a),i.wnext),r-=a,r?(i.window.set(e.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},y5=(t,e)=>{let n,r,a,i,o,l,c,h,f,m,b,p,_,w,S=0,x,T,R,E,U,Z,O,J;const F=new Uint8Array(4);let C,A;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ha(t)||!t.output||!t.input&&t.avail_in!==0)return $r;n=t.state,n.mode===ji&&(n.mode=iu),o=t.next_out,a=t.output,c=t.avail_out,i=t.next_in,r=t.input,l=t.avail_in,h=n.hold,f=n.bits,m=l,b=c,J=$a;e:for(;;)switch(n.mode){case ac:if(n.wrap===0){n.mode=iu;break}for(;f<16;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(n.wrap&2&&h===35615){n.wbits===0&&(n.wbits=15),n.check=0,F[0]=h&255,F[1]=h>>>8&255,n.check=fi(n.check,F,2,0),h=0,f=0,n.mode=Af;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=an;break}if((h&15)!==Sf){t.msg="unknown compression method",n.mode=an;break}if(h>>>=4,f-=4,O=(h&15)+8,n.wbits===0&&(n.wbits=O),O>15||O>n.wbits){t.msg="invalid window size",n.mode=an;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=h&512?Pf:ji,h=0,f=0;break;case Af:for(;f<16;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(n.flags=h,(n.flags&255)!==Sf){t.msg="unknown compression method",n.mode=an;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=an;break}n.head&&(n.head.text=h>>8&1),n.flags&512&&n.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,n.check=fi(n.check,F,2,0)),h=0,f=0,n.mode=kf;case kf:for(;f<32;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.head&&(n.head.time=h),n.flags&512&&n.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,F[2]=h>>>16&255,F[3]=h>>>24&255,n.check=fi(n.check,F,4,0)),h=0,f=0,n.mode=Nf;case Nf:for(;f<16;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.head&&(n.head.xflags=h&255,n.head.os=h>>8),n.flags&512&&n.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,n.check=fi(n.check,F,2,0)),h=0,f=0,n.mode=Ef;case Ef:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.length=h,n.head&&(n.head.extra_len=h),n.flags&512&&n.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,n.check=fi(n.check,F,2,0)),h=0,f=0}else n.head&&(n.head.extra=null);n.mode=Lf;case Lf:if(n.flags&1024&&(p=n.length,p>l&&(p=l),p&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+p),O)),n.flags&512&&n.wrap&4&&(n.check=fi(n.check,r,p,i)),l-=p,i+=p,n.length-=p),n.length))break e;n.length=0,n.mode=Cf;case Cf:if(n.flags&2048){if(l===0)break e;p=0;do O=r[i+p++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O));while(O&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=fi(n.check,r,p,i)),l-=p,i+=p,O)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Tf;case Tf:if(n.flags&4096){if(l===0)break e;p=0;do O=r[i+p++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O));while(O&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=fi(n.check,r,p,i)),l-=p,i+=p,O)break e}else n.head&&(n.head.comment=null);n.mode=If;case If:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(n.wrap&4&&h!==(n.check&65535)){t.msg="header crc mismatch",n.mode=an;break}h=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=ji;break;case Pf:for(;f<32;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}t.adler=n.check=Wf(h),h=0,f=0,n.mode=Vl;case Vl:if(n.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=h,n.bits=f,u5;t.adler=n.check=1,n.mode=ji;case ji:if(e===l5||e===wl)break e;case iu:if(n.last){h>>>=f&7,f-=f&7,n.mode=su;break}for(;f<3;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}switch(n.last=h&1,h>>>=1,f-=1,h&3){case 0:n.mode=Of;break;case 1:if(b5(n),n.mode=xl,e===wl){h>>>=2,f-=2;break e}break;case 2:n.mode=Ff;break;case 3:t.msg="invalid block type",n.mode=an}h>>>=2,f-=2;break;case Of:for(h>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=an;break}if(n.length=h&65535,h=0,f=0,n.mode=au,e===wl)break e;case au:n.mode=Rf;case Rf:if(p=n.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;a.set(r.subarray(i,i+p),o),l-=p,i+=p,c-=p,o+=p,n.length-=p;break}n.mode=ji;break;case Ff:for(;f<14;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(n.nlen=(h&31)+257,h>>>=5,f-=5,n.ndist=(h&31)+1,h>>>=5,f-=5,n.ncode=(h&15)+4,h>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=an;break}n.have=0,n.mode=Df;case Df:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.lens[D[n.have++]]=h&7,h>>>=3,f-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},J=mo(o5,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,J){t.msg="invalid code lengths set",n.mode=an;break}n.have=0,n.mode=jf;case jf:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[h&(1<<n.lenbits)-1],x=S>>>24,T=S>>>16&255,R=S&65535,!(x<=f);){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(R<16)h>>>=x,f-=x,n.lens[n.have++]=R;else{if(R===16){for(A=x+2;f<A;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(h>>>=x,f-=x,n.have===0){t.msg="invalid bit length repeat",n.mode=an;break}O=n.lens[n.have-1],p=3+(h&3),h>>>=2,f-=2}else if(R===17){for(A=x+3;f<A;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}h>>>=x,f-=x,O=0,p=3+(h&7),h>>>=3,f-=3}else{for(A=x+7;f<A;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}h>>>=x,f-=x,O=0,p=11+(h&127),h>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=an;break}for(;p--;)n.lens[n.have++]=O}}if(n.mode===an)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=an;break}if(n.lenbits=9,C={bits:n.lenbits},J=mo(Ig,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,J){t.msg="invalid literal/lengths set",n.mode=an;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},J=mo(Pg,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,J){t.msg="invalid distances set",n.mode=an;break}if(n.mode=xl,e===wl)break e;case xl:n.mode=Sl;case Sl:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=h,n.bits=f,t5(t,b),o=t.next_out,a=t.output,c=t.avail_out,i=t.next_in,r=t.input,l=t.avail_in,h=n.hold,f=n.bits,n.mode===ji&&(n.back=-1);break}for(n.back=0;S=n.lencode[h&(1<<n.lenbits)-1],x=S>>>24,T=S>>>16&255,R=S&65535,!(x<=f);){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(T&&(T&240)===0){for(E=x,U=T,Z=R;S=n.lencode[Z+((h&(1<<E+U)-1)>>E)],x=S>>>24,T=S>>>16&255,R=S&65535,!(E+x<=f);){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}h>>>=E,f-=E,n.back+=E}if(h>>>=x,f-=x,n.back+=x,n.length=R,T===0){n.mode=$f;break}if(T&32){n.back=-1,n.mode=ji;break}if(T&64){t.msg="invalid literal/length code",n.mode=an;break}n.extra=T&15,n.mode=Bf;case Bf:if(n.extra){for(A=n.extra;f<A;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Mf;case Mf:for(;S=n.distcode[h&(1<<n.distbits)-1],x=S>>>24,T=S>>>16&255,R=S&65535,!(x<=f);){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if((T&240)===0){for(E=x,U=T,Z=R;S=n.distcode[Z+((h&(1<<E+U)-1)>>E)],x=S>>>24,T=S>>>16&255,R=S&65535,!(E+x<=f);){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}h>>>=E,f-=E,n.back+=E}if(h>>>=x,f-=x,n.back+=x,T&64){t.msg="invalid distance code",n.mode=an;break}n.offset=R,n.extra=T&15,n.mode=Uf;case Uf:if(n.extra){for(A=n.extra;f<A;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=an;break}n.mode=qf;case qf:if(c===0)break e;if(p=b-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=an;break}p>n.wnext?(p-=n.wnext,_=n.wsize-p):_=n.wnext-p,p>n.length&&(p=n.length),w=n.window}else w=a,_=o-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do a[o++]=w[_++];while(--p);n.length===0&&(n.mode=Sl);break;case $f:if(c===0)break e;a[o++]=n.length,c--,n.mode=Sl;break;case su:if(n.wrap){for(;f<32;){if(l===0)break e;l--,h|=r[i++]<<f,f+=8}if(b-=c,t.total_out+=b,n.total+=b,n.wrap&4&&b&&(t.adler=n.check=n.flags?fi(n.check,a,b,o-b):Zu(n.check,a,b,o-b)),b=c,n.wrap&4&&(n.flags?h:Wf(h))!==n.check){t.msg="incorrect data check",n.mode=an;break}h=0,f=0}n.mode=zf;case zf:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,h+=r[i++]<<f,f+=8}if(n.wrap&4&&h!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=an;break}h=0,f=0}n.mode=Hf;case Hf:J=c5;break e;case an:J=Og;break e;case Fg:return Rg;case Dg:default:return $r}return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=h,n.bits=f,(n.wsize||b!==t.avail_out&&n.mode<an&&(n.mode<su||e!==xf))&&qg(t,t.output,t.next_out,b-t.avail_out),m-=t.avail_in,b-=t.avail_out,t.total_in+=m,t.total_out+=b,n.total+=b,n.wrap&4&&b&&(t.adler=n.check=n.flags?fi(n.check,a,b,t.next_out-b):Zu(n.check,a,b,t.next_out-b)),t.data_type=n.bits+(n.last?64:0)+(n.mode===ji?128:0)+(n.mode===xl||n.mode===au?256:0),(m===0&&b===0||e===xf)&&J===$a&&(J=h5),J},_5=t=>{if(Ha(t))return $r;let e=t.state;return e.window&&(e.window=null),t.state=null,$a},w5=(t,e)=>{if(Ha(t))return $r;const n=t.state;return(n.wrap&2)===0?$r:(n.head=e,e.done=!1,$a)},x5=(t,e)=>{const n=e.length;let r,a,i;return Ha(t)||(r=t.state,r.wrap!==0&&r.mode!==Vl)?$r:r.mode===Vl&&(a=1,a=Zu(a,e,n,0),a!==r.check)?Og:(i=qg(t,e,n,n),i?(r.mode=Fg,Rg):(r.havedict=1,$a))};var S5=Bg,A5=Mg,k5=jg,N5=v5,E5=Ug,L5=y5,C5=_5,T5=w5,I5=x5,P5="pako inflate (from Nodeca project)",Mi={inflateReset:S5,inflateReset2:A5,inflateResetKeep:k5,inflateInit:N5,inflateInit2:E5,inflate:L5,inflateEnd:C5,inflateGetHeader:T5,inflateSetDictionary:I5,inflateInfo:P5};function O5(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var R5=O5;const $g=Object.prototype.toString,{Z_NO_FLUSH:F5,Z_FINISH:D5,Z_OK:No,Z_STREAM_END:cu,Z_NEED_DICT:uu,Z_STREAM_ERROR:j5,Z_DATA_ERROR:Vf,Z_MEM_ERROR:B5}=Lg;function To(t){this.options=Cg.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qb,this.strm.avail_out=0;let n=Mi.inflateInit2(this.strm,e.windowBits);if(n!==No)throw new Error(Qu[n]);if(this.header=new R5,Mi.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=eh.string2buf(e.dictionary):$g.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Mi.inflateSetDictionary(this.strm,e.dictionary),n!==No)))throw new Error(Qu[n])}To.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,a=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?D5:F5,$g.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=Mi.inflate(n,o),i===uu&&a&&(i=Mi.inflateSetDictionary(n,a),i===No?i=Mi.inflate(n,o):i===Vf&&(i=uu));n.avail_in>0&&i===cu&&n.state.wrap>0&&t[n.next_in]!==0;)Mi.inflateReset(n),i=Mi.inflate(n,o);switch(i){case j5:case Vf:case uu:case B5:return this.onEnd(i),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||i===cu))if(this.options.to==="string"){let c=eh.utf8border(n.output,n.next_out),h=n.next_out-c,f=eh.buf2string(n.output,c);n.next_out=h,n.avail_out=r-h,h&&n.output.set(n.output.subarray(c,c+h),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(i===No&&l===0)){if(i===cu)return i=Mi.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};To.prototype.onData=function(t){this.chunks.push(t)};To.prototype.onEnd=function(t){t===No&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Cg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function M5(t,e){const n=new To(e);if(n.push(t),n.err)throw n.msg||Qu[n.err];return n.result}var U5=To,q5=M5,$5={Inflate:U5,inflate:q5};const{Inflate:z5,inflate:H5}=$5;var Kf=z5,W5=H5;const zg=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;zg[t]=e}const Jf=4294967295;function G5(t,e,n){let r=t;for(let a=0;a<n;a++)r=zg[(r^e[a])&255]^r>>>8;return r}function V5(t,e){return(G5(Jf,t,e)^Jf)>>>0}function Yf(t,e,n){const r=t.readUint32(),a=V5(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${a}`)}function Hg(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function Wg(t,e,n,r){let a=0;for(;a<r;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-r]&255}function Gg(t,e,n,r){let a=0;if(n.length===0)for(;a<r;a++)e[a]=t[a];else for(;a<r;a++)e[a]=t[a]+n[a]&255}function Vg(t,e,n,r,a){let i=0;if(n.length===0){for(;i<a;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+(e[i-a]>>1)&255}else{for(;i<a;i++)e[i]=t[i]+(n[i]>>1)&255;for(;i<r;i++)e[i]=t[i]+(e[i-a]+n[i]>>1)&255}}function Kg(t,e,n,r,a){let i=0;if(n.length===0){for(;i<a;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-a]&255}else{for(;i<a;i++)e[i]=t[i]+n[i]&255;for(;i<r;i++)e[i]=t[i]+K5(e[i-a],n[i],n[i-a])&255}}function K5(t,e,n){const r=t+e-n,a=Math.abs(r-t),i=Math.abs(r-e),o=Math.abs(r-n);return a<=i&&a<=o?t:i<=o?e:n}function J5(t,e,n,r,a,i){switch(t){case 0:Hg(e,n,a);break;case 1:Wg(e,n,a,i);break;case 2:Gg(e,n,r,a);break;case 3:Vg(e,n,r,a,i);break;case 4:Kg(e,n,r,a,i);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Y5=new Uint16Array([255]),X5=new Uint8Array(Y5.buffer),Z5=X5[0]===255;function Q5(t){const{data:e,width:n,height:r,channels:a,depth:i}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*a,c=new Uint8Array(r*n*l);let h=0;for(let f=0;f<7;f++){const m=o[f],b=Math.ceil((n-m.x)/m.xStep),p=Math.ceil((r-m.y)/m.yStep);if(b<=0||p<=0)continue;const _=b*l,w=new Uint8Array(_);for(let S=0;S<p;S++){const x=e[h++],T=e.subarray(h,h+_);h+=_;const R=new Uint8Array(_);J5(x,T,R,w,_,l),w.set(R);for(let E=0;E<b;E++){const U=m.x+E*m.xStep,Z=m.y+S*m.yStep;if(!(U>=n||Z>=r))for(let O=0;O<l;O++)c[(Z*n+U)*l+O]=R[E*l+O]}}}if(i===16){const f=new Uint16Array(c.buffer);if(Z5)for(let m=0;m<f.length;m++)f[m]=ey(f[m]);return f}else return c}function ey(t){return(t&255)<<8|t>>8&255}const ty=new Uint16Array([255]),ny=new Uint8Array(ty.buffer),ry=ny[0]===255,iy=new Uint8Array(0);function Xf(t){const{data:e,width:n,height:r,channels:a,depth:i}=t,o=Math.ceil(i/8)*a,l=Math.ceil(i/8*a*n),c=new Uint8Array(r*l);let h=iy,f=0,m,b;for(let p=0;p<r;p++){switch(m=e.subarray(f+1,f+1+l),b=c.subarray(p*l,(p+1)*l),e[f]){case 0:Hg(m,b,l);break;case 1:Wg(m,b,l,o);break;case 2:Gg(m,b,h,l);break;case 3:Vg(m,b,h,l,o);break;case 4:Kg(m,b,h,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}h=b,f+=l+1}if(i===16){const p=new Uint16Array(c.buffer);if(ry)for(let _=0;_<p.length;_++)p[_]=ay(p[_]);return p}else return c}function ay(t){return(t&255)<<8|t>>8&255}const Pl=Uint8Array.of(137,80,78,71,13,10,26,10);function Zf(t){if(!sy(t.readBytes(Pl.length)))throw new Error("wrong PNG signature")}function sy(t){if(t.length<Pl.length)return!1;for(let e=0;e<Pl.length;e++)if(t[e]!==Pl[e])return!1;return!0}const oy="tEXt",ly=0,Jg=new TextDecoder("latin1");function cy(t){if(hy(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const uy=/^[\u0000-\u00FF]*$/;function hy(t){if(!uy.test(t))throw new Error("invalid latin1 text")}function dy(t,e,n){const r=Yg(e);t[r]=fy(e,n-r.length-1)}function Yg(t){for(t.mark();t.readByte()!==ly;);const e=t.offset;t.reset();const n=Jg.decode(t.readBytes(e-t.offset-1));return t.skip(1),cy(n),n}function fy(t,e){return Jg.decode(t.readBytes(e))}const kr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},hu={UNKNOWN:-1,DEFLATE:0},Qf={UNKNOWN:-1,ADAPTIVE:0},du={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Al={NONE:0,BACKGROUND:1,PREVIOUS:2},fu={SOURCE:0,OVER:1};class py extends Nh{constructor(n,r={}){super(n);zt(this,"_checkCrc");zt(this,"_inflator");zt(this,"_png");zt(this,"_apng");zt(this,"_end");zt(this,"_hasPalette");zt(this,"_palette");zt(this,"_hasTransparency");zt(this,"_transparency");zt(this,"_compressionMethod");zt(this,"_filterMethod");zt(this,"_interlaceMethod");zt(this,"_colorType");zt(this,"_isAnimated");zt(this,"_numberOfFrames");zt(this,"_numberOfPlays");zt(this,"_frames");zt(this,"_writingDataChunks");const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new Kf,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=hu.UNKNOWN,this._filterMethod=Qf.UNKNOWN,this._interlaceMethod=du.UNKNOWN,this._colorType=kr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Zf(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(Zf(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case oy:dy(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-a!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Yf(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=a+n;break}if(this.offset-a!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Yf(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=gy(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case kr.GREYSCALE:a=1;break;case kr.TRUECOLOUR:a=3;break;case kr.INDEXED_COLOUR:a=1;break;case kr.GREYSCALE_ALPHA:a=2;break;case kr.TRUECOLOUR_ALPHA:a=4;break;case kr.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==hu.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<r;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case kr.GREYSCALE:case kr.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case kr.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case kr.UNKNOWN:case kr.GREYSCALE_ALPHA:case kr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=Yg(this),a=this.readUint8();if(a!==hu.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:W5(i)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:n,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(n);if(a){if(a.data=Xf({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const i=this._apng.frames.at(n-1);this.disposeFrame(a,i,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,a){switch(n.disposeOp){case Al.NONE:break;case Al.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*n.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case Al.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const a=1<<this._png.depth,i=(o,l)=>{const c=((o+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,h=(o*r.width+l)*this._png.channels;return{index:c,frameIndex:h}};switch(r.blendOp){case fu.SOURCE:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:h}=i(o,l);for(let f=0;f<this._png.channels;f++)n.data[c+f]=r.data[h+f]}break;case fu.OVER:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:h}=i(o,l);for(let f=0;f<this._png.channels;f++){const m=r.data[h+this._png.channels-1]/a,b=f%(this._png.channels-1)===0?1:r.data[h+f],p=Math.floor(m*b+(1-m)*n.data[c+f]);n.data[c+f]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==Qf.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===du.NO_INTERLACE)this._png.data=Xf({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===du.ADAM7)this._png.data=Q5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Al.NONE,blendOp:fu.SOURCE,data:n}),this._inflator=new Kf,this._writingDataChunks=!1}}function gy(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var ep;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(ep||(ep={}));function my(t,e){return new py(t,e).decode()}var ft=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function pu(){ft.console&&typeof ft.console.log=="function"&&ft.console.log.apply(ft.console,arguments)}var Kt={log:pu,warn:function(t){ft.console&&(typeof ft.console.warn=="function"?ft.console.warn.apply(ft.console,arguments):pu.call(null,arguments))},error:function(t){ft.console&&(typeof ft.console.error=="function"?ft.console.error.apply(ft.console,arguments):pu(t))}};function gu(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Ia(r.response,e,n)},r.onerror=function(){Kt.error("could not download file")},r.send()}function tp(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function kl(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Ia=ft.saveAs||((typeof window>"u"?"undefined":Ht(window))!=="object"||window!==ft?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=ft.URL||ft.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?tp(a.href)?gu(t,e,n):kl(a,a.target="_blank"):kl(a)):(a.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){kl(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(tp(t))gu(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){kl(r)})}else navigator.msSaveOrOpenBlob((function(a,i){return i===void 0?i={autoBom:!1}:Ht(i)!=="object"&&(Kt.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a})(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return gu(t,e,n);var a=t.type==="application/octet-stream",i=/constructor/i.test(ft.HTMLElement)||ft.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":Ht(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=ft.URL||ft.webkitURL,h=c.createObjectURL(t);r?r.location=h:location.href=h,r=null,setTimeout(function(){c.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Xg(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var a=n[r].re,i=n[r].process,o=a.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),h=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),"#"+l+c+h}}var Ol=ft.atob.bind(ft),np=ft.btoa.bind(ft);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function mu(t,e){var n=t[0],r=t[1],a=t[2],i=t[3];n=Kn(n,r,a,i,e[0],7,-680876936),i=Kn(i,n,r,a,e[1],12,-389564586),a=Kn(a,i,n,r,e[2],17,606105819),r=Kn(r,a,i,n,e[3],22,-1044525330),n=Kn(n,r,a,i,e[4],7,-176418897),i=Kn(i,n,r,a,e[5],12,1200080426),a=Kn(a,i,n,r,e[6],17,-1473231341),r=Kn(r,a,i,n,e[7],22,-45705983),n=Kn(n,r,a,i,e[8],7,1770035416),i=Kn(i,n,r,a,e[9],12,-1958414417),a=Kn(a,i,n,r,e[10],17,-42063),r=Kn(r,a,i,n,e[11],22,-1990404162),n=Kn(n,r,a,i,e[12],7,1804603682),i=Kn(i,n,r,a,e[13],12,-40341101),a=Kn(a,i,n,r,e[14],17,-1502002290),n=Jn(n,r=Kn(r,a,i,n,e[15],22,1236535329),a,i,e[1],5,-165796510),i=Jn(i,n,r,a,e[6],9,-1069501632),a=Jn(a,i,n,r,e[11],14,643717713),r=Jn(r,a,i,n,e[0],20,-373897302),n=Jn(n,r,a,i,e[5],5,-701558691),i=Jn(i,n,r,a,e[10],9,38016083),a=Jn(a,i,n,r,e[15],14,-660478335),r=Jn(r,a,i,n,e[4],20,-405537848),n=Jn(n,r,a,i,e[9],5,568446438),i=Jn(i,n,r,a,e[14],9,-1019803690),a=Jn(a,i,n,r,e[3],14,-187363961),r=Jn(r,a,i,n,e[8],20,1163531501),n=Jn(n,r,a,i,e[13],5,-1444681467),i=Jn(i,n,r,a,e[2],9,-51403784),a=Jn(a,i,n,r,e[7],14,1735328473),n=Yn(n,r=Jn(r,a,i,n,e[12],20,-1926607734),a,i,e[5],4,-378558),i=Yn(i,n,r,a,e[8],11,-2022574463),a=Yn(a,i,n,r,e[11],16,1839030562),r=Yn(r,a,i,n,e[14],23,-35309556),n=Yn(n,r,a,i,e[1],4,-1530992060),i=Yn(i,n,r,a,e[4],11,1272893353),a=Yn(a,i,n,r,e[7],16,-155497632),r=Yn(r,a,i,n,e[10],23,-1094730640),n=Yn(n,r,a,i,e[13],4,681279174),i=Yn(i,n,r,a,e[0],11,-358537222),a=Yn(a,i,n,r,e[3],16,-722521979),r=Yn(r,a,i,n,e[6],23,76029189),n=Yn(n,r,a,i,e[9],4,-640364487),i=Yn(i,n,r,a,e[12],11,-421815835),a=Yn(a,i,n,r,e[15],16,530742520),n=Xn(n,r=Yn(r,a,i,n,e[2],23,-995338651),a,i,e[0],6,-198630844),i=Xn(i,n,r,a,e[7],10,1126891415),a=Xn(a,i,n,r,e[14],15,-1416354905),r=Xn(r,a,i,n,e[5],21,-57434055),n=Xn(n,r,a,i,e[12],6,1700485571),i=Xn(i,n,r,a,e[3],10,-1894986606),a=Xn(a,i,n,r,e[10],15,-1051523),r=Xn(r,a,i,n,e[1],21,-2054922799),n=Xn(n,r,a,i,e[8],6,1873313359),i=Xn(i,n,r,a,e[15],10,-30611744),a=Xn(a,i,n,r,e[6],15,-1560198380),r=Xn(r,a,i,n,e[13],21,1309151649),n=Xn(n,r,a,i,e[4],6,-145523070),i=Xn(i,n,r,a,e[11],10,-1120210379),a=Xn(a,i,n,r,e[2],15,718787259),r=Xn(r,a,i,n,e[9],21,-343485551),t[0]=ca(n,t[0]),t[1]=ca(r,t[1]),t[2]=ca(a,t[2]),t[3]=ca(i,t[3])}function sc(t,e,n,r,a,i){return e=ca(ca(e,t),ca(r,i)),ca(e<<a|e>>>32-a,n)}function Kn(t,e,n,r,a,i,o){return sc(e&n|~e&r,t,e,a,i,o)}function Jn(t,e,n,r,a,i,o){return sc(e&r|n&~r,t,e,a,i,o)}function Yn(t,e,n,r,a,i,o){return sc(e^n^r,t,e,a,i,o)}function Xn(t,e,n,r,a,i,o){return sc(n^(e|~r),t,e,a,i,o)}function Zg(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)mu(r,vy(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(mu(r,a),e=0;e<16;e++)a[e]=0;return a[14]=8*n,mu(r,a),r}function vy(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var rp="0123456789abcdef".split("");function by(t){for(var e="",n=0;n<4;n++)e+=rp[t>>8*n+4&15]+rp[t>>8*n&15];return e}function yy(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function th(t){return Zg(t).map(yy).join("")}var _y=(function(t){for(var e=0;e<t.length;e++)t[e]=by(t[e]);return t.join("")})(Zg("hello"))!="5d41402abc4b2a76b9719d911017c592";function ca(t,e){if(_y){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function nh(t,e){var n,r,a,i;if(t!==n){for(var o=(a=t,i=1+(256/t.length|0),new Array(i+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var h=0;for(c=0;c<256;c++){var f=l[c];h=(h+f+o.charCodeAt(c))%256,l[c]=l[h],l[h]=f}n=t,r=l}else l=r;var m=e.length,b=0,p=0,_="";for(c=0;c<m;c++)p=(p+(f=l[b=(b+1)%256]))%256,l[b]=l[p],l[p]=f,o=l[(l[b]+l[p])%256],_+=String.fromCharCode(e.charCodeAt(c)^o);return _}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ip={print:4,modify:8,copy:16,"annot-forms":32};function ps(t,e,n,r){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(ip.perm!==void 0)throw new Error("Invalid permission: "+l);a+=ip[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=th(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=nh(this.encryptionKey,this.padding)}function gs(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var a=t.charCodeAt(r);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[r]}return e}function ap(t){if(Ht(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,a){if(a=a||!1,typeof n!="string"||typeof r!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var i=Math.random().toString(35);return e[n][i]=[r,!!a],i},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var i in e[n]){var o=e[n][i];try{o[0].apply(t,r)}catch(l){ft.console&&Kt.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Kl(t){if(!(this instanceof Kl))return new Kl(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function Qg(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Fa(t,e,n,r,a){if(!(this instanceof Fa))return new Fa(t,e,n,r,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,Qg.call(this,r,a)}function vs(t,e,n,r,a){if(!(this instanceof vs))return new vs(t,e,n,r,a);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,Qg.call(this,r,a)}function Xe(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],a=arguments[2],i=arguments[3],o=[],l=1,c=16,h="S",f=null;Ht(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,a=t.format||a,i=t.compress||t.compressPdf||i,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),h=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,b={},p={internal:{},__private__:{}};p.__private__.PubSub=ap;var _="1.3",w=p.__private__.getPdfVersion=function(){return _};p.__private__.setPdfVersion=function(g){_=g};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return S};var x=p.__private__.getPageFormat=function(g){return S[g]};a=a||"a4";var T="compat",R="advanced",E=T;function U(){this.saveGraphicsState(),q(new rt(mt,0,0,-mt,0,va()*mt).toString()+" cm"),this.setFontSize(this.getFontSize()/mt),h="n",E=R}function Z(){this.restoreGraphicsState(),h="S",E=T}var O=p.__private__.combineFontStyleAndFontWeight=function(g,k){if(g=="bold"&&k=="normal"||g=="bold"&&k==400||g=="normal"&&k=="italic"||g=="bold"&&k=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return k&&(g=k==400||k==="normal"?g==="italic"?"italic":"normal":k!=700&&k!=="bold"||g!=="normal"?(k==700?"bold":k)+""+g:"bold"),g};p.advancedAPI=function(g){var k=E===T;return k&&U.call(this),typeof g!="function"||(g(this),k&&Z.call(this)),this},p.compatAPI=function(g){var k=E===R;return k&&Z.call(this),typeof g!="function"||(g(this),k&&U.call(this)),this},p.isAdvancedAPI=function(){return E===R};var J,F=function(g){if(E!==R)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=p.roundToPrecision=p.__private__.roundToPrecision=function(g,k){var G=e||k;if(isNaN(g)||isNaN(G))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(G).replace(/0+$/,"")};J=p.hpf=p.__private__.hpf=typeof c=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return C(g,c)}:c==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return C(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return C(g,16)};var A=p.f2=p.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return C(g,2)},D=p.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return C(g,3)},j=p.scale=p.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return E===T?g*mt:E===R?g:void 0},$=function(g){return j((function(k){return E===T?va()-k:E===R?k:void 0})(g))};p.__private__.setPrecision=p.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(e=parseInt(g,10))};var V,oe="00000000000000000000000000000000",le=p.__private__.getFileId=function(){return oe},ae=p.__private__.setFileId=function(g){return oe=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():oe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Tn=new ps(f.userPermissions,f.userPassword,f.ownerPassword,oe)),oe};p.setFileId=function(g){return ae(g),this},p.getFileId=function(){return le()};var de=p.__private__.convertDateToPDFDate=function(g){var k=g.getTimezoneOffset(),G=k<0?"+":"-",X=Math.floor(Math.abs(k/60)),ie=Math.abs(k%60),ye=[G,K(X),"'",K(ie),"'"].join("");return["D:",g.getFullYear(),K(g.getMonth()+1),K(g.getDate()),K(g.getHours()),K(g.getMinutes()),K(g.getSeconds()),ye].join("")},Le=p.__private__.convertPDFDateToDate=function(g){var k=parseInt(g.substr(2,4),10),G=parseInt(g.substr(6,2),10)-1,X=parseInt(g.substr(8,2),10),ie=parseInt(g.substr(10,2),10),ye=parseInt(g.substr(12,2),10),xe=parseInt(g.substr(14,2),10);return new Date(k,G,X,ie,ye,xe,0)},pe=p.__private__.setCreationDate=function(g){var k;if(g===void 0&&(g=new Date),g instanceof Date)k=de(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");k=g}return V=k},I=p.__private__.getCreationDate=function(g){var k=V;return g==="jsDate"&&(k=Le(V)),k};p.setCreationDate=function(g){return pe(g),this},p.getCreationDate=function(g){return I(g)};var z,K=p.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},Y=p.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},Q=0,re=[],he=[],fe=0,me=[],Ae=[],Oe=!1,Te=he;p.__private__.setCustomOutputDestination=function(g){Oe=!0,Te=g};var Me=function(g){Oe||(Te=g)};p.__private__.resetCustomOutputDestination=function(){Oe=!1,Te=he};var q=p.__private__.out=function(g){return g=g.toString(),fe+=g.length+1,Te.push(g),Te},Ce=p.__private__.write=function(g){return q(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},dt=p.__private__.getArrayBuffer=function(g){for(var k=g.length,G=new ArrayBuffer(k),X=new Uint8Array(G);k--;)X[k]=g.charCodeAt(k);return G},ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return ze};var we=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(g){return we=E===R?g/mt:g,this};var Ke,Re=p.__private__.getFontSize=p.getFontSize=function(){return E===T?we:we*mt},Qe=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(g){return Qe=g,this},p.__private__.getR2L=p.getR2L=function(){return Qe};var Ie,it=p.__private__.setZoomMode=function(g){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))Ke=g;else if(isNaN(g)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');Ke=g}else Ke=parseInt(g,10)};p.__private__.getZoomMode=function(){return Ke};var nt,at=p.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');Ie=g};p.__private__.getPageMode=function(){return Ie};var ut=p.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');nt=g};p.__private__.getLayoutMode=function(){return nt},p.__private__.setDisplayMode=p.setDisplayMode=function(g,k,G){return it(g),ut(k),at(G),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(g){if(Object.keys(pt).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[g]},p.__private__.getDocumentProperties=function(){return pt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(g){for(var k in pt)pt.hasOwnProperty(k)&&g[k]&&(pt[k]=g[k]);return this},p.__private__.setDocumentProperty=function(g,k){if(Object.keys(pt).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[g]=k};var $e,mt,He,rn,Et,bt={},ct={},Dt=[],et={},Bt={},st={},ht={},Ut=null,kt=0,tt=[],Ft=new ap(p),_i=t.hotfixes||[],Ct={},Gn={},Tr=[],rt=function g(k,G,X,ie,ye,xe){if(!(this instanceof g))return new g(k,G,X,ie,ye,xe);isNaN(k)&&(k=1),isNaN(G)&&(G=0),isNaN(X)&&(X=0),isNaN(ie)&&(ie=1),isNaN(ye)&&(ye=0),isNaN(xe)&&(xe=0),this._matrix=[k,G,X,ie,ye,xe]};Object.defineProperty(rt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(rt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(rt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(rt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(rt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(rt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(rt.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(rt.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(rt.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(rt.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(rt.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(rt.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(rt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(rt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(rt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(rt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),rt.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(J).join(g)},rt.prototype.multiply=function(g){var k=g.sx*this.sx+g.shy*this.shx,G=g.sx*this.shy+g.shy*this.sy,X=g.shx*this.sx+g.sy*this.shx,ie=g.shx*this.shy+g.sy*this.sy,ye=g.tx*this.sx+g.ty*this.shx+this.tx,xe=g.tx*this.shy+g.ty*this.sy+this.ty;return new rt(k,G,X,ie,ye,xe)},rt.prototype.decompose=function(){var g=this.sx,k=this.shy,G=this.shx,X=this.sy,ie=this.tx,ye=this.ty,xe=Math.sqrt(g*g+k*k),qe=(g/=xe)*G+(k/=xe)*X;G-=g*qe,X-=k*qe;var Je=Math.sqrt(G*G+X*X);return qe/=Je,g*(X/=Je)<k*(G/=Je)&&(g=-g,k=-k,qe=-qe,xe=-xe),{scale:new rt(xe,0,0,Je,0,0),translate:new rt(1,0,0,1,ie,ye),rotate:new rt(g,k,-k,g,0,0),skew:new rt(1,0,qe,1,0,0)}},rt.prototype.toString=function(g){return this.join(" ")},rt.prototype.inversed=function(){var g=this.sx,k=this.shy,G=this.shx,X=this.sy,ie=this.tx,ye=this.ty,xe=1/(g*X-k*G),qe=X*xe,Je=-k*xe,gt=-G*xe,wt=g*xe;return new rt(qe,Je,gt,wt,-qe*ie-gt*ye,-Je*ie-wt*ye)},rt.prototype.applyToPoint=function(g){var k=g.x*this.sx+g.y*this.shx+this.tx,G=g.x*this.shy+g.y*this.sy+this.ty;return new ki(k,G)},rt.prototype.applyToRectangle=function(g){var k=this.applyToPoint(g),G=this.applyToPoint(new ki(g.x+g.w,g.y+g.h));return new Os(k.x,k.y,G.x-k.x,G.y-k.y)},rt.prototype.clone=function(){var g=this.sx,k=this.shy,G=this.shx,X=this.sy,ie=this.tx,ye=this.ty;return new rt(g,k,G,X,ie,ye)},p.Matrix=rt;var mr=p.matrixMult=function(g,k){return k.multiply(g)},Ir=new rt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Ir;var Qn=function(g,k){if(!Bt[g]){var G=(k instanceof Fa?"Sh":"P")+(Object.keys(et).length+1).toString(10);k.id=G,Bt[g]=G,et[G]=k,Ft.publish("addPattern",k)}};p.ShadingPattern=Fa,p.TilingPattern=vs,p.addShadingPattern=function(g,k){return F("addShadingPattern()"),Qn(g,k),this},p.beginTilingPattern=function(g){F("beginTilingPattern()"),Rs(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},p.endTilingPattern=function(g,k){F("endTilingPattern()"),k.stream=Ae[z].join(`
`),Qn(g,k),Ft.publish("endTilingPattern",k),Tr.pop().restore()};var cr,Pt=p.__private__.newObject=function(){var g=Yt();return xn(g,!0),g},Yt=p.__private__.newObjectDeferred=function(){return Q++,re[Q]=function(){return fe},Q},xn=function(g,k){return k=typeof k=="boolean"&&k,re[g]=fe,k&&q(g+" 0 obj"),g},ai=p.__private__.newAdditionalObject=function(){var g={objId:Yt(),content:""};return me.push(g),g},Pr=Yt(),ur=Yt(),Sn=p.__private__.decodeColorString=function(g){var k=g.split(" ");if(k.length!==2||k[1]!=="g"&&k[1]!=="G")k.length!==5||k[4]!=="k"&&k[4]!=="K"||(k=[(1-k[0])*(1-k[3]),(1-k[1])*(1-k[3]),(1-k[2])*(1-k[3]),"r"]);else{var G=parseFloat(k[0]);k=[G,G,G,"r"]}for(var X="#",ie=0;ie<3;ie++)X+=("0"+Math.floor(255*parseFloat(k[ie])).toString(16)).slice(-2);return X},hr=p.__private__.encodeColorString=function(g){var k;typeof g=="string"&&(g={ch1:g});var G=g.ch1,X=g.ch2,ie=g.ch3,ye=g.ch4,xe=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof G=="string"&&G.charAt(0)!=="#"){var qe=new Xg(G);if(qe.ok)G=qe.toHex();else if(!/^\d*\.?\d*$/.test(G))throw new Error('Invalid color "'+G+'" passed to jsPDF.encodeColorString.')}if(typeof G=="string"&&/^#[0-9A-Fa-f]{3}$/.test(G)&&(G="#"+G[1]+G[1]+G[2]+G[2]+G[3]+G[3]),typeof G=="string"&&/^#[0-9A-Fa-f]{6}$/.test(G)){var Je=parseInt(G.substr(1),16);G=Je>>16&255,X=Je>>8&255,ie=255&Je}if(X===void 0||ye===void 0&&G===X&&X===ie)k=typeof G=="string"?G+" "+xe[0]:g.precision===2?A(G/255)+" "+xe[0]:D(G/255)+" "+xe[0];else if(ye===void 0||Ht(ye)==="object"){if(ye&&!isNaN(ye.a)&&ye.a===0)return["1.","1.","1.",xe[1]].join(" ");k=typeof G=="string"?[G,X,ie,xe[1]].join(" "):g.precision===2?[A(G/255),A(X/255),A(ie/255),xe[1]].join(" "):[D(G/255),D(X/255),D(ie/255),xe[1]].join(" ")}else k=typeof G=="string"?[G,X,ie,ye,xe[2]].join(" "):g.precision===2?[A(G),A(X),A(ie),A(ye),xe[2]].join(" "):[D(G),D(X),D(ie),D(ye),xe[2]].join(" ");return k},dr=p.__private__.getFilters=function(){return o},er=p.__private__.putStream=function(g){var k=(g=g||{}).data||"",G=g.filters||dr(),X=g.alreadyAppliedFilters||[],ie=g.addLength1||!1,ye=k.length,xe=g.objectId,qe=function(In){return In};if(f!==null&&xe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(qe=Tn.encryptor(xe,0));var Je={};G===!0&&(G=["FlateEncode"]);var gt=g.additionalKeyValues||[],wt=(Je=Xe.API.processDataByFilters!==void 0?Xe.API.processDataByFilters(k,G):{data:k,reverseChain:[]}).reverseChain+(Array.isArray(X)?X.join(" "):X.toString());if(Je.data.length!==0&&(gt.push({key:"Length",value:Je.data.length}),ie===!0&&gt.push({key:"Length1",value:ye})),wt.length!=0)if(wt.split("/").length-1==1)gt.push({key:"Filter",value:wt});else{gt.push({key:"Filter",value:"["+wt+"]"});for(var Ot=0;Ot<gt.length;Ot+=1)if(gt[Ot].key==="DecodeParms"){for(var on=[],kn=0;kn<Je.reverseChain.split("/").length-1;kn+=1)on.push("null");on.push(gt[Ot].value),gt[Ot].value="["+on.join(" ")+"]"}}q("<<");for(var Xt=0;Xt<gt.length;Xt++)q("/"+gt[Xt].key+" "+gt[Xt].value);q(">>"),Je.data.length!==0&&(q("stream"),q(qe(Je.data)),q("endstream"))},si=p.__private__.putPage=function(g){var k=g.number,G=g.data,X=g.objId,ie=g.contentsObjId;xn(X,!0),q("<</Type /Page"),q("/Parent "+g.rootDictionaryObjId+" 0 R"),q("/Resources "+g.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(J(g.mediaBox.bottomLeftX))+" "+parseFloat(J(g.mediaBox.bottomLeftY))+" "+J(g.mediaBox.topRightX)+" "+J(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&q("/CropBox ["+J(g.cropBox.bottomLeftX)+" "+J(g.cropBox.bottomLeftY)+" "+J(g.cropBox.topRightX)+" "+J(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&q("/BleedBox ["+J(g.bleedBox.bottomLeftX)+" "+J(g.bleedBox.bottomLeftY)+" "+J(g.bleedBox.topRightX)+" "+J(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&q("/TrimBox ["+J(g.trimBox.bottomLeftX)+" "+J(g.trimBox.bottomLeftY)+" "+J(g.trimBox.topRightX)+" "+J(g.trimBox.topRightY)+"]"),g.artBox!==null&&q("/ArtBox ["+J(g.artBox.bottomLeftX)+" "+J(g.artBox.bottomLeftY)+" "+J(g.artBox.topRightX)+" "+J(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&q("/UserUnit "+g.userUnit),Ft.publish("putPage",{objId:X,pageContext:tt[k],pageNumber:k,page:G}),q("/Contents "+ie+" 0 R"),q(">>"),q("endobj");var ye=G.join(`
`);return E===R&&(ye+=`
Q`),xn(ie,!0),er({data:ye,filters:dr(),objectId:ie}),q("endobj"),X},Or=p.__private__.putPages=function(){var g,k,G=[];for(g=1;g<=kt;g++)tt[g].objId=Yt(),tt[g].contentsObjId=Yt();for(g=1;g<=kt;g++)G.push(si({number:g,data:Ae[g],objId:tt[g].objId,contentsObjId:tt[g].contentsObjId,mediaBox:tt[g].mediaBox,cropBox:tt[g].cropBox,bleedBox:tt[g].bleedBox,trimBox:tt[g].trimBox,artBox:tt[g].artBox,userUnit:tt[g].userUnit,rootDictionaryObjId:Pr,resourceDictionaryObjId:ur}));xn(Pr,!0),q("<</Type /Pages");var X="/Kids [";for(k=0;k<kt;k++)X+=G[k]+" 0 R ";q(X+"]"),q("/Count "+kt),q(">>"),q("endobj"),Ft.publish("postPutPages")},Ue=function(g){Ft.publish("putFont",{font:g,out:q,newObject:Pt,putStream:er}),g.isAlreadyPutted!==!0&&(g.objectNumber=Pt(),q("<<"),q("/Type /Font"),q("/BaseFont /"+gs(g.postScriptName)),q("/Subtype /Type1"),typeof g.encoding=="string"&&q("/Encoding /"+g.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},ee=function(g){g.objectNumber=Pt();var k=[];k.push({key:"Type",value:"/XObject"}),k.push({key:"Subtype",value:"/Form"}),k.push({key:"BBox",value:"["+[J(g.x),J(g.y),J(g.x+g.width),J(g.y+g.height)].join(" ")+"]"}),k.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var G=g.pages[1].join(`
`);er({data:G,additionalKeyValues:k,objectId:g.objectNumber}),q("endobj")},Ne=function(g,k){k||(k=21);var G=Pt(),X=(function(xe,qe){var Je,gt=[],wt=1/(qe-1);for(Je=0;Je<1;Je+=wt)gt.push(Je);if(gt.push(1),xe[0].offset!=0){var Ot={offset:0,color:xe[0].color};xe.unshift(Ot)}if(xe[xe.length-1].offset!=1){var on={offset:1,color:xe[xe.length-1].color};xe.push(on)}for(var kn="",Xt=0,In=0;In<gt.length;In++){for(Je=gt[In];Je>xe[Xt+1].offset;)Xt++;var Nn=xe[Xt].offset,Mn=(Je-Nn)/(xe[Xt+1].offset-Nn),Li=xe[Xt].color,Hr=xe[Xt+1].color;kn+=Y(Math.round((1-Mn)*Li[0]+Mn*Hr[0]).toString(16))+Y(Math.round((1-Mn)*Li[1]+Mn*Hr[1]).toString(16))+Y(Math.round((1-Mn)*Li[2]+Mn*Hr[2]).toString(16))}return kn.trim()})(g.colors,k),ie=[];ie.push({key:"FunctionType",value:"0"}),ie.push({key:"Domain",value:"[0.0 1.0]"}),ie.push({key:"Size",value:"["+k+"]"}),ie.push({key:"BitsPerSample",value:"8"}),ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),er({data:X,additionalKeyValues:ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:G}),q("endobj"),g.objectNumber=Pt(),q("<< /ShadingType "+g.type),q("/ColorSpace /DeviceRGB");var ye="/Coords ["+J(parseFloat(g.coords[0]))+" "+J(parseFloat(g.coords[1]))+" ";g.type===2?ye+=J(parseFloat(g.coords[2]))+" "+J(parseFloat(g.coords[3])):ye+=J(parseFloat(g.coords[2]))+" "+J(parseFloat(g.coords[3]))+" "+J(parseFloat(g.coords[4]))+" "+J(parseFloat(g.coords[5])),q(ye+="]"),g.matrix&&q("/Matrix ["+g.matrix.toString()+"]"),q("/Function "+G+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},Fe=function(g,k){var G=Yt(),X=Pt();k.push({resourcesOid:G,objectOid:X}),g.objectNumber=X;var ie=[];ie.push({key:"Type",value:"/Pattern"}),ie.push({key:"PatternType",value:"1"}),ie.push({key:"PaintType",value:"1"}),ie.push({key:"TilingType",value:"1"}),ie.push({key:"BBox",value:"["+g.boundingBox.map(J).join(" ")+"]"}),ie.push({key:"XStep",value:J(g.xStep)}),ie.push({key:"YStep",value:J(g.yStep)}),ie.push({key:"Resources",value:G+" 0 R"}),g.matrix&&ie.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),er({data:g.stream,additionalKeyValues:ie,objectId:g.objectNumber}),q("endobj")},Wt=function(g){for(var k in g.objectNumber=Pt(),q("<<"),g)switch(k){case"opacity":q("/ca "+A(g[k]));break;case"stroke-opacity":q("/CA "+A(g[k]))}q(">>"),q("endobj")},cn=function(g){xn(g.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var k in q("/Font <<"),bt)bt.hasOwnProperty(k)&&(m===!1||m===!0&&b.hasOwnProperty(k))&&q("/"+k+" "+bt[k].objectNumber+" 0 R");q(">>")})(),(function(){if(Object.keys(et).length>0){for(var k in q("/Shading <<"),et)et.hasOwnProperty(k)&&et[k]instanceof Fa&&et[k].objectNumber>=0&&q("/"+k+" "+et[k].objectNumber+" 0 R");Ft.publish("putShadingPatternDict"),q(">>")}})(),(function(k){if(Object.keys(et).length>0){for(var G in q("/Pattern <<"),et)et.hasOwnProperty(G)&&et[G]instanceof p.TilingPattern&&et[G].objectNumber>=0&&et[G].objectNumber<k&&q("/"+G+" "+et[G].objectNumber+" 0 R");Ft.publish("putTilingPatternDict"),q(">>")}})(g.objectOid),(function(){if(Object.keys(st).length>0){var k;for(k in q("/ExtGState <<"),st)st.hasOwnProperty(k)&&st[k].objectNumber>=0&&q("/"+k+" "+st[k].objectNumber+" 0 R");Ft.publish("putGStateDict"),q(">>")}})(),(function(){for(var k in q("/XObject <<"),Ct)Ct.hasOwnProperty(k)&&Ct[k].objectNumber>=0&&q("/"+k+" "+Ct[k].objectNumber+" 0 R");Ft.publish("putXobjectDict"),q(">>")})(),q(">>"),q("endobj")},en=function(g){ct[g.fontName]=ct[g.fontName]||{},ct[g.fontName][g.fontStyle]=g.id},Cn=function(g,k,G,X,ie){var ye={id:"F"+(Object.keys(bt).length+1).toString(10),postScriptName:g,fontName:k,fontStyle:G,encoding:X,isStandardFont:ie||!1,metadata:{}};return Ft.publish("addFont",{font:ye,instance:this}),bt[ye.id]=ye,en(ye),ye.id},un=p.__private__.pdfEscape=p.pdfEscape=function(g,k){return(function(G,X){var ie,ye,xe,qe,Je,gt,wt,Ot,on;if(xe=(X=X||{}).sourceEncoding||"Unicode",Je=X.outputEncoding,(X.autoencode||Je)&&bt[$e].metadata&&bt[$e].metadata[xe]&&bt[$e].metadata[xe].encoding&&(qe=bt[$e].metadata[xe].encoding,!Je&&bt[$e].encoding&&(Je=bt[$e].encoding),!Je&&qe.codePages&&(Je=qe.codePages[0]),typeof Je=="string"&&(Je=qe[Je]),Je)){for(wt=!1,gt=[],ie=0,ye=G.length;ie<ye;ie++)(Ot=Je[G.charCodeAt(ie)])?gt.push(String.fromCharCode(Ot)):gt.push(G[ie]),gt[ie].charCodeAt(0)>>8&&(wt=!0);G=gt.join("")}for(ie=G.length;wt===void 0&&ie!==0;)G.charCodeAt(ie-1)>>8&&(wt=!0),ie--;if(!wt)return G;for(gt=X.noBOM?[]:[254,255],ie=0,ye=G.length;ie<ye;ie++){if((on=(Ot=G.charCodeAt(ie))>>8)>>8)throw new Error("Character at position "+ie+" of string '"+G+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");gt.push(on),gt.push(Ot-(on<<8))}return String.fromCharCode.apply(void 0,gt)})(g,k).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rr=p.__private__.beginPage=function(g){Ae[++kt]=[],tt[kt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},ha(kt),Me(Ae[z])},qi=function(g,k){var G,X,ie;switch(n=k||n,typeof g=="string"&&(G=x(g.toLowerCase()),Array.isArray(G)&&(X=G[0],ie=G[1])),Array.isArray(g)&&(X=g[0]*mt,ie=g[1]*mt),isNaN(X)&&(X=a[0],ie=a[1]),(X>14400||ie>14400)&&(Kt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),X=Math.min(14400,X),ie=Math.min(14400,ie)),a=[X,ie],n.substr(0,1)){case"l":ie>X&&(a=[ie,X]);break;case"p":X>ie&&(a=[ie,X])}Rr(a),vt(Cs),q(Ja),Is!==0&&q(Is+" J"),Ps!==0&&q(Ps+" j"),Ft.publish("addPage",{pageNumber:kt})},sn=function(g){g>0&&g<=kt&&(Ae.splice(g,1),tt.splice(g,1),kt--,z>kt&&(z=kt),this.setPage(z))},ha=function(g){g>0&&g<=kt&&(z=g)},da=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ae.length-1},Io=function(g,k,G){var X,ie=void 0;return G=G||{},g=g!==void 0?g:bt[$e].fontName,k=k!==void 0?k:bt[$e].fontStyle,X=g.toLowerCase(),ct[X]!==void 0&&ct[X][k]!==void 0?ie=ct[X][k]:ct[g]!==void 0&&ct[g][k]!==void 0?ie=ct[g][k]:G.disableWarning===!1&&Kt.warn("Unable to look up font label for font '"+g+"', '"+k+"'. Refer to getFontList() for available fonts."),ie||G.noFallback||(ie=ct.times[k])==null&&(ie=ct.times.normal),ie},oi=p.__private__.putInfo=function(){var g=Pt(),k=function(X){return X};for(var G in f!==null&&(k=Tn.encryptor(g,0)),q("<<"),q("/Producer ("+un(k("jsPDF "+Xe.version))+")"),pt)pt.hasOwnProperty(G)&&pt[G]&&q("/"+G.substr(0,1).toUpperCase()+G.substr(1)+" ("+un(k(pt[G]))+")");q("/CreationDate ("+un(k(V))+")"),q(">>"),q("endobj")},Ga=p.__private__.putCatalog=function(g){var k=(g=g||{}).rootDictionaryObjId||Pr;switch(Pt(),q("<<"),q("/Type /Catalog"),q("/Pages "+k+" 0 R"),Ke||(Ke="fullwidth"),Ke){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var G=""+Ke;G.substr(G.length-1)==="%"&&(Ke=parseInt(Ke)/100),typeof Ke=="number"&&q("/OpenAction [3 0 R /XYZ null null "+A(Ke)+"]")}switch(nt||(nt="continuous"),nt){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}Ie&&q("/PageMode /"+Ie),Ft.publish("putCatalog"),q(">>"),q("endobj")},oc=p.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(Q+1)),q("/Root "+Q+" 0 R"),q("/Info "+(Q-1)+" 0 R"),f!==null&&q("/Encrypt "+Tn.oid+" 0 R"),q("/ID [ <"+oe+"> <"+oe+"> ]"),q(">>")},An=p.__private__.putHeader=function(){q("%PDF-"+_),q("%")},Po=p.__private__.putXRef=function(){var g="0000000000";q("xref"),q("0 "+(Q+1)),q("0000000000 65535 f ");for(var k=1;k<=Q;k++)typeof re[k]=="function"?q((g+re[k]()).slice(-10)+" 00000 n "):re[k]!==void 0?q((g+re[k]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},li=p.__private__.buildDocument=function(){var g;Q=0,fe=0,he=[],re=[],me=[],Pr=Yt(),ur=Yt(),Me(he),Ft.publish("buildDocument"),An(),Or(),(function(){Ft.publish("putAdditionalObjects");for(var G=0;G<me.length;G++){var X=me[G];xn(X.objId,!0),q(X.content),q("endobj")}Ft.publish("postPutAdditionalObjects")})(),g=[],(function(){for(var G in bt)bt.hasOwnProperty(G)&&(m===!1||m===!0&&b.hasOwnProperty(G))&&Ue(bt[G])})(),(function(){var G;for(G in st)st.hasOwnProperty(G)&&Wt(st[G])})(),(function(){for(var G in Ct)Ct.hasOwnProperty(G)&&ee(Ct[G])})(),(function(G){var X;for(X in et)et.hasOwnProperty(X)&&(et[X]instanceof Fa?Ne(et[X]):et[X]instanceof vs&&Fe(et[X],G))})(g),Ft.publish("putResources"),g.forEach(cn),cn({resourcesOid:ur,objectOid:Number.MAX_SAFE_INTEGER}),Ft.publish("postPutResources"),f!==null&&(Tn.oid=Pt(),q("<<"),q("/Filter /Standard"),q("/V "+Tn.v),q("/R "+Tn.r),q("/U <"+Tn.toHexString(Tn.U)+">"),q("/O <"+Tn.toHexString(Tn.O)+">"),q("/P "+Tn.P),q(">>"),q("endobj")),oi(),Ga();var k=fe;return Po(),oc(),q("startxref"),q(""+k),q("%%EOF"),Me(Ae[z]),he.join(`
`)},Va=p.__private__.getBlob=function(g){return new Blob([dt(g)],{type:"application/pdf"})},Oo=p.output=p.__private__.output=(cr=function(g,k){switch(typeof(k=k||{})=="string"?k={filename:k}:k.filename=k.filename||"generated.pdf",g){case void 0:return li();case"save":p.save(k.filename);break;case"arraybuffer":return dt(li());case"blob":return Va(li());case"bloburi":case"bloburl":if(ft.URL!==void 0&&typeof ft.URL.createObjectURL=="function")return ft.URL&&ft.URL.createObjectURL(Va(li()))||void 0;Kt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var G="",X=li();try{G=np(X)}catch{G=np(unescape(encodeURIComponent(X)))}return"data:application/pdf;filename="+k.filename+";base64,"+G;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ft)==="[object Window]"){var ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ye=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';k.pdfObjectUrl&&(ie=k.pdfObjectUrl,ye="");var xe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ie+'"'+ye+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(k)+");<\/script></body></html>",qe=ft.open();return qe!==null&&qe.document.write(xe),qe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ft)==="[object Window]"){var Je='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(k.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+k.filename+'" width="500px" height="400px" /></body></html>',gt=ft.open();if(gt!==null){gt.document.write(Je);var wt=this;gt.document.documentElement.querySelector("#pdfViewer").onload=function(){gt.document.title=k.filename,gt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(wt.output("bloburl"))}}return gt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ft)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",k)+'"></iframe></body></html>',on=ft.open();if(on!==null&&(on.document.write(Ot),on.document.title=k.filename),on||typeof safari>"u")return on;break;case"datauri":case"dataurl":return ft.document.location.href=this.output("datauristring",k);default:return null}},cr.foo=function(){try{return cr.apply(this,arguments)}catch(G){var g=G.stack||"";~g.indexOf(" at ")&&(g=g.split(" at ")[1]);var k="Error in function "+g.split(`
`)[0].split("<")[0]+": "+G.message;if(!ft.console)throw new Error(k);ft.console.error(k,G),ft.alert&&alert(k)}},cr.foo.bar=cr,cr.foo),Fr=function(g){return Array.isArray(_i)===!0&&_i.indexOf(g)>-1};switch(r){case"pt":mt=1;break;case"mm":mt=72/25.4;break;case"cm":mt=72/2.54;break;case"in":mt=72;break;case"px":mt=Fr("px_scaling")==1?.75:96/72;break;case"pc":case"em":mt=12;break;case"ex":mt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);mt=r}var Tn=null;pe(),ae();var wi=p.__private__.getPageInfo=p.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:tt[g].objId,pageNumber:g,pageContext:tt[g]}},Ro=p.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var k in tt)if(tt[k].objId===g)break;return wi(k)},lc=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:tt[z].objId,pageNumber:z,pageContext:tt[z]}};p.addPage=function(){return qi.apply(this,arguments),this},p.setPage=function(){return ha.apply(this,arguments),Me.call(this,Ae[z]),this},p.insertPage=function(g){return this.addPage(),this.movePage(z,g),this},p.movePage=function(g,k){var G,X;if(g>k){G=Ae[g],X=tt[g];for(var ie=g;ie>k;ie--)Ae[ie]=Ae[ie-1],tt[ie]=tt[ie-1];Ae[k]=G,tt[k]=X,this.setPage(k)}else if(g<k){G=Ae[g],X=tt[g];for(var ye=g;ye<k;ye++)Ae[ye]=Ae[ye+1],tt[ye]=tt[ye+1];Ae[k]=G,tt[k]=X,this.setPage(k)}return this},p.deletePage=function(){return sn.apply(this,arguments),this},p.__private__.text=p.text=function(g,k,G,X,ie){var ye,xe,qe,Je,gt,wt,Ot,on,kn,Xt=(X=X||{}).scope||this;if(typeof g=="number"&&typeof k=="number"&&(typeof G=="string"||Array.isArray(G))){var In=G;G=k,k=g,g=In}if(arguments[3]instanceof rt==0?(qe=arguments[4],Je=arguments[5],Ht(Ot=arguments[3])==="object"&&Ot!==null||(typeof qe=="string"&&(Je=qe,qe=null),typeof Ot=="string"&&(Je=Ot,Ot=null),typeof Ot=="number"&&(qe=Ot,Ot=null),X={flags:Ot,angle:qe,align:Je})):(F("The transform parameter of text() with a Matrix value"),kn=ie),isNaN(k)||isNaN(G)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return Xt;var Nn,Mn="",Li=typeof X.lineHeightFactor=="number"?X.lineHeightFactor:pa,Hr=Xt.internal.scaleFactor;function Ci(Mt){return Mt=Mt.split("	").join(Array(X.TabLen||9).join(" ")),un(Mt,Ot)}function Ds(Mt){for(var Gt,mn=Mt.concat(),Pn=[],Pi=mn.length;Pi--;)typeof(Gt=mn.shift())=="string"?Pn.push(Gt):Array.isArray(Mt)&&(Gt.length===1||Gt[1]===void 0&&Gt[2]===void 0)?Pn.push(Gt[0]):Pn.push([Gt[0],Gt[1],Gt[2]]);return Pn}function Xa(Mt,Gt){var mn;if(typeof Mt=="string")mn=Gt(Mt)[0];else if(Array.isArray(Mt)){for(var Pn,Pi,Gs=Mt.concat(),es=[],Wo=Gs.length;Wo--;)typeof(Pn=Gs.shift())=="string"?es.push(Gt(Pn)[0]):Array.isArray(Pn)&&typeof Pn[0]=="string"&&(Pi=Gt(Pn[0],Pn[1],Pn[2]),es.push([Pi[0],Pi[1],Pi[2]]));mn=es}return mn}var $i=!1,ba=!0;if(typeof g=="string")$i=!0;else if(Array.isArray(g)){var ya=g.concat();xe=[];for(var zi,Un=ya.length;Un--;)(typeof(zi=ya.shift())!="string"||Array.isArray(zi)&&typeof zi[0]!="string")&&(ba=!1);$i=ba}if($i===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var _a=we/Xt.internal.scaleFactor,wa=_a*(Li-1);switch(X.baseline){case"bottom":G-=wa;break;case"top":G+=_a-wa;break;case"hanging":G+=_a-2*wa;break;case"middle":G+=_a/2-wa}if((wt=X.maxWidth||0)>0&&(typeof g=="string"?g=Xt.splitTextToSize(g,wt):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(Mt,Gt){return Mt.concat(Xt.splitTextToSize(Gt,wt))},[]))),ye={text:g,x:k,y:G,options:X,mutex:{pdfEscape:un,activeFontKey:$e,fonts:bt,activeFontSize:we}},Ft.publish("preProcessText",ye),g=ye.text,qe=(X=ye.options).angle,kn instanceof rt==0&&qe&&typeof qe=="number"){qe*=Math.PI/180,X.rotationDirection===0&&(qe=-qe),E===R&&(qe=-qe);var js=Math.cos(qe),Bs=Math.sin(qe);kn=new rt(js,Bs,-Bs,js,0,0)}else qe&&qe instanceof rt&&(kn=qe);E!==R||kn||(kn=Ir),(gt=X.charSpace||Ai)!==void 0&&(Mn+=J(j(gt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(on=X.horizontalScale)!==void 0&&(Mn+=J(100*on)+` Tz
`),X.lang;var tr=-1,Ti=X.renderingMode!==void 0?X.renderingMode:X.stroke,Za=Xt.internal.getCurrentPageInfo().pageContext;switch(Ti){case 0:case!1:case"fill":tr=0;break;case 1:case!0:case"stroke":tr=1;break;case 2:case"fillThenStroke":tr=2;break;case 3:case"invisible":tr=3;break;case 4:case"fillAndAddForClipping":tr=4;break;case 5:case"strokeAndAddPathForClipping":tr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":tr=6;break;case 7:case"addToPathForClipping":tr=7}var zo=Za.usedRenderingMode!==void 0?Za.usedRenderingMode:-1;tr!==-1?Mn+=tr+` Tr
`:zo!==-1&&(Mn+=`0 Tr
`),tr!==-1&&(Za.usedRenderingMode=tr),Je=X.align||"left";var Dr,xa=we*Li,Ms=Xt.internal.pageSize.getWidth(),Us=bt[$e];gt=X.charSpace||Ai,wt=X.maxWidth||0,Ot=Object.assign({autoencode:!0,noBOM:!0},X.flags);var Hi=[],Sa=function(Mt){return Xt.getStringUnitWidth(Mt,{font:Us,charSpace:gt,fontSize:we,doKerning:!1})*we/Hr};if(Object.prototype.toString.call(g)==="[object Array]"){var vr;xe=Ds(g),Je!=="left"&&(Dr=xe.map(Sa));var br,Wi=0;if(Je==="right"){k-=Dr[0],g=[],Un=xe.length;for(var Ii=0;Ii<Un;Ii++)Ii===0?(br=xi(k),vr=Si(G)):(br=j(Wi-Dr[Ii]),vr=-xa),g.push([xe[Ii],br,vr]),Wi=Dr[Ii]}else if(Je==="center"){k-=Dr[0]/2,g=[],Un=xe.length;for(var Gi=0;Gi<Un;Gi++)Gi===0?(br=xi(k),vr=Si(G)):(br=j((Wi-Dr[Gi])/2),vr=-xa),g.push([xe[Gi],br,vr]),Wi=Dr[Gi]}else if(Je==="left"){g=[],Un=xe.length;for(var qs=0;qs<Un;qs++)g.push(xe[qs])}else if(Je==="justify"&&Us.encoding==="Identity-H"){g=[],Un=xe.length,wt=wt!==0?wt:Ms;for(var Qa=0,gn=0;gn<Un;gn++)if(vr=gn===0?Si(G):-xa,br=gn===0?xi(k):Qa,gn<Un-1){var Ho=j((wt-Dr[gn])/(xe[gn].split(" ").length-1)),ui=xe[gn].split(" ");g.push([ui[0]+" ",br,vr]),Qa=0;for(var hi=1;hi<ui.length;hi++){var $s=(Sa(ui[hi-1]+" "+ui[hi])-Sa(ui[hi]))*Hr+Ho;hi==ui.length-1?g.push([ui[hi],$s,0]):g.push([ui[hi]+" ",$s,0]),Qa-=$s}}else g.push([xe[gn],br,vr]);g.push(["",Qa,0])}else{if(Je!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],Un=xe.length,wt=wt!==0?wt:Ms,gn=0;gn<Un;gn++){vr=gn===0?Si(G):-xa,br=gn===0?xi(k):0;var zs=xe[gn].split(" ").length-1,Hs=zs>0?(wt-Dr[gn])/zs:0;gn<Un-1?Hi.push(J(j(Hs))):Hi.push(0),g.push([xe[gn],br,vr])}}}(typeof X.R2L=="boolean"?X.R2L:Qe)===!0&&(g=Xa(g,function(Mt,Gt,mn){return[Mt.split("").reverse().join(""),Gt,mn]})),ye={text:g,x:k,y:G,options:X,mutex:{pdfEscape:un,activeFontKey:$e,fonts:bt,activeFontSize:we}},Ft.publish("postProcessText",ye),g=ye.text,Nn=ye.mutex.isHex||!1;var Ws=bt[$e].encoding;Ws!=="WinAnsiEncoding"&&Ws!=="StandardEncoding"||(g=Xa(g,function(Mt,Gt,mn){return[Ci(Mt),Gt,mn]})),xe=Ds(g),g=[];for(var Vi,Ki,Ji,Aa=Array.isArray(xe[0])?1:0,Yi="",ka=function(Mt,Gt,mn){var Pn="";return mn instanceof rt?(mn=typeof X.angle=="number"?mr(mn,new rt(1,0,0,1,Mt,Gt)):mr(new rt(1,0,0,1,Mt,Gt),mn),E===R&&(mn=mr(new rt(1,0,0,-1,0,0),mn)),Pn=mn.join(" ")+` Tm
`):Pn=J(Mt)+" "+J(Gt)+` Td
`,Pn},jr=0;jr<xe.length;jr++){switch(Yi="",Aa){case 1:Ji=(Nn?"<":"(")+xe[jr][0]+(Nn?">":")"),Vi=parseFloat(xe[jr][1]),Ki=parseFloat(xe[jr][2]);break;case 0:Ji=(Nn?"<":"(")+xe[jr]+(Nn?">":")"),Vi=xi(k),Ki=Si(G)}Hi!==void 0&&Hi[jr]!==void 0&&(Yi=Hi[jr]+` Tw
`),jr===0?g.push(Yi+ka(Vi,Ki,kn)+Ji):Aa===0?g.push(Yi+Ji):Aa===1&&g.push(Yi+ka(Vi,Ki,kn)+Ji)}g=Aa===0?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var di=`BT
/`;return di+=$e+" "+we+` Tf
`,di+=J(we*Li)+` TL
`,di+=ga+`
`,di+=Mn,di+=g,q(di+="ET"),b[$e]=!0,Xt};var cc=p.__private__.clip=p.clip=function(g){return q(g==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return cc("evenodd")},p.__private__.discardPath=p.discardPath=function(){return q("n"),this};var ci=p.__private__.isValidStyle=function(g){var k=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(k=!0),k};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(g){return ci(g)&&(h=g),this};var Fo=p.__private__.getStyle=p.getStyle=function(g){var k=h;switch(g){case"D":case"S":k="S";break;case"F":k="f";break;case"FD":case"DF":k="B";break;case"f":case"f*":case"B":case"B*":k=g}return k},Do=p.close=function(){return q("h"),this};p.stroke=function(){return q("S"),this},p.fill=function(g){return Ka("f",g),this},p.fillEvenOdd=function(g){return Ka("f*",g),this},p.fillStroke=function(g){return Ka("B",g),this},p.fillStrokeEvenOdd=function(g){return Ka("B*",g),this};var Ka=function(g,k){Ht(k)==="object"?hc(k,g):q(g)},fa=function(g){g===null||E===R&&g===void 0||(g=Fo(g),q(g))};function uc(g,k,G,X,ie){var ye=new vs(k||this.boundingBox,G||this.xStep,X||this.yStep,this.gState,ie||this.matrix);ye.stream=this.stream;var xe=g+"$$"+this.cloneIndex+++"$$";return Qn(xe,ye),ye}var hc=function(g,k){var G=Bt[g.key],X=et[G];if(X instanceof Fa)q("q"),q(dc(k)),X.gState&&p.setGState(X.gState),q(g.matrix.toString()+" cm"),q("/"+G+" sh"),q("Q");else if(X instanceof vs){var ie=new rt(1,0,0,-1,0,va());g.matrix&&(ie=ie.multiply(g.matrix||Ir),G=uc.call(X,g.key,g.boundingBox,g.xStep,g.yStep,ie).id),q("q"),q("/Pattern cs"),q("/"+G+" scn"),X.gState&&p.setGState(X.gState),q(k),q("Q")}},dc=function(g){switch(g){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ls=p.moveTo=function(g,k){return q(J(j(g))+" "+J($(k))+" m"),this},jo=p.lineTo=function(g,k){return q(J(j(g))+" "+J($(k))+" l"),this},zr=p.curveTo=function(g,k,G,X,ie,ye){return q([J(j(g)),J($(k)),J(j(G)),J($(X)),J(j(ie)),J($(ye)),"c"].join(" ")),this};p.__private__.line=p.line=function(g,k,G,X,ie){if(isNaN(g)||isNaN(k)||isNaN(G)||isNaN(X)||!ci(ie))throw new Error("Invalid arguments passed to jsPDF.line");return E===T?this.lines([[G-g,X-k]],g,k,[1,1],ie||"S"):this.lines([[G-g,X-k]],g,k,[1,1]).stroke()},p.__private__.lines=p.lines=function(g,k,G,X,ie,ye){var xe,qe,Je,gt,wt,Ot,on,kn,Xt,In,Nn,Mn;if(typeof g=="number"&&(Mn=G,G=k,k=g,g=Mn),X=X||[1,1],ye=ye||!1,isNaN(k)||isNaN(G)||!Array.isArray(g)||!Array.isArray(X)||!ci(ie)||typeof ye!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ls(k,G),xe=X[0],qe=X[1],gt=g.length,In=k,Nn=G,Je=0;Je<gt;Je++)(wt=g[Je]).length===2?(In=wt[0]*xe+In,Nn=wt[1]*qe+Nn,jo(In,Nn)):(Ot=wt[0]*xe+In,on=wt[1]*qe+Nn,kn=wt[2]*xe+In,Xt=wt[3]*qe+Nn,In=wt[4]*xe+In,Nn=wt[5]*qe+Nn,zr(Ot,on,kn,Xt,In,Nn));return ye&&Do(),fa(ie),this},p.path=function(g){for(var k=0;k<g.length;k++){var G=g[k],X=G.c;switch(G.op){case"m":Ls(X[0],X[1]);break;case"l":jo(X[0],X[1]);break;case"c":zr.apply(this,X);break;case"h":Do()}}return this},p.__private__.rect=p.rect=function(g,k,G,X,ie){if(isNaN(g)||isNaN(k)||isNaN(G)||isNaN(X)||!ci(ie))throw new Error("Invalid arguments passed to jsPDF.rect");return E===T&&(X=-X),q([J(j(g)),J($(k)),J(j(G)),J(j(X)),"re"].join(" ")),fa(ie),this},p.__private__.triangle=p.triangle=function(g,k,G,X,ie,ye,xe){if(isNaN(g)||isNaN(k)||isNaN(G)||isNaN(X)||isNaN(ie)||isNaN(ye)||!ci(xe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[G-g,X-k],[ie-G,ye-X],[g-ie,k-ye]],g,k,[1,1],xe,!0),this},p.__private__.roundedRect=p.roundedRect=function(g,k,G,X,ie,ye,xe){if(isNaN(g)||isNaN(k)||isNaN(G)||isNaN(X)||isNaN(ie)||isNaN(ye)||!ci(xe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qe=4/3*(Math.SQRT2-1);return ie=Math.min(ie,.5*G),ye=Math.min(ye,.5*X),this.lines([[G-2*ie,0],[ie*qe,0,ie,ye-ye*qe,ie,ye],[0,X-2*ye],[0,ye*qe,-ie*qe,ye,-ie,ye],[2*ie-G,0],[-ie*qe,0,-ie,-ye*qe,-ie,-ye],[0,2*ye-X],[0,-ye*qe,ie*qe,-ye,ie,-ye]],g+ie,k,[1,1],xe,!0),this},p.__private__.ellipse=p.ellipse=function(g,k,G,X,ie){if(isNaN(g)||isNaN(k)||isNaN(G)||isNaN(X)||!ci(ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ye=4/3*(Math.SQRT2-1)*G,xe=4/3*(Math.SQRT2-1)*X;return Ls(g+G,k),zr(g+G,k-xe,g+ye,k-X,g,k-X),zr(g-ye,k-X,g-G,k-xe,g-G,k),zr(g-G,k+xe,g-ye,k+X,g,k+X),zr(g+ye,k+X,g+G,k+xe,g+G,k),fa(ie),this},p.__private__.circle=p.circle=function(g,k,G,X){if(isNaN(g)||isNaN(k)||isNaN(G)||!ci(X))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,k,G,G,X)},p.setFont=function(g,k,G){return G&&(k=O(k,G)),$e=Io(g,k,{disableWarning:!1}),this};var fc=p.__private__.getFont=p.getFont=function(){return bt[Io.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var g,k,G={};for(g in ct)if(ct.hasOwnProperty(g))for(k in G[g]=[],ct[g])ct[g].hasOwnProperty(k)&&G[g].push(k);return G},p.addFont=function(g,k,G,X,ie){var ye=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ye.indexOf(arguments[3])!==-1?ie=arguments[3]:arguments[3]&&ye.indexOf(arguments[3])==-1&&(G=O(G,X)),Cn.call(this,g,k,G,ie=ie||"Identity-H")};var pa,Cs=t.lineWidth||.200025,pc=p.__private__.getLineWidth=p.getLineWidth=function(){return Cs},vt=p.__private__.setLineWidth=p.setLineWidth=function(g){return Cs=g,q(J(j(g))+" w"),this};p.__private__.setLineDash=Xe.API.setLineDash=Xe.API.setLineDashPattern=function(g,k){if(g=g||[],k=k||0,isNaN(k)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function(G){return J(j(G))}).join(" "),k=J(j(k)),q("["+g+"] "+k+" d"),this};var gc=p.__private__.getLineHeight=p.getLineHeight=function(){return we*pa};p.__private__.getLineHeight=p.getLineHeight=function(){return we*pa};var mc=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(pa=g),this},vc=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return pa};mc(t.lineHeight);var xi=p.__private__.getHorizontalCoordinate=function(g){return j(g)},Si=p.__private__.getVerticalCoordinate=function(g){return E===R?g:tt[z].mediaBox.topRightY-tt[z].mediaBox.bottomLeftY-j(g)},bc=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(g){return J(xi(g))},yc=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(g){return J(Si(g))},Ja=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Sn(Ja)},p.__private__.setStrokeColor=p.setDrawColor=function(g,k,G,X){return Ja=hr({ch1:g,ch2:k,ch3:G,ch4:X,pdfColorType:"draw",precision:2}),q(Ja),this};var Ts=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Sn(Ts)},p.__private__.setFillColor=p.setFillColor=function(g,k,G,X){return Ts=hr({ch1:g,ch2:k,ch3:G,ch4:X,pdfColorType:"fill",precision:2}),q(Ts),this};var ga=t.textColor||"0 g",_c=p.__private__.getTextColor=p.getTextColor=function(){return Sn(ga)};p.__private__.setTextColor=p.setTextColor=function(g,k,G,X){return ga=hr({ch1:g,ch2:k,ch3:G,ch4:X,pdfColorType:"text",precision:3}),this};var Ai=t.charSpace,wc=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Ai||0)};p.__private__.setCharSpace=p.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ai=g,this};var Is=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(g){var k=p.CapJoinStyles[g];if(k===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Is=k,q(k+" J"),this};var Ps=0;p.__private__.setLineJoin=p.setLineJoin=function(g){var k=p.CapJoinStyles[g];if(k===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ps=k,q(k+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q(J(j(g))+" M"),this},p.GState=Kl,p.setGState=function(g){(g=typeof g=="string"?st[ht[g]]:Bo(null,g)).equals(Ut)||(q("/"+g.id+" gs"),Ut=g)};var Bo=function(g,k){if(!g||!ht[g]){var G=!1;for(var X in st)if(st.hasOwnProperty(X)&&st[X].equals(k)){G=!0;break}if(G)k=st[X];else{var ie="GS"+(Object.keys(st).length+1).toString(10);st[ie]=k,k.id=ie}return g&&(ht[g]=k.id),Ft.publish("addGState",k),k}};p.addGState=function(g,k){return Bo(g,k),this},p.saveGraphicsState=function(){return q("q"),Dt.push({key:$e,size:we,color:ga}),this},p.restoreGraphicsState=function(){q("Q");var g=Dt.pop();return $e=g.key,we=g.size,ga=g.color,Ut=null,this},p.setCurrentTransformationMatrix=function(g){return q(g.toString()+" cm"),this},p.comment=function(g){return q("#"+g),this};var ki=function(g,k){var G=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return G},set:function(ye){isNaN(ye)||(G=parseFloat(ye))}});var X=k||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return X},set:function(ye){isNaN(ye)||(X=parseFloat(ye))}});var ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ie},set:function(ye){ie=ye.toString()}}),this},Os=function(g,k,G,X){ki.call(this,g,k),this.type="rect";var ie=G||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ie},set:function(xe){isNaN(xe)||(ie=parseFloat(xe))}});var ye=X||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ye},set:function(xe){isNaN(xe)||(ye=parseFloat(xe))}}),this},Ya=function(){this.page=kt,this.currentPage=z,this.pages=Ae.slice(0),this.pagesContext=tt.slice(0),this.x=He,this.y=rn,this.matrix=Et,this.width=Fs(z),this.height=Uo(z),this.outputDestination=Te,this.id="",this.objectNumber=-1};Ya.prototype.restore=function(){kt=this.page,z=this.currentPage,tt=this.pagesContext,Ae=this.pages,He=this.x,rn=this.y,Et=this.matrix,Mo(z,this.width),Ni(z,this.height),Te=this.outputDestination};var Rs=function(g,k,G,X,ie){Tr.push(new Ya),kt=z=0,Ae=[],He=g,rn=k,Et=ie,Rr([G,X])};for(var ma in p.beginFormObject=function(g,k,G,X,ie){return Rs(g,k,G,X,ie),this},p.endFormObject=function(g){return(function(k){if(Gn[k])Tr.pop().restore();else{var G=new Ya,X="Xo"+(Object.keys(Ct).length+1).toString(10);G.id=X,Gn[k]=X,Ct[X]=G,Ft.publish("addFormObject",G),Tr.pop().restore()}})(g),this},p.doFormObject=function(g,k){var G=Ct[Gn[g]];return q("q"),q(k.toString()+" cm"),q("/"+G.id+" Do"),q("Q"),this},p.getFormObject=function(g){var k=Ct[Gn[g]];return{x:k.x,y:k.y,width:k.width,height:k.height,matrix:k.matrix}},p.save=function(g,k){return g=g||"generated.pdf",(k=k||{}).returnPromise=k.returnPromise||!1,k.returnPromise===!1?(Ia(Va(li()),g),typeof Ia.unload=="function"&&ft.setTimeout&&setTimeout(Ia.unload,911),this):new Promise(function(G,X){try{var ie=Ia(Va(li()),g);typeof Ia.unload=="function"&&ft.setTimeout&&setTimeout(Ia.unload,911),G(ie)}catch(ye){X(ye.message)}})},Xe.API)Xe.API.hasOwnProperty(ma)&&(ma==="events"&&Xe.API.events.length?(function(g,k){var G,X,ie;for(ie=k.length-1;ie!==-1;ie--)G=k[ie][0],X=k[ie][1],g.subscribe.apply(g,[G].concat(typeof X=="function"?[X]:X))})(Ft,Xe.API.events):p[ma]=Xe.API[ma]);function Fs(g){return tt[g].mediaBox.topRightX-tt[g].mediaBox.bottomLeftX}function Mo(g,k){tt[g].mediaBox.topRightX=k+tt[g].mediaBox.bottomLeftX}function Uo(g){return tt[g].mediaBox.topRightY-tt[g].mediaBox.bottomLeftY}function Ni(g,k){tt[g].mediaBox.topRightY=k+tt[g].mediaBox.bottomLeftY}var Ei=p.getPageWidth=function(g){return Fs(g=g||z)/mt},qo=p.setPageWidth=function(g,k){Mo(g,k*mt)},va=p.getPageHeight=function(g){return Uo(g=g||z)/mt},$o=p.setPageHeight=function(g,k){Ni(g,k*mt)};return p.internal={pdfEscape:un,getStyle:Fo,getFont:fc,getFontSize:Re,getCharSpace:wc,getTextColor:_c,getLineHeight:gc,getLineHeightFactor:vc,getLineWidth:pc,write:Ce,getHorizontalCoordinate:xi,getVerticalCoordinate:Si,getCoordinateString:bc,getVerticalCoordinateString:yc,collections:{},newObject:Pt,newAdditionalObject:ai,newObjectDeferred:Yt,newObjectDeferredBegin:xn,getFilters:dr,putStream:er,events:Ft,scaleFactor:mt,pageSize:{getWidth:function(){return Ei(z)},setWidth:function(g){qo(z,g)},getHeight:function(){return va(z)},setHeight:function(g){$o(z,g)}},encryptionOptions:f,encryption:Tn,getEncryptor:function(g){return f!==null?Tn.encryptor(g,0):function(k){return k}},output:Oo,getNumberOfPages:da,get pages(){return Ae},out:q,f2:A,f3:D,getPageInfo:wi,getPageInfoByObjId:Ro,getCurrentPageInfo:lc,getPDFVersion:w,Point:ki,Rectangle:Os,Matrix:rt,hasHotfix:Fr},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Ei(z)},set:function(g){qo(z,g)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return va(z)},set:function(g){$o(z,g)},enumerable:!0,configurable:!0}),(function(g){for(var k=0,G=ze.length;k<G;k++){var X=Cn.call(this,g[k][0],g[k][1],g[k][2],ze[k][3],!0);m===!1&&(b[X]=!0);var ie=g[k][0].split("-");en({id:X,fontName:ie[0],fontStyle:ie[1]||""})}Ft.publish("addFonts",{fonts:bt,dictionary:ct})}).call(p,ze),$e="F1",qi(a,n),Ft.publish("initialized"),p}ps.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},ps.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ps.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},ps.prototype.processOwnerPassword=function(t,e){return nh(th(e).substr(0,5),t)},ps.prototype.encryptor=function(t,e){var n=th(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return nh(n,r)}},Kl.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Ht(t)!==Ht(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},Xe.API={events:[]},Xe.version="4.2.0";var fn=Xe.API,Eh=1,Wa=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cs=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},za=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},yt=function(t){return t.toFixed(2)},ia=function(t){return t.toFixed(5)};fn.__acroform__={};var gr=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},sp=function(t){return t*Eh},gi=function(t){var e=new tm,n=Be.internal.getHeight(t)||0,r=Be.internal.getWidth(t)||0;return e.BBox=[0,0,Number(yt(r)),Number(yt(n))],e},wy=fn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},xy=fn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Sy=fn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},yn=fn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Sy(t,e-1)},_n=fn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return wy(t,e-1)},wn=fn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return xy(t,e-1)},Ay=fn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,a=t[0],i=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(a)||0,c.lowerLeft_Y=r(i+l)||0,c.upperRight_X=n(a+o)||0,c.upperRight_Y=r(i)||0,[Number(yt(c.lowerLeft_X)),Number(yt(c.lowerLeft_Y)),Number(yt(c.upperRight_X)),Number(yt(c.upperRight_Y))]},ky=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=rh(t,n),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+yt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=gi(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},rh=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(A){return A.split(`
`)}):a.map(function(A){return[A]});var i=n,o=Be.internal.getHeight(t)||0;o=o<0?-o:o;var l=Be.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(A,D,j){if(A+1<a.length){var $=D+" "+a[A+1][0];return Nl($,t,j).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var h,f,m=Nl("3",t,i).height,b=t.multiline?o-i:(o-m)/2,p=b+=2,_=0,w=0,S=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Nl(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var x="",T=0,R=0;R<a.length;R++)if(a.hasOwnProperty(R)){var E=!1;if(a[R].length!==1&&S!==a[R].length-1){if((m+2)*(T+2)+2>o)continue e;x+=a[R][S],E=!0,w=R,R--}else{x=(x+=a[R][S]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var U=parseInt(R),Z=c(U,x,i),O=R>=a.length-1;if(Z&&!O){x+=" ",S=0;continue}if(Z||O){if(O)w=U;else if(t.multiline&&(m+2)*(T+2)+2>o)continue e}else{if(!t.multiline||(m+2)*(T+2)+2>o)continue e;w=U}}for(var J="",F=_;F<=w;F++){var C=a[F];if(t.multiline){if(F===w){J+=C[S]+" ",S=(S+1)%C.length;continue}if(F===_){J+=C[C.length-1]+" ";continue}}J+=C[0]+" "}switch(J=J.substr(J.length-1)==" "?J.substr(0,J.length-1):J,f=Nl(J,t,i).width,t.textAlign){case"right":h=l-f-2;break;case"center":h=(l-f)/2;break;default:h=2}e+=yt(h)+" "+yt(p)+` Td
`,e+="("+Wa(J)+`) Tj
`,e+=-yt(h)+` 0 Td
`,p=-(i+2),f=0,_=E?w:w+1,T++,x=""}break}return r.text=e,r.fontSize=i,r},Nl=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},Ny={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Ey=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},Ly=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ri.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Ny)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Eh=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new nm,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in r)if(r.hasOwnProperty(a)){var i=r[a];i.objId=void 0,i.hasAnnotation&&Ey(i,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,a){var i=!r;for(var o in r||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],h=l.Rect;if(l.Rect&&(l.Rect=Ay(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Be.createDefaultAppearanceStream(l),Ht(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=h,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=ky(l);c.push({key:"AP",value:"<</N "+f+">>"}),a.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var m="";for(var b in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(b)){var p=l.appearanceStreamContent[b];if(m+="/"+b+" ",m+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var _=p[o];typeof _=="function"&&(_=_.call(a,l)),m+="/"+o+" "+_+" ",a.internal.acroformPlugin.xForms.indexOf(_)>=0||a.internal.acroformPlugin.xForms.push(_)}}else typeof(_=p)=="function"&&(_=_.call(a,l)),m+="/"+o+" "+_,a.internal.acroformPlugin.xForms.indexOf(_)>=0||a.internal.acroformPlugin.xForms.push(_);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}i&&(function(w,S){for(var x in w)if(w.hasOwnProperty(x)){var T=x,R=w[x];S.internal.newObjectDeferredBegin(R.objId,!0),Ht(R)==="object"&&typeof R.putStream=="function"&&R.putStream(),delete w[T]}})(a.internal.acroformPlugin.xForms,a)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},em=fn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var a="[",i=0;i<t.length;i++)switch(i!==0&&(a+=" "),Ht(t[i])){case"boolean":case"number":case"object":a+=t[i].toString();break;case"string":t[i].substr(0,1)==="/"?a+="/"+za(t[i].substr(1)):(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),a+="("+Wa(r(t[i].toString()))+")")}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},vu=function(t,e,n){var r=function(a){return a};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Wa(r(t))+")"},bi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};bi.prototype.toString=function(){return this.objId+" 0 R"},bi.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},bi.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],a=this[r];a&&(Array.isArray(a)?t.push({key:r,value:em(a,this.objId,this.scope)}):a instanceof bi?(a.scope=this.scope,t.push({key:r,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:r,value:a}))}return t};var tm=function(){bi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};gr(tm,bi);var nm=function(){bi.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Wa(n(t))+")"}},set:function(n){t=n}})};gr(nm,bi);var ri=function t(){bi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!yn(e,3)},set:function(x){x?this.F=_n(e,3):this.F=wn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');n=x}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(x){r=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(x){r[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(x){r[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(x){r[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(x){r[3]=x}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Jl)return;i="FieldObject"+t.FieldNum++}var x=function(T){return T};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Wa(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Eh:h},set:function(x){h=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof Jl||this instanceof Ba))return vu(m,this.objId,this.scope)},set:function(x){x=x.toString(),m=x}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Bn==0?vu(b,this.objId,this.scope):b},set:function(x){x=x.toString(),b=this instanceof Bn==0?x.substr(0,1)==="("?cs(x.substr(1,x.length-2)):cs(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bn==1?cs(b.substr(1,b.length-1)):b},set:function(x){x=x.toString(),b=this instanceof Bn==1?"/"+za(x):x}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Bn==0?vu(p,this.objId,this.scope):p},set:function(x){x=x.toString(),p=this instanceof Bn==0?x.substr(0,1)==="("?cs(x.substr(1,x.length-2)):cs(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bn==1?cs(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof Bn==1?"/"+za(x):x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var _,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(x){x=!!x,w=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(_)return _},set:function(x){_=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,1)},set:function(x){x?this.Ff=_n(this.Ff,1):this.Ff=wn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,2)},set:function(x){x?this.Ff=_n(this.Ff,2):this.Ff=wn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,3)},set:function(x){x?this.Ff=_n(this.Ff,3):this.Ff=wn(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');S=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(S){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:S=2;break;case"center":case 1:S=1;break;default:S=0}}})};gr(ri,bi);var ys=function(){ri.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return em(e,this.objId,this.scope)},set:function(n){var r,a;a=[],typeof(r=n)=="string"&&(a=(function(i,o,l){l||(l=1);for(var c,h=[];c=o.exec(i);)h.push(c[l]);return h})(r,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,18)},set:function(n){n?this.Ff=_n(this.Ff,18):this.Ff=wn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=_n(this.Ff,19):this.Ff=wn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,20)},set:function(n){n?(this.Ff=_n(this.Ff,20),e.sort()):this.Ff=wn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,22)},set:function(n){n?this.Ff=_n(this.Ff,22):this.Ff=wn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,23)},set:function(n){n?this.Ff=_n(this.Ff,23):this.Ff=wn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,27)},set:function(n){n?this.Ff=_n(this.Ff,27):this.Ff=wn(this.Ff,27)}}),this.hasAppearanceStream=!1};gr(ys,ri);var _s=function(){ys.call(this),this.fontName="helvetica",this.combo=!1};gr(_s,ys);var ws=function(){_s.call(this),this.combo=!0};gr(ws,_s);var Rl=function(){ws.call(this),this.edit=!0};gr(Rl,ws);var Bn=function(){ri.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,15)},set:function(n){n?this.Ff=_n(this.Ff,15):this.Ff=wn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,16)},set:function(n){n?this.Ff=_n(this.Ff,16):this.Ff=wn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,17)},set:function(n){n?this.Ff=_n(this.Ff,17):this.Ff=wn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,26)},set:function(n){n?this.Ff=_n(this.Ff,26):this.Ff=wn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,a=[];for(r in a.push("<<"),e)a.push("/"+r+" ("+Wa(n(e[r]))+")");return a.push(">>"),a.join(`
`)}},set:function(n){Ht(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){var r=n==null?"":n.toString();r.substr(0,1)==="/"&&(r=r.substr(1)),t="/"+za(r)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+za(n)}})};gr(Bn,ri);var Fl=function(){Bn.call(this),this.pushButton=!0};gr(Fl,Bn);var xs=function(){Bn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};gr(xs,Bn);var Jl=function(){var t,e;ri.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),r)o.push("/"+i+" ("+Wa(a(r[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Ht(a)==="object"&&(r=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(a){typeof a=="string"&&(r.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(a){var i=a==null?"":a.toString();i.substr(0,1)==="/"&&(i=i.substr(1)),n="/"+za(i)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(a){var i=a==null?"":a.toString();i.substr(0,1)==="/"&&(i=i.substr(1)),n="/"+za(i)}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Be.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};gr(Jl,ri),xs.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},xs.prototype.createOption=function(t){var e=new Jl;return e.Parent=this,e.optionName=t,this.Kids.push(e),Cy.call(this.scope,e),e};var Dl=function(){Bn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Be.CheckBox.createAppearanceStream()};gr(Dl,Bn);var Ba=function(){ri.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,13)},set:function(e){e?this.Ff=_n(this.Ff,13):this.Ff=wn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,21)},set:function(e){e?this.Ff=_n(this.Ff,21):this.Ff=wn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,23)},set:function(e){e?this.Ff=_n(this.Ff,23):this.Ff=wn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,24)},set:function(e){e?this.Ff=_n(this.Ff,24):this.Ff=wn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,25)},set:function(e){e?this.Ff=_n(this.Ff,25):this.Ff=wn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,26)},set:function(e){e?this.Ff=_n(this.Ff,26):this.Ff=wn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};gr(Ba,ri);var jl=function(){Ba.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,14)},set:function(t){t?this.Ff=_n(this.Ff,14):this.Ff=wn(this.Ff,14)}}),this.password=!0};gr(jl,Ba);var Be={CheckBox:{createAppearanceStream:function(){return{N:{On:Be.CheckBox.YesNormal},D:{On:Be.CheckBox.YesPushDown,Off:Be.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),i=rh(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+yt(Be.internal.getWidth(t))+" "+yt(Be.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+yt(i.fontSize)+" Tf "+a),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=gi(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),a=[],i=Be.internal.getHeight(t),o=Be.internal.getWidth(t),l=rh(t,t.caption);return a.push("1 g"),a.push("0 0 "+yt(o)+" "+yt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+yt(o-1)+" "+yt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+yt(l.fontSize)+" Tf "+r),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+yt(Be.internal.getWidth(t))+" "+yt(Be.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Be.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Be.RadioButton.Circle.YesNormal,e.D[t]=Be.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=gi(t);e.scope=t.scope;var n=[],r=Be.internal.getWidth(t)<=Be.internal.getHeight(t)?Be.internal.getWidth(t)/4:Be.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Be.internal.Bezier_C,i=Number((r*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+ia(Be.internal.getWidth(t)/2)+" "+ia(Be.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=[],r=Be.internal.getWidth(t)<=Be.internal.getHeight(t)?Be.internal.getWidth(t)/4:Be.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*Be.internal.Bezier_C).toFixed(5)),o=Number((r*Be.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+ia(Be.internal.getWidth(t)/2)+" "+ia(Be.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+ia(Be.internal.getWidth(t)/2)+" "+ia(Be.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=[],r=Be.internal.getWidth(t)<=Be.internal.getHeight(t)?Be.internal.getWidth(t)/4:Be.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*Be.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+ia(Be.internal.getWidth(t)/2)+" "+ia(Be.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Be.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Be.RadioButton.Cross.YesNormal,e.D[t]=Be.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=gi(t);e.scope=t.scope;var n=[],r=Be.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+yt(Be.internal.getWidth(t)-2)+" "+yt(Be.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(yt(r.x1.x)+" "+yt(r.x1.y)+" m"),n.push(yt(r.x2.x)+" "+yt(r.x2.y)+" l"),n.push(yt(r.x4.x)+" "+yt(r.x4.y)+" m"),n.push(yt(r.x3.x)+" "+yt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=Be.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+yt(Be.internal.getWidth(t))+" "+yt(Be.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+yt(Be.internal.getWidth(t)-2)+" "+yt(Be.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(yt(n.x1.x)+" "+yt(n.x1.y)+" m"),r.push(yt(n.x2.x)+" "+yt(n.x2.y)+" l"),r.push(yt(n.x4.x)+" "+yt(n.x4.y)+" m"),r.push(yt(n.x3.x)+" "+yt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=gi(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+yt(Be.internal.getWidth(t))+" "+yt(Be.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Be.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Be.internal.getWidth(t),n=Be.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Be.internal.getWidth=function(t){var e=0;return Ht(t)==="object"&&(e=sp(t.Rect[2])),e},Be.internal.getHeight=function(t){var e=0;return Ht(t)==="object"&&(e=sp(t.Rect[3])),e};var Cy=fn.addField=function(t){if(Ly(this,t),!(t instanceof ri))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};fn.AcroFormChoiceField=ys,fn.AcroFormListBox=_s,fn.AcroFormComboBox=ws,fn.AcroFormEditBox=Rl,fn.AcroFormButton=Bn,fn.AcroFormPushButton=Fl,fn.AcroFormRadioButton=xs,fn.AcroFormCheckBox=Dl,fn.AcroFormTextField=Ba,fn.AcroFormPasswordField=jl,fn.AcroFormAppearance=Be,fn.AcroForm={ChoiceField:ys,ListBox:_s,ComboBox:ws,EditBox:Rl,Button:Bn,PushButton:Fl,RadioButton:xs,CheckBox:Dl,TextField:Ba,PasswordField:jl,Appearance:Be},Xe.AcroForm={ChoiceField:ys,ListBox:_s,ComboBox:ws,EditBox:Rl,Button:Bn,PushButton:Fl,RadioButton:xs,CheckBox:Dl,TextField:Ba,PasswordField:jl,Appearance:Be};Xe.AcroForm;function rm(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(A,D){var j,$,V,oe,le,ae=n;if((D=D||n)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(Z(A))for(le in r)for(V=r[le],j=0;j<V.length;j+=1){for(oe=!0,$=0;$<V[j].length;$+=1)if(V[j][$]!==void 0&&V[j][$]!==A[$]){oe=!1;break}if(oe===!0){ae=le;break}}else for(le in r)for(V=r[le],j=0;j<V.length;j+=1){for(oe=!0,$=0;$<V[j].length;$+=1)if(V[j][$]!==void 0&&V[j][$]!==A.charCodeAt($)){oe=!1;break}if(oe===!0){ae=le;break}}return ae===n&&D!==n&&(ae=D),ae},i=function A(D){for(var j=this.internal.write,$=this.internal.putStream,V=(0,this.internal.getFilters)();V.indexOf("FlateEncode")!==-1;)V.splice(V.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var oe=[];if(oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Image"}),oe.push({key:"Width",value:D.width}),oe.push({key:"Height",value:D.height}),D.colorSpace===x.INDEXED?oe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(oe.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===x.DEVICE_CMYK&&oe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),oe.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&oe.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)&&D.transparency.length>0){for(var le="",ae=0,de=D.transparency.length;ae<de;ae++)le+=D.transparency[ae]+" "+D.transparency[ae]+" ";oe.push({key:"Mask",value:"["+le+"]"})}D.sMask!==void 0&&oe.push({key:"SMask",value:D.objectId+1+" 0 R"});var Le=D.filter!==void 0?["/"+D.filter]:void 0;if($({data:D.data,additionalKeyValues:oe,alreadyAppliedFilters:Le,objectId:D.objectId}),j("endobj"),"sMask"in D&&D.sMask!==void 0){var pe,I=(pe=D.sMaskBitsPerComponent)!==null&&pe!==void 0?pe:D.bitsPerComponent,z={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:I,data:D.sMask};"filter"in D&&(z.decodeParameters="/Predictor ".concat(D.predictor," /Colors 1 /BitsPerComponent ").concat(I," /Columns ").concat(D.width),z.filter=D.filter),A.call(this,z)}if(D.colorSpace===x.INDEXED){var K=this.internal.newObject();$({data:J(new Uint8Array(D.palette)),objectId:K}),j("endobj")}},o=function(){var A=this.internal.collections[e+"images"];for(var D in A)i.call(this,A[D])},l=function(){var A,D=this.internal.collections[e+"images"],j=this.internal.write;for(var $ in D)j("/I"+(A=D[$]).index,A.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},h=function(){var A=this.internal.collections[e+"images"];return c.call(this),A},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},m=function(A){return typeof t["process"+A.toUpperCase()]=="function"},b=function(A){return Ht(A)==="object"&&A.nodeType===1},p=function(A,D){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var j=""+A.getAttribute("src");if(j.indexOf("data:image/")===0)return Ol(unescape(j).split("base64,").pop());var $=t.loadFile(j,!0);if($!==void 0)return $}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var V;switch(D){case"PNG":V="image/png";break;case"WEBP":V="image/webp";break;default:V="image/jpeg"}return Ol(A.toDataURL(V,1).split("base64,").pop())}},_=function(A){var D=this.internal.collections[e+"images"];if(D){for(var j in D)if(A===D[j].alias)return D[j]}},w=function(A,D,j){return A||D||(A=-96,D=-96),A<0&&(A=-1*j.width*72/A/this.internal.scaleFactor),D<0&&(D=-1*j.height*72/D/this.internal.scaleFactor),A===0&&(A=D*j.width/j.height),D===0&&(D=A*j.height/j.width),[A,D]},S=function(A,D,j,$,V,oe){var le=w.call(this,j,$,V),ae=this.internal.getCoordinateString,de=this.internal.getVerticalCoordinateString,Le=h.call(this);if(j=le[0],$=le[1],Le[V.index]=V,oe){oe*=Math.PI/180;var pe=Math.cos(oe),I=Math.sin(oe),z=function(Y){return Y.toFixed(4)},K=[z(pe),z(I),z(-1*I),z(pe),0,0,"cm"]}this.internal.write("q"),oe?(this.internal.write([1,"0","0",1,ae(A),de(D+$),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([ae(j),"0","0",ae($),"0","0","cm"].join(" "))):this.internal.write([ae(j),"0","0",ae($),ae(A),de(D+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+V.index+" Do"),this.internal.write("Q")},x=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var T=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},R=t.__addimage__.sHashCode=function(A){var D,j,$=0;if(typeof A=="string")for(j=A.length,D=0;D<j;D++)$=($<<5)-$+A.charCodeAt(D),$|=0;else if(Z(A))for(j=A.byteLength/2,D=0;D<j;D++)$=($<<5)-$+A[D],$|=0;return $},E=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var D=!0;return A.length===0&&(D=!1),A.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(D=!1),D},U=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var D=A.indexOf(",");return D<0?null:A.substring(0,D).trim().endsWith("base64")?A.substring(D+1):null};t.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var Z=t.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},O=t.__addimage__.binaryStringToUint8Array=function(A){for(var D=A.length,j=new Uint8Array(D),$=0;$<D;$++)j[$]=A.charCodeAt($);return j},J=t.__addimage__.arrayBufferToBinaryString=function(A){for(var D="",j=Z(A)?A:new Uint8Array(A),$=0;$<j.length;$+=8192)D+=String.fromCharCode.apply(null,j.subarray($,$+8192));return D};t.addImage=function(){var A,D,j,$,V,oe,le,ae,de;if(typeof arguments[1]=="number"?(D=n,j=arguments[1],$=arguments[2],V=arguments[3],oe=arguments[4],le=arguments[5],ae=arguments[6],de=arguments[7]):(D=arguments[1],j=arguments[2],$=arguments[3],V=arguments[4],oe=arguments[5],le=arguments[6],ae=arguments[7],de=arguments[8]),Ht(A=arguments[0])==="object"&&!b(A)&&"imageData"in A){var Le=A;A=Le.imageData,D=Le.format||D||n,j=Le.x||j||0,$=Le.y||$||0,V=Le.w||Le.width||V,oe=Le.h||Le.height||oe,le=Le.alias||le,ae=Le.compression||ae,de=Le.rotation||Le.angle||de}var pe=this.internal.getFilters();if(ae===void 0&&pe.indexOf("FlateEncode")!==-1&&(ae="SLOW"),isNaN(j)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var I=F.call(this,A,D,le,ae);return S.call(this,j,$,V,oe,I,de),this};var F=function(A,D,j,$){var V,oe,le;if(typeof A=="string"&&a(A)===n){A=unescape(A);var ae=C(A,!1);(ae!==""||(ae=t.loadFile(A,!0))!==void 0)&&(A=ae)}if(b(A)&&(A=p(A,D)),D=a(A,D),!m(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((le=j)==null||le.length===0)&&(j=(function(de){return typeof de=="string"||Z(de)?R(de):Z(de.data)?R(de.data):null})(A)),(V=_.call(this,j))||(A instanceof Uint8Array||D==="RGBA"||(oe=A,A=O(A)),V=this["process"+D.toUpperCase()](A,f.call(this),j,(function(de){return de&&typeof de=="string"&&(de=de.toUpperCase()),de in t.image_compression?de:T.NONE})($),oe)),!V)throw new Error("An unknown error occurred whilst processing the image.");return V},C=t.__addimage__.convertBase64ToBinaryString=function(A,D){D=typeof D!="boolean"||D;var j,$="";if(typeof A=="string"){var V;j=(V=U(A))!==null&&V!==void 0?V:A;try{$=Ol(j)}catch(oe){if(D)throw E(j)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+oe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $};t.getImageProperties=function(A){var D,j,$="";if(b(A)&&(A=p(A)),typeof A=="string"&&a(A)===n&&(($=C(A,!1))===""&&($=t.loadFile(A)||""),A=$),j=a(A),!m(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(A instanceof Uint8Array||(A=O(A)),!(D=this["process"+j.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=j,D}})(Xe.API),(function(t){var e=function(n){if(n!==void 0&&n!="")return!0};Xe.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,a,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),h=n.pageContext.annotations,f=!1,m=0;m<h.length&&!f;m++)switch((r=h[m]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var b=0;b<h.length;b++){r=h[b];var p=this.internal.pdfEscape,_=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(w.objId),T=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+p(x(r.contents))+")",i+=" /Popup "+S.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+p(x(T))+") >>",w.content=i;var R=w.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+R,r.open&&(i+=" /Open true"),i+=" >>",S.content=i,this.internal.write(w.objId,"0 R",S.objId,"0 R");break;case"freetext":a="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var E=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+p(_(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var U=this.annotations._nameMap[r.options.name];r.options.pageNumber=U.page,r.options.top=U.y}else r.options.top||(r.options.top=0);if(a="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+p(_(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;default:var Z=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+Z+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,a,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:h(r),w:c(n+a),h:h(r+i)},options:o,type:"link"})},t.textWithLink=function(n,r,a,i){var o,l,c=this.getTextWidth(n),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(h*f)}else l=c,o=h;return this.text(n,r,a,i),a+=.2*h,i.align==="center"&&(r-=c/2),i.align==="right"&&(r-=c),this.link(r,a-h,l,o,i),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}})(Xe.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},l=t.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&a.indexOf(w.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(w){var S=0,x=n,T="",R=0;for(S=0;S<w.length;S+=1)x[w.charCodeAt(S)]!==void 0?(R++,typeof(x=x[w.charCodeAt(S)])=="number"&&(T+=String.fromCharCode(x),x=n,R=0),S===w.length-1&&(x=n,T+=w.charAt(S-(R-1)),S-=R-1,R=0)):(x=n,T+=w.charAt(S-R),S-=R,R=0);return T};t.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&r[w.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(w,S,x){return o(w)?i(w)===!1?-1:!h(w)||!o(S)&&!o(x)||!o(x)&&l(S)||l(w)&&!o(S)||l(w)&&c(S)||l(w)&&l(S)?0:f(w)&&o(S)&&!l(S)&&o(x)&&h(x)?3:l(w)||!o(x)?1:2:-1},p=function(w){var S=0,x=0,T=0,R="",E="",U="",Z=(w=w||"").split("\\s+"),O=[];for(S=0;S<Z.length;S+=1){for(O.push(""),x=0;x<Z[S].length;x+=1)R=Z[S][x],E=Z[S][x-1],U=Z[S][x+1],o(R)?(T=b(R,E,U),O[S]+=T!==-1?String.fromCharCode(e[R.charCodeAt(0)][T]):R):O[S]+=R;O[S]=m(O[S])}return O.join(" ")},_=t.__arabicParser__.processArabic=t.processArabic=function(){var w,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(S)){var T=0;for(x=[],T=0;T<S.length;T+=1)Array.isArray(S[T])?x.push([p(S[T][0]),S[T][1],S[T][2]]):x.push([p(S[T])]);w=x}else w=p(S);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};t.events.push(["preProcessText",_])})(Xe.API),Xe.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var a;if((n=n||"2d")!=="2d")return null;for(a in r)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=r[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Xe.API),(function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(w){f=w}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(w){m=w}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(w){b=w}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var _=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return _},set:function(w){_=w}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,h){r.call(this);var f=(h=h||{}).fontSize||this.getFontSize(),m=h.font||this.getFont(),b=h.scaleFactor||this.internal.scaleFactor,p=0,_=0,w=0,S=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=h.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(R,E){return R.concat(S.splitTextToSize(E,x))},[])):c=Array.isArray(c)?c:[c];for(var T=0;T<c.length;T++)p<(w=this.getStringUnitWidth(c[T],{font:m})*f)&&(p=w);return p!==0&&(_=c.length),{w:p/=b,h:Math.max((_*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var h=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===c.lineNumber?(c.x=(h.x||0)+(h.width||0),c.y=h.y||0):h.y+h.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,p&&b&&(this.printHeaderRow(c.lineNumber,!0),c.y+=b[0].height)):c.y=h.y+h.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,h,f,m,b){if(r.call(this),!f)throw new Error("No data for PDF table.");var p,_,w,S,x=[],T=[],R=[],E={},U={},Z=[],O=[],J=(b=b||{}).autoSize||!1,F=b.printHeaders!==!1,C=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,A=b.margins||Object.assign({width:this.getPageWidth()},e),D=typeof b.padding=="number"?b.padding:3,j=b.headerBackgroundColor||"#c8c8c8",$=b.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=C,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=j,this.internal.__cell__.headerTextColor=$,this.setFontSize(C),m==null)T=x=Object.keys(f[0]),R=x.map(function(){return"left"});else if(Array.isArray(m)&&Ht(m[0])==="object")for(x=m.map(function(Le){return Le.name}),T=m.map(function(Le){return Le.prompt||Le.name||""}),R=m.map(function(Le){return Le.align||"left"}),p=0;p<m.length;p+=1)U[m[p].name]=.7499990551181103*m[p].width;else Array.isArray(m)&&typeof m[0]=="string"&&(T=x=m,R=x.map(function(){return"left"}));if(J||Array.isArray(m)&&typeof m[0]=="string")for(p=0;p<x.length;p+=1){for(E[S=x[p]]=f.map(function(Le){return Le[S]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(T[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),_=E[S],this.setFont(void 0,"normal"),w=0;w<_.length;w+=1)Z.push(this.getTextDimensions(_[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[S]=Math.max.apply(null,Z)+D+D,Z=[]}if(F){var V={};for(p=0;p<x.length;p+=1)V[x[p]]={},V[x[p]].text=T[p],V[x[p]].align=R[p];var oe=l.call(this,V,U);O=x.map(function(Le){return new i(c,h,U[Le],oe,V[Le].text,void 0,V[Le].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var le=m.reduce(function(Le,pe){return Le[pe.name]=pe.align,Le},{});for(p=0;p<f.length;p+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:p,data:f[p]},this);var ae=l.call(this,f[p],U);for(w=0;w<x.length;w+=1){var de=f[p][x[w]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:p,col:w,data:de},this),o.call(this,new i(c,h,U[x[w]],ae,de,p+2,le[x[w]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=h,this};var l=function(c,h){var f=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(c).map(function(p){var _=c[p];return this.splitTextToSize(_.hasOwnProperty("text")?_.text:_,h[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*m/b+f+f},this).reduce(function(p,_){return Math.max(p,_)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,h){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),h&&(f.y=this.internal.__cell__.margins.top||0,b.push(f)),f.lineNumber=c;var _=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(_)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),n=!1}})(Xe.API);var im={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},am=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],ih=rm(am),sm=[100,200,300,400,500,600,700,800,900],Ty=rm(sm);function bu(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(i){return im[i=i||"normal"]?i:"normal"})(t.style),r=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(t.weight),a=(function(i){return typeof ih[i=i||"normal"]=="number"?i:"normal"})(t.stretch);return{family:e,style:n,weight:r,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,n,r].join(" ")}}}function op(t,e,n,r){var a;for(a=n;a>=0&&a<e.length;a+=r)if(t[e[a]])return t[e[a]];for(a=n;a>=0&&a<e.length;a-=r)if(t[e[a]])return t[e[a]]}var Iy={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lp={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cp(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function up(t){return t.trimLeft()}function Py(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function Oy(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var us,El,hp,dp,fp,yu=["times"];function pp(t,e,n,r,a){var i=4,o=mp;switch(a){case Xe.API.image_compression.FAST:i=1,o=gp;break;case Xe.API.image_compression.MEDIUM:i=6,o=vp;break;case Xe.API.image_compression.SLOW:i=9,o=bp}t=(function(c,h,f,m){for(var b,p=c.length/h,_=new Uint8Array(c.length+p),w=[Ry,gp,mp,vp,bp],S=0;S<p;S+=1){var x=S*h,T=c.subarray(x,x+h);if(m)_.set(m(T,f,b),x+S);else{for(var R=w.length,E=[],U=0;U<R;U+=1)E[U]=w[U](T,f,b);var Z=Dy(E.concat());_.set(E[Z],x+S)}b=T}return _})(t,e,Math.ceil(n*r/8),o);var l=Xu(t,{level:i});return Xe.API.__addimage__.arrayBufferToBinaryString(l)}function Ry(t){var e=Array.apply([],t);return e.unshift(0),e}function gp(t,e){var n=t.length,r=[];r[0]=1;for(var a=0;a<n;a+=1){var i=t[a-e]||0;r[a+1]=t[a]-i+256&255}return r}function mp(t,e,n){var r=t.length,a=[];a[0]=2;for(var i=0;i<r;i+=1){var o=n&&n[i]||0;a[i+1]=t[i]-o+256&255}return a}function vp(t,e,n){var r=t.length,a=[];a[0]=3;for(var i=0;i<r;i+=1){var o=t[i-e]||0,l=n&&n[i]||0;a[i+1]=t[i]+256-(o+l>>>1)&255}return a}function bp(t,e,n){var r=t.length,a=[];a[0]=4;for(var i=0;i<r;i+=1){var o=Fy(t[i-e]||0,n&&n[i]||0,n&&n[i-e]||0);a[i+1]=t[i]-o+256&255}return a}function Fy(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),a=Math.abs(t-n),i=Math.abs(t+e-n-n);return r<=a&&r<=i?t:a<=i?e:n}function Dy(t){var e=t.map(function(n){return n.reduce(function(r,a){return r+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function _u(t,e,n){var r=e*n,a=Math.floor(r/8),i=16-(r-8*a+n),o=(1<<n)-1;return om(t,a)>>i&o}function yp(t,e,n,r){var a=n*r,i=Math.floor(a/8),o=16-(a-8*i+r),l=(1<<r)-1,c=(e&l)<<o;(function(h,f,m){if(f+1<h.byteLength)h.setUint16(f,m,!1);else{var b=m>>8&255;h.setUint8(f,b)}})(t,i,om(t,i)&~(l<<o)&65535|c)}function om(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function jy(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,a=t[e++],i=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var h=!0,f=[],m=0,b=null,p=0,_=null;for(this.width=n,this.height=r;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,_=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=t[e++];m=t[e++]|t[e++]<<8,b=t[e++],1&w||(b=null),p=w>>2&7,e++;break;case 254:for(;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var S=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,T=t[e++]|t[e++]<<8,R=t[e++]|t[e++]<<8,E=t[e++],U=E>>6&1,Z=1<<1+(7&E),O=l,J=c,F=!1;E>>7&&(F=!0,O=e,J=Z,e+=3*Z);var C=e;for(e++;;){var A;if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}f.push({x:S,y:x,width:T,height:R,has_local_palette:F,palette_offset:O,palette_size:J,data_offset:C,data_length:e-C,transparent_index:b,interlaced:!!U,delay:m,disposal:p});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return _},this.frameInfo=function(D){if(D<0||D>=f.length)throw new Error("Frame index out of range.");return f[D]},this.decodeAndBlitFrameBGRA=function(D,j){var $=this.frameInfo(D),V=$.width*$.height;if(V>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var oe=new Uint8Array(V);_p(t,$.data_offset,oe,V);var le=$.palette_offset,ae=$.transparent_index;ae===null&&(ae=256);var de=$.width,Le=n-de,pe=de,I=4*($.y*n+$.x),z=4*(($.y+$.height)*n+$.x),K=I,Y=4*Le;$.interlaced===!0&&(Y+=4*n*7);for(var Q=8,re=0,he=oe.length;re<he;++re){var fe=oe[re];if(pe===0&&(pe=de,(K+=Y)>=z&&(Y=4*Le+4*n*(Q-1),K=I+(de+Le)*(Q<<1),Q>>=1)),fe===ae)K+=4;else{var me=t[le+3*fe],Ae=t[le+3*fe+1],Oe=t[le+3*fe+2];j[K++]=Oe,j[K++]=Ae,j[K++]=me,j[K++]=255}--pe}},this.decodeAndBlitFrameRGBA=function(D,j){var $=this.frameInfo(D),V=$.width*$.height;if(V>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var oe=new Uint8Array(V);_p(t,$.data_offset,oe,V);var le=$.palette_offset,ae=$.transparent_index;ae===null&&(ae=256);var de=$.width,Le=n-de,pe=de,I=4*($.y*n+$.x),z=4*(($.y+$.height)*n+$.x),K=I,Y=4*Le;$.interlaced===!0&&(Y+=4*n*7);for(var Q=8,re=0,he=oe.length;re<he;++re){var fe=oe[re];if(pe===0&&(pe=de,(K+=Y)>=z&&(Y=4*Le+4*n*(Q-1),K=I+(de+Le)*(Q<<1),Q>>=1)),fe===ae)K+=4;else{var me=t[le+3*fe],Ae=t[le+3*fe+1],Oe=t[le+3*fe+2];j[K++]=me,j[K++]=Ae,j[K++]=Oe,j[K++]=255}--pe}}}function _p(t,e,n,r){for(var a=t[e++],i=1<<a,o=i+1,l=o+1,c=a+1,h=(1<<c)-1,f=0,m=0,b=0,p=t[e++],_=new Int32Array(4096),w=null;;){for(;f<16&&p!==0;)m|=t[e++]<<f,f+=8,p===1?p=t[e++]:--p;if(f<c)break;var S=m&h;if(m>>=c,f-=c,S!==i){if(S===o)break;for(var x=S<l?S:w,T=0,R=x;R>i;)R=_[R]>>8,++T;var E=R;if(b+T+(x!==S?1:0)>r)return void Kt.log("Warning, gif stream longer than expected.");n[b++]=E;var U=b+=T;for(x!==S&&(n[b++]=E),R=x;T--;)R=_[R],n[--U]=255&R,R>>=8;w!==null&&l<4096&&(_[l++]=w<<8|E,l>=h+1&&c<12&&(++c,h=h<<1|1)),w=S}else l=o+1,h=(1<<(c=a+1))-1,w=null}return b!==r&&Kt.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function wu(t){var e,n,r,a,i,o=Math.floor,l=new Array(64),c=new Array(64),h=new Array(64),f=new Array(64),m=new Array(65535),b=new Array(65535),p=new Array(64),_=new Array(64),w=[],S=0,x=7,T=new Array(64),R=new Array(64),E=new Array(64),U=new Array(256),Z=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],J=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],V=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function oe(I,z){for(var K=0,Y=0,Q=new Array,re=1;re<=16;re++){for(var he=1;he<=I[re];he++)Q[z[Y]]=[],Q[z[Y]][0]=K,Q[z[Y]][1]=re,Y++,K++;K*=2}return Q}function le(I){for(var z=I[0],K=I[1]-1;K>=0;)z&1<<K&&(S|=1<<x),K--,--x<0&&(S==255?(ae(255),ae(0)):ae(S),x=7,S=0)}function ae(I){w.push(I)}function de(I){ae(I>>8&255),ae(255&I)}function Le(I,z,K,Y,Q){for(var re,he=Q[0],fe=Q[240],me=(function(we,Ke){var Re,Qe,Ie,it,nt,at,ut,pt,$e,mt,He=0;for($e=0;$e<8;++$e){Re=we[He],Qe=we[He+1],Ie=we[He+2],it=we[He+3],nt=we[He+4],at=we[He+5],ut=we[He+6];var rn=Re+(pt=we[He+7]),Et=Re-pt,bt=Qe+ut,ct=Qe-ut,Dt=Ie+at,et=Ie-at,Bt=it+nt,st=it-nt,ht=rn+Bt,Ut=rn-Bt,kt=bt+Dt,tt=bt-Dt;we[He]=ht+kt,we[He+4]=ht-kt;var Ft=.707106781*(tt+Ut);we[He+2]=Ut+Ft,we[He+6]=Ut-Ft;var _i=.382683433*((ht=st+et)-(tt=ct+Et)),Ct=.5411961*ht+_i,Gn=1.306562965*tt+_i,Tr=.707106781*(kt=et+ct),rt=Et+Tr,mr=Et-Tr;we[He+5]=mr+Ct,we[He+3]=mr-Ct,we[He+1]=rt+Gn,we[He+7]=rt-Gn,He+=8}for(He=0,$e=0;$e<8;++$e){Re=we[He],Qe=we[He+8],Ie=we[He+16],it=we[He+24],nt=we[He+32],at=we[He+40],ut=we[He+48];var Ir=Re+(pt=we[He+56]),Qn=Re-pt,cr=Qe+ut,Pt=Qe-ut,Yt=Ie+at,xn=Ie-at,ai=it+nt,Pr=it-nt,ur=Ir+ai,Sn=Ir-ai,hr=cr+Yt,dr=cr-Yt;we[He]=ur+hr,we[He+32]=ur-hr;var er=.707106781*(dr+Sn);we[He+16]=Sn+er,we[He+48]=Sn-er;var si=.382683433*((ur=Pr+xn)-(dr=Pt+Qn)),Or=.5411961*ur+si,Ue=1.306562965*dr+si,ee=.707106781*(hr=xn+Pt),Ne=Qn+ee,Fe=Qn-ee;we[He+40]=Fe+Or,we[He+24]=Fe-Or,we[He+8]=Ne+Ue,we[He+56]=Ne-Ue,He++}for($e=0;$e<64;++$e)mt=we[$e]*Ke[$e],p[$e]=mt>0?mt+.5|0:mt-.5|0;return p})(I,z),Ae=0;Ae<64;++Ae)_[O[Ae]]=me[Ae];var Oe=_[0]-K;K=_[0],Oe==0?le(Y[0]):(le(Y[b[re=32767+Oe]]),le(m[re]));for(var Te=63;Te>0&&_[Te]==0;)Te--;if(Te==0)return le(he),K;for(var Me,q=1;q<=Te;){for(var Ce=q;_[q]==0&&q<=Te;)++q;var dt=q-Ce;if(dt>=16){Me=dt>>4;for(var ze=1;ze<=Me;++ze)le(fe);dt&=15}re=32767+_[q],le(Q[(dt<<4)+b[re]]),le(m[re]),q++}return Te!=63&&le(he),K}function pe(I){I=Math.min(Math.max(I,1),100),i!=I&&((function(z){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Y=0;Y<64;Y++){var Q=o((K[Y]*z+50)/100);Q=Math.min(Math.max(Q,1),255),l[O[Y]]=Q}for(var re=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var fe=o((re[he]*z+50)/100);fe=Math.min(Math.max(fe,1),255),c[O[he]]=fe}for(var me=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ae=0,Oe=0;Oe<8;Oe++)for(var Te=0;Te<8;Te++)h[Ae]=1/(l[O[Ae]]*me[Oe]*me[Te]*8),f[Ae]=1/(c[O[Ae]]*me[Oe]*me[Te]*8),Ae++})(I<50?Math.floor(5e3/I):Math.floor(200-2*I)),i=I)}this.encode=function(I,z){z&&pe(z),w=new Array,S=0,x=7,de(65496),de(65504),de(16),ae(74),ae(70),ae(73),ae(70),ae(0),ae(1),ae(1),ae(0),de(1),de(1),ae(0),ae(0),(function(){de(65499),de(132),ae(0);for(var Qe=0;Qe<64;Qe++)ae(l[Qe]);ae(1);for(var Ie=0;Ie<64;Ie++)ae(c[Ie])})(),(function(Qe,Ie){de(65472),de(17),ae(8),de(Ie),de(Qe),ae(3),ae(1),ae(17),ae(0),ae(2),ae(17),ae(1),ae(3),ae(17),ae(1)})(I.width,I.height),(function(){de(65476),de(418),ae(0);for(var Qe=0;Qe<16;Qe++)ae(J[Qe+1]);for(var Ie=0;Ie<=11;Ie++)ae(F[Ie]);ae(16);for(var it=0;it<16;it++)ae(C[it+1]);for(var nt=0;nt<=161;nt++)ae(A[nt]);ae(1);for(var at=0;at<16;at++)ae(D[at+1]);for(var ut=0;ut<=11;ut++)ae(j[ut]);ae(17);for(var pt=0;pt<16;pt++)ae($[pt+1]);for(var $e=0;$e<=161;$e++)ae(V[$e])})(),de(65498),de(12),ae(3),ae(1),ae(0),ae(2),ae(17),ae(3),ae(17),ae(0),ae(63),ae(0);var K=0,Y=0,Q=0;S=0,x=7,this.encode.displayName="_encode_";for(var re,he,fe,me,Ae,Oe,Te,Me,q,Ce=I.data,dt=I.width,ze=I.height,we=4*dt,Ke=0;Ke<ze;){for(re=0;re<we;){for(Ae=we*Ke+re,Te=-1,Me=0,q=0;q<64;q++)Oe=Ae+(Me=q>>3)*we+(Te=4*(7&q)),Ke+Me>=ze&&(Oe-=we*(Ke+1+Me-ze)),re+Te>=we&&(Oe-=re+Te-we+4),he=Ce[Oe++],fe=Ce[Oe++],me=Ce[Oe++],T[q]=(Z[he]+Z[fe+256|0]+Z[me+512|0]>>16)-128,R[q]=(Z[he+768|0]+Z[fe+1024|0]+Z[me+1280|0]>>16)-128,E[q]=(Z[he+1280|0]+Z[fe+1536|0]+Z[me+1792|0]>>16)-128;K=Le(T,h,K,e,r),Y=Le(R,f,Y,n,a),Q=Le(E,f,Q,n,a),re+=32}Ke+=8}if(x>=0){var Re=[];Re[1]=x+1,Re[0]=(1<<x+1)-1,le(Re)}return de(65497),new Uint8Array(w)},t=t||50,(function(){for(var I=String.fromCharCode,z=0;z<256;z++)U[z]=I(z)})(),e=oe(J,F),n=oe(D,j),r=oe(C,A),a=oe($,V),(function(){for(var I=1,z=2,K=1;K<=15;K++){for(var Y=I;Y<z;Y++)b[32767+Y]=K,m[32767+Y]=[],m[32767+Y][1]=K,m[32767+Y][0]=Y;for(var Q=-(z-1);Q<=-I;Q++)b[32767+Q]=K,m[32767+Q]=[],m[32767+Q][1]=K,m[32767+Q][0]=z-1+Q;I<<=1,z<<=1}})(),(function(){for(var I=0;I<256;I++)Z[I]=19595*I,Z[I+256|0]=38470*I,Z[I+512|0]=7471*I+32768,Z[I+768|0]=-11059*I,Z[I+1024|0]=-21709*I,Z[I+1280|0]=32768*I+8421375,Z[I+1536|0]=-27439*I,Z[I+1792|0]=-5329*I})(),pe(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Kr(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wp(t){function e(F){if(!F)throw Error("assert :P")}function n(F,C,A){for(var D=0;4>D;D++)if(F[C+D]!=A.charCodeAt(D))return!0;return!1}function r(F,C,A,D,j){for(var $=0;$<j;$++)F[C+$]=A[D+$]}function a(F,C,A,D){for(var j=0;j<D;j++)F[C+j]=A}function i(F){return new Int32Array(F)}function o(F,C){for(var A=[],D=0;D<F;D++)A.push(new C);return A}function l(F,C){var A=[];return(function D(j,$,V){for(var oe=V[$],le=0;le<oe&&(j.push(V.length>$+1?[]:new C),!(V.length<$+1));le++)D(j[le],$+1,V)})(A,0,F),A}var c=function(){var F=this;function C(u,d){for(var v=1<<d-1>>>0;u&v;)v>>>=1;return v?(u&v-1)+v:u}function A(u,d,v,y,N){e(!(y%v));do u[d+(y-=v)]=N;while(0<y)}function D(u,d,v,y,N){if(e(2328>=N),512>=N)var L=i(512);else if((L=i(N))==null)return 0;return(function(P,B,M,H,te,ue){var W,ne,se=B,ge=1<<M,ce=i(16),ve=i(16);for(e(te!=0),e(H!=null),e(P!=null),e(0<M),ne=0;ne<te;++ne){if(15<H[ne])return 0;++ce[H[ne]]}if(ce[0]==te)return 0;for(ve[1]=0,W=1;15>W;++W){if(ce[W]>1<<W)return 0;ve[W+1]=ve[W]+ce[W]}for(ne=0;ne<te;++ne)W=H[ne],0<H[ne]&&(ue[ve[W]++]=ne);if(ve[15]==1)return(H=new j).g=0,H.value=ue[0],A(P,se,1,ge,H),ge;var _e,Ee=-1,Se=ge-1,Ze=0,De=1,St=1,We=1<<M;for(ne=0,W=1,te=2;W<=M;++W,te<<=1){if(De+=St<<=1,0>(St-=ce[W]))return 0;for(;0<ce[W];--ce[W])(H=new j).g=W,H.value=ue[ne++],A(P,se+Ze,te,We,H),Ze=C(Ze,W)}for(W=M+1,te=2;15>=W;++W,te<<=1){if(De+=St<<=1,0>(St-=ce[W]))return 0;for(;0<ce[W];--ce[W]){if(H=new j,(Ze&Se)!=Ee){for(se+=We,_e=1<<(Ee=W)-M;15>Ee&&!(0>=(_e-=ce[Ee]));)++Ee,_e<<=1;ge+=We=1<<(_e=Ee-M),P[B+(Ee=Ze&Se)].g=_e+M,P[B+Ee].value=se-B-Ee}H.g=W-M,H.value=ue[ne++],A(P,se+(Ze>>M),te,We,H),Ze=C(Ze,W)}}return De!=2*ve[15]-1?0:ge})(u,d,v,y,N,L)}function j(){this.value=this.g=0}function $(){this.value=this.g=0}function V(){this.G=o(5,j),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Sa,$)}function oe(u,d,v,y){e(u!=null),e(d!=null),e(2147483648>y),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=d,u.pa=v,u.Jd=d,u.Yc=v+y,u.Zc=4<=y?v+y-4+1:v,he(u)}function le(u,d){for(var v=0;0<d--;)v|=me(u,128)<<d;return v}function ae(u,d){var v=le(u,d);return fe(u)?-v:v}function de(u,d,v,y){var N,L=0;for(e(u!=null),e(d!=null),e(4294967288>y),u.Sb=y,u.Ra=0,u.u=0,u.h=0,4<y&&(y=4),N=0;N<y;++N)L+=d[v+N]<<8*N;u.Ra=L,u.bb=y,u.oa=d,u.pa=v}function Le(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<Wi-8>>>0,++u.bb,u.u-=8;Y(u)&&(u.h=1,u.u=0)}function pe(u,d){if(e(0<=d),!u.h&&d<=br){var v=K(u)&vr[d];return u.u+=d,Le(u),v}return u.h=1,u.u=0}function I(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function K(u){return u.Ra>>>(u.u&Wi-1)>>>0}function Y(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>Wi}function Q(u,d){u.u=d,u.h=Y(u)}function re(u){u.u>=Ii&&(e(u.u>=Ii),Le(u))}function he(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function fe(u){return le(u,1)}function me(u,d){var v=u.Ca;0>u.b&&he(u);var y=u.b,N=v*d>>>8,L=(u.I>>>y>N)+0;for(L?(v-=N,u.I-=N+1<<y>>>0):v=N+1,y=v,N=0;256<=y;)N+=8,y>>=8;return y=7^N+Gi[y],u.b-=y,u.Ca=(v<<y)-1,L}function Ae(u,d,v){u[d+0]=v>>24&255,u[d+1]=v>>16&255,u[d+2]=v>>8&255,u[d+3]=255&v}function Oe(u,d){return u[d+0]|u[d+1]<<8}function Te(u,d){return Oe(u,d)|u[d+2]<<16}function Me(u,d){return Oe(u,d)|Oe(u,d+2)<<16}function q(u,d){var v=1<<d;return e(u!=null),e(0<d),u.X=i(v),u.X==null?0:(u.Mb=32-d,u.Xa=d,1)}function Ce(u,d){e(u!=null),e(d!=null),e(u.Xa==d.Xa),r(d.X,0,u.X,0,1<<d.Xa)}function dt(){this.X=[],this.Xa=this.Mb=0}function ze(u,d,v,y){e(v!=null),e(y!=null);var N=v[0],L=y[0];return N==0&&(N=(u*L+d/2)/d),L==0&&(L=(d*N+u/2)/u),0>=N||0>=L?0:(v[0]=N,y[0]=L,1)}function we(u,d){return u+(1<<d)-1>>>d}function Ke(u,d){return((4278255360&u)+(4278255360&d)>>>0&4278255360)+((16711935&u)+(16711935&d)>>>0&16711935)>>>0}function Re(u,d){F[d]=function(v,y,N,L,P,B,M){var H;for(H=0;H<P;++H){var te=F[u](B[M+H-1],N,L+H);B[M+H]=Ke(v[y+H],te)}}}function Qe(){this.ud=this.hd=this.jd=0}function Ie(u,d){return((4278124286&(u^d))>>>1)+(u&d)>>>0}function it(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function nt(u,d){return it(u+(u-d+.5>>1))}function at(u,d,v){return Math.abs(d-v)-Math.abs(u-v)}function ut(u,d,v,y,N,L,P){for(y=L[P-1],v=0;v<N;++v)L[P+v]=y=Ke(u[d+v],y)}function pt(u,d,v,y,N){var L;for(L=0;L<v;++L){var P=u[d+L],B=P>>8&255,M=16711935&(M=(M=16711935&P)+((B<<16)+B));y[N+L]=(4278255360&P)+M>>>0}}function $e(u,d){d.jd=255&u,d.hd=u>>8&255,d.ud=u>>16&255}function mt(u,d,v,y,N,L){var P;for(P=0;P<y;++P){var B=d[v+P],M=B>>>8,H=B,te=255&(te=(te=B>>>16)+((u.jd<<24>>24)*(M<<24>>24)>>>5));H=255&(H=(H+=(u.hd<<24>>24)*(M<<24>>24)>>>5)+((u.ud<<24>>24)*(te<<24>>24)>>>5)),N[L+P]=(4278255360&B)+(te<<16)+H}}function He(u,d,v,y,N){F[d]=function(L,P,B,M,H,te,ue,W,ne){for(M=ue;M<W;++M)for(ue=0;ue<ne;++ue)H[te++]=N(B[y(L[P++])])},F[u]=function(L,P,B,M,H,te,ue){var W=8>>L.b,ne=L.Ea,se=L.K[0],ge=L.w;if(8>W)for(L=(1<<L.b)-1,ge=(1<<W)-1;P<B;++P){var ce,ve=0;for(ce=0;ce<ne;++ce)ce&L||(ve=y(M[H++])),te[ue++]=N(se[ve&ge]),ve>>=W}else F["VP8LMapColor"+v](M,H,se,ge,te,ue,P,B,ne)}}function rn(u,d,v,y,N){for(v=d+v;d<v;){var L=u[d++];y[N++]=L>>16&255,y[N++]=L>>8&255,y[N++]=255&L}}function Et(u,d,v,y,N){for(v=d+v;d<v;){var L=u[d++];y[N++]=L>>16&255,y[N++]=L>>8&255,y[N++]=255&L,y[N++]=L>>24&255}}function bt(u,d,v,y,N){for(v=d+v;d<v;){var L=(P=u[d++])>>16&240|P>>12&15,P=240&P|P>>28&15;y[N++]=L,y[N++]=P}}function ct(u,d,v,y,N){for(v=d+v;d<v;){var L=(P=u[d++])>>16&248|P>>13&7,P=P>>5&224|P>>3&31;y[N++]=L,y[N++]=P}}function Dt(u,d,v,y,N){for(v=d+v;d<v;){var L=u[d++];y[N++]=255&L,y[N++]=L>>8&255,y[N++]=L>>16&255}}function et(u,d,v,y,N,L){if(L==0)for(v=d+v;d<v;)Ae(y,((L=u[d++])[0]>>24|L[1]>>8&65280|L[2]<<8&16711680|L[3]<<24)>>>0),N+=32;else r(y,N,u,d,v)}function Bt(u,d){F[d][0]=F[u+"0"],F[d][1]=F[u+"1"],F[d][2]=F[u+"2"],F[d][3]=F[u+"3"],F[d][4]=F[u+"4"],F[d][5]=F[u+"5"],F[d][6]=F[u+"6"],F[d][7]=F[u+"7"],F[d][8]=F[u+"8"],F[d][9]=F[u+"9"],F[d][10]=F[u+"10"],F[d][11]=F[u+"11"],F[d][12]=F[u+"12"],F[d][13]=F[u+"13"],F[d][14]=F[u+"0"],F[d][15]=F[u+"0"]}function st(u){return u==Ac||u==kc||u==Xo||u==Nc}function ht(){this.eb=[],this.size=this.A=this.fb=0}function Ut(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function kt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ht,this.f.kb=new Ut,this.sd=null}function tt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ft(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _i(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Ct(u,d){var v=u.T,y=d.ba.f.RGBA,N=y.eb,L=y.fb+u.ka*y.A,P=Mr[d.ba.S],B=u.y,M=u.O,H=u.f,te=u.N,ue=u.ea,W=u.W,ne=d.cc,se=d.dc,ge=d.Mc,ce=d.Nc,ve=u.ka,_e=u.ka+u.T,Ee=u.U,Se=Ee+1>>1;for(ve==0?P(B,M,null,null,H,te,ue,W,H,te,ue,W,N,L,null,null,Ee):(P(d.ec,d.fc,B,M,ne,se,ge,ce,H,te,ue,W,N,L-y.A,N,L,Ee),++v);ve+2<_e;ve+=2)ne=H,se=te,ge=ue,ce=W,te+=u.Rc,W+=u.Rc,L+=2*y.A,P(B,(M+=2*u.fa)-u.fa,B,M,ne,se,ge,ce,H,te,ue,W,N,L-y.A,N,L,Ee);return M+=u.fa,u.j+_e<u.o?(r(d.ec,d.fc,B,M,Ee),r(d.cc,d.dc,H,te,Se),r(d.Mc,d.Nc,ue,W,Se),v--):1&_e||P(B,M,null,null,H,te,ue,W,H,te,ue,W,N,L+y.A,null,null,Ee),v}function Gn(u,d,v){var y=u.F,N=[u.J];if(y!=null){var L=u.U,P=d.ba.S,B=P==Yo||P==Xo;d=d.ba.f.RGBA;var M=[0],H=u.ka;M[0]=u.T,u.Kb&&(H==0?--M[0]:(--H,N[0]-=u.width),u.j+u.ka+u.T==u.o&&(M[0]=u.o-u.j-H));var te=d.eb;H=d.fb+H*d.A,u=Fh(y,N[0],u.width,L,M,te,H+(B?0:3),d.A),e(v==M),u&&st(P)&&Vs(te,H,B,L,M,d.A)}return 0}function Tr(u){var d=u.ma,v=d.ba.S,y=11>v,N=v==Ko||v==Jo||v==Yo||v==Sc||v==12||st(v);if(d.memory=null,d.Ib=null,d.Jb=null,d.Nd=null,!Ms(d.Oa,u,N?11:12))return 0;if(N&&st(v)&&Ds(),u.da)alert("todo:use_scaling");else{if(y){if(d.Ib=_i,u.Kb){if(v=u.U+1>>1,d.memory=i(u.U+2*v),d.memory==null)return 0;d.ec=d.memory,d.fc=0,d.cc=d.ec,d.dc=d.fc+u.U,d.Mc=d.cc,d.Nc=d.dc+v,d.Ib=Ct,Ds()}}else alert("todo:EmitYUV");N&&(d.Jb=Gn,y&&Hr())}if(y&&!Xh){for(u=0;256>u;++u)Lm[u]=89858*(u-128)+Qo>>Zo,Im[u]=-22014*(u-128)+Qo,Tm[u]=-45773*(u-128),Cm[u]=113618*(u-128)+Qo>>Zo;for(u=Js;u<Cc;++u)d=76283*(u-16)+Qo>>Zo,Pm[u-Js]=oi(d,255),Om[u-Js]=oi(d+8>>4,15);Xh=1}return 1}function rt(u){var d=u.ma,v=u.U,y=u.T;return e(!(1&u.ka)),0>=v||0>=y?0:(v=d.Ib(u,d),d.Jb!=null&&d.Jb(u,d,v),d.Dc+=v,1)}function mr(u){u.ma.memory=null}function Ir(u,d,v,y){return pe(u,8)!=47?0:(d[0]=pe(u,14)+1,v[0]=pe(u,14)+1,y[0]=pe(u,1),pe(u,3)!=0?0:!u.h)}function Qn(u,d){if(4>u)return u+1;var v=u-2>>1;return(2+(1&u)<<v)+pe(d,v)+1}function cr(u,d){return 120<d?d-120:1<=(v=((v=pm[d-1])>>4)*u+(8-(15&v)))?v:1;var v}function Pt(u,d,v){var y=K(v),N=u[d+=255&y].g-8;return 0<N&&(Q(v,v.u+8),y=K(v),d+=u[d].value,d+=y&(1<<N)-1),Q(v,v.u+u[d].g),u[d].value}function Yt(u,d,v){return v.g+=u.g,v.value+=u.value<<d>>>0,e(8>=v.g),u.g}function xn(u,d,v){var y=u.xc;return e((d=y==0?0:u.vc[u.md*(v>>y)+(d>>y)])<u.Wb),u.Ya[d]}function ai(u,d,v,y){var N=u.ab,L=u.c*d,P=u.C;d=P+d;var B=v,M=y;for(y=u.Ta,v=u.Ua;0<N--;){var H=u.gc[N],te=P,ue=d,W=B,ne=M,se=(M=y,B=v,H.Ea);switch(e(te<ue),e(ue<=H.nc),H.hc){case 2:gn(W,ne,(ue-te)*se,M,B);break;case 0:var ge=te,ce=ue,ve=M,_e=B,Ee=(We=H).Ea;ge==0&&(qs(W,ne,null,null,1,ve,_e),ut(W,ne+1,0,0,Ee-1,ve,_e+1),ne+=Ee,_e+=Ee,++ge);for(var Se=1<<We.b,Ze=Se-1,De=we(Ee,We.b),St=We.K,We=We.w+(ge>>We.b)*De;ge<ce;){var Tt=St,On=We,At=1;for(Qa(W,ne,ve,_e-Ee,1,ve,_e);At<Ee;){var Ge=(At&~Ze)+Se;Ge>Ee&&(Ge=Ee),(0,zs[Tt[On++]>>8&15])(W,ne+ +At,ve,_e+At-Ee,Ge-At,ve,_e+At),At=Ge}ne+=Ee,_e+=Ee,++ge&Ze||(We+=De)}ue!=H.nc&&r(M,B-se,M,B+(ue-te-1)*se,se);break;case 1:for(se=W,ce=ne,Ee=(W=H.Ea)-(_e=W&~(ve=(ne=1<<H.b)-1)),ge=we(W,H.b),Se=H.K,H=H.w+(te>>H.b)*ge;te<ue;){for(Ze=Se,De=H,St=new Qe,We=ce+_e,Tt=ce+W;ce<We;)$e(Ze[De++],St),Hs(St,se,ce,ne,M,B),ce+=ne,B+=ne;ce<Tt&&($e(Ze[De++],St),Hs(St,se,ce,Ee,M,B),ce+=Ee,B+=Ee),++te&ve||(H+=ge)}break;case 3:if(W==M&&ne==B&&0<H.b){for(ce=M,W=se=B+(ue-te)*se-(_e=(ue-te)*we(H.Ea,H.b)),ne=M,ve=B,ge=[],_e=(Ee=_e)-1;0<=_e;--_e)ge[_e]=ne[ve+_e];for(_e=Ee-1;0<=_e;--_e)ce[W+_e]=ge[_e];Ho(H,te,ue,M,se,M,B)}else Ho(H,te,ue,W,ne,M,B)}B=y,M=v}M!=v&&r(y,v,B,M,L)}function Pr(u,d){var v=u.V,y=u.Ba+u.c*u.C,N=d-u.C;if(e(d<=u.l.o),e(16>=N),0<N){var L=u.l,P=u.Ta,B=u.Ua,M=L.width;if(ai(u,N,v,y),N=B=[B],e((v=u.C)<(y=d)),e(L.v<L.va),y>L.o&&(y=L.o),v<L.j){var H=L.j-v;v=L.j,N[0]+=H*M}if(v>=y?v=0:(N[0]+=4*L.v,L.ka=v-L.j,L.U=L.va-L.v,L.T=y-v,v=1),v){if(B=B[0],11>(v=u.ca).S){var te=v.f.RGBA,ue=(y=v.S,N=L.U,L=L.T,H=te.eb,te.A),W=L;for(te=te.fb+u.Ma*te.A;0<W--;){var ne=P,se=B,ge=N,ce=H,ve=te;switch(y){case Vo:Ws(ne,se,ge,ce,ve);break;case Ko:Vi(ne,se,ge,ce,ve);break;case Ac:Vi(ne,se,ge,ce,ve),Vs(ce,ve,0,ge,1,0);break;case $h:Aa(ne,se,ge,ce,ve);break;case Jo:et(ne,se,ge,ce,ve,1);break;case kc:et(ne,se,ge,ce,ve,1),Vs(ce,ve,0,ge,1,0);break;case Yo:et(ne,se,ge,ce,ve,0);break;case Xo:et(ne,se,ge,ce,ve,0),Vs(ce,ve,1,ge,1,0);break;case Sc:Ki(ne,se,ge,ce,ve);break;case Nc:Ki(ne,se,ge,ce,ve),Rh(ce,ve,ge,1,0);break;case zh:Ji(ne,se,ge,ce,ve);break;default:e(0)}B+=M,te+=ue}u.Ma+=L}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=v.height)}}u.C=d,e(u.C<=u.i)}function ur(u){var d;if(0<u.ua)return 0;for(d=0;d<u.Wb;++d){var v=u.Ya[d].G,y=u.Ya[d].H;if(0<v[1][y[1]+0].g||0<v[2][y[2]+0].g||0<v[3][y[3]+0].g)return 0}return 1}function Sn(u,d,v,y,N,L){if(u.Z!=0){var P=u.qd,B=u.rd;for(e(Zi[u.Z]!=null);d<v;++d)Zi[u.Z](P,B,y,N,y,N,L),P=y,B=N,N+=L;u.qd=P,u.rd=B}}function hr(u,d){var v=u.l.ma,y=v.Z==0||v.Z==1?u.l.j:u.C;if(y=u.C<y?y:u.C,e(d<=u.l.o),d>y){var N=u.l.width,L=v.ca,P=v.tb+N*y,B=u.V,M=u.Ba+u.c*y,H=u.gc;e(u.ab==1),e(H[0].hc==3),hi(H[0],y,d,B,M,L,P),Sn(v,y,d,L,P,N)}u.C=u.Ma=d}function dr(u,d,v,y,N,L,P){var B=u.$/y,M=u.$%y,H=u.m,te=u.s,ue=v+u.$,W=ue;N=v+y*N;var ne=v+y*L,se=280+te.ua,ge=u.Pb?B:16777216,ce=0<te.ua?te.Wa:null,ve=te.wc,_e=ue<ne?xn(te,M,B):null;e(u.C<L),e(ne<=N);var Ee=!1;e:for(;;){for(;Ee||ue<ne;){var Se=0;if(B>=ge){var Ze=ue-v;e((ge=u).Pb),ge.wd=ge.m,ge.xd=Ze,0<ge.s.ua&&Ce(ge.s.Wa,ge.s.vb),ge=B+mm}if(M&ve||(_e=xn(te,M,B)),e(_e!=null),_e.Qb&&(d[ue]=_e.qb,Ee=!0),!Ee)if(re(H),_e.jc){Se=H,Ze=d;var De=ue,St=_e.pd[K(Se)&Sa-1];e(_e.jc),256>St.g?(Q(Se,Se.u+St.g),Ze[De]=St.value,Se=0):(Q(Se,Se.u+St.g-256),e(256<=St.value),Se=St.value),Se==0&&(Ee=!0)}else Se=Pt(_e.G[0],_e.H[0],H);if(H.h)break;if(Ee||256>Se){if(!Ee)if(_e.nd)d[ue]=(_e.qb|Se<<8)>>>0;else{if(re(H),Ee=Pt(_e.G[1],_e.H[1],H),re(H),Ze=Pt(_e.G[2],_e.H[2],H),De=Pt(_e.G[3],_e.H[3],H),H.h)break;d[ue]=(De<<24|Ee<<16|Se<<8|Ze)>>>0}if(Ee=!1,++ue,++M>=y&&(M=0,++B,P!=null&&B<=L&&!(B%16)&&P(u,B),ce!=null))for(;W<ue;)Se=d[W++],ce.X[(506832829*Se&4294967295)>>>ce.Mb]=Se}else if(280>Se){if(Se=Qn(Se-256,H),Ze=Pt(_e.G[4],_e.H[4],H),re(H),Ze=cr(y,Ze=Qn(Ze,H)),H.h)break;if(ue-v<Ze||N-ue<Se)break e;for(De=0;De<Se;++De)d[ue+De]=d[ue+De-Ze];for(ue+=Se,M+=Se;M>=y;)M-=y,++B,P!=null&&B<=L&&!(B%16)&&P(u,B);if(e(ue<=N),M&ve&&(_e=xn(te,M,B)),ce!=null)for(;W<ue;)Se=d[W++],ce.X[(506832829*Se&4294967295)>>>ce.Mb]=Se}else{if(!(Se<se))break e;for(Ee=Se-280,e(ce!=null);W<ue;)Se=d[W++],ce.X[(506832829*Se&4294967295)>>>ce.Mb]=Se;Se=ue,e(!(Ee>>>(Ze=ce).Xa)),d[Se]=Ze.X[Ee],Ee=!0}Ee||e(H.h==Y(H))}if(u.Pb&&H.h&&ue<N)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&Ce(u.s.vb,u.s.Wa);else{if(H.h)break e;P!=null&&P(u,B>L?L:B),u.a=0,u.$=ue-v}return 1}return u.a=3,0}function er(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var d=u.Wa;d!=null&&(d.X=null),u.vb=null,e(u!=null)}function si(){var u=new gt;return u==null?null:(u.a=0,u.xb=Gh,Bt("Predictor","VP8LPredictors"),Bt("Predictor","VP8LPredictors_C"),Bt("PredictorAdd","VP8LPredictorsAdd"),Bt("PredictorAdd","VP8LPredictorsAdd_C"),gn=pt,Hs=mt,Ws=rn,Vi=Et,Ki=bt,Ji=ct,Aa=Dt,F.VP8LMapColor32b=ui,F.VP8LMapColor8b=$s,u)}function Or(u,d,v,y,N){var L=1,P=[u],B=[d],M=y.m,H=y.s,te=null,ue=0;e:for(;;){if(v)for(;L&&pe(M,1);){var W=P,ne=B,se=y,ge=1,ce=se.m,ve=se.gc[se.ab],_e=pe(ce,2);if(se.Oc&1<<_e)L=0;else{switch(se.Oc|=1<<_e,ve.hc=_e,ve.Ea=W[0],ve.nc=ne[0],ve.K=[null],++se.ab,e(4>=se.ab),_e){case 0:case 1:ve.b=pe(ce,3)+2,ge=Or(we(ve.Ea,ve.b),we(ve.nc,ve.b),0,se,ve.K),ve.K=ve.K[0];break;case 3:var Ee,Se=pe(ce,8)+1,Ze=16<Se?0:4<Se?1:2<Se?2:3;if(W[0]=we(ve.Ea,Ze),ve.b=Ze,Ee=ge=Or(Se,1,0,se,ve.K)){var De,St=Se,We=ve,Tt=1<<(8>>We.b),On=i(Tt);if(On==null)Ee=0;else{var At=We.K[0],Ge=We.w;for(On[0]=We.K[0][0],De=1;De<1*St;++De)On[De]=Ke(At[Ge+De],On[De-1]);for(;De<4*Tt;++De)On[De]=0;We.K[0]=null,We.K[0]=On,Ee=1}}ge=Ee;break;case 2:break;default:e(0)}L=ge}}if(P=P[0],B=B[0],L&&pe(M,1)&&!(L=1<=(ue=pe(M,4))&&11>=ue)){y.a=3;break e}var Pe;if(Pe=L)t:{var vn,_t,It,tn=y,qn=P,nr=B,hn=ue,Vn=v,rr=tn.m,Rn=tn.s,Rt=[null],qt=1,dn=0,$t=gm[hn];n:for(;;){if(Vn&&pe(rr,1)){var $n=pe(rr,3)+2,Gr=we(qn,$n),bn=we(nr,$n),fr=Gr*bn;if(!Or(Gr,bn,0,tn,Rt))break n;for(Rt=Rt[0],Rn.xc=$n,vn=0;vn<fr;++vn){var Vt=Rt[vn]>>8&65535;Rt[vn]=Vt,Vt>=qt&&(qt=Vt+1)}}if(rr.h)break n;for(_t=0;5>_t;++_t){var Fn=Hh[_t];!_t&&0<hn&&(Fn+=1<<hn),dn<Fn&&(dn=Fn)}var _r=o(qt*$t,j),ir=qt,wr=o(ir,V);if(wr==null)var xr=null;else e(65536>=ir),xr=wr;var pr=i(dn);if(xr==null||pr==null||_r==null){tn.a=1;break n}var Sr=_r;for(vn=It=0;vn<qt;++vn){var Zt=xr[vn],Ar=Zt.G,Vr=Zt.H,Na=0,Ri=1,zn=0;for(_t=0;5>_t;++_t){Fn=Hh[_t],Ar[_t]=Sr,Vr[_t]=It,!_t&&0<hn&&(Fn+=1<<hn);i:{var tl,Tc=Fn,nl=tn,Ys=pr,Dm=Sr,jm=It,Ic=0,Qi=nl.m,Bm=pe(Qi,1);if(a(Ys,0,0,Tc),Bm){var Mm=pe(Qi,1)+1,Um=pe(Qi,1),ed=pe(Qi,Um==0?1:8);Ys[ed]=1,Mm==2&&(Ys[ed=pe(Qi,8)]=1);var rl=1}else{var td=i(19),nd=pe(Qi,4)+4;if(19<nd){nl.a=3;var il=0;break i}for(tl=0;tl<nd;++tl)td[fm[tl]]=pe(Qi,3);var Pc=void 0,Xs=void 0,rd=nl,qm=td,al=Tc,id=Ys,Oc=0,ea=rd.m,ad=8,sd=o(128,j);r:for(;D(sd,0,7,qm,19);){if(pe(ea,1)){var $m=2+2*pe(ea,3);if((Pc=2+pe(ea,$m))>al)break r}else Pc=al;for(Xs=0;Xs<al&&Pc--;){re(ea);var od=sd[0+(127&K(ea))];Q(ea,ea.u+od.g);var ts=od.value;if(16>ts)id[Xs++]=ts,ts!=0&&(ad=ts);else{var zm=ts==16,ld=ts-16,Hm=hm[ld],cd=pe(ea,um[ld])+Hm;if(Xs+cd>al)break r;for(var Wm=zm?ad:0;0<cd--;)id[Xs++]=Wm}}Oc=1;break r}Oc||(rd.a=3),rl=Oc}(rl=rl&&!Qi.h)&&(Ic=D(Dm,jm,8,Ys,Tc)),rl&&Ic!=0?il=Ic:(nl.a=3,il=0)}if(il==0)break n;if(Ri&&dm[_t]==1&&(Ri=Sr[It].g==0),Na+=Sr[It].g,It+=il,3>=_t){var Zs,Rc=pr[0];for(Zs=1;Zs<Fn;++Zs)pr[Zs]>Rc&&(Rc=pr[Zs]);zn+=Rc}}if(Zt.nd=Ri,Zt.Qb=0,Ri&&(Zt.qb=(Ar[3][Vr[3]+0].value<<24|Ar[1][Vr[1]+0].value<<16|Ar[2][Vr[2]+0].value)>>>0,Na==0&&256>Ar[0][Vr[0]+0].value&&(Zt.Qb=1,Zt.qb+=Ar[0][Vr[0]+0].value<<8)),Zt.jc=!Zt.Qb&&6>zn,Zt.jc){var sl,Fi=Zt;for(sl=0;sl<Sa;++sl){var ta=sl,na=Fi.pd[ta],ol=Fi.G[0][Fi.H[0]+ta];256<=ol.value?(na.g=ol.g+256,na.value=ol.value):(na.g=0,na.value=0,ta>>=Yt(ol,8,na),ta>>=Yt(Fi.G[1][Fi.H[1]+ta],16,na),ta>>=Yt(Fi.G[2][Fi.H[2]+ta],0,na),Yt(Fi.G[3][Fi.H[3]+ta],24,na))}}}Rn.vc=Rt,Rn.Wb=qt,Rn.Ya=xr,Rn.yc=_r,Pe=1;break t}Pe=0}if(!(L=Pe)){y.a=3;break e}if(0<ue){if(H.ua=1<<ue,!q(H.Wa,ue)){y.a=1,L=0;break e}}else H.ua=0;var Fc=y,ud=P,Gm=B,Dc=Fc.s,jc=Dc.xc;if(Fc.c=ud,Fc.i=Gm,Dc.md=we(ud,jc),Dc.wc=jc==0?-1:(1<<jc)-1,v){y.xb=Sm;break e}if((te=i(P*B))==null){y.a=1,L=0;break e}L=(L=dr(y,te,0,P,B,B,null))&&!M.h;break e}return L?(N!=null?N[0]=te:(e(te==null),e(v)),y.$=0,v||er(H)):er(H),L}function Ue(u,d){var v=u.c*u.i,y=v+d+16*d;return e(u.c<=d),u.V=i(y),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+v+d,1)}function ee(u,d){var v=u.C,y=d-v,N=u.V,L=u.Ba+u.c*v;for(e(d<=u.l.o);0<y;){var P=16<y?16:y,B=u.l.ma,M=u.l.width,H=M*P,te=B.ca,ue=B.tb+M*v,W=u.Ta,ne=u.Ua;ai(u,P,N,L),Dh(W,ne,te,ue,H),Sn(B,v,v+P,te,ue,M),y-=P,N+=P*u.c,v+=P}e(v==d),u.C=u.Ma=d}function Ne(){this.ub=this.yd=this.td=this.Rb=0}function Fe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Wt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function cn(){this.Yb=(function(){var u=[];return(function d(v,y,N){for(var L=N[y],P=0;P<L&&(v.push(N.length>y+1?[]:0),!(N.length<y+1));P++)d(v[P],y+1,N)})(u,0,[3,11]),u})()}function en(){this.jb=i(3),this.Wc=l([4,8],cn),this.Xc=l([4,17],cn)}function Cn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function un(){this.ld=this.La=this.dd=this.tc=0}function Rr(){this.Na=this.la=0}function qi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function sn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ha(){this.uc=this.M=this.Nb=0,this.wa=Array(new un),this.Y=0,this.ya=Array(new sn),this.aa=0,this.l=new Ga}function da(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Io(){this.cb=this.a=0,this.sc="",this.m=new I,this.Od=new Ne,this.Kc=new Fe,this.ed=new Cn,this.Qa=new Wt,this.Ic=this.$c=this.Aa=0,this.D=new ha,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,I),this.ia=0,this.pb=o(4,qi),this.Pa=new en,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new da),this.Hd=0,this.rb=Array(new Rr),this.sb=0,this.wa=Array(new un),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new sn),this.L=this.aa=0,this.gd=l([4,2],un),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function oi(u,d){return 0>u?0:u>d?d:u}function Ga(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function oc(){var u=new Io;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,Ks||(Ks=Va)),u}function An(u,d,v){return u.a==0&&(u.a=d,u.sc=v,u.cb=0),0}function Po(u,d,v){return 3<=v&&u[d+0]==157&&u[d+1]==1&&u[d+2]==42}function li(u,d){if(u==null)return 0;if(u.a=0,u.sc="OK",d==null)return An(u,2,"null VP8Io passed to VP8GetHeaders()");var v=d.data,y=d.w,N=d.ha;if(4>N)return An(u,7,"Truncated header.");var L=v[y+0]|v[y+1]<<8|v[y+2]<<16,P=u.Od;if(P.Rb=!(1&L),P.td=L>>1&7,P.yd=L>>4&1,P.ub=L>>5,3<P.td)return An(u,3,"Incorrect keyframe parameters.");if(!P.yd)return An(u,4,"Frame not displayable.");y+=3,N-=3;var B=u.Kc;if(P.Rb){if(7>N)return An(u,7,"cannot parse picture header");if(!Po(v,y,N))return An(u,3,"Bad code word");B.c=16383&(v[y+4]<<8|v[y+3]),B.Td=v[y+4]>>6,B.i=16383&(v[y+6]<<8|v[y+5]),B.Ud=v[y+6]>>6,y+=7,N-=7,u.za=B.c+15>>4,u.Ub=B.i+15>>4,d.width=B.c,d.height=B.i,d.Da=0,d.j=0,d.v=0,d.va=d.width,d.o=d.height,d.da=0,d.ib=d.width,d.hb=d.height,d.U=d.width,d.T=d.height,a((L=u.Pa).jb,0,255,L.jb.length),e((L=u.Qa)!=null),L.Cb=0,L.Bb=0,L.Fb=1,a(L.Zb,0,0,L.Zb.length),a(L.Lb,0,0,L.Lb)}if(P.ub>N)return An(u,7,"bad partition length");oe(L=u.m,v,y,P.ub),y+=P.ub,N-=P.ub,P.Rb&&(B.Ld=fe(L),B.Kd=fe(L)),B=u.Qa;var M,H=u.Pa;if(e(L!=null),e(B!=null),B.Cb=fe(L),B.Cb){if(B.Bb=fe(L),fe(L)){for(B.Fb=fe(L),M=0;4>M;++M)B.Zb[M]=fe(L)?ae(L,7):0;for(M=0;4>M;++M)B.Lb[M]=fe(L)?ae(L,6):0}if(B.Bb)for(M=0;3>M;++M)H.jb[M]=fe(L)?le(L,8):255}else B.Bb=0;if(L.Ka)return An(u,3,"cannot parse segment header");if((B=u.ed).zd=fe(L),B.Tb=le(L,6),B.wb=le(L,3),B.Pc=fe(L),B.Pc&&fe(L)){for(H=0;4>H;++H)fe(L)&&(B.vd[H]=ae(L,6));for(H=0;4>H;++H)fe(L)&&(B.od[H]=ae(L,6))}if(u.L=B.Tb==0?0:B.zd?1:2,L.Ka)return An(u,3,"cannot parse filter header");var te=N;if(N=M=y,y=M+te,B=te,u.Xb=(1<<le(u.m,2))-1,te<3*(H=u.Xb))v=7;else{for(M+=3*H,B-=3*H,te=0;te<H;++te){var ue=v[N+0]|v[N+1]<<8|v[N+2]<<16;ue>B&&(ue=B),oe(u.Jc[+te],v,M,ue),M+=ue,B-=ue,N+=3}oe(u.Jc[+H],v,M,B),v=M<y?0:5}if(v!=0)return An(u,v,"cannot parse partitions");for(v=le(M=u.m,7),N=fe(M)?ae(M,4):0,y=fe(M)?ae(M,4):0,B=fe(M)?ae(M,4):0,H=fe(M)?ae(M,4):0,M=fe(M)?ae(M,4):0,te=u.Qa,ue=0;4>ue;++ue){if(te.Cb){var W=te.Zb[ue];te.Fb||(W+=v)}else{if(0<ue){u.pb[ue]=u.pb[0];continue}W=v}var ne=u.pb[ue];ne.Sc[0]=Ec[oi(W+N,127)],ne.Sc[1]=Lc[oi(W+0,127)],ne.Eb[0]=2*Ec[oi(W+y,127)],ne.Eb[1]=101581*Lc[oi(W+B,127)]>>16,8>ne.Eb[1]&&(ne.Eb[1]=8),ne.Qc[0]=Ec[oi(W+H,117)],ne.Qc[1]=Lc[oi(W+M,127)],ne.lc=W+M}if(!P.Rb)return An(u,4,"Not a key frame.");for(fe(L),P=u.Pa,v=0;4>v;++v){for(N=0;8>N;++N)for(y=0;3>y;++y)for(B=0;11>B;++B)H=me(L,wm[v][N][y][B])?le(L,8):ym[v][N][y][B],P.Wc[v][N].Yb[y][B]=H;for(N=0;17>N;++N)P.Xc[v][N]=P.Wc[v][xm[N]]}return u.kc=fe(L),u.kc&&(u.Bd=le(L,8)),u.cb=1}function Va(u,d,v,y,N,L,P){var B=d[N].Yb[v];for(v=0;16>N;++N){if(!me(u,B[v+0]))return N;for(;!me(u,B[v+1]);)if(B=d[++N].Yb[0],v=0,N==16)return 16;var M=d[N+1].Yb;if(me(u,B[v+2])){var H=u,te=0;if(me(H,(W=B)[(ue=v)+3]))if(me(H,W[ue+6])){for(B=0,ue=2*(te=me(H,W[ue+8]))+(W=me(H,W[ue+9+te])),te=0,W=vm[ue];W[B];++B)te+=te+me(H,W[B]);te+=3+(8<<ue)}else me(H,W[ue+7])?(te=7+2*me(H,165),te+=me(H,145)):te=5+me(H,159);else te=me(H,W[ue+4])?3+me(H,W[ue+5]):2;B=M[2]}else te=1,B=M[1];M=P+bm[N],0>(H=u).b&&he(H);var ue,W=H.b,ne=(ue=H.Ca>>1)-(H.I>>W)>>31;--H.b,H.Ca+=ne,H.Ca|=1,H.I-=(ue+1&ne)<<W,L[M]=((te^ne)-ne)*y[(0<N)+0]}return 16}function Oo(u){var d=u.rb[u.sb-1];d.la=0,d.Na=0,a(u.zc,0,0,u.zc.length),u.ja=0}function Fr(u,d,v,y,N){N=u[d+v+32*y]+(N>>3),u[d+v+32*y]=-256&N?0>N?0:255:N}function Tn(u,d,v,y,N,L){Fr(u,d,0,v,y+N),Fr(u,d,1,v,y+L),Fr(u,d,2,v,y-L),Fr(u,d,3,v,y-N)}function wi(u){return(20091*u>>16)+u}function Ro(u,d,v,y){var N,L=0,P=i(16);for(N=0;4>N;++N){var B=u[d+0]+u[d+8],M=u[d+0]-u[d+8],H=(35468*u[d+4]>>16)-wi(u[d+12]),te=wi(u[d+4])+(35468*u[d+12]>>16);P[L+0]=B+te,P[L+1]=M+H,P[L+2]=M-H,P[L+3]=B-te,L+=4,d++}for(N=L=0;4>N;++N)B=(u=P[L+0]+4)+P[L+8],M=u-P[L+8],H=(35468*P[L+4]>>16)-wi(P[L+12]),Fr(v,y,0,0,B+(te=wi(P[L+4])+(35468*P[L+12]>>16))),Fr(v,y,1,0,M+H),Fr(v,y,2,0,M-H),Fr(v,y,3,0,B-te),L++,y+=32}function lc(u,d,v,y){var N=u[d+0]+4,L=35468*u[d+4]>>16,P=wi(u[d+4]),B=35468*u[d+1]>>16;Tn(v,y,0,N+P,u=wi(u[d+1]),B),Tn(v,y,1,N+L,u,B),Tn(v,y,2,N-L,u,B),Tn(v,y,3,N-P,u,B)}function cc(u,d,v,y,N){Ro(u,d,v,y),N&&Ro(u,d+16,v,y+4)}function ci(u,d,v,y){ka(u,d+0,v,y,1),ka(u,d+32,v,y+128,1)}function Fo(u,d,v,y){var N;for(u=u[d+0]+4,N=0;4>N;++N)for(d=0;4>d;++d)Fr(v,y,d,N,u)}function Do(u,d,v,y){u[d+0]&&Mt(u,d+0,v,y),u[d+16]&&Mt(u,d+16,v,y+4),u[d+32]&&Mt(u,d+32,v,y+128),u[d+48]&&Mt(u,d+48,v,y+128+4)}function Ka(u,d,v,y){var N,L=i(16);for(N=0;4>N;++N){var P=u[d+0+N]+u[d+12+N],B=u[d+4+N]+u[d+8+N],M=u[d+4+N]-u[d+8+N],H=u[d+0+N]-u[d+12+N];L[0+N]=P+B,L[8+N]=P-B,L[4+N]=H+M,L[12+N]=H-M}for(N=0;4>N;++N)P=(u=L[0+4*N]+3)+L[3+4*N],B=L[1+4*N]+L[2+4*N],M=L[1+4*N]-L[2+4*N],H=u-L[3+4*N],v[y+0]=P+B>>3,v[y+16]=H+M>>3,v[y+32]=P-B>>3,v[y+48]=H-M>>3,y+=64}function fa(u,d,v){var y,N=d-32,L=yr,P=255-u[N-1];for(y=0;y<v;++y){var B,M=L,H=P+u[d-1];for(B=0;B<v;++B)u[d+B]=M[H+u[N+B]];d+=32}}function uc(u,d){fa(u,d,4)}function hc(u,d){fa(u,d,8)}function dc(u,d){fa(u,d,16)}function Ls(u,d){var v;for(v=0;16>v;++v)r(u,d+32*v,u,d-32,16)}function jo(u,d){var v;for(v=16;0<v;--v)a(u,d,u[d-1],16),d+=32}function zr(u,d,v){var y;for(y=0;16>y;++y)a(d,v+32*y,u,16)}function fc(u,d){var v,y=16;for(v=0;16>v;++v)y+=u[d-1+32*v]+u[d+v-32];zr(y>>5,u,d)}function pa(u,d){var v,y=8;for(v=0;16>v;++v)y+=u[d-1+32*v];zr(y>>4,u,d)}function Cs(u,d){var v,y=8;for(v=0;16>v;++v)y+=u[d+v-32];zr(y>>4,u,d)}function pc(u,d){zr(128,u,d)}function vt(u,d,v){return u+2*d+v+2>>2}function gc(u,d){var v,y=d-32;for(y=new Uint8Array([vt(u[y-1],u[y+0],u[y+1]),vt(u[y+0],u[y+1],u[y+2]),vt(u[y+1],u[y+2],u[y+3]),vt(u[y+2],u[y+3],u[y+4])]),v=0;4>v;++v)r(u,d+32*v,y,0,y.length)}function mc(u,d){var v=u[d-1],y=u[d-1+32],N=u[d-1+64],L=u[d-1+96];Ae(u,d+0,16843009*vt(u[d-1-32],v,y)),Ae(u,d+32,16843009*vt(v,y,N)),Ae(u,d+64,16843009*vt(y,N,L)),Ae(u,d+96,16843009*vt(N,L,L))}function vc(u,d){var v,y=4;for(v=0;4>v;++v)y+=u[d+v-32]+u[d-1+32*v];for(y>>=3,v=0;4>v;++v)a(u,d+32*v,y,4)}function xi(u,d){var v=u[d-1+0],y=u[d-1+32],N=u[d-1+64],L=u[d-1-32],P=u[d+0-32],B=u[d+1-32],M=u[d+2-32],H=u[d+3-32];u[d+0+96]=vt(y,N,u[d-1+96]),u[d+1+96]=u[d+0+64]=vt(v,y,N),u[d+2+96]=u[d+1+64]=u[d+0+32]=vt(L,v,y),u[d+3+96]=u[d+2+64]=u[d+1+32]=u[d+0+0]=vt(P,L,v),u[d+3+64]=u[d+2+32]=u[d+1+0]=vt(B,P,L),u[d+3+32]=u[d+2+0]=vt(M,B,P),u[d+3+0]=vt(H,M,B)}function Si(u,d){var v=u[d+1-32],y=u[d+2-32],N=u[d+3-32],L=u[d+4-32],P=u[d+5-32],B=u[d+6-32],M=u[d+7-32];u[d+0+0]=vt(u[d+0-32],v,y),u[d+1+0]=u[d+0+32]=vt(v,y,N),u[d+2+0]=u[d+1+32]=u[d+0+64]=vt(y,N,L),u[d+3+0]=u[d+2+32]=u[d+1+64]=u[d+0+96]=vt(N,L,P),u[d+3+32]=u[d+2+64]=u[d+1+96]=vt(L,P,B),u[d+3+64]=u[d+2+96]=vt(P,B,M),u[d+3+96]=vt(B,M,M)}function bc(u,d){var v=u[d-1+0],y=u[d-1+32],N=u[d-1+64],L=u[d-1-32],P=u[d+0-32],B=u[d+1-32],M=u[d+2-32],H=u[d+3-32];u[d+0+0]=u[d+1+64]=L+P+1>>1,u[d+1+0]=u[d+2+64]=P+B+1>>1,u[d+2+0]=u[d+3+64]=B+M+1>>1,u[d+3+0]=M+H+1>>1,u[d+0+96]=vt(N,y,v),u[d+0+64]=vt(y,v,L),u[d+0+32]=u[d+1+96]=vt(v,L,P),u[d+1+32]=u[d+2+96]=vt(L,P,B),u[d+2+32]=u[d+3+96]=vt(P,B,M),u[d+3+32]=vt(B,M,H)}function yc(u,d){var v=u[d+0-32],y=u[d+1-32],N=u[d+2-32],L=u[d+3-32],P=u[d+4-32],B=u[d+5-32],M=u[d+6-32],H=u[d+7-32];u[d+0+0]=v+y+1>>1,u[d+1+0]=u[d+0+64]=y+N+1>>1,u[d+2+0]=u[d+1+64]=N+L+1>>1,u[d+3+0]=u[d+2+64]=L+P+1>>1,u[d+0+32]=vt(v,y,N),u[d+1+32]=u[d+0+96]=vt(y,N,L),u[d+2+32]=u[d+1+96]=vt(N,L,P),u[d+3+32]=u[d+2+96]=vt(L,P,B),u[d+3+64]=vt(P,B,M),u[d+3+96]=vt(B,M,H)}function Ja(u,d){var v=u[d-1+0],y=u[d-1+32],N=u[d-1+64],L=u[d-1+96];u[d+0+0]=v+y+1>>1,u[d+2+0]=u[d+0+32]=y+N+1>>1,u[d+2+32]=u[d+0+64]=N+L+1>>1,u[d+1+0]=vt(v,y,N),u[d+3+0]=u[d+1+32]=vt(y,N,L),u[d+3+32]=u[d+1+64]=vt(N,L,L),u[d+3+64]=u[d+2+64]=u[d+0+96]=u[d+1+96]=u[d+2+96]=u[d+3+96]=L}function Ts(u,d){var v=u[d-1+0],y=u[d-1+32],N=u[d-1+64],L=u[d-1+96],P=u[d-1-32],B=u[d+0-32],M=u[d+1-32],H=u[d+2-32];u[d+0+0]=u[d+2+32]=v+P+1>>1,u[d+0+32]=u[d+2+64]=y+v+1>>1,u[d+0+64]=u[d+2+96]=N+y+1>>1,u[d+0+96]=L+N+1>>1,u[d+3+0]=vt(B,M,H),u[d+2+0]=vt(P,B,M),u[d+1+0]=u[d+3+32]=vt(v,P,B),u[d+1+32]=u[d+3+64]=vt(y,v,P),u[d+1+64]=u[d+3+96]=vt(N,y,v),u[d+1+96]=vt(L,N,y)}function ga(u,d){var v;for(v=0;8>v;++v)r(u,d+32*v,u,d-32,8)}function _c(u,d){var v;for(v=0;8>v;++v)a(u,d,u[d-1],8),d+=32}function Ai(u,d,v){var y;for(y=0;8>y;++y)a(d,v+32*y,u,8)}function wc(u,d){var v,y=8;for(v=0;8>v;++v)y+=u[d+v-32]+u[d-1+32*v];Ai(y>>4,u,d)}function Is(u,d){var v,y=4;for(v=0;8>v;++v)y+=u[d+v-32];Ai(y>>3,u,d)}function Ps(u,d){var v,y=4;for(v=0;8>v;++v)y+=u[d-1+32*v];Ai(y>>3,u,d)}function Bo(u,d){Ai(128,u,d)}function ki(u,d,v){var y=u[d-v],N=u[d+0],L=3*(N-y)+xc[1020+u[d-2*v]-u[d+v]],P=Go[112+(L+4>>3)];u[d-v]=yr[255+y+Go[112+(L+3>>3)]],u[d+0]=yr[255+N-P]}function Os(u,d,v,y){var N=u[d+0],L=u[d+v];return Br[255+u[d-2*v]-u[d-v]]>y||Br[255+L-N]>y}function Ya(u,d,v,y){return 4*Br[255+u[d-v]-u[d+0]]+Br[255+u[d-2*v]-u[d+v]]<=y}function Rs(u,d,v,y,N){var L=u[d-3*v],P=u[d-2*v],B=u[d-v],M=u[d+0],H=u[d+v],te=u[d+2*v],ue=u[d+3*v];return 4*Br[255+B-M]+Br[255+P-H]>y?0:Br[255+u[d-4*v]-L]<=N&&Br[255+L-P]<=N&&Br[255+P-B]<=N&&Br[255+ue-te]<=N&&Br[255+te-H]<=N&&Br[255+H-M]<=N}function ma(u,d,v,y){var N=2*y+1;for(y=0;16>y;++y)Ya(u,d+y,v,N)&&ki(u,d+y,v)}function Fs(u,d,v,y){var N=2*y+1;for(y=0;16>y;++y)Ya(u,d+y*v,1,N)&&ki(u,d+y*v,1)}function Mo(u,d,v,y){var N;for(N=3;0<N;--N)ma(u,d+=4*v,v,y)}function Uo(u,d,v,y){var N;for(N=3;0<N;--N)Fs(u,d+=4,v,y)}function Ni(u,d,v,y,N,L,P,B){for(L=2*L+1;0<N--;){if(Rs(u,d,v,L,P))if(Os(u,d,v,B))ki(u,d,v);else{var M=u,H=d,te=v,ue=M[H-2*te],W=M[H-te],ne=M[H+0],se=M[H+te],ge=M[H+2*te],ce=27*(_e=xc[1020+3*(ne-W)+xc[1020+ue-se]])+63>>7,ve=18*_e+63>>7,_e=9*_e+63>>7;M[H-3*te]=yr[255+M[H-3*te]+_e],M[H-2*te]=yr[255+ue+ve],M[H-te]=yr[255+W+ce],M[H+0]=yr[255+ne-ce],M[H+te]=yr[255+se-ve],M[H+2*te]=yr[255+ge-_e]}d+=y}}function Ei(u,d,v,y,N,L,P,B){for(L=2*L+1;0<N--;){if(Rs(u,d,v,L,P))if(Os(u,d,v,B))ki(u,d,v);else{var M=u,H=d,te=v,ue=M[H-te],W=M[H+0],ne=M[H+te],se=Go[112+(4+(ge=3*(W-ue))>>3)],ge=Go[112+(ge+3>>3)],ce=se+1>>1;M[H-2*te]=yr[255+M[H-2*te]+ce],M[H-te]=yr[255+ue+ge],M[H+0]=yr[255+W-se],M[H+te]=yr[255+ne-ce]}d+=y}}function qo(u,d,v,y,N,L){Ni(u,d,v,1,16,y,N,L)}function va(u,d,v,y,N,L){Ni(u,d,1,v,16,y,N,L)}function $o(u,d,v,y,N,L){var P;for(P=3;0<P;--P)Ei(u,d+=4*v,v,1,16,y,N,L)}function g(u,d,v,y,N,L){var P;for(P=3;0<P;--P)Ei(u,d+=4,1,v,16,y,N,L)}function k(u,d,v,y,N,L,P,B){Ni(u,d,N,1,8,L,P,B),Ni(v,y,N,1,8,L,P,B)}function G(u,d,v,y,N,L,P,B){Ni(u,d,1,N,8,L,P,B),Ni(v,y,1,N,8,L,P,B)}function X(u,d,v,y,N,L,P,B){Ei(u,d+4*N,N,1,8,L,P,B),Ei(v,y+4*N,N,1,8,L,P,B)}function ie(u,d,v,y,N,L,P,B){Ei(u,d+4,1,N,8,L,P,B),Ei(v,y+4,1,N,8,L,P,B)}function ye(){this.ba=new kt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ft,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function xe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function qe(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Je(){this.ua=0,this.Wa=new dt,this.vb=new dt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new j}function gt(){this.xb=this.a=0,this.l=new Ga,this.ca=new kt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Je,this.ab=0,this.gc=o(4,qe),this.Oc=0}function wt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ga,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ot(u,d,v,y,N,L,P){for(u=u==null?0:u[d+0],d=0;d<P;++d)N[L+d]=u+v[y+d]&255,u=N[L+d]}function on(u,d,v,y,N,L,P){var B;if(u==null)Ot(null,null,v,y,N,L,P);else for(B=0;B<P;++B)N[L+B]=u[d+B]+v[y+B]&255}function kn(u,d,v,y,N,L,P){if(u==null)Ot(null,null,v,y,N,L,P);else{var B,M=u[d+0],H=M,te=M;for(B=0;B<P;++B)H=te+(M=u[d+B])-H,te=v[y+B]+(-256&H?0>H?0:255:H)&255,H=M,N[L+B]=te}}function Xt(u,d,v,y){var N=d.width,L=d.o;if(e(u!=null&&d!=null),0>v||0>=y||v+y>L)return null;if(!u.Cc){if(u.ga==null){var P;if(u.ga=new wt,(P=u.ga==null)||(P=d.width*d.o,e(u.Gb.length==0),u.Gb=i(P),u.Uc=0,u.Gb==null?P=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,P=1),P=!P),!P){P=u.ga;var B=u.Fa,M=u.P,H=u.qc,te=u.mb,ue=u.nb,W=M+1,ne=H-1,se=P.l;if(e(B!=null&&te!=null&&d!=null),Zi[0]=null,Zi[1]=Ot,Zi[2]=on,Zi[3]=kn,P.ca=te,P.tb=ue,P.c=d.width,P.i=d.height,e(0<P.c&&0<P.i),1>=H)d=0;else if(P.$a=3&B[M+0],P.Z=B[M+0]>>2&3,P.Lc=B[M+0]>>4&3,M=B[M+0]>>6&3,0>P.$a||1<P.$a||4<=P.Z||1<P.Lc||M)d=0;else if(se.put=rt,se.ac=Tr,se.bc=mr,se.ma=P,se.width=d.width,se.height=d.height,se.Da=d.Da,se.v=d.v,se.va=d.va,se.j=d.j,se.o=d.o,P.$a)e:{e(P.$a==1),d=si();t:for(;;){if(d==null){d=0;break e}if(e(P!=null),P.mc=d,d.c=P.c,d.i=P.i,d.l=P.l,d.l.ma=P,d.l.width=P.c,d.l.height=P.i,d.a=0,de(d.m,B,W,ne),!Or(P.c,P.i,1,d,null)||(d.ab==1&&d.gc[0].hc==3&&ur(d.s)?(P.ic=1,B=d.c*d.i,d.Ta=null,d.Ua=0,d.V=i(B),d.Ba=0,d.V==null?(d.a=1,d=0):d=1):(P.ic=0,d=Ue(d,P.c)),!d))break t;d=1;break e}P.mc=null,d=0}else d=ne>=P.c*P.i;P=!d}if(P)return null;u.ga.Lc!=1?u.Ga=0:y=L-v}e(u.ga!=null),e(v+y<=L);e:{if(d=(B=u.ga).c,L=B.l.o,B.$a==0){if(W=u.rc,ne=u.Vc,se=u.Fa,M=u.P+1+v*d,H=u.mb,te=u.nb+v*d,e(M<=u.P+u.qc),B.Z!=0)for(e(Zi[B.Z]!=null),P=0;P<y;++P)Zi[B.Z](W,ne,se,M,H,te,d),W=H,ne=te,te+=d,M+=d;else for(P=0;P<y;++P)r(H,te,se,M,d),W=H,ne=te,te+=d,M+=d;u.rc=W,u.Vc=ne}else{if(e(B.mc!=null),d=v+y,e((P=B.mc)!=null),e(d<=P.i),P.C>=d)d=1;else if(B.ic||Hr(),B.ic){B=P.V,W=P.Ba,ne=P.c;var ge=P.i,ce=(se=1,M=P.$/ne,H=P.$%ne,te=P.m,ue=P.s,P.$),ve=ne*ge,_e=ne*d,Ee=ue.wc,Se=ce<_e?xn(ue,H,M):null;e(ce<=ve),e(d<=ge),e(ur(ue));t:for(;;){for(;!te.h&&ce<_e;){if(H&Ee||(Se=xn(ue,H,M)),e(Se!=null),re(te),256>(ge=Pt(Se.G[0],Se.H[0],te)))B[W+ce]=ge,++ce,++H>=ne&&(H=0,++M<=d&&!(M%16)&&hr(P,M));else{if(!(280>ge)){se=0;break t}ge=Qn(ge-256,te);var Ze,De=Pt(Se.G[4],Se.H[4],te);if(re(te),!(ce>=(De=cr(ne,De=Qn(De,te)))&&ve-ce>=ge)){se=0;break t}for(Ze=0;Ze<ge;++Ze)B[W+ce+Ze]=B[W+ce+Ze-De];for(ce+=ge,H+=ge;H>=ne;)H-=ne,++M<=d&&!(M%16)&&hr(P,M);ce<_e&&H&Ee&&(Se=xn(ue,H,M))}e(te.h==Y(te))}hr(P,M>d?d:M);break t}!se||te.h&&ce<ve?(se=0,P.a=te.h?5:3):P.$=ce,d=se}else d=dr(P,P.V,P.Ba,P.c,P.i,d,ee);if(!d){y=0;break e}}v+y>=L&&(u.Cc=1),y=1}if(!y)return null;if(u.Cc&&((y=u.ga)!=null&&(y.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+v*N}function In(u,d,v,y,N,L){for(;0<N--;){var P,B=u,M=d+(v?1:0),H=u,te=d+(v?0:3);for(P=0;P<y;++P){var ue=H[te+4*P];ue!=255&&(ue*=32897,B[M+4*P+0]=B[M+4*P+0]*ue>>23,B[M+4*P+1]=B[M+4*P+1]*ue>>23,B[M+4*P+2]=B[M+4*P+2]*ue>>23)}d+=L}}function Nn(u,d,v,y,N){for(;0<y--;){var L;for(L=0;L<v;++L){var P=u[d+2*L+0],B=15&(H=u[d+2*L+1]),M=4369*B,H=(240&H|H>>4)*M>>16;u[d+2*L+0]=(240&P|P>>4)*M>>16&240|(15&P|P<<4)*M>>16>>4&15,u[d+2*L+1]=240&H|B}d+=N}}function Mn(u,d,v,y,N,L,P,B){var M,H,te=255;for(H=0;H<N;++H){for(M=0;M<y;++M){var ue=u[d+M];L[P+4*M]=ue,te&=ue}d+=v,P+=B}return te!=255}function Li(u,d,v,y,N){var L;for(L=0;L<N;++L)v[y+L]=u[d+L]>>8}function Hr(){Vs=In,Rh=Nn,Fh=Mn,Dh=Li}function Ci(u,d,v){F[u]=function(y,N,L,P,B,M,H,te,ue,W,ne,se,ge,ce,ve,_e,Ee){var Se,Ze=Ee-1>>1,De=B[M+0]|H[te+0]<<16,St=ue[W+0]|ne[se+0]<<16;e(y!=null);var We=3*De+St+131074>>2;for(d(y[N+0],255&We,We>>16,ge,ce),L!=null&&(We=3*St+De+131074>>2,d(L[P+0],255&We,We>>16,ve,_e)),Se=1;Se<=Ze;++Se){var Tt=B[M+Se]|H[te+Se]<<16,On=ue[W+Se]|ne[se+Se]<<16,At=De+Tt+St+On+524296,Ge=At+2*(Tt+St)>>3;We=Ge+De>>1,De=(At=At+2*(De+On)>>3)+Tt>>1,d(y[N+2*Se-1],255&We,We>>16,ge,ce+(2*Se-1)*v),d(y[N+2*Se-0],255&De,De>>16,ge,ce+(2*Se-0)*v),L!=null&&(We=At+St>>1,De=Ge+On>>1,d(L[P+2*Se-1],255&We,We>>16,ve,_e+(2*Se-1)*v),d(L[P+2*Se+0],255&De,De>>16,ve,_e+(2*Se+0)*v)),De=Tt,St=On}1&Ee||(We=3*De+St+131074>>2,d(y[N+Ee-1],255&We,We>>16,ge,ce+(Ee-1)*v),L!=null&&(We=3*St+De+131074>>2,d(L[P+Ee-1],255&We,We>>16,ve,_e+(Ee-1)*v)))}}function Ds(){Mr[Vo]=Am,Mr[Ko]=Vh,Mr[$h]=km,Mr[Jo]=Kh,Mr[Yo]=Jh,Mr[Sc]=Yh,Mr[zh]=Nm,Mr[Ac]=Vh,Mr[kc]=Kh,Mr[Xo]=Jh,Mr[Nc]=Yh}function Xa(u){return u&-16384?0>u?0:255:u>>Em}function $i(u,d){return Xa((19077*u>>8)+(26149*d>>8)-14234)}function ba(u,d,v){return Xa((19077*u>>8)-(6419*d>>8)-(13320*v>>8)+8708)}function ya(u,d){return Xa((19077*u>>8)+(33050*d>>8)-17685)}function zi(u,d,v,y,N){y[N+0]=$i(u,v),y[N+1]=ba(u,d,v),y[N+2]=ya(u,d)}function Un(u,d,v,y,N){y[N+0]=ya(u,d),y[N+1]=ba(u,d,v),y[N+2]=$i(u,v)}function _a(u,d,v,y,N){var L=ba(u,d,v);d=L<<3&224|ya(u,d)>>3,y[N+0]=248&$i(u,v)|L>>5,y[N+1]=d}function wa(u,d,v,y,N){var L=240&ya(u,d)|15;y[N+0]=240&$i(u,v)|ba(u,d,v)>>4,y[N+1]=L}function js(u,d,v,y,N){y[N+0]=255,zi(u,d,v,y,N+1)}function Bs(u,d,v,y,N){Un(u,d,v,y,N),y[N+3]=255}function tr(u,d,v,y,N){zi(u,d,v,y,N),y[N+3]=255}function Ti(u,d,v){F[u]=function(y,N,L,P,B,M,H,te,ue){for(var W=te+(-2&ue)*v;te!=W;)d(y[N+0],L[P+0],B[M+0],H,te),d(y[N+1],L[P+0],B[M+0],H,te+v),N+=2,++P,++M,te+=2*v;1&ue&&d(y[N+0],L[P+0],B[M+0],H,te)}}function Za(u,d,v){return v==0?u==0?d==0?6:5:d==0?4:0:v}function zo(u,d,v,y,N){switch(u>>>30){case 3:ka(d,v,y,N,0);break;case 2:jr(d,v,y,N);break;case 1:Mt(d,v,y,N)}}function Dr(u,d){var v,y,N=d.M,L=d.Nb,P=u.oc,B=u.pc+40,M=u.oc,H=u.pc+584,te=u.oc,ue=u.pc+600;for(v=0;16>v;++v)P[B+32*v-1]=129;for(v=0;8>v;++v)M[H+32*v-1]=129,te[ue+32*v-1]=129;for(0<N?P[B-1-32]=M[H-1-32]=te[ue-1-32]=129:(a(P,B-32-1,127,21),a(M,H-32-1,127,9),a(te,ue-32-1,127,9)),y=0;y<u.za;++y){var W=d.ya[d.aa+y];if(0<y){for(v=-1;16>v;++v)r(P,B+32*v-4,P,B+32*v+12,4);for(v=-1;8>v;++v)r(M,H+32*v-4,M,H+32*v+4,4),r(te,ue+32*v-4,te,ue+32*v+4,4)}var ne=u.Gd,se=u.Hd+y,ge=W.ad,ce=W.Hc;if(0<N&&(r(P,B-32,ne[se].y,0,16),r(M,H-32,ne[se].f,0,8),r(te,ue-32,ne[se].ea,0,8)),W.Za){var ve=P,_e=B-32+16;for(0<N&&(y>=u.za-1?a(ve,_e,ne[se].y[15],4):r(ve,_e,ne[se+1].y,0,4)),v=0;4>v;v++)ve[_e+128+v]=ve[_e+256+v]=ve[_e+384+v]=ve[_e+0+v];for(v=0;16>v;++v,ce<<=2)ve=P,_e=B+Zh[v],Wr[W.Ob[v]](ve,_e),zo(ce,ge,16*+v,ve,_e)}else if(ve=Za(y,N,W.Ob[0]),Xi[ve](P,B),ce!=0)for(v=0;16>v;++v,ce<<=2)zo(ce,ge,16*+v,P,B+Zh[v]);for(v=W.Gc,ve=Za(y,N,W.Dd),Oi[ve](M,H),Oi[ve](te,ue),ce=ge,ve=M,_e=H,255&(W=0|v)&&(170&W?di(ce,256,ve,_e):Gt(ce,256,ve,_e)),W=te,ce=ue,255&(v>>=8)&&(170&v?di(ge,320,W,ce):Gt(ge,320,W,ce)),N<u.Ub-1&&(r(ne[se].y,0,P,B+480,16),r(ne[se].f,0,M,H+224,8),r(ne[se].ea,0,te,ue+224,8)),v=8*L*u.B,ne=u.sa,se=u.ta+16*y+16*L*u.R,ge=u.qa,W=u.ra+8*y+v,ce=u.Ha,ve=u.Ia+8*y+v,v=0;16>v;++v)r(ne,se+v*u.R,P,B+32*v,16);for(v=0;8>v;++v)r(ge,W+v*u.B,M,H+32*v,8),r(ce,ve+v*u.B,te,ue+32*v,8)}}function xa(u,d,v,y,N,L,P,B,M){var H=[0],te=[0],ue=0,W=M!=null?M.kd:0,ne=M??new xe;if(u==null||12>v)return 7;ne.data=u,ne.w=d,ne.ha=v,d=[d],v=[v],ne.gb=[ne.gb];e:{var se=d,ge=v,ce=ne.gb;if(e(u!=null),e(ge!=null),e(ce!=null),ce[0]=0,12<=ge[0]&&!n(u,se[0],"RIFF")){if(n(u,se[0]+8,"WEBP")){ce=3;break e}var ve=Me(u,se[0]+4);if(12>ve||4294967286<ve){ce=3;break e}if(W&&ve>ge[0]-8){ce=7;break e}ce[0]=ve,se[0]+=12,ge[0]-=12}ce=0}if(ce!=0)return ce;for(ve=0<ne.gb[0],v=v[0];;){e:{var _e=u;ge=d,ce=v;var Ee=H,Se=te,Ze=se=[0];if((We=ue=[ue])[0]=0,8>ce[0])ce=7;else{if(!n(_e,ge[0],"VP8X")){if(Me(_e,ge[0]+4)!=10){ce=3;break e}if(18>ce[0]){ce=7;break e}var De=Me(_e,ge[0]+8),St=1+Te(_e,ge[0]+12);if(2147483648<=St*(_e=1+Te(_e,ge[0]+15))){ce=3;break e}Ze!=null&&(Ze[0]=De),Ee!=null&&(Ee[0]=St),Se!=null&&(Se[0]=_e),ge[0]+=18,ce[0]-=18,We[0]=1}ce=0}}if(ue=ue[0],se=se[0],ce!=0)return ce;if(ge=!!(2&se),!ve&&ue)return 3;if(L!=null&&(L[0]=!!(16&se)),P!=null&&(P[0]=ge),B!=null&&(B[0]=0),P=H[0],se=te[0],ue&&ge&&M==null){ce=0;break}if(4>v){ce=7;break}if(ve&&ue||!ve&&!ue&&!n(u,d[0],"ALPH")){v=[v],ne.na=[ne.na],ne.P=[ne.P],ne.Sa=[ne.Sa];e:{De=u,ce=d,ve=v;var We=ne.gb;Ee=ne.na,Se=ne.P,Ze=ne.Sa,St=22,e(De!=null),e(ve!=null),_e=ce[0];var Tt=ve[0];for(e(Ee!=null),e(Ze!=null),Ee[0]=null,Se[0]=null,Ze[0]=0;;){if(ce[0]=_e,ve[0]=Tt,8>Tt){ce=7;break e}var On=Me(De,_e+4);if(4294967286<On){ce=3;break e}var At=8+On+1&-2;if(St+=At,0<We&&St>We){ce=3;break e}if(!n(De,_e,"VP8 ")||!n(De,_e,"VP8L")){ce=0;break e}if(Tt[0]<At){ce=7;break e}n(De,_e,"ALPH")||(Ee[0]=De,Se[0]=_e+8,Ze[0]=On),_e+=At,Tt-=At}}if(v=v[0],ne.na=ne.na[0],ne.P=ne.P[0],ne.Sa=ne.Sa[0],ce!=0)break}v=[v],ne.Ja=[ne.Ja],ne.xa=[ne.xa];e:if(We=u,ce=d,ve=v,Ee=ne.gb[0],Se=ne.Ja,Ze=ne.xa,De=ce[0],_e=!n(We,De,"VP8 "),St=!n(We,De,"VP8L"),e(We!=null),e(ve!=null),e(Se!=null),e(Ze!=null),8>ve[0])ce=7;else{if(_e||St){if(We=Me(We,De+4),12<=Ee&&We>Ee-12){ce=3;break e}if(W&&We>ve[0]-8){ce=7;break e}Se[0]=We,ce[0]+=8,ve[0]-=8,Ze[0]=St}else Ze[0]=5<=ve[0]&&We[De+0]==47&&!(We[De+4]>>5),Se[0]=ve[0];ce=0}if(v=v[0],ne.Ja=ne.Ja[0],ne.xa=ne.xa[0],d=d[0],ce!=0)break;if(4294967286<ne.Ja)return 3;if(B==null||ge||(B[0]=ne.xa?2:1),P=[P],se=[se],ne.xa){if(5>v){ce=7;break}B=P,W=se,ge=L,u==null||5>v?u=0:5<=v&&u[d+0]==47&&!(u[d+4]>>5)?(ve=[0],We=[0],Ee=[0],de(Se=new z,u,d,v),Ir(Se,ve,We,Ee)?(B!=null&&(B[0]=ve[0]),W!=null&&(W[0]=We[0]),ge!=null&&(ge[0]=Ee[0]),u=1):u=0):u=0}else{if(10>v){ce=7;break}B=se,u==null||10>v||!Po(u,d+3,v-3)?u=0:(W=u[d+0]|u[d+1]<<8|u[d+2]<<16,ge=16383&(u[d+7]<<8|u[d+6]),u=16383&(u[d+9]<<8|u[d+8]),1&W||3<(W>>1&7)||!(W>>4&1)||W>>5>=ne.Ja||!ge||!u?u=0:(P&&(P[0]=ge),B&&(B[0]=u),u=1))}if(!u||(P=P[0],se=se[0],ue&&(H[0]!=P||te[0]!=se)))return 3;M!=null&&(M[0]=ne,M.offset=d-M.w,e(4294967286>d-M.w),e(M.offset==M.ha-v));break}return ce==0||ce==7&&ue&&M==null?(L!=null&&(L[0]|=ne.na!=null&&0<ne.na.length),y!=null&&(y[0]=P),N!=null&&(N[0]=se),0):ce}function Ms(u,d,v){var y=d.width,N=d.height,L=0,P=0,B=y,M=N;if(d.Da=u!=null&&0<u.Da,d.Da&&(B=u.cd,M=u.bd,L=u.v,P=u.j,11>v||(L&=-2,P&=-2),0>L||0>P||0>=B||0>=M||L+B>y||P+M>N))return 0;if(d.v=L,d.j=P,d.va=L+B,d.o=P+M,d.U=B,d.T=M,d.da=u!=null&&0<u.da,d.da){if(!ze(B,M,v=[u.ib],L=[u.hb]))return 0;d.ib=v[0],d.hb=L[0]}return d.ob=u!=null&&u.ob,d.Kb=u==null||!u.Sd,d.da&&(d.ob=d.ib<3*y/4&&d.hb<3*N/4,d.Kb=0),1}function Us(u){if(u==null)return 2;if(11>u.S){var d=u.f.RGBA;d.fb+=(u.height-1)*d.A,d.A=-d.A}else d=u.f.kb,u=u.height,d.O+=(u-1)*d.fa,d.fa=-d.fa,d.N+=(u-1>>1)*d.Ab,d.Ab=-d.Ab,d.W+=(u-1>>1)*d.Db,d.Db=-d.Db,d.F!=null&&(d.J+=(u-1)*d.lb,d.lb=-d.lb);return 0}function Hi(u,d,v,y){if(y==null||0>=u||0>=d)return 2;if(v!=null){if(v.Da){var N=v.cd,L=v.bd,P=-2&v.v,B=-2&v.j;if(0>P||0>B||0>=N||0>=L||P+N>u||B+L>d)return 2;u=N,d=L}if(v.da){if(!ze(u,d,N=[v.ib],L=[v.hb]))return 2;u=N[0],d=L[0]}}y.width=u,y.height=d;e:{var M=y.width,H=y.height;if(u=y.S,0>=M||0>=H||!(u>=Vo&&13>u))u=2;else{if(0>=y.Rd&&y.sd==null){P=L=N=d=0;var te=(B=M*Qh[u])*H;if(11>u||(L=(H+1)/2*(d=(M+1)/2),u==12&&(P=(N=M)*H)),(H=i(te+2*L+P))==null){u=1;break e}y.sd=H,11>u?((M=y.f.RGBA).eb=H,M.fb=0,M.A=B,M.size=te):((M=y.f.kb).y=H,M.O=0,M.fa=B,M.Fd=te,M.f=H,M.N=0+te,M.Ab=d,M.Cd=L,M.ea=H,M.W=0+te+L,M.Db=d,M.Ed=L,u==12&&(M.F=H,M.J=0+te+2*L),M.Tc=P,M.lb=N)}if(d=1,N=y.S,L=y.width,P=y.height,N>=Vo&&13>N)if(11>N)u=y.f.RGBA,d&=(B=Math.abs(u.A))*(P-1)+L<=u.size,d&=B>=L*Qh[N],d&=u.eb!=null;else{u=y.f.kb,B=(L+1)/2,te=(P+1)/2,M=Math.abs(u.fa),H=Math.abs(u.Ab);var ue=Math.abs(u.Db),W=Math.abs(u.lb),ne=W*(P-1)+L;d&=M*(P-1)+L<=u.Fd,d&=H*(te-1)+B<=u.Cd,d=(d&=ue*(te-1)+B<=u.Ed)&M>=L&H>=B&ue>=B,d&=u.y!=null,d&=u.f!=null,d&=u.ea!=null,N==12&&(d&=W>=L,d&=ne<=u.Tc,d&=u.F!=null)}else d=0;u=d?0:2}}return u!=0||v!=null&&v.fd&&(u=Us(y)),u}var Sa=64,vr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],br=24,Wi=32,Ii=8,Gi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Re("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(u){return u},F.Predictor2=function(u,d,v){return d[v+0]},F.Predictor3=function(u,d,v){return d[v+1]},F.Predictor4=function(u,d,v){return d[v-1]},F.Predictor5=function(u,d,v){return Ie(Ie(u,d[v+1]),d[v+0])},F.Predictor6=function(u,d,v){return Ie(u,d[v-1])},F.Predictor7=function(u,d,v){return Ie(u,d[v+0])},F.Predictor8=function(u,d,v){return Ie(d[v-1],d[v+0])},F.Predictor9=function(u,d,v){return Ie(d[v+0],d[v+1])},F.Predictor10=function(u,d,v){return Ie(Ie(u,d[v-1]),Ie(d[v+0],d[v+1]))},F.Predictor11=function(u,d,v){var y=d[v+0];return 0>=at(y>>24&255,u>>24&255,(d=d[v-1])>>24&255)+at(y>>16&255,u>>16&255,d>>16&255)+at(y>>8&255,u>>8&255,d>>8&255)+at(255&y,255&u,255&d)?y:u},F.Predictor12=function(u,d,v){var y=d[v+0];return(it((u>>24&255)+(y>>24&255)-((d=d[v-1])>>24&255))<<24|it((u>>16&255)+(y>>16&255)-(d>>16&255))<<16|it((u>>8&255)+(y>>8&255)-(d>>8&255))<<8|it((255&u)+(255&y)-(255&d)))>>>0},F.Predictor13=function(u,d,v){var y=d[v-1];return(nt((u=Ie(u,d[v+0]))>>24&255,y>>24&255)<<24|nt(u>>16&255,y>>16&255)<<16|nt(u>>8&255,y>>8&255)<<8|nt(255&u,255&y))>>>0};var qs=F.PredictorAdd0;F.PredictorAdd1=ut,Re("Predictor2","PredictorAdd2"),Re("Predictor3","PredictorAdd3"),Re("Predictor4","PredictorAdd4"),Re("Predictor5","PredictorAdd5"),Re("Predictor6","PredictorAdd6"),Re("Predictor7","PredictorAdd7"),Re("Predictor8","PredictorAdd8"),Re("Predictor9","PredictorAdd9"),Re("Predictor10","PredictorAdd10"),Re("Predictor11","PredictorAdd11"),Re("Predictor12","PredictorAdd12"),Re("Predictor13","PredictorAdd13");var Qa=F.PredictorAdd2;He("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),He("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var gn,Ho=F.ColorIndexInverseTransform,ui=F.MapARGB,hi=F.VP8LColorIndexInverseTransformAlpha,$s=F.MapAlpha,zs=F.VP8LPredictorsAdd=[];zs.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var Hs,Ws,Vi,Ki,Ji,Aa,Yi,ka,jr,di,Mt,Gt,mn,Pn,Pi,Gs,es,Wo,Lh,Ch,Th,Ih,Ph,Oh,Vs,Rh,Fh,Dh,jh=i(511),Bh=i(2041),Mh=i(225),Uh=i(767),qh=0,xc=Bh,Go=Mh,yr=Uh,Br=jh,Vo=0,Ko=1,$h=2,Jo=3,Yo=4,Sc=5,zh=6,Ac=7,kc=8,Xo=9,Nc=10,um=[2,3,7],hm=[3,3,11],Hh=[280,256,256,256,40],dm=[0,1,1,1,0],fm=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],pm=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],gm=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],mm=8,Ec=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Lc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ks=null,vm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],bm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Wh=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ym=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_m=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],wm=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],xm=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Xi=[],Wr=[],Oi=[],Sm=1,Gh=2,Zi=[],Mr=[];Ci("UpsampleRgbLinePair",zi,3),Ci("UpsampleBgrLinePair",Un,3),Ci("UpsampleRgbaLinePair",tr,4),Ci("UpsampleBgraLinePair",Bs,4),Ci("UpsampleArgbLinePair",js,4),Ci("UpsampleRgba4444LinePair",wa,2),Ci("UpsampleRgb565LinePair",_a,2);var Am=F.UpsampleRgbLinePair,km=F.UpsampleBgrLinePair,Vh=F.UpsampleRgbaLinePair,Kh=F.UpsampleBgraLinePair,Jh=F.UpsampleArgbLinePair,Yh=F.UpsampleRgba4444LinePair,Nm=F.UpsampleRgb565LinePair,Zo=16,Qo=1<<Zo-1,Js=-227,Cc=482,Em=6,Xh=0,Lm=i(256),Cm=i(256),Tm=i(256),Im=i(256),Pm=i(Cc-Js),Om=i(Cc-Js);Ti("YuvToRgbRow",zi,3),Ti("YuvToBgrRow",Un,3),Ti("YuvToRgbaRow",tr,4),Ti("YuvToBgraRow",Bs,4),Ti("YuvToArgbRow",js,4),Ti("YuvToRgba4444Row",wa,2),Ti("YuvToRgb565Row",_a,2);var Zh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],el=[0,2,8],Rm=[8,7,6,4,4,2,2,2,1,1,1,1],Fm=1;this.WebPDecodeRGBA=function(u,d,v,y,N){var L=Ko,P=new ye,B=new kt;P.ba=B,B.S=L,B.width=[B.width],B.height=[B.height];var M=B.width,H=B.height,te=new tt;if(te==null||u==null)var ue=2;else e(te!=null),ue=xa(u,d,v,te.width,te.height,te.Pd,te.Qd,te.format,null);if(ue!=0?M=0:(M!=null&&(M[0]=te.width[0]),H!=null&&(H[0]=te.height[0]),M=1),M){B.width=B.width[0],B.height=B.height[0],y!=null&&(y[0]=B.width),N!=null&&(N[0]=B.height);e:{if(y=new Ga,(N=new xe).data=u,N.w=d,N.ha=v,N.kd=1,d=[0],e(N!=null),((u=xa(N.data,N.w,N.ha,null,null,null,d,null,N))==0||u==7)&&d[0]&&(u=4),(d=u)==0){if(e(P!=null),y.data=N.data,y.w=N.w+N.offset,y.ha=N.ha-N.offset,y.put=rt,y.ac=Tr,y.bc=mr,y.ma=P,N.xa){if((u=si())==null){P=1;break e}if((function(W,ne){var se=[0],ge=[0],ce=[0];t:for(;;){if(W==null)return 0;if(ne==null)return W.a=2,0;if(W.l=ne,W.a=0,de(W.m,ne.data,ne.w,ne.ha),!Ir(W.m,se,ge,ce)){W.a=3;break t}if(W.xb=Gh,ne.width=se[0],ne.height=ge[0],!Or(se[0],ge[0],1,W,null))break t;return 1}return e(W.a!=0),0})(u,y)){if(y=(d=Hi(y.width,y.height,P.Oa,P.ba))==0){t:{y=u;n:for(;;){if(y==null){y=0;break t}if(e(y.s.yc!=null),e(y.s.Ya!=null),e(0<y.s.Wb),e((v=y.l)!=null),e((N=v.ma)!=null),y.xb!=0){if(y.ca=N.ba,y.tb=N.tb,e(y.ca!=null),!Ms(N.Oa,v,Jo)){y.a=2;break n}if(!Ue(y,v.width)||v.da)break n;if((v.da||st(y.ca.S))&&Hr(),11>y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),y.ca.f.kb.F!=null&&Hr()),y.Pb&&0<y.s.ua&&y.s.vb.X==null&&!q(y.s.vb,y.s.Wa.Xa)){y.a=1;break n}y.xb=0}if(!dr(y,y.V,y.Ba,y.c,y.i,v.o,Pr))break n;N.Dc=y.Ma,y=1;break t}e(y.a!=0),y=0}y=!y}y&&(d=u.a)}else d=u.a}else{if((u=new oc)==null){P=1;break e}if(u.Fa=N.na,u.P=N.P,u.qc=N.Sa,li(u,y)){if((d=Hi(y.width,y.height,P.Oa,P.ba))==0){if(u.Aa=0,v=P.Oa,e((N=u)!=null),v!=null){if(0<(M=0>(M=v.Md)?0:100<M?255:255*M/100)){for(H=te=0;4>H;++H)12>(ue=N.pb[H]).lc&&(ue.ia=M*Rm[0>ue.lc?0:ue.lc]>>3),te|=ue.ia;te&&(alert("todo:VP8InitRandom"),N.ia=1)}N.Ga=v.Id,100<N.Ga?N.Ga=100:0>N.Ga&&(N.Ga=0)}(function(W,ne){if(W==null)return 0;if(ne==null)return An(W,2,"NULL VP8Io parameter in VP8Decode().");if(!W.cb&&!li(W,ne))return 0;if(e(W.cb),ne.ac==null||ne.ac(ne)){ne.ob&&(W.L=0);var se=el[W.L];if(W.L==2?(W.yb=0,W.zb=0):(W.yb=ne.v-se>>4,W.zb=ne.j-se>>4,0>W.yb&&(W.yb=0),0>W.zb&&(W.zb=0)),W.Va=ne.o+15+se>>4,W.Hb=ne.va+15+se>>4,W.Hb>W.za&&(W.Hb=W.za),W.Va>W.Ub&&(W.Va=W.Ub),0<W.L){var ge=W.ed;for(se=0;4>se;++se){var ce;if(W.Qa.Cb){var ve=W.Qa.Lb[se];W.Qa.Fb||(ve+=ge.Tb)}else ve=ge.Tb;for(ce=0;1>=ce;++ce){var _e=W.gd[se][ce],Ee=ve;if(ge.Pc&&(Ee+=ge.vd[0],ce&&(Ee+=ge.od[0])),0<(Ee=0>Ee?0:63<Ee?63:Ee)){var Se=Ee;0<ge.wb&&(Se=4<ge.wb?Se>>2:Se>>1)>9-ge.wb&&(Se=9-ge.wb),1>Se&&(Se=1),_e.dd=Se,_e.tc=2*Ee+Se,_e.ld=40<=Ee?2:15<=Ee?1:0}else _e.tc=0;_e.La=ce}}}se=0}else An(W,6,"Frame setup failed"),se=W.a;if(se=se==0){if(se){W.$c=0,0<W.Aa||(W.Ic=Fm);t:{se=W.Ic,ge=4*(Se=W.za);var Ze=32*Se,De=Se+1,St=0<W.L?Se*(0<W.Aa?2:1):0,We=(W.Aa==2?2:1)*Se;if((_e=ge+832+(ce=3*(16*se+el[W.L])/2*Ze)+(ve=W.Fa!=null&&0<W.Fa.length?W.Kc.c*W.Kc.i:0))!=_e)se=0;else{if(_e>W.Vb){if(W.Vb=0,W.Ec=i(_e),W.Fc=0,W.Ec==null){se=An(W,1,"no memory during frame initialization.");break t}W.Vb=_e}_e=W.Ec,Ee=W.Fc,W.Ac=_e,W.Bc=Ee,Ee+=ge,W.Gd=o(Ze,da),W.Hd=0,W.rb=o(De+1,Rr),W.sb=1,W.wa=St?o(St,un):null,W.Y=0,W.D.Nb=0,W.D.wa=W.wa,W.D.Y=W.Y,0<W.Aa&&(W.D.Y+=Se),e(!0),W.oc=_e,W.pc=Ee,Ee+=832,W.ya=o(We,sn),W.aa=0,W.D.ya=W.ya,W.D.aa=W.aa,W.Aa==2&&(W.D.aa+=Se),W.R=16*Se,W.B=8*Se,Se=(Ze=el[W.L])*W.R,Ze=Ze/2*W.B,W.sa=_e,W.ta=Ee+Se,W.qa=W.sa,W.ra=W.ta+16*se*W.R+Ze,W.Ha=W.qa,W.Ia=W.ra+8*se*W.B+Ze,W.$c=0,Ee+=ce,W.mb=ve?_e:null,W.nb=ve?Ee:null,e(Ee+ve<=W.Fc+W.Vb),Oo(W),a(W.Ac,W.Bc,0,ge),se=1}}if(se){if(ne.ka=0,ne.y=W.sa,ne.O=W.ta,ne.f=W.qa,ne.N=W.ra,ne.ea=W.Ha,ne.Vd=W.Ia,ne.fa=W.R,ne.Rc=W.B,ne.F=null,ne.J=0,!qh){for(se=-255;255>=se;++se)jh[255+se]=0>se?-se:se;for(se=-1020;1020>=se;++se)Bh[1020+se]=-128>se?-128:127<se?127:se;for(se=-112;112>=se;++se)Mh[112+se]=-16>se?-16:15<se?15:se;for(se=-255;510>=se;++se)Uh[255+se]=0>se?0:255<se?255:se;qh=1}Yi=Ka,ka=cc,di=ci,Mt=Fo,Gt=Do,jr=lc,mn=qo,Pn=va,Pi=k,Gs=G,es=$o,Wo=g,Lh=X,Ch=ie,Th=ma,Ih=Fs,Ph=Mo,Oh=Uo,Wr[0]=vc,Wr[1]=uc,Wr[2]=gc,Wr[3]=mc,Wr[4]=xi,Wr[5]=bc,Wr[6]=Si,Wr[7]=yc,Wr[8]=Ts,Wr[9]=Ja,Xi[0]=fc,Xi[1]=dc,Xi[2]=Ls,Xi[3]=jo,Xi[4]=pa,Xi[5]=Cs,Xi[6]=pc,Oi[0]=wc,Oi[1]=hc,Oi[2]=ga,Oi[3]=_c,Oi[4]=Ps,Oi[5]=Is,Oi[6]=Bo,se=1}else se=0}se&&(se=(function(Tt,On){for(Tt.M=0;Tt.M<Tt.Va;++Tt.M){var At,Ge=Tt.Jc[Tt.M&Tt.Xb],Pe=Tt.m,vn=Tt;for(At=0;At<vn.za;++At){var _t=Pe,It=vn,tn=It.Ac,qn=It.Bc+4*At,nr=It.zc,hn=It.ya[It.aa+At];if(It.Qa.Bb?hn.$b=me(_t,It.Pa.jb[0])?2+me(_t,It.Pa.jb[2]):me(_t,It.Pa.jb[1]):hn.$b=0,It.kc&&(hn.Ad=me(_t,It.Bd)),hn.Za=!me(_t,145)+0,hn.Za){var Vn=hn.Ob,rr=0;for(It=0;4>It;++It){var Rn,Rt=nr[0+It];for(Rn=0;4>Rn;++Rn){Rt=_m[tn[qn+Rn]][Rt];for(var qt=Wh[me(_t,Rt[0])];0<qt;)qt=Wh[2*qt+me(_t,Rt[qt])];Rt=-qt,tn[qn+Rn]=Rt}r(Vn,rr,tn,qn,4),rr+=4,nr[0+It]=Rt}}else Rt=me(_t,156)?me(_t,128)?1:3:me(_t,163)?2:0,hn.Ob[0]=Rt,a(tn,qn,Rt,4),a(nr,0,Rt,4);hn.Dd=me(_t,142)?me(_t,114)?me(_t,183)?1:3:2:0}if(vn.m.Ka)return An(Tt,7,"Premature end-of-partition0 encountered.");for(;Tt.ja<Tt.za;++Tt.ja){if(vn=Ge,_t=(Pe=Tt).rb[Pe.sb-1],tn=Pe.rb[Pe.sb+Pe.ja],At=Pe.ya[Pe.aa+Pe.ja],qn=Pe.kc?At.Ad:0)_t.la=tn.la=0,At.Za||(_t.Na=tn.Na=0),At.Hc=0,At.Gc=0,At.ia=0;else{var dn,$t;if(_t=tn,tn=vn,qn=Pe.Pa.Xc,nr=Pe.ya[Pe.aa+Pe.ja],hn=Pe.pb[nr.$b],It=nr.ad,Vn=0,rr=Pe.rb[Pe.sb-1],Rt=Rn=0,a(It,Vn,0,384),nr.Za)var $n=0,Gr=qn[3];else{qt=i(16);var bn=_t.Na+rr.Na;if(bn=Ks(tn,qn[1],bn,hn.Eb,0,qt,0),_t.Na=rr.Na=(0<bn)+0,1<bn)Yi(qt,0,It,Vn);else{var fr=qt[0]+3>>3;for(qt=0;256>qt;qt+=16)It[Vn+qt]=fr}$n=1,Gr=qn[0]}var Vt=15&_t.la,Fn=15&rr.la;for(qt=0;4>qt;++qt){var _r=1&Fn;for(fr=$t=0;4>fr;++fr)Vt=Vt>>1|(_r=(bn=Ks(tn,Gr,bn=_r+(1&Vt),hn.Sc,$n,It,Vn))>$n)<<7,$t=$t<<2|(3<bn?3:1<bn?2:It[Vn+0]!=0),Vn+=16;Vt>>=4,Fn=Fn>>1|_r<<7,Rn=(Rn<<8|$t)>>>0}for(Gr=Vt,$n=Fn>>4,dn=0;4>dn;dn+=2){for($t=0,Vt=_t.la>>4+dn,Fn=rr.la>>4+dn,qt=0;2>qt;++qt){for(_r=1&Fn,fr=0;2>fr;++fr)bn=_r+(1&Vt),Vt=Vt>>1|(_r=0<(bn=Ks(tn,qn[2],bn,hn.Qc,0,It,Vn)))<<3,$t=$t<<2|(3<bn?3:1<bn?2:It[Vn+0]!=0),Vn+=16;Vt>>=2,Fn=Fn>>1|_r<<5}Rt|=$t<<4*dn,Gr|=Vt<<4<<dn,$n|=(240&Fn)<<dn}_t.la=Gr,rr.la=$n,nr.Hc=Rn,nr.Gc=Rt,nr.ia=43690&Rt?0:hn.ia,qn=!(Rn|Rt)}if(0<Pe.L&&(Pe.wa[Pe.Y+Pe.ja]=Pe.gd[At.$b][At.Za],Pe.wa[Pe.Y+Pe.ja].La|=!qn),vn.Ka)return An(Tt,7,"Premature end-of-file encountered.")}if(Oo(Tt),Pe=On,vn=1,At=(Ge=Tt).D,_t=0<Ge.L&&Ge.M>=Ge.zb&&Ge.M<=Ge.Va,Ge.Aa==0)t:{if(At.M=Ge.M,At.uc=_t,Dr(Ge,At),vn=1,At=($t=Ge.D).Nb,_t=(Rt=el[Ge.L])*Ge.R,tn=Rt/2*Ge.B,qt=16*At*Ge.R,fr=8*At*Ge.B,qn=Ge.sa,nr=Ge.ta-_t+qt,hn=Ge.qa,It=Ge.ra-tn+fr,Vn=Ge.Ha,rr=Ge.Ia-tn+fr,Fn=(Vt=$t.M)==0,Rn=Vt>=Ge.Va-1,Ge.Aa==2&&Dr(Ge,$t),$t.uc)for(_r=(bn=Ge).D.M,e(bn.D.uc),$t=bn.yb;$t<bn.Hb;++$t){$n=$t,Gr=_r;var ir=(wr=(zn=bn).D).Nb;dn=zn.R;var wr=wr.wa[wr.Y+$n],xr=zn.sa,pr=zn.ta+16*ir*dn+16*$n,Sr=wr.dd,Zt=wr.tc;if(Zt!=0)if(e(3<=Zt),zn.L==1)0<$n&&Ih(xr,pr,dn,Zt+4),wr.La&&Oh(xr,pr,dn,Zt),0<Gr&&Th(xr,pr,dn,Zt+4),wr.La&&Ph(xr,pr,dn,Zt);else{var Ar=zn.B,Vr=zn.qa,Na=zn.ra+8*ir*Ar+8*$n,Ri=zn.Ha,zn=zn.Ia+8*ir*Ar+8*$n;ir=wr.ld,0<$n&&(Pn(xr,pr,dn,Zt+4,Sr,ir),Gs(Vr,Na,Ri,zn,Ar,Zt+4,Sr,ir)),wr.La&&(Wo(xr,pr,dn,Zt,Sr,ir),Ch(Vr,Na,Ri,zn,Ar,Zt,Sr,ir)),0<Gr&&(mn(xr,pr,dn,Zt+4,Sr,ir),Pi(Vr,Na,Ri,zn,Ar,Zt+4,Sr,ir)),wr.La&&(es(xr,pr,dn,Zt,Sr,ir),Lh(Vr,Na,Ri,zn,Ar,Zt,Sr,ir))}}if(Ge.ia&&alert("todo:DitherRow"),Pe.put!=null){if($t=16*Vt,Vt=16*(Vt+1),Fn?(Pe.y=Ge.sa,Pe.O=Ge.ta+qt,Pe.f=Ge.qa,Pe.N=Ge.ra+fr,Pe.ea=Ge.Ha,Pe.W=Ge.Ia+fr):($t-=Rt,Pe.y=qn,Pe.O=nr,Pe.f=hn,Pe.N=It,Pe.ea=Vn,Pe.W=rr),Rn||(Vt-=Rt),Vt>Pe.o&&(Vt=Pe.o),Pe.F=null,Pe.J=null,Ge.Fa!=null&&0<Ge.Fa.length&&$t<Vt&&(Pe.J=Xt(Ge,Pe,$t,Vt-$t),Pe.F=Ge.mb,Pe.F==null&&Pe.F.length==0)){vn=An(Ge,3,"Could not decode alpha data.");break t}$t<Pe.j&&(Rt=Pe.j-$t,$t=Pe.j,e(!(1&Rt)),Pe.O+=Ge.R*Rt,Pe.N+=Ge.B*(Rt>>1),Pe.W+=Ge.B*(Rt>>1),Pe.F!=null&&(Pe.J+=Pe.width*Rt)),$t<Vt&&(Pe.O+=Pe.v,Pe.N+=Pe.v>>1,Pe.W+=Pe.v>>1,Pe.F!=null&&(Pe.J+=Pe.v),Pe.ka=$t-Pe.j,Pe.U=Pe.va-Pe.v,Pe.T=Vt-$t,vn=Pe.put(Pe))}At+1!=Ge.Ic||Rn||(r(Ge.sa,Ge.ta-_t,qn,nr+16*Ge.R,_t),r(Ge.qa,Ge.ra-tn,hn,It+8*Ge.B,tn),r(Ge.Ha,Ge.Ia-tn,Vn,rr+8*Ge.B,tn))}if(!vn)return An(Tt,6,"Output aborted.")}return 1})(W,ne)),ne.bc!=null&&ne.bc(ne),se&=1}return se?(W.cb=0,se):0})(u,y)||(d=u.a)}}else d=u.a}d==0&&P.Oa!=null&&P.Oa.fd&&(d=Us(P.ba))}P=d}L=P!=0?null:11>L?B.f.RGBA.eb:B.f.kb.y}else L=null;return L};var Qh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(F,C){for(var A="",D=0;D<4;D++)A+=String.fromCharCode(F[C++]);return A}function f(F,C){return F[C+0]|F[C+1]<<8}function m(F,C){return(F[C+0]|F[C+1]<<8|F[C+2]<<16)>>>0}function b(F,C){return(F[C+0]|F[C+1]<<8|F[C+2]<<16|F[C+3]<<24)>>>0}new c;var p=[0],_=[0],w=[],S=new c,x=t,T=(function(F,C){var A={},D=0,j=!1,$=0,V=0;if(A.frames=[],!(function(I,z){for(var K=0;K<4;K++)if(I[z+K]!="RIFF".charCodeAt(K))return!0;return!1})(F,C)){for(b(F,C+=4),C+=8;C<F.length;){var oe=h(F,C),le=b(F,C+=4);C+=4;var ae=le+(1&le);switch(oe){case"VP8 ":case"VP8L":A.frames[D]===void 0&&(A.frames[D]={}),(pe=A.frames[D]).src_off=j?V:C-8,pe.src_size=$+le+8,D++,j&&(j=!1,$=0,V=0);break;case"VP8X":(pe=A.header={}).feature_flags=F[C];var de=C+4;pe.canvas_width=1+m(F,de),de+=3,pe.canvas_height=1+m(F,de),de+=3;break;case"ALPH":j=!0,$=ae+8,V=C-8;break;case"ANIM":(pe=A.header).bgcolor=b(F,C),de=C+4,pe.loop_count=f(F,de),de+=2;break;case"ANMF":var Le,pe;(pe=A.frames[D]={}).offset_x=2*m(F,C),C+=3,pe.offset_y=2*m(F,C),C+=3,pe.width=1+m(F,C),C+=3,pe.height=1+m(F,C),C+=3,pe.duration=m(F,C),C+=3,Le=F[C++],pe.dispose=1&Le,pe.blend=Le>>1&1}oe!="ANMF"&&(C+=ae)}return A}})(x,0);T.response=x,T.rgbaoutput=!0,T.dataurl=!1;var R=T.header?T.header:null,E=T.frames?T.frames:null;if(R){R.loop_counter=R.loop_count,p=[R.canvas_height],_=[R.canvas_width];for(var U=0;U<E.length&&E[U].blend!=0;U++);}var Z=E[0],O=S.WebPDecodeRGBA(x,Z.src_off,Z.src_size,_,p);Z.rgba=O,Z.imgwidth=_[0],Z.imgheight=p[0];for(var J=0;J<_[0]*p[0]*4;J++)w[J]=O[J];return this.width=_,this.height=p,this.data=w,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function By(){var t,e=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(e));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function My(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var e,n,r,a,i,o,l,c,h,f=function(I){return I=I||{},this.isStrokeTransparent=I.isStrokeTransparent||!1,this.strokeOpacity=I.strokeOpacity||1,this.strokeStyle=I.strokeStyle||"#000000",this.fillStyle=I.fillStyle||"#000000",this.isFillTransparent=I.isFillTransparent||!1,this.fillOpacity=I.fillOpacity||1,this.font=I.font||"10px sans-serif",this.textBaseline=I.textBaseline||"alphabetic",this.textAlign=I.textAlign||"left",this.lineWidth=I.lineWidth||1,this.lineJoin=I.lineJoin||"miter",this.lineCap=I.lineCap||"butt",this.path=I.path||[],this.transform=I.transform!==void 0?I.transform.clone():new c,this.globalCompositeOperation=I.globalCompositeOperation||"normal",this.globalAlpha=I.globalAlpha||1,this.clip_path=I.clip_path||[],this.currentPoint=I.currentPoint||new o,this.miterLimit=I.miterLimit||10,this.lastPoint=I.lastPoint||new o,this.lineDashOffset=I.lineDashOffset||0,this.lineDash=I.lineDash||[],this.margin=I.margin||[0,0,0,0],this.prevPageLastElemOffset=I.prevPageLastElemOffset||0,this.ignoreClearRect=typeof I.ignoreClearRect!="boolean"||I.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,h=new f}]);var m=function(I){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=I;Object.defineProperty(this,"pdf",{get:function(){return z}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(q){K=!!q}});var Y=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Y},set:function(q){Y=!!q}});var Q=0;Object.defineProperty(this,"posX",{get:function(){return Q},set:function(q){isNaN(q)||(Q=q)}});var re=0;Object.defineProperty(this,"posY",{get:function(){return re},set:function(q){isNaN(q)||(re=q)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(q){var Ce;typeof q=="number"?Ce=[q,q,q,q]:((Ce=new Array(4))[0]=q[0],Ce[1]=q.length>=2?q[1]:Ce[0],Ce[2]=q.length>=3?q[2]:Ce[0],Ce[3]=q.length>=4?q[3]:Ce[1]),h.margin=Ce}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(q){he=q}});var fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return fe},set:function(q){fe=q}});var me=[];Object.defineProperty(this,"pageBreaks",{get:function(){return me},set:function(q){me=q}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(q){q instanceof f&&(h=q)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(q){h.path=q}});var Ae=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ae},set:function(q){Ae=q}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(q){var Ce;Ce=b(q),this.ctx.fillStyle=Ce.style,this.ctx.isFillTransparent=Ce.a===0,this.ctx.fillOpacity=Ce.a,this.pdf.setFillColor(Ce.r,Ce.g,Ce.b,{a:Ce.a}),this.pdf.setTextColor(Ce.r,Ce.g,Ce.b,{a:Ce.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(q){var Ce=b(q);this.ctx.strokeStyle=Ce.style,this.ctx.isStrokeTransparent=Ce.a===0,this.ctx.strokeOpacity=Ce.a,Ce.a===0?this.pdf.setDrawColor(255,255,255):(Ce.a,this.pdf.setDrawColor(Ce.r,Ce.g,Ce.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(q){["butt","round","square"].indexOf(q)!==-1&&(this.ctx.lineCap=q,this.pdf.setLineCap(q))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(q){isNaN(q)||(this.ctx.lineWidth=q,this.pdf.setLineWidth(q))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(q){["bevel","round","miter"].indexOf(q)!==-1&&(this.ctx.lineJoin=q,this.pdf.setLineJoin(q))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(q){isNaN(q)||(this.ctx.miterLimit=q,this.pdf.setMiterLimit(q))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(q){this.ctx.textBaseline=q}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(q){["right","end","center","left","start"].indexOf(q)!==-1&&(this.ctx.textAlign=q)}});var Oe=null,Te=null,Me=null;Object.defineProperty(this,"fontFaces",{get:function(){return Me},set:function(q){Oe=null,Te=null,Me=q}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(q){var Ce;if(this.ctx.font=q,(Ce=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(q))!==null){var dt=Ce[1];Ce[2];var ze=Ce[3],we=Ce[4];Ce[5];var Ke=Ce[6],Re=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(we)[2];we=Math.floor(Re==="px"?parseFloat(we)*this.pdf.internal.scaleFactor:Re==="em"?parseFloat(we)*this.pdf.getFontSize():parseFloat(we)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(we);var Qe=(function(He){var rn,Et,bt=[],ct=He.trim();if(ct==="")return yu;if(ct in lp)return[lp[ct]];for(;ct!=="";){switch(Et=null,rn=(ct=up(ct)).charAt(0)){case'"':case"'":Et=Py(ct.substring(1),rn);break;default:Et=Oy(ct)}if(Et===null||(bt.push(Et[0]),(ct=up(Et[1]))!==""&&ct.charAt(0)!==","))return yu;ct=ct.replace(/^,/,"")}return bt})(Ke);if(this.fontFaces){var Ie=(function(He,rn){var Et=He.getFontList(),bt=JSON.stringify(Et);if(Oe===null||Te!==bt){var ct=(function(Dt){var et=[];return Object.keys(Dt).forEach(function(Bt){Dt[Bt].forEach(function(st){var ht=null;switch(st){case"bold":ht={family:Bt,weight:"bold"};break;case"italic":ht={family:Bt,style:"italic"};break;case"bolditalic":ht={family:Bt,weight:"bold",style:"italic"};break;case"":case"normal":ht={family:Bt}}ht!==null&&(ht.ref={name:Bt,style:st},et.push(ht))})}),et})(Et);Oe=(function(Dt){for(var et={},Bt=0;Bt<Dt.length;++Bt){var st=bu(Dt[Bt]),ht=st.family,Ut=st.stretch,kt=st.style,tt=st.weight;et[ht]=et[ht]||{},et[ht][Ut]=et[ht][Ut]||{},et[ht][Ut][kt]=et[ht][Ut][kt]||{},et[ht][Ut][kt][tt]=st}return et})(ct.concat(rn)),Te=bt}return Oe})(this.pdf,this.fontFaces),it=Qe.map(function(He){return{family:He,stretch:"normal",weight:ze,style:dt}}),nt=(function(He,rn,Et){for(var bt=(Et=Et||{}).defaultFontFamily||"times",ct=Object.assign({},Iy,Et.genericFontFamilies||{}),Dt=null,et=null,Bt=0;Bt<rn.length;++Bt)if(ct[(Dt=bu(rn[Bt])).family]&&(Dt.family=ct[Dt.family]),He.hasOwnProperty(Dt.family)){et=He[Dt.family];break}if(!(et=et||He[bt]))throw new Error("Could not find a font-family for the rule '"+cp(Dt)+"' and default family '"+bt+"'.");if(et=(function(st,ht){if(ht[st])return ht[st];var Ut=ih[st],kt=Ut<=ih.normal?-1:1,tt=op(ht,am,Ut,kt);if(!tt)throw new Error("Could not find a matching font-stretch value for "+st);return tt})(Dt.stretch,et),et=(function(st,ht){if(ht[st])return ht[st];for(var Ut=im[st],kt=0;kt<Ut.length;++kt)if(ht[Ut[kt]])return ht[Ut[kt]];throw new Error("Could not find a matching font-style for "+st)})(Dt.style,et),!(et=(function(st,ht){if(ht[st])return ht[st];if(st===400&&ht[500])return ht[500];if(st===500&&ht[400])return ht[400];var Ut=Ty[st],kt=op(ht,sm,Ut,st<400?-1:1);if(!kt)throw new Error("Could not find a matching font-weight for value "+st);return kt})(Dt.weight,et)))throw new Error("Failed to resolve a font for the rule '"+cp(Dt)+"'.");return et})(Ie,it);this.pdf.setFont(nt.ref.name,nt.ref.style)}else{var at="";(ze==="bold"||parseInt(ze,10)>=700||dt==="bold")&&(at="bold"),dt==="italic"&&(at+="italic"),at.length===0&&(at="normal");for(var ut="",pt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},$e=0;$e<Qe.length;$e++){if(this.pdf.internal.getFont(Qe[$e],at,{noFallback:!0,disableWarning:!0})!==void 0){ut=Qe[$e];break}if(at==="bolditalic"&&this.pdf.internal.getFont(Qe[$e],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ut=Qe[$e],at="bold";else if(this.pdf.internal.getFont(Qe[$e],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ut=Qe[$e],at="normal";break}}if(ut===""){for(var mt=0;mt<Qe.length;mt++)if(pt[Qe[mt]]){ut=pt[Qe[mt]];break}}ut=ut===""?"Times":ut,this.pdf.setFont(ut,at)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(q){this.ctx.globalCompositeOperation=q}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(q){this.ctx.globalAlpha=q}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(q){this.ctx.lineDashOffset=q,pe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(q){this.ctx.lineDash=q,pe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(q){this.ctx.ignoreClearRect=!!q}})};m.prototype.setLineDash=function(I){this.lineDash=I},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){E.call(this,"fill",!1)},m.prototype.stroke=function(){E.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(I,z){if(isNaN(I)||isNaN(z))throw Kt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new o(I,z));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(I,z)},m.prototype.closePath=function(){var I=new o(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Ht(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){I=new o(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(I.x,I.y)},m.prototype.lineTo=function(I,z){if(isNaN(I)||isNaN(z))throw Kt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new o(I,z));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},m.prototype.quadraticCurveTo=function(I,z,K,Y){if(isNaN(K)||isNaN(Y)||isNaN(I)||isNaN(z))throw Kt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Q=this.ctx.transform.applyToPoint(new o(K,Y)),re=this.ctx.transform.applyToPoint(new o(I,z));this.path.push({type:"qct",x1:re.x,y1:re.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},m.prototype.bezierCurveTo=function(I,z,K,Y,Q,re){if(isNaN(Q)||isNaN(re)||isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y))throw Kt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new o(Q,re)),fe=this.ctx.transform.applyToPoint(new o(I,z)),me=this.ctx.transform.applyToPoint(new o(K,Y));this.path.push({type:"bct",x1:fe.x,y1:fe.y,x2:me.x,y2:me.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},m.prototype.arc=function(I,z,K,Y,Q,re){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y)||isNaN(Q))throw Kt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(re=!!re,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new o(I,z));I=he.x,z=he.y;var fe=this.ctx.transform.applyToPoint(new o(0,K)),me=this.ctx.transform.applyToPoint(new o(0,0));K=Math.sqrt(Math.pow(fe.x-me.x,2)+Math.pow(fe.y-me.y,2))}Math.abs(Q-Y)>=2*Math.PI&&(Y=0,Q=2*Math.PI),this.path.push({type:"arc",x:I,y:z,radius:K,startAngle:Y,endAngle:Q,counterclockwise:re})},m.prototype.arcTo=function(I,z,K,Y,Q){throw new Error("arcTo not implemented.")},m.prototype.rect=function(I,z,K,Y){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y))throw Kt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(I,z),this.lineTo(I+K,z),this.lineTo(I+K,z+Y),this.lineTo(I,z+Y),this.lineTo(I,z),this.lineTo(I+K,z),this.lineTo(I,z)},m.prototype.fillRect=function(I,z,K,Y){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y))throw Kt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var Q={};this.lineCap!=="butt"&&(Q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(I,z,K,Y),this.fill(),Q.hasOwnProperty("lineCap")&&(this.lineCap=Q.lineCap),Q.hasOwnProperty("lineJoin")&&(this.lineJoin=Q.lineJoin)}},m.prototype.strokeRect=function(I,z,K,Y){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y))throw Kt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");_.call(this)||(this.beginPath(),this.rect(I,z,K,Y),this.stroke())},m.prototype.clearRect=function(I,z,K,Y){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y))throw Kt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(I,z,K,Y))},m.prototype.save=function(I){I=typeof I!="boolean"||I;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),I){this.ctx.fontSize=this.pdf.internal.getFontSize();var Y=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Y}},m.prototype.restore=function(I){I=typeof I!="boolean"||I;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(z),I&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(I){var z,K,Y,Q;if(I.isCanvasGradient===!0&&(I=I.getColor()),!I)return{r:0,g:0,b:0,a:0,style:I};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(I))z=0,K=0,Y=0,Q=0;else{var re=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(I);if(re!==null)z=parseInt(re[1]),K=parseInt(re[2]),Y=parseInt(re[3]),Q=1;else if((re=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(I))!==null)z=parseInt(re[1]),K=parseInt(re[2]),Y=parseInt(re[3]),Q=parseFloat(re[4]);else{if(Q=1,typeof I=="string"&&I.charAt(0)!=="#"){var he=new Xg(I);I=he.ok?he.toHex():"#000000"}I.length===4?(z=I.substring(1,2),z+=z,K=I.substring(2,3),K+=K,Y=I.substring(3,4),Y+=Y):(z=I.substring(1,3),K=I.substring(3,5),Y=I.substring(5,7)),z=parseInt(z,16),K=parseInt(K,16),Y=parseInt(Y,16)}}return{r:z,g:K,b:Y,a:Q,style:I}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},_=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(I,z,K,Y){if(isNaN(z)||isNaN(K)||typeof I!="string")throw Kt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Y=isNaN(Y)?void 0:Y,!p.call(this)){var Q=ae(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;D.call(this,{text:I,x:z,y:K,scale:re,angle:Q,align:this.textAlign,maxWidth:Y})}},m.prototype.strokeText=function(I,z,K,Y){if(isNaN(z)||isNaN(K)||typeof I!="string")throw Kt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!_.call(this)){Y=isNaN(Y)?void 0:Y;var Q=ae(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;D.call(this,{text:I,x:z,y:K,scale:re,renderingMode:"stroke",angle:Q,align:this.textAlign,maxWidth:Y})}},m.prototype.measureText=function(I){if(typeof I!="string")throw Kt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,K=this.pdf.internal.scaleFactor,Y=z.internal.getFontSize(),Q=z.getStringUnitWidth(I)*Y/z.internal.scaleFactor;return new function(re){var he=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this}({width:Q*=Math.round(96*K/72*1e4)/1e4})},m.prototype.scale=function(I,z){if(isNaN(I)||isNaN(z))throw Kt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new c(I,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},m.prototype.rotate=function(I){if(isNaN(I))throw Kt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos(I),Math.sin(I),-Math.sin(I),Math.cos(I),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},m.prototype.translate=function(I,z){if(isNaN(I)||isNaN(z))throw Kt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new c(1,0,0,1,I,z);this.ctx.transform=this.ctx.transform.multiply(K)},m.prototype.transform=function(I,z,K,Y,Q,re){if(isNaN(I)||isNaN(z)||isNaN(K)||isNaN(Y)||isNaN(Q)||isNaN(re))throw Kt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new c(I,z,K,Y,Q,re);this.ctx.transform=this.ctx.transform.multiply(he)},m.prototype.setTransform=function(I,z,K,Y,Q,re){I=isNaN(I)?1:I,z=isNaN(z)?0:z,K=isNaN(K)?0:K,Y=isNaN(Y)?1:Y,Q=isNaN(Q)?0:Q,re=isNaN(re)?0:re,this.ctx.transform=new c(I,z,K,Y,Q,re)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(I,z,K,Y,Q,re,he,fe,me){var Ae=this.pdf.getImageProperties(I),Oe=1,Te=1,Me=1,q=1;Y!==void 0&&fe!==void 0&&(Me=fe/Y,q=me/Q,Oe=Ae.width/Y*fe/Y,Te=Ae.height/Q*me/Q),re===void 0&&(re=z,he=K,z=0,K=0),Y!==void 0&&fe===void 0&&(fe=Y,me=Q),Y===void 0&&fe===void 0&&(fe=Ae.width,me=Ae.height);var Ce=this.ctx.transform.decompose(),dt=ae(Ce.rotate.shx),ze=new c,we=(ze=(ze=(ze=ze.multiply(Ce.translate)).multiply(Ce.skew)).multiply(Ce.scale)).applyToRectangle(new l(re-z*Me,he-K*q,Y*Oe,Q*Te));if(this.autoPaging){for(var Ke,Re=S.call(this,we),Qe=[],Ie=0;Ie<Re.length;Ie+=1)Qe.indexOf(Re[Ie])===-1&&Qe.push(Re[Ie]);R(Qe);for(var it=Qe[0],nt=Qe[Qe.length-1],at=it;at<nt+1;at++){this.pdf.setPage(at);var ut=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pt=at===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],He=at===1?0:$e+(at-2)*mt;if(this.ctx.clip_path.length!==0){var rn=this.path;Ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(Ke,this.posX+this.margin[3],-He+pt+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=rn}var Et=JSON.parse(JSON.stringify(we));Et=T([Et],this.posX+this.margin[3],-He+pt+this.ctx.prevPageLastElemOffset)[0];var bt=(at>it||at<nt)&&w.call(this);bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ut,mt,null).clip().discardPath()),this.pdf.addImage(I,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,dt),bt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(I,"JPEG",we.x,we.y,we.w,we.h,null,null,dt)};var S=function(I,z,K){var Y=[];z=z||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Q=this.posY+this.ctx.prevPageLastElemOffset;switch(I.type){default:case"mt":case"lt":Y.push(Math.floor((I.y+Q)/K)+1);break;case"arc":Y.push(Math.floor((I.y+Q-I.radius)/K)+1),Y.push(Math.floor((I.y+Q+I.radius)/K)+1);break;case"qct":var re=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x,I.y);Y.push(Math.floor((re.y+Q)/K)+1),Y.push(Math.floor((re.y+re.h+Q)/K)+1);break;case"bct":var he=Le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x2,I.y2,I.x,I.y);Y.push(Math.floor((he.y+Q)/K)+1),Y.push(Math.floor((he.y+he.h+Q)/K)+1);break;case"rect":Y.push(Math.floor((I.y+Q)/K)+1),Y.push(Math.floor((I.y+I.h+Q)/K)+1)}for(var fe=0;fe<Y.length;fe+=1)for(;this.pdf.internal.getNumberOfPages()<Y[fe];)x.call(this);return Y},x=function(){var I=this.fillStyle,z=this.strokeStyle,K=this.font,Y=this.lineCap,Q=this.lineWidth,re=this.lineJoin;this.pdf.addPage(),this.fillStyle=I,this.strokeStyle=z,this.font=K,this.lineCap=Y,this.lineWidth=Q,this.lineJoin=re},T=function(I,z,K){for(var Y=0;Y<I.length;Y++)switch(I[Y].type){case"bct":I[Y].x2+=z,I[Y].y2+=K;case"qct":I[Y].x1+=z,I[Y].y1+=K;default:I[Y].x+=z,I[Y].y+=K}return I},R=function(I){return I.sort(function(z,K){return z-K})},E=function(I,z){var K=this.fillStyle,Y=this.strokeStyle,Q=this.lineCap,re=this.lineWidth,he=Math.abs(re*this.ctx.transform.scaleX),fe=this.lineJoin;if(this.autoPaging){for(var me,Ae,Oe=JSON.parse(JSON.stringify(this.path)),Te=JSON.parse(JSON.stringify(this.path)),Me=[],q=0;q<Te.length;q++)if(Te[q].x!==void 0)for(var Ce=S.call(this,Te[q]),dt=0;dt<Ce.length;dt+=1)Me.indexOf(Ce[dt])===-1&&Me.push(Ce[dt]);for(var ze=0;ze<Me.length;ze++)for(;this.pdf.internal.getNumberOfPages()<Me[ze];)x.call(this);R(Me);for(var we=Me[0],Ke=Me[Me.length-1],Re=we;Re<Ke+1;Re++){this.pdf.setPage(Re),this.fillStyle=K,this.strokeStyle=Y,this.lineCap=Q,this.lineWidth=he,this.lineJoin=fe;var Qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Re===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=Re===1?0:it+(Re-2)*nt;if(this.ctx.clip_path.length!==0){var ut=this.path;me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(me,this.posX+this.margin[3],-at+Ie+this.ctx.prevPageLastElemOffset),U.call(this,I,!0),this.path=ut}if(Ae=JSON.parse(JSON.stringify(Oe)),this.path=T(Ae,this.posX+this.margin[3],-at+Ie+this.ctx.prevPageLastElemOffset),z===!1||Re===0){var pt=(Re>we||Re<Ke)&&w.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qe,nt,null).clip().discardPath()),U.call(this,I,z),pt&&this.pdf.restoreGraphicsState()}this.lineWidth=re}this.path=Oe}else this.lineWidth=he,U.call(this,I,z),this.lineWidth=re},U=function(I,z){if((I!=="stroke"||z||!_.call(this))&&(I==="stroke"||z||!p.call(this))){for(var K,Y,Q=[],re=this.path,he=0;he<re.length;he++){var fe=re[he];switch(fe.type){case"begin":Q.push({begin:!0});break;case"close":Q.push({close:!0});break;case"mt":Q.push({start:fe,deltas:[],abs:[]});break;case"lt":var me=Q.length;if(re[he-1]&&!isNaN(re[he-1].x)&&(K=[fe.x-re[he-1].x,fe.y-re[he-1].y],me>0)){for(;me>=0;me--)if(Q[me-1].close!==!0&&Q[me-1].begin!==!0){Q[me-1].deltas.push(K),Q[me-1].abs.push(fe);break}}break;case"bct":K=[fe.x1-re[he-1].x,fe.y1-re[he-1].y,fe.x2-re[he-1].x,fe.y2-re[he-1].y,fe.x-re[he-1].x,fe.y-re[he-1].y],Q[Q.length-1].deltas.push(K);break;case"qct":var Ae=re[he-1].x+2/3*(fe.x1-re[he-1].x),Oe=re[he-1].y+2/3*(fe.y1-re[he-1].y),Te=fe.x+2/3*(fe.x1-fe.x),Me=fe.y+2/3*(fe.y1-fe.y),q=fe.x,Ce=fe.y;K=[Ae-re[he-1].x,Oe-re[he-1].y,Te-re[he-1].x,Me-re[he-1].y,q-re[he-1].x,Ce-re[he-1].y],Q[Q.length-1].deltas.push(K);break;case"arc":Q.push({deltas:[],abs:[],arc:!0}),Array.isArray(Q[Q.length-1].abs)&&Q[Q.length-1].abs.push(fe)}}Y=z?null:I==="stroke"?"stroke":"fill";for(var dt=!1,ze=0;ze<Q.length;ze++)if(Q[ze].arc)for(var we=Q[ze].abs,Ke=0;Ke<we.length;Ke++){var Re=we[Ke];Re.type==="arc"?J.call(this,Re.x,Re.y,Re.radius,Re.startAngle,Re.endAngle,Re.counterclockwise,void 0,z,!dt):j.call(this,Re.x,Re.y),dt=!0}else if(Q[ze].close===!0)this.pdf.internal.out("h"),dt=!1;else if(Q[ze].begin!==!0){var Qe=Q[ze].start.x,Ie=Q[ze].start.y;$.call(this,Q[ze].deltas,Qe,Ie),dt=!0}Y&&F.call(this,Y),z&&C.call(this)}},Z=function(I){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return I-K;case"top":return I+z-K;case"hanging":return I+z-2*K;case"middle":return I+z/2-K;default:return I}},O=function(I){return I+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var I=function(){};return I.colorStops=[],I.addColorStop=function(z,K){this.colorStops.push([z,K])},I.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},I.isCanvasGradient=!0,I},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var J=function(I,z,K,Y,Q,re,he,fe,me){for(var Ae=oe.call(this,K,Y,Q,re),Oe=0;Oe<Ae.length;Oe++){var Te=Ae[Oe];Oe===0&&(me?A.call(this,Te.x1+I,Te.y1+z):j.call(this,Te.x1+I,Te.y1+z)),V.call(this,I,z,Te.x2,Te.y2,Te.x3,Te.y3,Te.x4,Te.y4)}fe?C.call(this):F.call(this,he)},F=function(I){switch(I){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},C=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(I,z){this.pdf.internal.out(n(I)+" "+r(z)+" m")},D=function(I){var z;switch(I.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var K,Y,Q,re=this.pdf.getTextDimensions(I.text),he=Z.call(this,I.y),fe=O.call(this,he)-re.h,me=this.ctx.transform.applyToPoint(new o(I.x,he));if(this.autoPaging){var Ae=this.ctx.transform.decompose(),Oe=new c;Oe=(Oe=(Oe=Oe.multiply(Ae.translate)).multiply(Ae.skew)).multiply(Ae.scale);for(var Te=this.ctx.transform.applyToRectangle(new l(I.x,he,re.w,re.h)),Me=Oe.applyToRectangle(new l(I.x,fe,re.w,re.h)),q=S.call(this,Me),Ce=[],dt=0;dt<q.length;dt+=1)Ce.indexOf(q[dt])===-1&&Ce.push(q[dt]);R(Ce);for(var ze=Ce[0],we=Ce[Ce.length-1],Ke=ze;Ke<we+1;Ke++){this.pdf.setPage(Ke);var Re=Ke===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ie=this.pdf.internal.pageSize.height-this.margin[2],it=Ie-this.margin[0],nt=this.pdf.internal.pageSize.width-this.margin[1],at=nt-this.margin[3],ut=Ke===1?0:Qe+(Ke-2)*it;if(this.ctx.clip_path.length!==0){var pt=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(K,this.posX+this.margin[3],-1*ut+Re),U.call(this,"fill",!0),this.path=pt}var $e=T([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-ut+Re+this.ctx.prevPageLastElemOffset)[0];I.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*I.scale),Q=this.lineWidth,this.lineWidth=Q*I.scale);var mt=this.autoPaging!=="text";if(mt||$e.y+$e.h<=Ie){if(mt||$e.y>=Re&&$e.x<=nt){var He=mt?I.text:this.pdf.splitTextToSize(I.text,I.maxWidth||nt-$e.x)[0],rn=T([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-ut+Re+this.ctx.prevPageLastElemOffset)[0],Et=mt&&(Ke>ze||Ke<we)&&w.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,it,null).clip().discardPath()),this.pdf.text(He,rn.x,rn.y,{angle:I.angle,align:z,renderingMode:I.renderingMode}),Et&&this.pdf.restoreGraphicsState()}}else $e.y<Ie&&(this.ctx.prevPageLastElemOffset+=Ie-$e.y);I.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=Q)}}else I.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*I.scale),Q=this.lineWidth,this.lineWidth=Q*I.scale),this.pdf.text(I.text,me.x+this.posX,me.y+this.posY,{angle:I.angle,align:z,renderingMode:I.renderingMode,maxWidth:I.maxWidth}),I.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=Q)},j=function(I,z,K,Y){K=K||0,Y=Y||0,this.pdf.internal.out(n(I+K)+" "+r(z+Y)+" l")},$=function(I,z,K){return this.pdf.lines(I,z,K,null,null)},V=function(I,z,K,Y,Q,re,he,fe){this.pdf.internal.out([e(a(K+I)),e(i(Y+z)),e(a(Q+I)),e(i(re+z)),e(a(he+I)),e(i(fe+z)),"c"].join(" "))},oe=function(I,z,K,Y){for(var Q=2*Math.PI,re=Math.PI/2;z>K;)z-=Q;var he=Math.abs(K-z);he<Q&&Y&&(he=Q-he);for(var fe=[],me=Y?-1:1,Ae=z;he>1e-5;){var Oe=Ae+me*Math.min(he,re);fe.push(le.call(this,I,Ae,Oe)),he-=Math.abs(Oe-Ae),Ae=Oe}return fe},le=function(I,z,K){var Y=(K-z)/2,Q=I*Math.cos(Y),re=I*Math.sin(Y),he=Q,fe=-re,me=he*he+fe*fe,Ae=me+he*Q+fe*re,Oe=4/3*(Math.sqrt(2*me*Ae)-Ae)/(he*re-fe*Q),Te=he-Oe*fe,Me=fe+Oe*he,q=Te,Ce=-Me,dt=Y+z,ze=Math.cos(dt),we=Math.sin(dt);return{x1:I*Math.cos(z),y1:I*Math.sin(z),x2:Te*ze-Me*we,y2:Te*we+Me*ze,x3:q*ze-Ce*we,y3:q*we+Ce*ze,x4:I*Math.cos(K),y4:I*Math.sin(K)}},ae=function(I){return 180*I/Math.PI},de=function(I,z,K,Y,Q,re){var he=I+.5*(K-I),fe=z+.5*(Y-z),me=Q+.5*(K-Q),Ae=re+.5*(Y-re),Oe=Math.min(I,Q,he,me),Te=Math.max(I,Q,he,me),Me=Math.min(z,re,fe,Ae),q=Math.max(z,re,fe,Ae);return new l(Oe,Me,Te-Oe,q-Me)},Le=function(I,z,K,Y,Q,re,he,fe){var me,Ae,Oe,Te,Me,q,Ce,dt,ze,we,Ke,Re,Qe,Ie,it=K-I,nt=Y-z,at=Q-K,ut=re-Y,pt=he-Q,$e=fe-re;for(Ae=0;Ae<41;Ae++)ze=(Ce=(Oe=I+(me=Ae/40)*it)+me*((Me=K+me*at)-Oe))+me*(Me+me*(Q+me*pt-Me)-Ce),we=(dt=(Te=z+me*nt)+me*((q=Y+me*ut)-Te))+me*(q+me*(re+me*$e-q)-dt),Ae==0?(Ke=ze,Re=we,Qe=ze,Ie=we):(Ke=Math.min(Ke,ze),Re=Math.min(Re,we),Qe=Math.max(Qe,ze),Ie=Math.max(Ie,we));return new l(Math.round(Ke),Math.round(Re),Math.round(Qe-Ke),Math.round(Ie-Re))},pe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var I,z,K=(I=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:I,lineDashOffset:z}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(Xe.API),(function(t){var e=function(o){var l,c,h,f,m,b,p,_,w,S;for(c=[],h=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>h;h+=4)(m=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(b=(m=((m=((m=((m=(m-(S=m%85))/85)-(w=m%85))/85)-(_=m%85))/85)-(p=m%85))/85)%85,c.push(b+33,p+33,_+33,w+33,S+33)):c.push(122);return(function(x,T){for(var R=T;R>0;R--)x.pop()})(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(o){var l,c,h,f,m,b=String,p="length",_=255,w="charCodeAt",S="slice",x="replace";for(o[S](-2),o=o[S](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),h=[],f=0,m=(o+=l="uuuuu"[S](o[p]%5||5))[p];m>f;f+=5)c=52200625*(o[w](f)-33)+614125*(o[w](f+1)-33)+7225*(o[w](f+2)-33)+85*(o[w](f+3)-33)+(o[w](f+4)-33),h.push(_&c>>24,_&c>>16,_&c>>8,_&c);return(function(T,R){for(var E=R;E>0;E--)T.pop()})(h,l[p]),b.fromCharCode.apply(b,h)},r=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",h=0;h<o.length;h+=2)c+=String.fromCharCode("0x"+(o[h]+o[h+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Xu(l)).reduce(function(h,f){return h+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var c=0,h=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":h=n(h),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=a(h),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=r(h),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=i(h),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:h,reverseChain:f.reverse().join(" ")}}})(Xe.API),(function(t){t.loadFile=function(e,n,r){return(function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(c,h,f){var m=new XMLHttpRequest,b=0,p=function(_){var w=_.length,S=[],x=String.fromCharCode;for(b=0;b<w;b+=1)S.push(x(255&_.charCodeAt(b)));return S.join("")};if(m.open("GET",c,!h),m.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(m.onload=function(){m.status===200?f(p(this.responseText)):f(void 0)}),m.send(null),h&&m.status===200)return p(m.responseText)})(a,i,o)}catch{}return l})(e,n,r)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Xe.API),(function(t){function e(){return(ft.html2canvas?Promise.resolve(ft.html2canvas):eu(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(ft.DOMPurify?Promise.resolve(ft.DOMPurify):eu(()=>Promise.resolve().then(()=>rb),void 0)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=Ht(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var h=document.createElement(l);for(var f in c.className&&(h.className=c.className),c.innerHTML&&c.dompurify&&(h.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)h.style[f]=c.style[f];return h},i=function l(c,h){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),m=c.firstChild;m;m=m.nextSibling)h!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||f.appendChild(l(m,h));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var h=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),h);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||(function(h){switch(r(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),c){case"string":return this.then(n).then(function(h){return this.set({src:a("div",{innerHTML:l,dompurify:h})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,c(this.prop.container,h)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var h=this.opt.jsPDF,f=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var _=f[p],w=_.src.find(function(S){return S.format==="truetype"});w&&h.addFont(w.url,_.ref.name,_.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,h.context2d.save(!0),c(this.prop.container,b)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=l[h]};switch(h){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[h]=l[h]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var h=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(h):h})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(h,f){return Math.floor(h*f/72*96)}return this.then(function(){(l=l||Xe.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,h,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),h!=null&&(this.progress.n=h),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,h,f){return this.setProgress(l?this.progress.val+l:null,c||null,h?this.progress.n+h:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var h=this;return this.thenCore(l,c,function(f,m){return h.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(b){return h.updateProgress(null,f),b}).then(f,m).then(function(b){return h.updateProgress(1),b})})},o.prototype.thenCore=function(l,c,h){h=h||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),b=h.call(m,l,c);return o.convert(b,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(h){c=c.thenCore(h)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Xe.getPageSize=function(l,c,h){if(Ht(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,h=f.format||h}c=c||"mm",h=h||"a4",l=(""+(l||"P")).toLowerCase();var m,b=(""+h).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+c}var _,w=0,S=0;if(p.hasOwnProperty(b))w=p[b][1]/m,S=p[b][0]/m;else try{w=h[1],S=h[0]}catch{throw new Error("Invalid format: "+h)}if(l==="p"||l==="portrait")l="p",S>w&&(_=S,S=w,w=_);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",w>S&&(_=S,S=w,w=_)}return{width:S,height:w,unit:c,k:m,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(bu):null;var h=new o(c);return c.worker?h:h.from(l).doCallback()}})(Xe.API),Xe.API.addJS=function(t){var e,n,r=(function(a){for(var i="",o=0;o<a.length;o++){var l=a[o];if(l==="("||l===")"){for(var c=0,h=o-1;h>=0&&a[h]==="\\";h--)c++;i+=c%2==0?"\\"+l:l}else i+=l}return i})(t);return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+r+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=n.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,f=[];for(i=0;i<h;i++){var m=n.internal.newObject();f.push(m);var b=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var p=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<f.length;i++)n.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+p+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,a,i){var o={title:a,options:i,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var a=0;a<r.children.length;a++)this.genIds_r(r.children[a])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var o=r.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var h=0;h<r.children.length;h++)this.renderItems(r.children[h])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,a){for(var i=0;i<a.children.length;i++)r.count++,this.count_r(r,a.children[i]);return r.count}}])})(Xe.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,a,i,o,l){var c,h=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=(function(m){for(var b,p=256*m.charCodeAt(4)+m.charCodeAt(5),_=m.length,w={width:0,height:0,numcomponents:1},S=4;S<_;S+=2){if(S+=p,e.indexOf(m.charCodeAt(S+1))!==-1){b=256*m.charCodeAt(S+5)+m.charCodeAt(S+6),w={width:256*m.charCodeAt(S+7)+m.charCodeAt(S+8),height:b,numcomponents:m.charCodeAt(S+9)};break}p=256*m.charCodeAt(S+2)+m.charCodeAt(S+3)}return w})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:h,index:r,alias:a}}return f}})(Xe.API),Xe.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,i=my(t,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,h=i.palette,f=i.depth;a=h&&c===1?(function(J){for(var F=J.width,C=J.height,A=J.data,D=J.palette,j=J.depth,$=!1,V=[],oe=[],le=void 0,ae=!1,de=0,Le=0;Le<D.length;Le++){var pe=mf(D[Le],4),I=pe[0],z=pe[1],K=pe[2],Y=pe[3];V.push(I,z,K),Y!=null&&(Y===0?(de++,oe.length<1&&oe.push(Le)):Y<255&&(ae=!0))}if(ae||de>1){$=!0,oe=void 0;var Q=F*C;le=new Uint8Array(Q);for(var re=new DataView(A.buffer),he=0;he<Q;he++){var fe=_u(re,he,j),me=mf(D[fe],4)[3];le[he]=me}}else de===0&&(oe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:$?8:void 0,colorBytes:A,alphaBytes:le,needSMask:$,palette:V,mask:oe}})(i):c===2||c===4?(function(J){for(var F=J.data,C=J.width,A=J.height,D=J.channels,j=J.depth,$=D===2?"DeviceGray":"DeviceRGB",V=D-1,oe=C*A,le=V,ae=oe*le,de=1*oe,Le=Math.ceil(ae*j/8),pe=Math.ceil(de*j/8),I=new Uint8Array(Le),z=new Uint8Array(pe),K=new DataView(F.buffer),Y=new DataView(I.buffer),Q=new DataView(z.buffer),re=!1,he=0;he<oe;he++){for(var fe=he*D,me=0;me<le;me++)yp(Y,_u(K,fe+me,j),he*le+me,j);var Ae=_u(K,fe+le,j);Ae<(1<<j)-1&&(re=!0),yp(Q,Ae,1*he,j)}return{colorSpace:$,colorsPerPixel:V,sMaskBitsPerComponent:re?j:void 0,colorBytes:I,alphaBytes:z,needSMask:re}})(i):(function(J){var F=J.data,C=J.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:C,colorsPerPixel:C==="DeviceGray"?1:3,colorBytes:F instanceof Uint16Array?(function(A){for(var D=A.length,j=new Uint8Array(2*D),$=new DataView(j.buffer,j.byteOffset,j.byteLength),V=0;V<D;V++)$.setUint16(2*V,A[V],!1);return j})(F):F,needSMask:!1}})(i);var m,b,p,_=a,w=_.colorSpace,S=_.colorsPerPixel,x=_.sMaskBitsPerComponent,T=_.colorBytes,R=_.alphaBytes,E=_.needSMask,U=_.palette,Z=_.mask,O=null;return r!==Xe.API.image_compression.NONE&&typeof Xu=="function"?(O=(function(J){var F;switch(J){case Xe.API.image_compression.FAST:F=11;break;case Xe.API.image_compression.MEDIUM:F=13;break;case Xe.API.image_compression.SLOW:F=14;break;default:F=12}return F})(r),m=this.decode.FLATE_DECODE,b="/Predictor ".concat(O," /Colors ").concat(S," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=pp(T,Math.ceil(o*S*f/8),S,f,r),E&&(p=pp(R,Math.ceil(o*x/8),1,x,r))):(m=void 0,b=void 0,t=T,E&&(p=R)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:n,data:t,index:e,filter:m,decodeParameters:b,transparency:Z,palette:U,sMask:p,predictor:O,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:x,colorSpace:w}}},(function(t){t.processGIF89A=function(e,n,r,a){var i=new jy(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var h={data:c,width:o,height:l},f=new wu(100).encode(h,100);return t.processJPEG.call(this,f,n,r,a)},t.processGIF87A=t.processGIF89A})(Xe.API),Kr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kr.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[t]()}catch(n){Kt.log("bit decode error:"+n)}},Kr.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},Kr.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<t;a++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*a*4,l=i>>4,c=15&i,h=this.palette[l];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*a+1>=this.width)break;h=this.palette[c],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Kr.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Kr.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,h=i>>15?255:0,f=r*this.width*4+4*a;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=h}this.pos+=t}},Kr.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,h=(o>>11)/e*255|0,f=a*this.width*4+4*i;this.data[f]=h,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},Kr.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Kr.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=r,this.data[l+3]=o}},Kr.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,n,r,a){var i=new Kr(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},h=new wu(100).encode(c,100);return t.processJPEG.call(this,h,n,r,a)}})(Xe.API),wp.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,n,r,a){var i=new wp(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},h=new wu(100).encode(c,100);return t.processJPEG.call(this,h,n,r,a)}})(Xe.API),Xe.API.processRGBA=function(t,e,n){for(var r=t.data,a=r.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,h=0;h<a;h+=4){var f=r[h],m=r[h+1],b=r[h+2],p=r[h+3];i[l++]=f,i[l++]=m,i[l++]=b,o[c++]=p}var _=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:_,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Xe.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},us=Xe.API,El=us.getCharWidthsArray=function(t,e){var n,r,a=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,h=e.kerning?e.kerning:a.metadata.Unicode.kerning,f=h.fof?h.fof:1,m=e.doKerning!==!1,b=0,p=t.length,_=0,w=l[0]||c,S=[];for(n=0;n<p;n++)r=t.charCodeAt(n),typeof a.metadata.widthOfString=="function"?S.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(r))+o*(1e3/i)||0)/1e3):(b=m&&Ht(h[r])==="object"&&!isNaN(parseInt(h[r][_],10))?h[r][_]/f:0,S.push((l[r]||w)/c+b)),_=r;return S},hp=us.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return us.processArabic&&(t=us.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,a)/n:El.apply(this,arguments).reduce(function(i,o){return i+o},0)},dp=function(t,e,n,r){for(var a=[],i=0,o=t.length,l=0;i!==o&&l+e[i]<n;)l+=e[i],i++;a.push(t.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>r&&(a.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&a.push(t.slice(c,i)),a},fp=function(t,e,n){n||(n={});var r,a,i,o,l,c,h,f=[],m=[f],b=n.textIndent||0,p=0,_=0,w=t.split(" "),S=El.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?w[0].length+2:n.lineIndent||0){var x=Array(c).join(" "),T=[];w.map(function(E){(E=E.split(/\s*\n/)).length>1?T=T.concat(E.map(function(U,Z){return(Z&&U.length?`
`:"")+U})):T.push(E[0])}),w=T,c=hp.apply(this,[x,n])}for(i=0,o=w.length;i<o;i++){var R=0;if(r=w[i],c&&r[0]==`
`&&(r=r.substr(1),R=1),b+p+(_=(a=El.apply(this,[r,n])).reduce(function(E,U){return E+U},0))>e||R){if(_>e){for(l=dp.apply(this,[r,a,e-(b+p),e]),f.push(l.shift()),f=[l.pop()];l.length;)m.push([l.shift()]);_=a.slice(r.length-(f[0]?f[0].length:0)).reduce(function(E,U){return E+U},0)}else f=[r];m.push(f),b=_+c,p=S}else f.push(r),b+=p+_,p=S}return h=c?function(E,U){return(U?x:"")+E.join(" ")}:function(E){return E.join(" ")},m.map(h)},us.splitTextToSize=function(t,e,n){var r,a=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var m=this.internal.getFont(f.fontName,f.fontStyle),b="Unicode";return m.metadata[b]?{widths:m.metadata[b].widths||{0:1},kerning:m.metadata[b].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=n.lineIndent;var l,c,h=[];for(l=0,c=r.length;l<c;l++)h=h.concat(fp.apply(this,[r[l],o,i]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},a={},i=0;i<16;i++)r[n[i]]=e[i],a[e[i]]=n[i];var o=function(b){return"0x"+parseInt(b,10).toString(16)},l=t.__fontmetrics__.compress=function(b){var p,_,w,S,x=["{"];for(var T in b){if(p=b[T],isNaN(parseInt(T,10))?_="'"+T+"'":(T=parseInt(T,10),_=(_=o(T).slice(2)).slice(0,-1)+a[_.slice(-1)]),typeof p=="number")p<0?(w=o(p).slice(3),S="-"):(w=o(p).slice(2),S=""),w=S+w.slice(0,-1)+a[w.slice(-1)];else{if(Ht(p)!=="object")throw new Error("Don't know what to do with value type "+Ht(p)+".");w=l(p)}x.push(_+w)}return x.push("}"),x.join("")},c=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,_,w,S,x={},T=1,R=x,E=[],U="",Z="",O=b.length-1,J=1;J<O;J+=1)(S=b[J])=="'"?p?(w=p.join(""),p=void 0):p=[]:p?p.push(S):S=="{"?(E.push([R,w]),R={},w=void 0):S=="}"?((_=E.pop())[0][_[1]]=R,w=void 0,R=_[0]):S=="-"?T=-1:w===void 0?r.hasOwnProperty(S)?(U+=r[S],w=parseInt(U,16)*T,T=1,U=""):U+=S:r.hasOwnProperty(S)?(Z+=r[S],R[w]=parseInt(Z,16)*T,T=1,w=void 0,Z=""):Z+=S;return x},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},m={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var p=b.font,_=m.Unicode[p.postScriptName];_&&(p.metadata.Unicode={},p.metadata.Unicode.widths=_.widths,p.metadata.Unicode.kerning=_.kerning);var w=f.Unicode[p.postScriptName];w&&(p.metadata.Unicode.encoding=w,p.encoding=w.codePages[0])}])})(Xe.API),(function(t){var e=function(n){for(var r=n.length,a=new Uint8Array(r),i=0;i<r;i++)a[i]=n.charCodeAt(i);return a};t.API.events.push(["addFont",function(n){var r=void 0,a=n.font,i=n.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(r=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Ol(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,r)}}])})(Xe),Xe.API.addSvgAsImage=function(t,e,n,r,a,i,o,l){if(isNaN(e)||isNaN(n))throw Kt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a))throw Kt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=a;var h=c.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(ft.canvg?Promise.resolve(ft.canvg):eu(()=>import("./index.es-CkF-8K8v.js"),[])).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(h,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(f)}).then(function(){m.addImage(c.toDataURL("image/jpeg",1),e,n,r,a,o,l)})},Xe.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(e,n);return this},Xe.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],h=0,f=0,m=0;function b(_,w){var S,x=!1;for(S=0;S<_.length;S+=1)_[S]===w&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=l.length;for(m=0;m<p;m+=1)n[l[m]].value=n[l[m]].defaultValue,n[l[m]].explicitSet=!1}if(Ht(t)==="object"){for(a in t)if(i=t[a],b(l,a)&&i!==void 0){if(n[a].type==="boolean"&&typeof i=="boolean")n[a].value=i;else if(n[a].type==="name"&&b(n[a].valueSet,i))n[a].value=i;else if(n[a].type==="integer"&&Number.isInteger(i))n[a].value=i;else if(n[a].type==="array"){for(h=0;h<i.length;h+=1)if(r=!0,i[h].length===1&&typeof i[h][0]=="number")c.push(String(i[h]-1));else if(i[h].length>1){for(f=0;f<i[h].length;f+=1)typeof i[h][f]!="number"&&(r=!1);r===!0&&c.push([i[h][0]-1,i[h][1]-1].join(" "))}n[a].value="["+c.join(" ")+"]"}else n[a].value=n[a].defaultValue;n[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var _,w=[];for(_ in n)n[_].explicitSet===!0&&(n[_].type==="name"?w.push("/"+_+" /"+n[_].value):w.push("/"+_+" "+n[_].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},Xe.API.addMetadata=function(t,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",My),this.internal.events.subscribe("postPutResources",By)),this},(function(t){var e=t.API,n=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,h=["","0","00","000","0000"],f=[""],m=0,b=i.length;m<b;++m){if(l=o.metadata.characterToGlyph(i.charCodeAt(m)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(m),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(h[4-l.length],l)}return f.join("")},r=function(i){var o,l,c,h,f,m,b;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,b=(l=Object.keys(i).sort(function(p,_){return p-_})).length;m<b;m++)o=l[m],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(h=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+h+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,h=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var m=l.metadata.Unicode.widths,b=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",_=0;_<b.length;_++)p+=String.fromCharCode(b[_]);var w=h();f({data:p,addLength1:!0,objectId:w}),c("endobj");var S=h();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var x=h();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+gs(l.fontName)),c("/FontFile2 "+w+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var T=h();c("<<"),c("/Type /Font"),c("/BaseFont /"+gs(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+t.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=h(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+S+" 0 R"),c("/BaseFont /"+gs(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+T+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,h=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var m=l.metadata.rawData,b="",p=0;p<m.length;p++)b+=String.fromCharCode(m[p]);var _=h();f({data:b,addLength1:!0,objectId:_}),c("endobj");var w=h();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var S=h();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+_+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+gs(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=h();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+gs(l.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,l=i.text||"",c=i.x,h=i.y,f=i.options||{},m=i.mutex||{},b=m.pdfEscape,p=m.activeFontKey,_=m.fonts,w=p,S="",x=0,T="",R=_[w].encoding;if(_[w].encoding!=="Identity-H")return{text:l,x:c,y:h,options:f,mutex:m};for(T=l,w=p,Array.isArray(l)&&(T=l[0]),x=0;x<T.length;x+=1)_[w].metadata.hasOwnProperty("cmap")&&(o=_[w].metadata.cmap.unicode.codeMap[T[x].charCodeAt(0)]),o||T[x].charCodeAt(0)<256&&_[w].metadata.hasOwnProperty("Unicode")?S+=T[x]:S+="";var E="";return parseInt(w.slice(1))<14||R==="WinAnsiEncoding"?E=b(S,w).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):R==="Identity-H"&&(E=n(S,_[w])),m.isHex=!0,{text:E,x:c,y:h,options:f,mutex:m}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?l.push([a(Object.assign({},c,{text:o[h][0]})).text,o[h][1],o[h][2]]):l.push(a(Object.assign({},c,{text:o[h]})).text);i.text=l}else i.text=a(Object.assign({},c,{text:o})).text}])})(Xe),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(Xe.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var a,i,o,l,c,h,f,m=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],_={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),T=!1,R=0;this.__bidiEngine__={};var E=function(A){var D=A.charCodeAt(),j=D>>8,$=w[j];return $!==void 0?m[256*$+(255&D)]:j===252||j===253?"AL":x.test(j)?"L":j===8?"R":"N"},U=function(A){for(var D,j=0;j<A.length;j++){if((D=E(A.charAt(j)))==="L")return!1;if(D==="R")return!0}return!1},Z=function(A,D,j,$){var V,oe,le,ae,de=D[$];switch(de){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":T=!1;break;case"N":case"AN":break;case"EN":T&&(de="AN");break;case"AL":T=!0,de="R";break;case"WS":case"BN":de="N";break;case"CS":$<1||$+1>=D.length||(V=j[$-1])!=="EN"&&V!=="AN"||(oe=D[$+1])!=="EN"&&oe!=="AN"?de="N":T&&(oe="AN"),de=oe===V?oe:"N";break;case"ES":de=(V=$>0?j[$-1]:"B")==="EN"&&$+1<D.length&&D[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&j[$-1]==="EN"){de="EN";break}if(T){de="N";break}for(le=$+1,ae=D.length;le<ae&&D[le]==="ET";)le++;de=le<ae&&D[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ae=D.length,le=$+1;le<ae&&D[le]==="NSM";)le++;if(le<ae){var Le=A[$],pe=Le>=1425&&Le<=2303||Le===64286;if(V=D[le],pe&&(V==="R"||V==="AL")){de="R";break}}}de=$<1||(V=D[$-1])==="B"?"N":j[$-1];break;case"B":T=!1,a=!0,de=R;break;case"S":i=!0,de="N"}return de},O=function(A,D,j){var $=A.split("");return j&&J($,j,{hiLevel:R}),$.reverse(),D&&D.reverse(),$.join("")},J=function(A,D,j){var $,V,oe,le,ae,de=-1,Le=A.length,pe=0,I=[],z=R?p:b,K=[];for(T=!1,a=!1,i=!1,V=0;V<Le;V++)K[V]=E(A[V]);for(oe=0;oe<Le;oe++){if(ae=pe,I[oe]=Z(A,K,I,oe),$=240&(pe=z[ae][_[I[oe]]]),pe&=15,D[oe]=le=z[pe][5],$>0)if($===16){for(V=de;V<oe;V++)D[V]=1;de=-1}else de=-1;if(z[pe][6])de===-1&&(de=oe);else if(de>-1){for(V=de;V<oe;V++)D[V]=le;de=-1}K[oe]==="B"&&(D[oe]=0),j.hiLevel|=le}i&&(function(Y,Q,re){for(var he=0;he<re;he++)if(Y[he]==="S"){Q[he]=R;for(var fe=he-1;fe>=0&&Y[fe]==="WS";fe--)Q[fe]=R}})(K,D,Le)},F=function(A,D,j,$,V){if(!(V.hiLevel<A)){if(A===1&&R===1&&!a)return D.reverse(),void(j&&j.reverse());for(var oe,le,ae,de,Le=D.length,pe=0;pe<Le;){if($[pe]>=A){for(ae=pe+1;ae<Le&&$[ae]>=A;)ae++;for(de=pe,le=ae-1;de<le;de++,le--)oe=D[de],D[de]=D[le],D[le]=oe,j&&(oe=j[de],j[de]=j[le],j[le]=oe);pe=ae}pe++}}},C=function(A,D,j){var $=A.split(""),V={hiLevel:R};return j||(j=[]),J($,j,V),(function(oe,le,ae){if(ae.hiLevel!==0&&f)for(var de,Le=0;Le<oe.length;Le++)le[Le]===1&&(de=S.indexOf(oe[Le]))>=0&&(oe[Le]=S[de+1])})($,j,V),F(2,$,D,j,V),F(1,$,D,j,V),$.join("")};return this.__bidiEngine__.doBidiReorder=function(A,D,j){if((function(V,oe){if(oe)for(var le=0;le<V.length;le++)oe[le]=le;l===void 0&&(l=U(V)),h===void 0&&(h=U(V))})(A,D),o||!c||h)if(o&&c&&l^h)R=l?1:0,A=O(A,D,j);else if(!o&&c&&h)R=l?1:0,A=C(A,D,j),A=O(A,D);else if(!o||l||c||h){if(o&&!c&&l^h)A=O(A,D),l?(R=0,A=C(A,D,j)):(R=1,A=C(A,D,j),A=O(A,D));else if(o&&l&&!c&&h)R=1,A=C(A,D,j),A=O(A,D);else if(!o&&!c&&l^h){var $=f;l?(R=1,A=C(A,D,j),R=0,f=!1,A=C(A,D,j),f=$):(R=0,A=C(A,D,j),A=O(A,D),R=1,f=!1,A=C(A,D,j),f=$,A=O(A,D))}}else R=0,A=C(A,D,j);else R=l?1:0,A=C(A,D,j);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,h=A.isOutputRtl,f=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var a=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([n.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([n.doBidiReorder(a[l])]);r.text=o}else r.text=n.doBidiReorder(a);n.setOptions({isInputVisual:!0})}])})(Xe),Xe.API.TTFFont=(function(){function t(e){var n;if(this.rawData=e,n=this.contents=new ua(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new e_(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Uy(this.contents),this.head=new $y(this),this.name=new Vy(this),this.cmap=new lm(this),this.toUnicode={},this.hhea=new zy(this),this.maxp=new Ky(this),this.hmtx=new Jy(this),this.post=new Wy(this),this.os2=new Hy(this),this.loca=new Qy(this),this.glyf=new Yy(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,h;for(h=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(r=255&(a=this.post.italic_angle),32768&(n=a>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var a,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t})();var ii,ua=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,a;for(a=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)a.push(this.writeByte(e.charCodeAt(n)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,a,i,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*a+16777216*i+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,a,i;for(i=[],r=0,a=e.length;r<a;r++)n=e[r],i.push(this.writeByte(n));return i},t})(),Uy=(function(){var t;function e(n){var r,a,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,a,i,o,l,c,h,f,m,b,p,_,w;for(w in p=Object.keys(n).length,c=Math.log(2),m=16*Math.floor(Math.log(p)/c),o=Math.floor(m/c),f=16*p-m,(a=new ua).writeInt(this.scalarType),a.writeShort(p),a.writeShort(m),a.writeShort(o),a.writeShort(f),i=16*p,h=a.pos+i,l=null,_=[],n)for(b=n[w],a.writeString(w),a.writeInt(t(b)),a.writeInt(h),a.writeInt(b.length),_=_.concat(b),w==="head"&&(l=h),h+=b.length;h%4;)_.push(0),h++;return a.write(_),r=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(r),a.data},t=function(n){var r,a,i,o;for(n=cm.call(n);n.length%4;)n.push(0);for(i=new ua(n),a=0,r=0,o=n.length;r<o;r=r+=4)a+=i.readUInt32();return 4294967295&a},e})(),qy={}.hasOwnProperty,yi=function(t,e){for(var n in e)qy.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};ii=(function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var $y=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new ua).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t})(),xp=(function(){function t(e,n){var r,a,i,o,l,c,h,f,m,b,p,_,w,S,x,T,R;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),b=p/2,e.pos+=6,i=(function(){var E,U;for(U=[],c=E=0;0<=b?E<b:E>b;c=0<=b?++E:--E)U.push(e.readUInt16());return U})(),e.pos+=2,w=(function(){var E,U;for(U=[],c=E=0;0<=b?E<b:E>b;c=0<=b?++E:--E)U.push(e.readUInt16());return U})(),h=(function(){var E,U;for(U=[],c=E=0;0<=b?E<b:E>b;c=0<=b?++E:--E)U.push(e.readUInt16());return U})(),f=(function(){var E,U;for(U=[],c=E=0;0<=b?E<b:E>b;c=0<=b?++E:--E)U.push(e.readUInt16());return U})(),a=(this.length-e.pos+this.offset)/2,l=(function(){var E,U;for(U=[],c=E=0;0<=a?E<a:E>a;c=0<=a?++E:--E)U.push(e.readUInt16());return U})(),c=x=0,R=i.length;x<R;c=++x)for(S=i[c],r=T=_=w[c];_<=S?T<=S:T>=S;r=_<=S?++T:--T)f[c]===0?o=r+h[c]:(o=l[f[c]/2+(r-_)-(b-c)]||0)!==0&&(o+=h[c]),this.codeMap[r]=65535&o}e.pos=m}return t.encode=function(e,n){var r,a,i,o,l,c,h,f,m,b,p,_,w,S,x,T,R,E,U,Z,O,J,F,C,A,D,j,$,V,oe,le,ae,de,Le,pe,I,z,K,Y,Q,re,he,fe,me,Ae,Oe;switch($=new ua,o=Object.keys(e).sort(function(Te,Me){return Te-Me}),n){case"macroman":for(w=0,S=(function(){var Te=[];for(_=0;_<256;++_)Te.push(0);return Te})(),T={0:0},i={},V=0,de=o.length;V<de;V++)T[fe=e[a=o[V]]]==null&&(T[fe]=++w),i[a]={old:e[a],new:T[e[a]]},S[a]=T[e[a]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(S),{charMap:i,subtable:$.data,maxGlyphID:w+1};case"unicode":for(D=[],m=[],R=0,T={},r={},x=h=null,oe=0,Le=o.length;oe<Le;oe++)T[U=e[a=o[oe]]]==null&&(T[U]=++R),r[a]={old:U,new:T[U]},l=T[U]-a,x!=null&&l===h||(x&&m.push(x),D.push(a),h=l),x=a;for(x&&m.push(x),m.push(65535),D.push(65535),C=2*(F=D.length),J=2*Math.pow(Math.log(F)/Math.LN2,2),b=Math.log(J/2)/Math.LN2,O=2*F-J,c=[],Z=[],p=[],_=le=0,pe=D.length;le<pe;_=++le){if(A=D[_],f=m[_],A===65535){c.push(0),Z.push(0);break}if(A-(j=r[A].new)>=32768)for(c.push(0),Z.push(2*(p.length+F-_)),a=ae=A;A<=f?ae<=f:ae>=f;a=A<=f?++ae:--ae)p.push(r[a].new);else c.push(j-A),Z.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*F+2*p.length),$.writeUInt16(0),$.writeUInt16(C),$.writeUInt16(J),$.writeUInt16(b),$.writeUInt16(O),re=0,I=m.length;re<I;re++)a=m[re],$.writeUInt16(a);for($.writeUInt16(0),he=0,z=D.length;he<z;he++)a=D[he],$.writeUInt16(a);for(me=0,K=c.length;me<K;me++)l=c[me],$.writeUInt16(l);for(Ae=0,Y=Z.length;Ae<Y;Ae++)E=Z[Ae],$.writeUInt16(E);for(Oe=0,Q=p.length;Oe<Q;Oe++)w=p[Oe],$.writeUInt16(w);return{charMap:r,subtable:$.data,maxGlyphID:R+1}}},t})(),lm=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=a?r<a:r>a;r=0<=a?++r:--r)n=new xp(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,a;return n==null&&(n="macroman"),r=xp.encode(e,n),(a=new ua).writeUInt16(0),a.writeUInt16(1),r.table=a.data.concat(r.subtable),r},t})(),zy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),Hy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r})(),this.charRange=(function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),Wy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(r=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)n=e.readByte(),a.push(this.names.push(e.readString(n)));return a;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t})(),Gy=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Vy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,a,i,o,l,c,h,f,m,b;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},i=f=0,m=r.length;f<m;i=++f)a=r[i],e.pos=a.offset,h=e.readString(a.length),o=new Gy(h,a),c[b=a.nameID]==null&&(c[b]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),Ky=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),Jy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,a,i,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,f;for(f=[],n=h=0;0<=a?h<a:h>a;n=0<=a?++h:--h)f.push(e.readInt16());return f})(),this.widths=(function(){var h,f,m,b;for(b=[],h=0,f=(m=this.metrics).length;h<f;h++)i=m[h],b.push(i.advance);return b}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=a?o<a:o>a;n=0<=a?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),cm=[].slice,Yy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,a,i,o,l,c,h,f,m;return e in this.cache?this.cache[e]:(i=this.file.loca,n=this.file.contents,r=i.indexOf(e),(a=i.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new ua(n.read(a))).readShort(),h=l.readShort(),m=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new Zy(l,h,m,c,f):new Xy(l,o,h,m,c,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var a,i,o,l,c;for(o=[],i=[],l=0,c=n.length;l<c;l++)a=e[n[l]],i.push(o.length),a&&(o=o.concat(a.encode(r)));return i.push(o.length),{table:o,offsets:i}},t})(),Xy=(function(){function t(e,n,r,a,i,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),Zy=(function(){function t(e,n,r,a,i){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new ua(cm.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t})(),Qy=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return yi(t,ii),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,i;for(i=[],r=0,a=this.length;r<a;r+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],r=0,a=this.length;r<a;r+=4)i.push(e.readUInt32());return i}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),a=0,i=0,o=0;o<r.length;++o)if(r[o]=a,i<n.length&&n[i]==o){++i,r[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var h=new Array(4*r.length),f=0;f<r.length;++f)h[4*f+3]=255&r[f],h[4*f+2]=(65280&r[f])>>8,h[4*f+1]=(16711680&r[f])>>16,h[4*f]=(4278190080&r[f])>>24;return h},t})(),e_=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,a,i;for(n in a=this.font.cmap.tables[0].codeMap,e={},i=this.subset)r=i[n],e[n]=a[r];return e},t.prototype.glyphsFor=function(e){var n,r,a,i,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[i=e[o]]=this.font.glyf.glyphFor(i);for(i in n=[],a)(r=a[i])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(i in c=this.glyphsFor(n))r=c[i],a[i]=r;return a},t.prototype.encode=function(e,n){var r,a,i,o,l,c,h,f,m,b,p,_,w,S,x;for(a in r=lm.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},x=r.charMap)p[(c=x[a]).old]=c.new;for(_ in b=r.maxGlyphID,o)_ in p||(p[_]=b++);return f=(function(T){var R,E;for(R in E={},T)E[T[R]]=R;return E})(p),m=Object.keys(f).sort(function(T,R){return T-R}),w=(function(){var T,R,E;for(E=[],T=0,R=m.length;T<R;T++)l=m[T],E.push(f[l]);return E})(),i=this.font.glyf.encode(o,w,p),h=this.font.loca.encode(i.offsets,w),S={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},t})();Xe.API.PDFObject=(function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,a,i,o;if(Array.isArray(n))return"["+(function(){var l,c,h;for(h=[],l=0,c=n.length;l<c;l++)r=n[l],h.push(e.convert(r));return h})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(a in i=["<<"],n)o=n[a],i.push("/"+a+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+n},e})();const Zr=[26,92,107],t_=[240,247,248],Ur=[0,0,0],mi=[100,100,100],Sp=[200,200,200],n_=[248,249,250],Ap=[255,255,255];function aa(t){return(parseFloat(t)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+" "}function xu(t){return t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function kp(t,e,n,r){const a=new Xe("p","mm","a4"),i=210,o=25,l=25,c=i-o-l,h=n||{},f=h.company_name||"BECK360",m=h.owner_name||"Eugen Beck",b=h.address_line1||"Eichenweg 1",p=h.address_zip||"76275",_=h.address_city||"Ettlingen",w=h.phone||"0173-4682501",S=h.email||"rundgang@beck360.de",x=h.website||"www.beck360.de",T=h.tax_id||"31205/27003",R=h.vat_id||"DE321274049",E=h.bank_name||"VR Bank Suedpfalz",U=h.bank_iban||"DE92 5486 2500 0001 1389 95",Z=h.bank_bic||"GEN0DE61SUW",O=h.payment_reference_note||"Bitte verwenden Sie die Rechnungsnummer als Verwendungszweck.",J=h.default_invoice_intro||"Vielen Dank fuer Ihren Auftrag. Ich berechne Ihnen fuer folgende Leistungen:",F=h.default_quote_intro||"Vielen Dank fuer Ihr Interesse. Gerne unterbreite ich Ihnen folgendes Angebot:",C=t.type==="quote",A=C?"ANGEBOT":"RECHNUNG",D=C?"Angebotsnr.":"Rechnungsnr.",j=C?"Angebotsdatum":"Rechnungsdatum",$=C?"Gueltig bis":"Faellig am";a.setFillColor(...Zr),a.rect(0,0,i,4,"F");let V=16;a.setFont("helvetica","bold"),a.setFontSize(18),a.setTextColor(...Zr),a.text("Beck360",o,V),a.setFontSize(22),a.setTextColor(...Ur),a.text(A,i-l,V,{align:"right"}),V+=14,a.setFontSize(7),a.setTextColor(...mi),a.setFont("helvetica","normal");const oe=`${f}  ${m}  ${b}  ${p} ${_}`;a.text(oe,o,V);const le=a.getTextWidth(oe);a.setDrawColor(...Sp),a.setLineWidth(.2),a.line(o,V+1,o+le,V+1),V+=8;const ae=V;a.setFontSize(10),a.setTextColor(...Ur),t.customer_company&&(a.setFont("helvetica","bold"),a.text(t.customer_company,o,V),V+=5),t.customer_name&&(a.setFont("helvetica",t.customer_company?"normal":"bold"),a.text(t.customer_name,o,V),V+=5),a.setFont("helvetica","normal"),t.customer_street&&(a.text(t.customer_street,o,V),V+=5);const de=`${t.customer_zip||""} ${t.customer_city||""}`.trim();de&&(a.text(de,o,V),V+=5);const Le=65,pe=i-l-Le,I=4,z=5.5,K=[[D,t.invoice_number],[j,xu(t.invoice_date)]];t.due_date&&K.push([$,xu(t.due_date)]),t.customer_number&&K.push(["Kundennr.",t.customer_number]),t.service_date&&K.push(["Leistungsdatum",xu(t.service_date)]);const Y=I*2+K.length*z,Q=ae-2;a.setFillColor(...t_),a.roundedRect(pe,Q,Le,Y,1.5,1.5,"F"),a.setFillColor(...Zr),a.rect(pe,Q,1,Y,"F"),a.setFontSize(8.5);let re=Q+I+4;for(const[Ie,it]of K)a.setFont("helvetica","normal"),a.setTextColor(...mi),a.text(Ie,pe+I+2,re),a.setFont("helvetica","bold"),a.setTextColor(...Ur),a.text(it||"",pe+Le-I,re,{align:"right"}),re+=z;V=Math.max(V,Q+Y+8),V+=4;const he=t.intro_text||(C?F:J);{a.setFont("helvetica","normal"),a.setFontSize(9.5),a.setTextColor(...Ur);const Ie=a.splitTextToSize(he,c);a.text(Ie,o,V),V+=Ie.length*4.5+6}const fe=o,me=o+12,Ae=o+c*.58,Oe=o+c*.76,Te=i-l,Me=6,q=8;a.setFillColor(...Zr),a.rect(o,V,c,q,"F"),a.setFont("helvetica","bold"),a.setFontSize(8.5),a.setTextColor(...Ap);const Ce=V+5.5;a.text("Pos.",fe+2,Ce),a.text("Bezeichnung",me,Ce),a.text("Menge",Ae,Ce,{align:"right"}),a.text("Einzelpreis",Oe,Ce,{align:"right"}),a.text("Gesamt",Te-2,Ce,{align:"right"}),V+=q,a.setFont("helvetica","normal"),a.setFontSize(9);for(let Ie=0;Ie<e.length;Ie++){const it=e[Ie];let nt=Me;it.sub_description&&(nt+=4.5),V+nt>245&&(Ll(a,i,o,l,f,m,b,p,_,w,S,x,T,R,U,Z,E),a.addPage(),a.setFillColor(...Zr),a.rect(0,0,i,4,"F"),V=16),Ie%2===1&&(a.setFillColor(...n_),a.rect(o,V,c,nt,"F"));const at=(parseFloat(it.quantity)||0)*(parseFloat(it.unit_price)||0),ut=parseFloat(it.quantity)%1===0?`${parseInt(it.quantity)} Stk.`:`${parseFloat(it.quantity).toLocaleString("de-DE")}`,pt=V+4.5;a.setTextColor(...Ur),a.setFont("helvetica","normal"),a.setFontSize(9),a.setTextColor(...mi),a.text(`${Ie+1}`,fe+2,pt),a.setTextColor(...Ur),a.text(it.description||"",me,pt),a.text(ut,Ae,pt,{align:"right"}),a.text(aa(it.unit_price),Oe,pt,{align:"right"}),a.setFont("helvetica","bold"),a.text(aa(at),Te-2,pt,{align:"right"}),V+=Me,it.sub_description&&(a.setFont("helvetica","italic"),a.setFontSize(8),a.setTextColor(...mi),a.text(it.sub_description,me,V+1),V+=4.5)}a.setDrawColor(...Zr),a.setLineWidth(.4),a.line(o,V,i-l,V),V+=10;const dt=75,ze=i-l-dt,we=ze+3,Ke=i-l-3;function Re(Ie,it,nt={}){if(nt.highlight){a.setFillColor(...Zr),a.roundedRect(ze,V-4,dt,9,1,1,"F"),a.setFont("helvetica","bold"),a.setFontSize(10),a.setTextColor(...Ap),a.text(Ie,we,V+1),a.text(it,Ke,V+1,{align:"right"}),V+=10;return}a.setFont("helvetica",nt.bold?"bold":"normal"),nt.italic&&a.setFont("helvetica","italic"),a.setFontSize(nt.size||9),a.setTextColor(...nt.color||Ur),a.text(Ie,we,V),a.text(it,Ke,V,{align:"right"}),V+=nt.spacing||6}if(a.setDrawColor(...Sp),a.setLineWidth(.2),Re("Zwischensumme",aa(t.subtotal)),parseFloat(t.discount_percent)>0){const Ie=parseFloat(t.subtotal)-parseFloat(t.net_amount);Re(`Rabatt (- ${t.discount_percent}%)`,`-${aa(Ie)}`,{color:mi})}if(Re("Nettobetrag",aa(t.net_amount)),Re(`${t.vat_rate} % MwSt.`,aa(t.vat_amount),{italic:!0,color:mi}),Re("Gesamtbetrag",aa(t.total_amount),{highlight:!0}),t.status==="paid"&&Re("Bezahlt",aa(t.paid_amount||t.total_amount),{bold:!0,size:10,color:[22,163,74]}),V+=4,t.payment_terms){V>245&&(Ll(a,i,o,l,f,m,b,p,_,w,S,x,T,R,U,Z,E),a.addPage(),a.setFillColor(...Zr),a.rect(0,0,i,4,"F"),V=16),a.setFont("helvetica","normal"),a.setFontSize(9),a.setTextColor(...Ur);const Ie=a.splitTextToSize(t.payment_terms,c);a.text(Ie,o,V),V+=Ie.length*4.5+3}if(!C&&O&&(a.setFont("helvetica","normal"),a.setFontSize(8.5),a.setTextColor(...mi),a.text(O,o,V),V+=8),t.closing_message){V>250&&(Ll(a,i,o,l,f,m,b,p,_,w,S,x,T,R,U,Z,E),a.addPage(),a.setFillColor(...Zr),a.rect(0,0,i,4,"F"),V=16),a.setFont("helvetica","normal"),a.setFontSize(9),a.setTextColor(...Ur);const Ie=a.splitTextToSize(t.closing_message,c);a.text(Ie,o,V),V+=Ie.length*4.5}if(Ll(a,i,o,l,f,m,b,p,_,w,S,x,T,R,U,Z,E),r!=null&&r.preview){const Ie=a.output("blob"),it=URL.createObjectURL(Ie);window.open(it,"_blank");return}const Qe=`${t.invoice_number}.pdf`;a.save(Qe)}function Ll(t,e,n,r,a,i,o,l,c,h,f,m,b,p,_,w,S){t.setDrawColor(...Zr),t.setLineWidth(.3),t.line(n,268,e-r,268),t.setFontSize(7);const T=n;t.setFont("helvetica","bold"),t.setTextColor(...Zr),t.text(a,T,272),t.setTextColor(...Ur),t.text(i,T,272+3.5),t.setFont("helvetica","normal"),t.setTextColor(...mi),t.text(o,T,279),t.text(`${l} ${c}`,T,272+10.5),t.text(m,T,286),t.text(`St.-Nr.: ${b}`,T,272+17.5);const R=n+55;t.setFont("helvetica","bold"),t.setTextColor(...Ur),t.text("Kontakt",R,272),t.setFont("helvetica","normal"),t.setTextColor(...mi),t.text(`Tel.: ${h}`,R,272+3.5),t.text(`E-Mail: ${f}`,R,279),t.text(`USt-IdNr.: ${p}`,R,272+10.5);const E=n+110;t.setFont("helvetica","bold"),t.setTextColor(...Ur),t.text("Bankverbindung",E,272),t.setFont("helvetica","normal"),t.setTextColor(...mi),t.text(S,E,272+3.5),t.text(`IBAN: ${_}`,E,279),t.text(`BIC: ${w}`,E,272+10.5)}function r_({id:t}){var S,x,T,R,E,U,Z;const{invoice:e,items:n,loading:r,update:a}=hg(t),{settings:i}=nc(),o=lr();if(r)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Rechnung"})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]});if(!e)return s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Nicht gefunden"})}),s("div",{class:"page-body",children:s("div",{class:"empty-state",children:s("div",{class:"empty-state-text",children:"Dokument nicht gefunden"})})})]});const l=e.type==="quote",c=((S=ks[e.type])==null?void 0:S.label)||"Dokument";async function h(){const{error:O}=await a({status:"sent"});O?o.error("Fehler"):o.success("Als versendet markiert")}async function f(){const{error:O}=await a({status:"paid",paid_date:new Date().toISOString().slice(0,10),paid_amount:e.total_amount});O?o.error("Fehler"):o.success("Als bezahlt markiert")}async function m(){const{data:O,error:J}=await rv(t);J?o.error("Fehler: "+J.message):(o.success("In Rechnung umgewandelt"),Ve(`/crm/invoices/${O.id}`))}async function b(){if(!confirm(`${c} "${e.invoice_number}" wirklich loeschen?`))return;const{error:O}=await av(t);O?o.error("Fehler"):(o.success("Geloescht"),Ve("/crm/invoices"))}function p(){kp(e,n,i)}function _(){kp(e,n,i,{preview:!0})}function w(){Ve(`/crm/invoices/new?edit=${t}`)}return s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices"),children:""}),s("h1",{class:"page-title",children:e.invoice_number}),s("span",{class:"stage-badge",style:`color:${(x=Zn[e.status])==null?void 0:x.color};background:${(T=Zn[e.status])==null?void 0:T.color}20`,children:(R=Zn[e.status])==null?void 0:R.label})]}),s("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:_,children:"Vorschau"}),s("button",{class:"btn btn-primary btn-sm",onClick:p,children:"PDF herunterladen"}),e.status==="draft"&&s(xt,{children:[s("button",{class:"btn btn-secondary btn-sm",onClick:w,children:"Bearbeiten"}),s("button",{class:"btn btn-secondary btn-sm",onClick:h,children:"Als versendet markieren"}),l&&s("button",{class:"btn btn-primary btn-sm",onClick:m,children:"In Rechnung umwandeln"}),s("button",{class:"btn btn-danger btn-sm",onClick:b,children:"Loeschen"})]}),e.status==="sent"&&!l&&s("button",{class:"btn btn-primary btn-sm",onClick:f,children:"Als bezahlt markieren"})]})]}),s("div",{class:"page-body",children:s("div",{class:"detail-grid",children:[s("div",{class:"detail-main",children:[s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:c})}),s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:l?"Angebotsnr.":"Rechnungsnr."}),s("span",{class:"detail-value",children:e.invoice_number})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Typ"}),s("span",{class:"detail-value",children:c})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Datum"}),s("span",{class:"detail-value",children:jn(e.invoice_date)})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:l?"Gueltig bis":"Faellig am"}),s("span",{class:"detail-value",children:jn(e.due_date)})]}),e.paid_date&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Bezahlt am"}),s("span",{class:"detail-value",children:jn(e.paid_date)})]}),e.converted_from_quote_id&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt aus Angebot"}),s("span",{class:"detail-value",children:s("a",{href:"#",onClick:O=>{O.preventDefault(),Ve(`/crm/invoices/${e.converted_from_quote_id}`)},children:"Angebot anzeigen"})})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Kunde"})}),s("div",{class:"form-grid",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Firma"}),s("span",{class:"detail-value",children:e.company_id?s("a",{href:"#",onClick:O=>{O.preventDefault(),Ve(`/crm/companies/${e.company_id}`)},children:e.customer_company||""}):e.customer_company||""})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Ansprechpartner"}),s("span",{class:"detail-value",children:e.customer_name||""})]}),s("div",{class:"detail-field form-group-full",children:[s("span",{class:"detail-label",children:"Adresse"}),s("span",{class:"detail-value",children:[e.customer_street,`${e.customer_zip||""} ${e.customer_city||""}`.trim()].filter(Boolean).join(", ")||""})]})]})]}),s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Positionen"})}),s("div",{class:"table-wrapper",children:s("table",{class:"line-items-table",children:[s("thead",{children:s("tr",{children:[s("th",{children:"Bezeichnung"}),s("th",{style:"text-align:right",children:"Menge"}),s("th",{style:"text-align:right",children:"Einzelpreis"}),s("th",{style:"text-align:right",children:"Gesamt"})]})}),s("tbody",{children:n.map(O=>s("tr",{children:[s("td",{"data-label":"Bezeichnung",children:[s("div",{children:O.description}),O.sub_description&&s("div",{style:"font-size:0.8rem;color:var(--text-muted)",children:O.sub_description})]}),s("td",{"data-label":"Menge",children:O.quantity}),s("td",{"data-label":"Einzelpreis",children:je(O.unit_price)}),s("td",{"data-label":"Gesamt",style:"font-weight:500",children:je(O.total)})]},O.id))})]})}),s("div",{class:"invoice-totals",style:"margin-top:1rem",children:[s("div",{class:"invoice-totals-row",children:[s("span",{children:"Zwischensumme"}),s("span",{children:je(e.subtotal)})]}),parseFloat(e.discount_percent)>0&&s("div",{class:"invoice-totals-row",children:[s("span",{children:["Rabatt (-",e.discount_percent,"%)"]}),s("span",{children:["-",je(e.subtotal-e.net_amount)]})]}),s("div",{class:"invoice-totals-row",children:[s("span",{children:"Nettobetrag"}),s("span",{children:je(e.net_amount)})]}),s("div",{class:"invoice-totals-row",children:[s("span",{children:[e.vat_rate,"% MwSt."]}),s("span",{children:je(e.vat_amount)})]}),s("div",{class:"invoice-totals-row",style:"font-weight:700;font-size:1.1rem;border-top:2px solid var(--border);padding-top:0.5rem",children:[s("span",{children:"Gesamtbetrag"}),s("span",{children:je(e.total_amount)})]}),e.status==="paid"&&s("div",{class:"invoice-totals-row",style:"font-weight:700;color:var(--success)",children:[s("span",{children:"Bezahlt"}),s("span",{children:je(e.paid_amount)})]})]})]}),(e.payment_terms||e.closing_message)&&s("div",{class:"card",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Texte"})}),e.payment_terms&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Zahlungsbedingungen"}),s("span",{class:"detail-value",style:"white-space:pre-wrap",children:e.payment_terms})]}),e.closing_message&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Schlussnachricht"}),s("span",{class:"detail-value",style:"white-space:pre-wrap",children:e.closing_message})]})]})]}),s("div",{class:"detail-sidebar",children:s("div",{class:"card",children:[s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Status"}),s("span",{class:"detail-value",children:s("span",{class:"stage-badge",style:`color:${(E=Zn[e.status])==null?void 0:E.color};background:${(U=Zn[e.status])==null?void 0:U.color}20`,children:(Z=Zn[e.status])==null?void 0:Z.label})})]}),e.deal_id&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Deal"}),s("span",{class:"detail-value",children:s("a",{href:"#",onClick:O=>{O.preventDefault(),Ve(`/crm/deals/${e.deal_id}`)},children:"Deal anzeigen"})})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Erstellt am"}),s("span",{class:"detail-value",children:jn(e.created_at)})]}),s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Aktualisiert"}),s("span",{class:"detail-value",children:jn(e.updated_at)})]}),e.notes&&s("div",{class:"detail-field",children:[s("span",{class:"detail-label",children:"Interne Notizen"}),s("span",{class:"detail-value",style:"white-space:pre-wrap;font-size:0.8rem",children:e.notes})]})]})})]})})]})}function i_({month:t=null,year:e=null,category:n=null}={}){const[r,a]=be([]),[i,o]=be(!0),l=Nt(async()=>{o(!0);let c=ke.from("expenses").select("*").is("deleted_at",null).order("date",{ascending:!1});if(e&&(c=c.gte("date",`${e}-01-01`).lte("date",`${e}-12-31`)),t){const m=String(t).padStart(2,"0"),b=e||new Date().getFullYear();c=c.gte("date",`${b}-${m}-01`).lte("date",`${b}-${m}-31`)}n&&(c=c.eq("category",n));const{data:h,error:f}=await c;f||a(h||[]),o(!1)},[t,e,n]);return jt(()=>{l()},[l]),{expenses:r,loading:i,refetch:l}}function a_(t){const[e,n]=be(null),[r,a]=be(!0),i=Nt(async()=>{if(!t)return;a(!0);const{data:o}=await ke.from("expenses").select("*").eq("id",t).single();n(o),a(!1)},[t]);return jt(()=>{i()},[i]),{expense:e,loading:r,refetch:i}}async function s_(t){const{data:e}=await ke.auth.getUser(),n=e.user.id,{data:r,error:a}=await ke.from("expenses").insert({...t,owner_id:n}).select().single();return{data:r,error:a}}async function o_(t,e){const{error:n}=await ke.from("expenses").update({...e,updated_at:new Date().toISOString()}).eq("id",t);return{error:n}}async function l_(t){const{error:e}=await ke.from("expenses").update({deleted_at:new Date().toISOString()}).eq("id",t);return{error:e}}function c_(){const t=new Date,[e,n]=be(t.getFullYear()),[r,a]=be(null),[i,o]=be(null),{expenses:l,loading:c}=i_({year:e,month:r,category:i}),h=l.reduce((p,_)=>p+(parseFloat(_.amount)||0),0),f=l.reduce((p,_)=>p+(parseFloat(_.amount)||0),0),m=l.length,b=[];for(let p=t.getFullYear();p>=t.getFullYear()-5;p--)b.push(p);return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Ausgaben"}),s("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/expenses/new"),children:"+ Ausgabe"})]}),s("div",{class:"page-body",children:[s("div",{class:"search-bar",style:"flex-wrap:wrap;gap:0.75rem",children:[s("select",{value:e,onChange:p=>n(parseInt(p.target.value)),style:"width:auto",children:b.map(p=>s("option",{value:p,children:p},p))}),s("select",{value:r||"",onChange:p=>a(p.target.value?parseInt(p.target.value):null),style:"width:auto",children:[s("option",{value:"",children:"Alle Monate"}),Wl.map((p,_)=>s("option",{value:_+1,children:p},_))]}),s("div",{class:"filter-pills",children:[s("button",{class:`filter-pill ${i?"":"active"}`,onClick:()=>o(null),children:"Alle"}),Object.entries(Hl).map(([p,_])=>s("button",{class:`filter-pill ${i===p?"active":""}`,onClick:()=>o(i===p?null:p),children:_},p))]})]}),s("div",{class:"grid-3",style:"margin-bottom:1.5rem",children:[s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:["Ausgaben ",r?Wl[r-1]:"Zeitraum"]}),s("div",{style:"font-size:1.5rem;font-weight:700;color:#ef4444",children:je(h)})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:["Ausgaben ",e]}),s("div",{style:"font-size:1.5rem;font-weight:700;color:#ef4444",children:je(f)})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:"Anzahl Belege"}),s("div",{style:"font-size:1.5rem;font-weight:700",children:m})]})]}),c?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):l.length===0?s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Ausgaben gefunden"})]}):s("div",{class:"card",children:s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Datum"}),s("th",{children:"Kategorie"}),s("th",{children:"Beschreibung"}),s("th",{children:"Lieferant"}),s("th",{style:"text-align:right",children:"Betrag"})]})}),s("tbody",{children:l.map(p=>s("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/expenses/new?edit=${p.id}`),children:[s("td",{"data-label":"Datum",children:jn(p.date)}),s("td",{"data-label":"Kategorie",children:s("span",{style:"font-size:0.75rem;padding:0.15rem 0.5rem;border-radius:999px;background:rgba(239,68,68,0.12);color:#ef4444",children:Hl[p.category]||p.category})}),s("td",{"data-label":"Beschreibung",children:p.description}),s("td",{"data-label":"Lieferant",children:p.vendor||""}),s("td",{"data-label":"Betrag",style:"text-align:right;font-weight:600",children:je(p.amount)})]},p.id))})]})})})]})]})}function u_(){const t=lr(),n=new URLSearchParams(window.location.search).get("edit"),{expense:r,loading:a}=a_(n),[i,o]=be(!1),[l,c]=be({date:new Date().toISOString().slice(0,10),category:"other",description:"",amount:"",vat_rate:19,vendor:"",receipt_ref:"",payment_method:"bank_transfer",notes:""});jt(()=>{!n||a||!r||c({date:r.date||"",category:r.category||"other",description:r.description||"",amount:r.amount||"",vat_rate:r.vat_rate!=null?r.vat_rate:19,vendor:r.vendor||"",receipt_ref:r.receipt_ref||"",payment_method:r.payment_method||"bank_transfer",notes:r.notes||""})},[n,a,r]);const h=parseFloat(l.amount)||0,f=parseFloat(l.vat_rate)||0,m=f>0?h/(1+f/100):h,b=h-m;async function p(w){if(w.preventDefault(),!l.description||!l.amount){t.error("Beschreibung und Betrag sind Pflichtfelder");return}o(!0);const S={date:l.date,category:l.category,description:l.description,amount:parseFloat(l.amount)||0,net_amount:Math.round(m*100)/100,vat_amount:Math.round(b*100)/100,vat_rate:parseFloat(l.vat_rate)||0,vendor:l.vendor||null,receipt_ref:l.receipt_ref||null,payment_method:l.payment_method,notes:l.notes||null};let x;n?(x=await o_(n,S),x.error||(t.success("Ausgabe gespeichert"),Ve("/crm/expenses"))):(x=await s_(S),x.error||(t.success("Ausgabe erstellt"),Ve("/crm/expenses"))),x.error&&t.error("Fehler: "+x.error.message),o(!1)}async function _(){if(!confirm("Ausgabe wirklich loeschen?"))return;const{error:w}=await l_(n);w?t.error("Fehler: "+w.message):(t.success("Ausgabe geloescht"),Ve("/crm/expenses"))}return n&&a?s(xt,{children:[s("div",{class:"page-header",children:s("h1",{class:"page-title",children:"Laden..."})}),s("div",{class:"page-body",children:s("div",{class:"loading-center",children:s("div",{class:"spinner"})})})]}):s(xt,{children:[s("div",{class:"page-header",children:[s("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[s("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/expenses"),children:""}),s("h1",{class:"page-title",children:n?"Ausgabe bearbeiten":"Neue Ausgabe"})]}),n&&s("button",{class:"btn btn-danger btn-sm",onClick:_,children:"Loeschen"})]}),s("div",{class:"page-body",children:s("form",{onSubmit:p,style:"max-width:640px",children:[s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Ausgabe"})}),s("div",{class:"form-grid",children:[s("div",{class:"form-group",children:[s("label",{children:"Datum"}),s("input",{type:"date",value:l.date,onInput:w=>c({...l,date:w.target.value}),required:!0})]}),s("div",{class:"form-group",children:[s("label",{children:"Kategorie"}),s("select",{value:l.category,onChange:w=>c({...l,category:w.target.value}),children:Object.entries(Hl).map(([w,S])=>s("option",{value:w,children:S},w))})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Beschreibung"}),s("input",{value:l.description,onInput:w=>c({...l,description:w.target.value}),required:!0,placeholder:"z.B. Matterport-Lizenz, Bueroeinrichtung..."})]}),s("div",{class:"form-group",children:[s("label",{children:"Betrag brutto"}),s("input",{type:"number",step:"0.01",min:"0",value:l.amount,onInput:w=>c({...l,amount:w.target.value}),required:!0,style:"text-align:right"})]}),s("div",{class:"form-group",children:[s("label",{children:"MwSt-Satz (%)"}),s("input",{type:"number",step:"0.01",min:"0",value:l.vat_rate,onInput:w=>c({...l,vat_rate:w.target.value}),style:"max-width:100px;text-align:right"})]}),s("div",{class:"form-group",children:[s("label",{children:"Lieferant"}),s("input",{value:l.vendor,onInput:w=>c({...l,vendor:w.target.value}),placeholder:"Optional"})]}),s("div",{class:"form-group",children:[s("label",{children:"Belegnummer"}),s("input",{value:l.receipt_ref,onInput:w=>c({...l,receipt_ref:w.target.value}),placeholder:"Optional"})]}),s("div",{class:"form-group",children:[s("label",{children:"Zahlungsart"}),s("select",{value:l.payment_method,onChange:w=>c({...l,payment_method:w.target.value}),children:Object.entries(lv).map(([w,S])=>s("option",{value:w,children:S},w))})]}),s("div",{class:"form-group form-group-full",children:[s("label",{children:"Notizen"}),s("textarea",{value:l.notes,onInput:w=>c({...l,notes:w.target.value}),placeholder:"Optional"})]})]}),h>0&&s("div",{style:"margin-top:1rem;padding:1rem;background:var(--bg-secondary);border-radius:8px",children:[s("div",{style:"display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem",children:[s("span",{children:"Nettobetrag"}),s("span",{children:je(m)})]}),s("div",{style:"display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem",children:[s("span",{children:[l.vat_rate,"% MwSt."]}),s("span",{children:je(b)})]}),s("div",{style:"display:flex;justify-content:space-between;font-size:0.95rem;font-weight:700;border-top:1px solid var(--border);padding-top:0.5rem;margin-top:0.25rem",children:[s("span",{children:"Bruttobetrag"}),s("span",{children:je(h)})]})]})]}),s("div",{class:"form-actions",children:[s("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/expenses"),children:"Abbrechen"}),s("button",{type:"submit",class:"btn btn-primary",disabled:i,children:i?"Speichern...":n?"Speichern":"Erstellen"})]})]})})]})}function h_({year:t}={}){const[e,n]=be(null),[r,a]=be([]),[i,o]=be([]),[l,c]=be({}),[h,f]=be(!0),m=Nt(async()=>{if(!t)return;f(!0);const b=`${t}-01-01`,p=`${t}-12-31`,[{data:_},{data:w},{data:S}]=await Promise.all([ke.from("invoices").select("total_amount, net_amount, vat_amount, paid_date").eq("type","invoice").eq("status","paid").gte("paid_date",b).lte("paid_date",p),ke.from("invoices").select("total_amount").eq("type","invoice").in("status",["sent","overdue"]),ke.from("expenses").select("date, category, amount, net_amount, vat_amount").is("deleted_at",null).gte("date",b).lte("date",p)]),x=_||[],T=S||[],R=Array.from({length:12},(j,$)=>{const V=$+1,oe=String(V).padStart(2,"0"),le=`${t}-${oe}`,ae=x.filter(Q=>Q.paid_date&&Q.paid_date.startsWith(le)),de=T.filter(Q=>Q.date&&Q.date.startsWith(le)),Le=ae.reduce((Q,re)=>Q+(parseFloat(re.total_amount)||0),0),pe=ae.reduce((Q,re)=>Q+(parseFloat(re.net_amount)||0),0),I=ae.reduce((Q,re)=>Q+(parseFloat(re.vat_amount)||0),0),z=de.reduce((Q,re)=>Q+(parseFloat(re.amount)||0),0),K=de.reduce((Q,re)=>Q+(parseFloat(re.net_amount)||0),0),Y=de.reduce((Q,re)=>Q+(parseFloat(re.vat_amount)||0),0);return{month:V,incomeBrutto:Le,incomeNetto:pe,vatCollected:I,expensesBrutto:z,expensesNetto:K,vatPaid:Y,profit:pe-K}});a(R);const E=[0,1,2,3].map(j=>{const $=R.slice(j*3,j*3+3);return{quarter:j+1,incomeBrutto:$.reduce((V,oe)=>V+oe.incomeBrutto,0),incomeNetto:$.reduce((V,oe)=>V+oe.incomeNetto,0),vatCollected:$.reduce((V,oe)=>V+oe.vatCollected,0),expensesBrutto:$.reduce((V,oe)=>V+oe.expensesBrutto,0),expensesNetto:$.reduce((V,oe)=>V+oe.expensesNetto,0),vatPaid:$.reduce((V,oe)=>V+oe.vatPaid,0),profit:$.reduce((V,oe)=>V+oe.profit,0)}});o(E);const U={};T.forEach(j=>{const $=j.category||"other";U[$]=(U[$]||0)+(parseFloat(j.amount)||0)}),c(U);const Z=x.reduce((j,$)=>j+(parseFloat($.total_amount)||0),0),O=x.reduce((j,$)=>j+(parseFloat($.net_amount)||0),0),J=T.reduce((j,$)=>j+(parseFloat($.amount)||0),0),F=T.reduce((j,$)=>j+(parseFloat($.net_amount)||0),0),C=x.reduce((j,$)=>j+(parseFloat($.vat_amount)||0),0),A=T.reduce((j,$)=>j+(parseFloat($.vat_amount)||0),0),D=(w||[]).reduce((j,$)=>j+(parseFloat($.total_amount)||0),0);n({yearRevenue:Z,yearRevenueNetto:O,yearExpenses:J,yearExpensesNetto:F,yearProfit:O-F,openInvoices:D,vatCollected:C,vatPaid:A,vatPayable:C-A}),f(!1)},[t]);return jt(()=>{m()},[m]),{stats:e,monthlyData:r,quarterlyData:i,expensesByCategory:l,loading:h,refetch:m}}const Su=[26,92,107],lo=[0,0,0],Au=[100,100,100],Np=[200,200,200];function Jr(t){return(parseFloat(t)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+" "}const d_=["Januar","Februar","Maerz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];function f_({year:t,monthlyData:e,quarterlyData:n,stats:r,settings:a}){const i=new Xe("p","mm","a4"),o=210,l=25,c=25,h=a||{},f=h.company_name||"BECK360",m=h.owner_name||"Eugen Beck",b=h.address_line1||"Eichenweg 1",p=h.address_zip||"76275",_=h.address_city||"Ettlingen",w=h.phone||"0173-4682501",S=h.email||"rundgang@beck360.de",x=h.website||"www.beck360.de",T=h.tax_id||"31205/27003",R=h.vat_id||"DE321274049",E=h.bank_name||"VR Bank Suedpfalz",U=h.bank_iban||"DE92 5486 2500 0001 1389 95",Z=h.bank_bic||"GEN0DE61SUW";let O=20;i.setFont("helvetica","bold"),i.setFontSize(18),i.setTextColor(...Su),i.text("Beck360",l,O),i.setFontSize(16),i.setTextColor(...lo),i.text("EINNAHMEN-UEBERSCHUSS-RECHNUNG",o-c,O,{align:"right"}),O+=8,i.setFontSize(12),i.setTextColor(...Au),i.text(`Geschaeftsjahr ${t}`,o-c,O,{align:"right"}),O+=5,i.setFontSize(7),i.setTextColor(...Au);const J=`${f} - ${m} - ${b} - ${p} ${_}`;i.text(J,l,O);const F=i.getTextWidth(J);i.setDrawColor(...Au),i.setLineWidth(.2),i.line(l,O+.5,l+F,O+.5),O+=12,i.setFont("helvetica","bold"),i.setFontSize(11),i.setTextColor(...Su),i.text("Monatsuebersicht",l,O),O+=6;const C=[{label:"Monat",x:l,align:"left",w:28},{label:"Einnahmen",x:l+30,align:"right"},{label:"Ausg. netto",x:l+58,align:"right"},{label:"MwSt erh.",x:l+84,align:"right"},{label:"MwSt gez.",x:l+108,align:"right"},{label:"Gewinn",x:l+136,align:"right"}];i.setFont("helvetica","bold"),i.setFontSize(7.5),i.setTextColor(...lo),i.setDrawColor(...lo),i.setLineWidth(.3),i.line(l,O,o-c,O),O+=4,C.forEach(le=>{const ae=le.align==="right"?{align:"right"}:{};i.text(le.label,le.x,O,ae)}),O+=2,i.line(l,O,o-c,O),O+=4,i.setFont("helvetica","normal"),i.setFontSize(7.5);const A={incomeNetto:0,expensesNetto:0,vatCollected:0,vatPaid:0,profit:0};e.forEach(le=>{i.text(d_[le.month-1],C[0].x,O),i.text(Jr(le.incomeNetto),C[1].x,O,{align:"right"}),i.text(Jr(le.expensesNetto),C[2].x,O,{align:"right"}),i.text(Jr(le.vatCollected),C[3].x,O,{align:"right"}),i.text(Jr(le.vatPaid),C[4].x,O,{align:"right"}),i.text(Jr(le.profit),C[5].x,O,{align:"right"}),A.incomeNetto+=le.incomeNetto,A.expensesNetto+=le.expensesNetto,A.vatCollected+=le.vatCollected,A.vatPaid+=le.vatPaid,A.profit+=le.profit,O+=4.5}),i.line(l,O-1,o-c,O-1),O+=2,i.setFont("helvetica","bold"),i.text("Summe",C[0].x,O),i.text(Jr(A.incomeNetto),C[1].x,O,{align:"right"}),i.text(Jr(A.expensesNetto),C[2].x,O,{align:"right"}),i.text(Jr(A.vatCollected),C[3].x,O,{align:"right"}),i.text(Jr(A.vatPaid),C[4].x,O,{align:"right"}),i.text(Jr(A.profit),C[5].x,O,{align:"right"}),O+=3,i.line(l,O,o-c,O),O+=15,i.setFont("helvetica","bold"),i.setFontSize(11),i.setTextColor(...Su),i.text("EUER-Zusammenfassung",l,O),O+=8,i.setFontSize(9),i.setTextColor(...lo);function D(le,ae,de={}){de.bold?i.setFont("helvetica","bold"):i.setFont("helvetica","normal"),i.text(le,l,O),i.text(Jr(ae),o-c,O,{align:"right"}),O+=de.spacing||6}D("Betriebseinnahmen (netto)",r.yearRevenueNetto),D("Betriebsausgaben (netto)",r.yearExpensesNetto),i.setDrawColor(...Np),i.setLineWidth(.3),i.line(l,O-2,o-c,O-2),D("Gewinn vor Steuern",r.yearProfit,{bold:!0,spacing:10}),D("MwSt. erhalten",r.vatCollected),D("MwSt. gezahlt (Vorsteuer)",r.vatPaid),i.line(l,O-2,o-c,O-2),D("MwSt.-Zahllast",r.vatPayable,{bold:!0});const j=270;i.setDrawColor(...Np),i.setLineWidth(.3),i.line(l,j-3,o-c,j-3),i.setFontSize(7),i.setTextColor(...lo);const $=l;i.setFont("helvetica","bold"),i.text(f,$,j),i.text(m,$,j+3.5),i.setFont("helvetica","normal"),i.text(b,$,j+7),i.text(`${p} ${_}`,$,j+10.5),i.text(x,$,j+14),i.text(`Steuernummer: ${T}`,$,j+17.5),i.text(`USt-IdNr.: ${R}`,$,j+21);const V=l+55;i.setFont("helvetica","bold"),i.text("Kontakt:",V,j),i.setFont("helvetica","normal"),i.text(`Tel.: ${w}`,V,j+3.5),i.text(`E-Mail: ${S}`,V,j+7);const oe=l+110;i.setFont("helvetica","bold"),i.text("Zahlungsinformationen:",oe,j),i.setFont("helvetica","normal"),i.text(`IBAN: ${U}`,oe,j+3.5),i.text(`BIC: ${Z}`,oe,j+7),i.text(E,oe,j+10.5),i.save(`EUER-${t}-Beck360.pdf`)}function p_(){const t=lr(),e=new Date,[n,r]=be(e.getFullYear()),{stats:a,monthlyData:i,quarterlyData:o,expensesByCategory:l,loading:c}=h_({year:n}),{settings:h}=nc(),f=[];for(let _=e.getFullYear();_>=e.getFullYear()-5;_--)f.push(_);function m(){a&&(f_({year:n,monthlyData:i,quarterlyData:o,stats:a,settings:h}),t.success("PDF erstellt"))}function b(){if(!i.length)return;const _="Monat,Einnahmen Brutto,Einnahmen Netto,MwSt erhalten,Ausgaben Brutto,Ausgaben Netto,MwSt gezahlt,Gewinn",w=i.map(U=>[Wl[U.month-1],U.incomeBrutto.toFixed(2).replace(".",","),U.incomeNetto.toFixed(2).replace(".",","),U.vatCollected.toFixed(2).replace(".",","),U.expensesBrutto.toFixed(2).replace(".",","),U.expensesNetto.toFixed(2).replace(".",","),U.vatPaid.toFixed(2).replace(".",","),U.profit.toFixed(2).replace(".",",")].map(Z=>`"${Z}"`).join(";")),S=i.reduce((U,Z)=>({ib:U.ib+Z.incomeBrutto,in_:U.in_+Z.incomeNetto,vc:U.vc+Z.vatCollected,eb:U.eb+Z.expensesBrutto,en:U.en+Z.expensesNetto,vp:U.vp+Z.vatPaid,p:U.p+Z.profit}),{ib:0,in_:0,vc:0,eb:0,en:0,vp:0,p:0});w.push(["Summe",S.ib.toFixed(2).replace(".",","),S.in_.toFixed(2).replace(".",","),S.vc.toFixed(2).replace(".",","),S.eb.toFixed(2).replace(".",","),S.en.toFixed(2).replace(".",","),S.vp.toFixed(2).replace(".",","),S.p.toFixed(2).replace(".",",")].map(U=>`"${U}"`).join(";"));const x=[_.split(",").map(U=>`"${U}"`).join(";"),...w].join(`
`),T=new Blob(["\uFEFF"+x],{type:"text/csv;charset=utf-8"}),R=URL.createObjectURL(T),E=document.createElement("a");E.href=R,E.download=`EUER-${n}-Beck360.csv`,E.click(),URL.revokeObjectURL(R),t.success("CSV erstellt")}const p=Object.values(l).reduce((_,w)=>_+w,0);return s(xt,{children:[s("div",{class:"page-header",children:[s("h1",{class:"page-title",children:"Berichte"}),s("div",{style:"display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap",children:[s("select",{value:n,onChange:_=>r(parseInt(_.target.value)),style:"width:auto",children:f.map(_=>s("option",{value:_,children:_},_))}),s("button",{class:"btn btn-primary btn-sm",onClick:m,disabled:c,children:"PDF Export"}),s("button",{class:"btn btn-secondary btn-sm",onClick:b,disabled:c,children:"CSV Export"})]})]}),s("div",{class:"page-body",children:c?s("div",{class:"loading-center",children:s("div",{class:"spinner"})}):a?s(xt,{children:[s("div",{class:"grid-4",style:"margin-bottom:1.5rem",children:[s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:"Jahresumsatz brutto"}),s("div",{style:"font-size:1.5rem;font-weight:700;color:#10b981",children:je(a.yearRevenue)})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:"Ausgaben gesamt"}),s("div",{style:"font-size:1.5rem;font-weight:700;color:#ef4444",children:je(a.yearExpenses)})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:"Gewinn (netto)"}),s("div",{style:"font-size:1.5rem;font-weight:700;color:var(--brand)",children:je(a.yearProfit)})]}),s("div",{class:"card",style:"text-align:center;padding:1.25rem",children:[s("div",{style:"font-size:0.8rem;color:var(--text-dim);margin-bottom:0.25rem",children:"Offene Rechnungen"}),s("div",{style:"font-size:1.5rem;font-weight:700;color:#f59e0b",children:je(a.openInvoices)})]})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Monatsuebersicht ",n]})}),s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Monat"}),s("th",{style:"text-align:right",children:"Einnahmen brutto"}),s("th",{style:"text-align:right",children:"Einnahmen netto"}),s("th",{style:"text-align:right",children:"Ausgaben brutto"}),s("th",{style:"text-align:right",children:"MwSt erh."}),s("th",{style:"text-align:right",children:"MwSt gez."}),s("th",{style:"text-align:right",children:"Gewinn"})]})}),s("tbody",{children:[i.map(_=>s("tr",{children:[s("td",{"data-label":"Monat",style:"font-weight:600",children:Wl[_.month-1]}),s("td",{"data-label":"Einnahmen brutto",children:je(_.incomeBrutto)}),s("td",{"data-label":"Einnahmen netto",children:je(_.incomeNetto)}),s("td",{"data-label":"Ausgaben brutto",children:je(_.expensesBrutto)}),s("td",{"data-label":"MwSt erh.",children:je(_.vatCollected)}),s("td",{"data-label":"MwSt gez.",children:je(_.vatPaid)}),s("td",{"data-label":"Gewinn",style:`font-weight:600;color:${_.profit>=0?"#10b981":"#ef4444"}`,children:je(_.profit)})]},_.month)),s("tr",{style:"font-weight:700;border-top:2px solid var(--border)",children:[s("td",{"data-label":"Monat",children:"Summe"}),s("td",{"data-label":"Einnahmen brutto",children:je(i.reduce((_,w)=>_+w.incomeBrutto,0))}),s("td",{"data-label":"Einnahmen netto",children:je(i.reduce((_,w)=>_+w.incomeNetto,0))}),s("td",{"data-label":"Ausgaben brutto",children:je(i.reduce((_,w)=>_+w.expensesBrutto,0))}),s("td",{"data-label":"MwSt erh.",children:je(i.reduce((_,w)=>_+w.vatCollected,0))}),s("td",{"data-label":"MwSt gez.",children:je(i.reduce((_,w)=>_+w.vatPaid,0))}),s("td",{"data-label":"Gewinn",style:`color:${a.yearProfit>=0?"#10b981":"#ef4444"}`,children:je(a.yearProfit)})]})]})]})})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["Quartalsuebersicht ",n]})}),s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Quartal"}),s("th",{style:"text-align:right",children:"Einnahmen brutto"}),s("th",{style:"text-align:right",children:"Einnahmen netto"}),s("th",{style:"text-align:right",children:"Ausgaben brutto"}),s("th",{style:"text-align:right",children:"MwSt erh."}),s("th",{style:"text-align:right",children:"MwSt gez."}),s("th",{style:"text-align:right",children:"Gewinn"})]})}),s("tbody",{children:[o.map(_=>s("tr",{children:[s("td",{"data-label":"Quartal",style:"font-weight:600",children:["Q",_.quarter]}),s("td",{"data-label":"Einnahmen brutto",children:je(_.incomeBrutto)}),s("td",{"data-label":"Einnahmen netto",children:je(_.incomeNetto)}),s("td",{"data-label":"Ausgaben brutto",children:je(_.expensesBrutto)}),s("td",{"data-label":"MwSt erh.",children:je(_.vatCollected)}),s("td",{"data-label":"MwSt gez.",children:je(_.vatPaid)}),s("td",{"data-label":"Gewinn",style:`font-weight:600;color:${_.profit>=0?"#10b981":"#ef4444"}`,children:je(_.profit)})]},_.quarter)),s("tr",{style:"font-weight:700;border-top:2px solid var(--border)",children:[s("td",{"data-label":"Quartal",children:"Summe"}),s("td",{"data-label":"Einnahmen brutto",children:je(a.yearRevenue)}),s("td",{"data-label":"Einnahmen netto",children:je(a.yearRevenueNetto)}),s("td",{"data-label":"Ausgaben brutto",children:je(a.yearExpenses)}),s("td",{"data-label":"MwSt erh.",children:je(a.vatCollected)}),s("td",{"data-label":"MwSt gez.",children:je(a.vatPaid)}),s("td",{"data-label":"Gewinn",style:`color:${a.yearProfit>=0?"#10b981":"#ef4444"}`,children:je(a.yearProfit)})]})]})]})})]}),Object.keys(l).length>0&&s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:"Ausgaben nach Kategorie"})}),s("div",{class:"table-wrapper",children:s("table",{children:[s("thead",{children:s("tr",{children:[s("th",{children:"Kategorie"}),s("th",{style:"text-align:right",children:"Betrag"}),s("th",{style:"text-align:right",children:"Anteil"})]})}),s("tbody",{children:[Object.entries(l).sort(([,_],[,w])=>w-_).map(([_,w])=>s("tr",{children:[s("td",{"data-label":"Kategorie",style:"font-weight:500",children:Hl[_]||_}),s("td",{"data-label":"Betrag",children:je(w)}),s("td",{"data-label":"Anteil",children:[p>0?(w/p*100).toFixed(1):0," %"]})]},_)),s("tr",{style:"font-weight:700;border-top:2px solid var(--border)",children:[s("td",{"data-label":"Kategorie",children:"Gesamt"}),s("td",{"data-label":"Betrag",children:je(p)}),s("td",{"data-label":"Anteil",children:"100 %"})]})]})]})})]}),s("div",{class:"card",style:"margin-bottom:1.5rem",children:[s("div",{class:"card-header",children:s("span",{class:"card-title",children:["EUER-Zusammenfassung ",n]})}),s("div",{style:"padding:0.5rem 0",children:[s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--border)",children:[s("span",{children:"Betriebseinnahmen (netto)"}),s("span",{style:"font-weight:600",children:je(a.yearRevenueNetto)})]}),s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--border)",children:[s("span",{children:"Betriebsausgaben (netto)"}),s("span",{style:"font-weight:600;color:#ef4444",children:je(a.yearExpensesNetto)})]}),s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:2px solid var(--border);font-weight:700;font-size:1.1rem",children:[s("span",{children:"Gewinn vor Steuern"}),s("span",{style:`color:${a.yearProfit>=0?"#10b981":"#ef4444"}`,children:je(a.yearProfit)})]}),s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--border);margin-top:0.5rem",children:[s("span",{children:"MwSt. erhalten"}),s("span",{children:je(a.vatCollected)})]}),s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--border)",children:[s("span",{children:"MwSt. gezahlt (Vorsteuer)"}),s("span",{children:je(a.vatPaid)})]}),s("div",{style:"display:flex;justify-content:space-between;padding:0.75rem 0;font-weight:700",children:[s("span",{children:"MwSt.-Zahllast"}),s("span",{children:je(a.vatPayable)})]})]})]})]}):s("div",{class:"empty-state",children:[s("div",{class:"empty-state-icon",children:""}),s("div",{class:"empty-state-text",children:"Keine Daten verfuegbar"})]})})]})}function g_(){const{user:t,loading:e}=tc();return e?s("div",{class:"loading-center",style:"min-height: 100vh",children:s("div",{class:"spinner"})}):t?s(X2,{children:s(ug,{children:[s(Xd,{path:"/crm/"}),s(fv,{path:"/crm/pipeline"}),s(xv,{path:"/crm/contacts"}),s(Av,{path:"/crm/contacts/new"}),s(Sv,{path:"/crm/contacts/:id"}),s(Nv,{path:"/crm/companies"}),s(Ev,{path:"/crm/companies/:id"}),s(Cv,{path:"/crm/deals/new"}),s(Lv,{path:"/crm/deals/:id"}),s(sb,{path:"/crm/invoices"}),s(lb,{path:"/crm/invoices/new"}),s(r_,{path:"/crm/invoices/:id"}),s(c_,{path:"/crm/expenses"}),s(u_,{path:"/crm/expenses/new"}),s(p_,{path:"/crm/reports"}),s(Fv,{path:"/crm/campaigns"}),s(ib,{path:"/crm/campaigns/new"}),s(ab,{path:"/crm/campaigns/:id"}),s(Tv,{path:"/crm/settings"}),s(Xd,{default:!0})]})}):s(Z2,{})}t0(s(M2,{children:s(U2,{children:s(g_,{})})}),document.getElementById("app"));export{Ht as _};
