var G0=Object.defineProperty;var K0=(n,e,t)=>e in n?G0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var It=(n,e,t)=>K0(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var ro,Ft,If,us,Ph,Tf,Of,Rf,ku,Kc,Jc,jf,gl={},ml=[],J0=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,io=Array.isArray;function zr(n,e){for(var t in e)n[t]=e[t];return n}function Nu(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function Ff(n,e,t){var r,s,i,a={};for(i in e)i=="key"?r=e[i]:i=="ref"?s=e[i]:a[i]=e[i];if(arguments.length>2&&(a.children=arguments.length>3?ro.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(i in n.defaultProps)a[i]===void 0&&(a[i]=n.defaultProps[i]);return $a(n,a,r,s,null)}function $a(n,e,t,r,s){var i={type:n,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++If,__i:-1,__u:0};return s==null&&Ft.vnode!=null&&Ft.vnode(i),i}function bt(n){return n.children}function za(n,e){this.props=n,this.context=e}function na(n,e){if(e==null)return n.__?na(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?na(n):null}function Y0(n){if(n.__P&&n.__d){var e=n.__v,t=e.__e,r=[],s=[],i=zr({},e);i.__v=e.__v+1,Ft.vnode&&Ft.vnode(i),Lu(n.__P,i,e,n.__n,n.__P.namespaceURI,32&e.__u?[t]:null,r,t??na(e),!!(32&e.__u),s),i.__v=e.__v,i.__.__k[i.__i]=i,Mf(r,i,s),e.__e=e.__=null,i.__e!=t&&Df(i)}}function Df(n){if((n=n.__)!=null&&n.__c!=null)return n.__e=n.__c.base=null,n.__k.some(function(e){if(e!=null&&e.__e!=null)return n.__e=n.__c.base=e.__e}),Df(n)}function Yc(n){(!n.__d&&(n.__d=!0)&&us.push(n)&&!vl.__r++||Ph!=Ft.debounceRendering)&&((Ph=Ft.debounceRendering)||Tf)(vl)}function vl(){for(var n,e=1;us.length;)us.length>e&&us.sort(Of),n=us.shift(),e=us.length,Y0(n);vl.__r=0}function Bf(n,e,t,r,s,i,a,o,u,h,f){var m,y,p,S,_,x,w,O=r&&r.__k||ml,C=e.length;for(u=X0(t,e,O,u,C),m=0;m<C;m++)(p=t.__k[m])!=null&&(y=p.__i!=-1&&O[p.__i]||gl,p.__i=m,x=Lu(n,p,y,s,i,a,o,u,h,f),S=p.__e,p.ref&&y.ref!=p.ref&&(y.ref&&Eu(y.ref,null,p),f.push(p.ref,p.__c||S,p)),_==null&&S!=null&&(_=S),(w=!!(4&p.__u))||y.__k===p.__k?u=Uf(p,u,n,w):typeof p.type=="function"&&x!==void 0?u=x:S&&(u=S.nextSibling),p.__u&=-7);return t.__e=_,u}function X0(n,e,t,r,s){var i,a,o,u,h,f=t.length,m=f,y=0;for(n.__k=new Array(s),i=0;i<s;i++)(a=e[i])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=n.__k[i]=$a(null,a,null,null,null):io(a)?a=n.__k[i]=$a(bt,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?a=n.__k[i]=$a(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):n.__k[i]=a,u=i+y,a.__=n,a.__b=n.__b+1,o=null,(h=a.__i=Z0(a,t,u,m))!=-1&&(m--,(o=t[h])&&(o.__u|=2)),o==null||o.__v==null?(h==-1&&(s>f?y--:s<f&&y++),typeof a.type!="function"&&(a.__u|=4)):h!=u&&(h==u-1?y--:h==u+1?y++:(h>u?y--:y++,a.__u|=4))):n.__k[i]=null;if(m)for(i=0;i<f;i++)(o=t[i])!=null&&(2&o.__u)==0&&(o.__e==r&&(r=na(o)),$f(o,o));return r}function Uf(n,e,t,r){var s,i;if(typeof n.type=="function"){for(s=n.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=n,e=Uf(s[i],e,t,r));return e}n.__e!=e&&(r&&(e&&n.type&&!e.parentNode&&(e=na(n)),t.insertBefore(n.__e,e||null)),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Xc(n,e){return e=e||[],n==null||typeof n=="boolean"||(io(n)?n.some(function(t){Xc(t,e)}):e.push(n)),e}function Z0(n,e,t,r){var s,i,a,o=n.key,u=n.type,h=e[t],f=h!=null&&(2&h.__u)==0;if(h===null&&o==null||f&&o==h.key&&u==h.type)return t;if(r>(f?1:0)){for(s=t-1,i=t+1;s>=0||i<e.length;)if((h=e[a=s>=0?s--:i++])!=null&&(2&h.__u)==0&&o==h.key&&u==h.type)return a}return-1}function Ch(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||J0.test(e)?t:t+"px"}function Wo(n,e,t,r,s){var i,a;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(e in r)t&&e in t||Ch(n.style,e,"");if(t)for(e in t)r&&t[e]==r[e]||Ch(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(Rf,"$1")),a=e.toLowerCase(),e=a in n||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),n.l||(n.l={}),n.l[e+i]=t,t?r?t.u=r.u:(t.u=ku,n.addEventListener(e,i?Jc:Kc,i)):n.removeEventListener(e,i?Jc:Kc,i);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function Ih(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=ku++;else if(e.t<t.u)return;return t(Ft.event?Ft.event(e):e)}}}function Lu(n,e,t,r,s,i,a,o,u,h){var f,m,y,p,S,_,x,w,O,C,F,G,V,re,J,U=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(u=!!(32&t.__u),i=[o=e.__e=t.__e]),(f=Ft.__b)&&f(e);e:if(typeof U=="function")try{if(w=e.props,O="prototype"in U&&U.prototype.render,C=(f=U.contextType)&&r[f.__c],F=f?C?C.props.value:f.__:r,t.__c?x=(m=e.__c=t.__c).__=m.__E:(O?e.__c=m=new U(w,F):(e.__c=m=new za(w,F),m.constructor=U,m.render=eg),C&&C.sub(m),m.state||(m.state={}),m.__n=r,y=m.__d=!0,m.__h=[],m._sb=[]),O&&m.__s==null&&(m.__s=m.state),O&&U.getDerivedStateFromProps!=null&&(m.__s==m.state&&(m.__s=zr({},m.__s)),zr(m.__s,U.getDerivedStateFromProps(w,m.__s))),p=m.props,S=m.state,m.__v=e,y)O&&U.getDerivedStateFromProps==null&&m.componentWillMount!=null&&m.componentWillMount(),O&&m.componentDidMount!=null&&m.__h.push(m.componentDidMount);else{if(O&&U.getDerivedStateFromProps==null&&w!==p&&m.componentWillReceiveProps!=null&&m.componentWillReceiveProps(w,F),e.__v==t.__v||!m.__e&&m.shouldComponentUpdate!=null&&m.shouldComponentUpdate(w,m.__s,F)===!1){e.__v!=t.__v&&(m.props=w,m.state=m.__s,m.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(I){I&&(I.__=e)}),ml.push.apply(m.__h,m._sb),m._sb=[],m.__h.length&&a.push(m);break e}m.componentWillUpdate!=null&&m.componentWillUpdate(w,m.__s,F),O&&m.componentDidUpdate!=null&&m.__h.push(function(){m.componentDidUpdate(p,S,_)})}if(m.context=F,m.props=w,m.__P=n,m.__e=!1,G=Ft.__r,V=0,O)m.state=m.__s,m.__d=!1,G&&G(e),f=m.render(m.props,m.state,m.context),ml.push.apply(m.__h,m._sb),m._sb=[];else do m.__d=!1,G&&G(e),f=m.render(m.props,m.state,m.context),m.state=m.__s;while(m.__d&&++V<25);m.state=m.__s,m.getChildContext!=null&&(r=zr(zr({},r),m.getChildContext())),O&&!y&&m.getSnapshotBeforeUpdate!=null&&(_=m.getSnapshotBeforeUpdate(p,S)),re=f!=null&&f.type===bt&&f.key==null?qf(f.props.children):f,o=Bf(n,io(re)?re:[re],e,t,r,s,i,a,o,u,h),m.base=e.__e,e.__u&=-161,m.__h.length&&a.push(m),x&&(m.__E=m.__=null)}catch(I){if(e.__v=null,u||i!=null)if(I.then){for(e.__u|=u?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;i[i.indexOf(o)]=null,e.__e=o}else{for(J=i.length;J--;)Nu(i[J]);Zc(e)}else e.__e=t.__e,e.__k=t.__k,I.then||Zc(e);Ft.__e(I,e,t)}else i==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):o=e.__e=Q0(t.__e,e,t,r,s,i,a,u,h);return(f=Ft.diffed)&&f(e),128&e.__u?void 0:o}function Zc(n){n&&(n.__c&&(n.__c.__e=!0),n.__k&&n.__k.some(Zc))}function Mf(n,e,t){for(var r=0;r<t.length;r++)Eu(t[r],t[++r],t[++r]);Ft.__c&&Ft.__c(e,n),n.some(function(s){try{n=s.__h,s.__h=[],n.some(function(i){i.call(s)})}catch(i){Ft.__e(i,s.__v)}})}function qf(n){return typeof n!="object"||n==null||n.__b>0?n:io(n)?n.map(qf):zr({},n)}function Q0(n,e,t,r,s,i,a,o,u){var h,f,m,y,p,S,_,x=t.props||gl,w=e.props,O=e.type;if(O=="svg"?s="http://www.w3.org/2000/svg":O=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(h=0;h<i.length;h++)if((p=i[h])&&"setAttribute"in p==!!O&&(O?p.localName==O:p.nodeType==3)){n=p,i[h]=null;break}}if(n==null){if(O==null)return document.createTextNode(w);n=document.createElementNS(s,O,w.is&&w),o&&(Ft.__m&&Ft.__m(e,i),o=!1),i=null}if(O==null)x===w||o&&n.data==w||(n.data=w);else{if(i=i&&ro.call(n.childNodes),!o&&i!=null)for(x={},h=0;h<n.attributes.length;h++)x[(p=n.attributes[h]).name]=p.value;for(h in x)p=x[h],h=="dangerouslySetInnerHTML"?m=p:h=="children"||h in w||h=="value"&&"defaultValue"in w||h=="checked"&&"defaultChecked"in w||Wo(n,h,null,p,s);for(h in w)p=w[h],h=="children"?y=p:h=="dangerouslySetInnerHTML"?f=p:h=="value"?S=p:h=="checked"?_=p:o&&typeof p!="function"||x[h]===p||Wo(n,h,p,x[h],s);if(f)o||m&&(f.__html==m.__html||f.__html==n.innerHTML)||(n.innerHTML=f.__html),e.__k=[];else if(m&&(n.innerHTML=""),Bf(e.type=="template"?n.content:n,io(y)?y:[y],e,t,r,O=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,a,i?i[0]:t.__k&&na(t,0),o,u),i!=null)for(h=i.length;h--;)Nu(i[h]);o||(h="value",O=="progress"&&S==null?n.removeAttribute("value"):S!=null&&(S!==n[h]||O=="progress"&&!S||O=="option"&&S!=x[h])&&Wo(n,h,S,x[h],s),h="checked",_!=null&&_!=n[h]&&Wo(n,h,_,x[h],s))}return n}function Eu(n,e,t){try{if(typeof n=="function"){var r=typeof n.__u=="function";r&&n.__u(),r&&e==null||(n.__u=n(e))}else n.current=e}catch(s){Ft.__e(s,t)}}function $f(n,e,t){var r,s;if(Ft.unmount&&Ft.unmount(n),(r=n.ref)&&(r.current&&r.current!=n.__e||Eu(r,null,e)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){Ft.__e(i,e)}r.base=r.__P=null}if(r=n.__k)for(s=0;s<r.length;s++)r[s]&&$f(r[s],e,t||typeof n.type!="function");t||Nu(n.__e),n.__c=n.__=n.__e=void 0}function eg(n,e,t){return this.constructor(n,t)}function tg(n,e,t){var r,s,i,a;e==document&&(e=document.documentElement),Ft.__&&Ft.__(n,e),s=(r=!1)?null:e.__k,i=[],a=[],Lu(e,n=e.__k=Ff(bt,null,[n]),s||gl,gl,e.namespaceURI,s?null:e.firstChild?ro.call(e.childNodes):null,i,s?s.__e:e.firstChild,r,a),Mf(i,n,a)}function ng(n,e,t){var r,s,i,a,o=zr({},n.props);for(i in n.type&&n.type.defaultProps&&(a=n.type.defaultProps),e)i=="key"?r=e[i]:i=="ref"?s=e[i]:o[i]=e[i]===void 0&&a!=null?a[i]:e[i];return arguments.length>2&&(o.children=arguments.length>3?ro.call(arguments,2):t),$a(n.type,o,r||n.key,s||n.ref,null)}function Pu(n){function e(t){var r,s;return this.getChildContext||(r=new Set,(s={})[e.__c]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&r.forEach(function(a){a.__e=!0,Yc(a)})},this.sub=function(i){r.add(i);var a=i.componentWillUnmount;i.componentWillUnmount=function(){r&&r.delete(i),a&&a.call(i)}}),t.children}return e.__c="__cC"+jf++,e.__=n,e.Provider=e.__l=(e.Consumer=function(t,r){return t.children(r)}).contextType=e,e}ro=ml.slice,Ft={__e:function(n,e,t,r){for(var s,i,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(n)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,r||{}),a=s.__d),a)return s.__E=s}catch(o){n=o}throw n}},If=0,za.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=zr({},this.state),typeof n=="function"&&(n=n(zr({},t),this.props)),n&&zr(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),Yc(this))},za.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Yc(this))},za.prototype.render=bt,us=[],Tf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Of=function(n,e){return n.__v.__b-e.__v.__b},vl.__r=0,Rf=/(PointerCapture)$|Capture$/i,ku=0,Kc=Ih(!1),Jc=Ih(!0),jf=0;var rg=0;function l(n,e,t,r,s,i){e||(e={});var a,o,u=e;if("ref"in u)for(o in u={},e)o=="ref"?a=e[o]:u[o]=e[o];var h={type:n,props:u,key:t,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--rg,__i:-1,__u:0,__source:s,__self:i};if(typeof n=="function"&&(a=n.defaultProps))for(o in a)u[o]===void 0&&(u[o]=a[o]);return Ft.vnode&&Ft.vnode(h),h}var ra,Jt,pc,Th,bl=0,zf=[],pn=Ft,Oh=pn.__b,Rh=pn.__r,jh=pn.diffed,Fh=pn.__c,Dh=pn.unmount,Bh=pn.__;function Nl(n,e){pn.__h&&pn.__h(Jt,n,bl||e),bl=0;var t=Jt.__H||(Jt.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({}),t.__[n]}function Ae(n){return bl=1,ig(Vf,n)}function ig(n,e,t){var r=Nl(ra++,2);if(r.t=n,!r.__c&&(r.__=[Vf(void 0,e),function(o){var u=r.__N?r.__N[0]:r.__[0],h=r.t(u,o);u!==h&&(r.__N=[h,r.__[1]],r.__c.setState({}))}],r.__c=Jt,!Jt.__f)){var s=function(o,u,h){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(y){return y.__c});if(f.every(function(y){return!y.__N}))return!i||i.call(this,o,u,h);var m=r.__c.props!==o;return f.some(function(y){if(y.__N){var p=y.__[0];y.__=y.__N,y.__N=void 0,p!==y.__[0]&&(m=!0)}}),i&&i.call(this,o,u,h)||m};Jt.__f=!0;var i=Jt.shouldComponentUpdate,a=Jt.componentWillUpdate;Jt.componentWillUpdate=function(o,u,h){if(this.__e){var f=i;i=void 0,s(o,u,h),i=f}a&&a.call(this,o,u,h)},Jt.shouldComponentUpdate=s}return r.__N||r.__}function qt(n,e){var t=Nl(ra++,3);!pn.__s&&Hf(t.__H,e)&&(t.__=n,t.u=e,Jt.__H.__h.push(t))}function sg(n,e){var t=Nl(ra++,7);return Hf(t.__H,e)&&(t.__=n(),t.__H=e,t.__h=n),t.__}function kt(n,e){return bl=8,sg(function(){return n},e)}function Wf(n){var e=Jt.context[n.__c],t=Nl(ra++,9);return t.c=n,e?(t.__==null&&(t.__=!0,e.sub(Jt)),e.props.value):n.__}function ag(){for(var n;n=zf.shift();){var e=n.__H;if(n.__P&&e)try{e.__h.some(ll),e.__h.some(Qc),e.__h=[]}catch(t){e.__h=[],pn.__e(t,n.__v)}}}pn.__b=function(n){Jt=null,Oh&&Oh(n)},pn.__=function(n,e){n&&e.__k&&e.__k.__m&&(n.__m=e.__k.__m),Bh&&Bh(n,e)},pn.__r=function(n){Rh&&Rh(n),ra=0;var e=(Jt=n.__c).__H;e&&(pc===Jt?(e.__h=[],Jt.__h=[],e.__.some(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.some(ll),e.__h.some(Qc),e.__h=[],ra=0)),pc=Jt},pn.diffed=function(n){jh&&jh(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(zf.push(e)!==1&&Th===pn.requestAnimationFrame||((Th=pn.requestAnimationFrame)||og)(ag)),e.__H.__.some(function(t){t.u&&(t.__H=t.u),t.u=void 0})),pc=Jt=null},pn.__c=function(n,e){e.some(function(t){try{t.__h.some(ll),t.__h=t.__h.filter(function(r){return!r.__||Qc(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],pn.__e(r,t.__v)}}),Fh&&Fh(n,e)},pn.unmount=function(n){Dh&&Dh(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.some(function(r){try{ll(r)}catch(s){e=s}}),t.__H=void 0,e&&pn.__e(e,t.__v))};var Uh=typeof requestAnimationFrame=="function";function og(n){var e,t=function(){clearTimeout(r),Uh&&cancelAnimationFrame(e),setTimeout(n)},r=setTimeout(t,35);Uh&&(e=requestAnimationFrame(t))}function ll(n){var e=Jt,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Jt=e}function Qc(n){var e=Jt;n.__c=n.__(),Jt=e}function Hf(n,e){return!n||n.length!==e.length||e.some(function(t,r){return t!==n[r]})}function Vf(n,e){return typeof e=="function"?e(n):e}function Ll(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function lg(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(f){try{h(r.next(f))}catch(m){a(m)}}function u(f){try{h(r.throw(f))}catch(m){a(m)}}function h(f){f.done?i(f.value):s(f.value).then(o,u)}h((r=r.apply(n,e||[])).next())})}const cg=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Cu extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class ug extends Cu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mh extends Cu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qh extends Cu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var eu;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(eu||(eu={}));class hg{constructor(e,{headers:t={},customFetch:r,region:s=eu.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=cg(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return lg(this,arguments,void 0,function*(t,r={}){var s;let i,a;try{const{headers:o,method:u,body:h,signal:f,timeout:m}=r;let y={},{region:p}=r;p||(p=this.region);const S=new URL(`${this.url}/${t}`);p&&p!=="any"&&(y["x-region"]=p,S.searchParams.set("forceFunctionRegion",p));let _;h&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",_=h):typeof h=="string"?(y["Content-Type"]="text/plain",_=h):typeof FormData<"u"&&h instanceof FormData?_=h:(y["Content-Type"]="application/json",_=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?_=JSON.stringify(h):_=h;let x=f;m&&(a=new AbortController,i=setTimeout(()=>a.abort(),m),f?(x=a.signal,f.addEventListener("abort",()=>a.abort())):x=a.signal);const w=yield this.fetch(S.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),o),body:_,signal:x}).catch(G=>{throw new ug(G)}),O=w.headers.get("x-relay-error");if(O&&O==="true")throw new Mh(w);if(!w.ok)throw new qh(w);let C=((s=w.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),F;return C==="application/json"?F=yield w.json():C==="application/octet-stream"||C==="application/pdf"?F=yield w.blob():C==="text/event-stream"?F=w:C==="multipart/form-data"?F=yield w.formData():F=yield w.text(),{data:F,error:null,response:w}}catch(o){return{data:null,error:o,response:o instanceof qh||o instanceof Mh?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var dg=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},fg=class{constructor(n){var e,t,r;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(r=n.urlLengthLimit)!==null&&r!==void 0?r:8e3,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,o=null,u=null,h=i.status,f=i.statusText;if(i.ok){var m,y;if(t.method!=="HEAD"){var p;const w=await i.text();w===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((p=t.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?o=w:o=JSON.parse(w))}const _=(m=t.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),x=(y=i.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");_&&x&&x.length>1&&(u=parseInt(x[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,u=null,h=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var S;const _=await i.text();try{a=JSON.parse(_),Array.isArray(a)&&i.status===404&&(o=[],a=null,h=200,f="OK")}catch{i.status===404&&_===""?(h=204,f="No Content"):a={message:_}}if(a&&t.isMaybeSingle&&(!(a==null||(S=a.details)===null||S===void 0)&&S.includes("0 rows"))&&(a=null,h=200,f="OK"),a&&t.shouldThrowOnError)throw new dg(a)}return{error:a,data:o,count:u,status:h,statusText:f}});return this.shouldThrowOnError||(s=s.catch(i=>{var a;let o="",u="",h="";const f=i==null?void 0:i.cause;if(f){var m,y,p,S;const w=(m=f==null?void 0:f.message)!==null&&m!==void 0?m:"",O=(y=f==null?void 0:f.code)!==null&&y!==void 0?y:"";o=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(S=f==null?void 0:f.name)!==null&&S!==void 0?S:"Error"}: ${w}`,O&&(o+=` (${O})`),f!=null&&f.stack&&(o+=`
${f.stack}`)}else{var _;o=(_=i==null?void 0:i.stack)!==null&&_!==void 0?_:""}const x=this.url.toString().length;return(i==null?void 0:i.name)==="AbortError"||(i==null?void 0:i.code)==="ABORT_ERR"?(h="",u="Request was aborted (timeout or manual cancellation)",x>this.urlLengthLimit&&(u+=`. Note: Your request URL is ${x} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((f==null?void 0:f.name)==="HeadersOverflowError"||(f==null?void 0:f.code)==="UND_ERR_HEADERS_OVERFLOW")&&(h="",u="HTTP headers exceeded server limits (typically 16KB)",x>this.urlLengthLimit&&(u+=`. Your request URL is ${x} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:u,code:h},data:null,count:null,status:0,statusText:""}})),s.then(n,e)}returns(){return this}overrideTypes(){return this}},pg=class extends fg{select(n){let e=!1;const t=(n??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const i=s?`${s}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${n}`),this.url.searchParams.set(i,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:i="text"}={}){var a;const o=[n?"analyze":null,e?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const $h=new RegExp("[,()]");var Ws=class extends pg{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(r=>typeof r=="string"&&$h.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(r=>typeof r=="string"&&$h.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const i=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${s}fts${i}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},gg=class{constructor(n,{headers:e={},schema:t,fetch:r,urlLengthLimit:s=8e3}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=r,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:r}=e??{},s=t?"HEAD":"GET";let i=!1;const a=(n??"*").split("").map(h=>/\s/.test(h)&&!i?"":(h==='"'&&(i=!i),h)).join(""),{url:o,headers:u}=this.cloneRequestState();return o.searchParams.set("select",a),r&&u.append("Prefer",`count=${r}`),new Ws({method:s,url:o,headers:u,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(n,{count:e,defaultToNull:t=!0}={}){var r;const s="POST",{url:i,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(n)){const o=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(o.length>0){const u=[...new Set(o)].map(h=>`"${h}"`);i.searchParams.set("columns",u.join(","))}}return new Ws({method:s,url:i,headers:a,schema:this.schema,body:n,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){var i;const a="POST",{url:o,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&o.searchParams.set("on_conflict",e),r&&u.append("Prefer",`count=${r}`),s||u.append("Prefer","missing=default"),Array.isArray(n)){const h=n.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(h.length>0){const f=[...new Set(h)].map(m=>`"${m}"`);o.searchParams.set("columns",f.join(","))}}return new Ws({method:a,url:o,headers:u,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(n,{count:e}={}){var t;const r="PATCH",{url:s,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Ws({method:r,url:s,headers:i,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:n}={}){var e;const t="DELETE",{url:r,headers:s}=this.cloneRequestState();return n&&s.append("Prefer",`count=${n}`),new Ws({method:t,url:r,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function Ka(n){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(n)}function mg(n,e){if(Ka(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Ka(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vg(n){var e=mg(n,"string");return Ka(e)=="symbol"?e:e+""}function bg(n,e,t){return(e=vg(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zh(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Ho(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?zh(Object(t),!0).forEach(function(r){bg(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):zh(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var yg=class Gf{constructor(e,{headers:t={},schema:r,fetch:s,timeout:i,urlLengthLimit:a=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.urlLengthLimit=a;const o=s??globalThis.fetch;i!==void 0&&i>0?this.fetch=(u,h)=>{const f=new AbortController,m=setTimeout(()=>f.abort(),i),y=h==null?void 0:h.signal;if(y){if(y.aborted)return clearTimeout(m),o(u,h);const p=()=>{clearTimeout(m),f.abort()};return y.addEventListener("abort",p,{once:!0}),o(u,Ho(Ho({},h),{},{signal:f.signal})).finally(()=>{clearTimeout(m),y.removeEventListener("abort",p)})}return o(u,Ho(Ho({},h),{},{signal:f.signal})).finally(()=>clearTimeout(m))}:this.fetch=o}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new gg(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Gf(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){var a;let o;const u=new URL(`${this.url}/rpc/${e}`);let h;const f=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(f)),m=r&&Object.values(t).some(f);m?(o="POST",h=t):r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([p,S])=>S!==void 0).map(([p,S])=>[p,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([p,S])=>{u.searchParams.append(p,S)})):(o="POST",h=t);const y=new Headers(this.headers);return m?y.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&y.set("Prefer",`count=${i}`),new Ws({method:o,url:u,headers:y,schema:this.schemaName,body:h,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class _g{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const r=t.versions;if(r&&r.node){const s=r.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const wg="2.97.0",xg=`realtime-js/${wg}`,Sg="1.0.0",Kf="2.0.0",Wh=Kf,tu=1e4,Ag=1e3,kg=100;var Fi;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Fi||(Fi={}));var wn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(wn||(wn={}));var Er;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Er||(Er={}));var nu;(function(n){n.websocket="websocket"})(nu||(nu={}));var hs;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(hs||(hs={}));class Ng{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const s=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,r;const s=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,r){var s,i;const a=e.topic,o=(s=e.ref)!==null&&s!==void 0?s:"",u=(i=e.join_ref)!==null&&i!==void 0?i:"",h=e.payload.event,f=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(f).length===0?"":JSON.stringify(f);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+o.length+a.length+h.length+m.length,p=new ArrayBuffer(this.HEADER_LENGTH+y);let S=new DataView(p),_=0;S.setUint8(_++,this.KINDS.userBroadcastPush),S.setUint8(_++,u.length),S.setUint8(_++,o.length),S.setUint8(_++,a.length),S.setUint8(_++,h.length),S.setUint8(_++,m.length),S.setUint8(_++,t),Array.from(u,w=>S.setUint8(_++,w.charCodeAt(0))),Array.from(o,w=>S.setUint8(_++,w.charCodeAt(0))),Array.from(a,w=>S.setUint8(_++,w.charCodeAt(0))),Array.from(h,w=>S.setUint8(_++,w.charCodeAt(0))),Array.from(m,w=>S.setUint8(_++,w.charCodeAt(0)));var x=new Uint8Array(p.byteLength+r.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(r),p.byteLength),x.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,i,a,o,u]=r;return t({join_ref:s,ref:i,topic:a,event:o,payload:u})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2),a=t.getUint8(3),o=t.getUint8(4);let u=this.HEADER_LENGTH+4;const h=r.decode(e.slice(u,u+s));u=u+s;const f=r.decode(e.slice(u,u+i));u=u+i;const m=r.decode(e.slice(u,u+a));u=u+a;const y=e.slice(u,e.byteLength),p=o===this.JSON_ENCODING?JSON.parse(r.decode(y)):y,S={type:this.BROADCAST_EVENT,event:f,payload:p};return a>0&&(S.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:S}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>t.includes(r)))}}class Jf{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Mt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Mt||(Mt={}));const Hh=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=Lg(a,n,e,s),i),{}):{}},Lg=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s==null?void 0:s.type,a=t[n];return i&&!r.includes(i)?Yf(i,a):ru(a)},Yf=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Ig(e,t)}switch(n){case Mt.bool:return Eg(e);case Mt.float4:case Mt.float8:case Mt.int2:case Mt.int4:case Mt.int8:case Mt.numeric:case Mt.oid:return Pg(e);case Mt.json:case Mt.jsonb:return Cg(e);case Mt.timestamp:return Tg(e);case Mt.abstime:case Mt.date:case Mt.daterange:case Mt.int4range:case Mt.int8range:case Mt.money:case Mt.reltime:case Mt.text:case Mt.time:case Mt.timestamptz:case Mt.timetz:case Mt.tsrange:case Mt.tstzrange:return ru(e);default:return ru(e)}},ru=n=>n,Eg=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Pg=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Cg=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},Ig=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Yf(e,o))}return n},Tg=n=>typeof n=="string"?n.replace(" ","T"):n,Xf=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class gc{constructor(e,t,r={},s=tu){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Vh;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Vh||(Vh={}));class Wa{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wa.syncState(this.state,s,i,a),this.pendingDiffs.forEach(u=>{this.state=Wa.syncDiff(this.state,u,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Wa.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},u={};return this.map(i,(h,f)=>{a[h]||(u[h]=f)}),this.map(a,(h,f)=>{const m=i[h];if(m){const y=f.map(x=>x.presence_ref),p=m.map(x=>x.presence_ref),S=f.filter(x=>p.indexOf(x.presence_ref)<0),_=m.filter(x=>y.indexOf(x.presence_ref)<0);S.length>0&&(o[h]=S),_.length>0&&(u[h]=_)}else o[h]=f}),this.syncDiff(i,{joins:o,leaves:u},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var h;const f=(h=e[o])!==null&&h!==void 0?h:[];if(e[o]=this.cloneDeep(u),f.length>0){const m=e[o].map(p=>p.presence_ref),y=f.filter(p=>m.indexOf(p.presence_ref)<0);e[o].unshift(...y)}r(o,f,u)}),this.map(a,(o,u)=>{let h=e[o];if(!h)return;const f=u.map(m=>m.presence_ref);h=h.filter(m=>f.indexOf(m.presence_ref)<0),e[o]=h,s(o,h,u),h.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gh;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Gh||(Gh={}));var Ha;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Ha||(Ha={}));var fi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(fi||(fi={}));class Js{constructor(e,t={config:{}},r){var s,i;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=wn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new gc(this,Er.join,this.params,this.timeout),this.rejoinTimer=new Jf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=wn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=wn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Er.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Wa(this),this.broadcastEndpointURL=Xf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==wn.closed){const{config:{broadcast:a,presence:o,private:u}}=this.params,h=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[Ha.PRESENCE]&&this.bindings[Ha.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},y={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:h,private:u};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(fi.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(fi.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var S;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(fi.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,x=(S=_==null?void 0:_.length)!==null&&S!==void 0?S:0,w=[];for(let O=0;O<x;O++){const C=_[O],{filter:{event:F,schema:G,table:V,filter:re}}=C,J=p&&p[O];if(J&&J.event===F&&Js.isFilterValueEqual(J.schema,G)&&Js.isFilterValueEqual(J.table,V)&&Js.isFilterValueEqual(J.filter,re))w.push(Object.assign(Object.assign({},C),{id:J.id}));else{this.unsubscribe(),this.state=wn.errored,e==null||e(fi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(fi.SUBSCRIBED);return}}).receive("error",p=>{this.state=wn.errored,e==null||e(fi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(fi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===wn.joined&&e===Ha.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(o.status===202)return{success:!0};let u=o.statusText;try{const h=await o.json();u=h.error||h.message||u}catch{}return Promise.reject(new Error(u))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=h.body)===null||s===void 0?void 0:s.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,u;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Er.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new gc(this,Er.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wn.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new gc(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>kg){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:u,leave:h,join:f}=Er;if(r&&[o,u,h,f].indexOf(a)>=0&&r!==this._joinRef())return;let y=this._onMessage(a,t,r);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var S,_,x;return((S=p.filter)===null||S===void 0?void 0:S.event)==="*"||((x=(_=p.filter)===null||_===void 0?void 0:_.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(y,r)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var S,_,x,w,O,C;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const F=p.id,G=(S=p.filter)===null||S===void 0?void 0:S.event;return F&&((_=t.ids)===null||_===void 0?void 0:_.includes(F))&&(G==="*"||(G==null?void 0:G.toLocaleLowerCase())===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const F=(O=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return F==="*"||F===((C=t==null?void 0:t.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof y=="object"&&"ids"in y){const S=y.data,{schema:_,table:x,commit_timestamp:w,type:O,errors:C}=S;y=Object.assign(Object.assign({},{schema:_,table:x,commit_timestamp:w,eventType:O,new:{},old:{},errors:C}),this._getPayloadRecords(S))}p.callback(y,r)})}_isClosed(){return this.state===wn.closed}_isJoined(){return this.state===wn.joined}_isJoining(){return this.state===wn.joining}_isLeaving(){return this.state===wn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Js.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Er.close,{},e)}_onError(e){this._on(Er.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Hh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Hh(e.columns,e.old_record)),t}}const mc=()=>{},Vo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Og=[1e3,2e3,5e3,1e4],Rg=1e4,jg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Fg{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=tu,this.transport=null,this.heartbeatIntervalMs=Vo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mc,this.ref=0,this.reconnectTimer=null,this.vsn=Wh,this.logger=mc,this.conn=null,this.sendBuffer=[],this.serializer=new Ng,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${nu.websocket}`,this.httpEndpoint=Xf(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_g.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Fi.connecting:return hs.Connecting;case Fi.open:return hs.Open;case Fi.closing:return hs.Closing;default:return hs.Closed}}isConnected(){return this.connectionState()===hs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Js(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ag,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Vo.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",h)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:s,payload:i,ref:a}=t,o=a?`(${a})`:"",u=i.status||"";this.log("receive",`${u} ${r} ${s} ${o}`.trim(),i),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(s,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Fi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fi.open||this.conn.readyState===Fi.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(Er.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([jg],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const i={access_token:t,version:xg};t&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Er.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Jf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,i,a,o,u,h,f,m,y,p;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:tu,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Vo.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:mc,this.vsn=(u=e==null?void 0:e.vsn)!==null&&u!==void 0?u:Wh,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:(S=>Og[S-1]||Rg),this.vsn){case Sg:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:((S,_)=>_(JSON.stringify(S))),this.decode=(m=e==null?void 0:e.decode)!==null&&m!==void 0?m:((S,_)=>_(JSON.parse(S)));break;case Kf:this.encode=(y=e==null?void 0:e.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Ja=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Dg(n,e,t){const r=new URL(e,n);if(t)for(const[s,i]of Object.entries(t))i!==void 0&&r.searchParams.set(s,i);return r.toString()}async function Bg(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function Ug(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:r,query:s,body:i,headers:a}){const o=Dg(n.baseUrl,r,s),u=await Bg(n.auth),h=await e(o,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...u,...a},body:i?JSON.stringify(i):void 0}),f=await h.text(),m=(h.headers.get("content-type")||"").includes("application/json"),y=m&&f?JSON.parse(f):f;if(!h.ok){const p=m?y:void 0,S=p==null?void 0:p.error;throw new Ja((S==null?void 0:S.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:S==null?void 0:S.type,icebergCode:S==null?void 0:S.code,details:p})}return{status:h.status,headers:h.headers,data:y}}}}function Go(n){return n.join("")}var Mg=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Go(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Go(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Go(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Go(n.namespace)}`}),!0}catch(e){if(e instanceof Ja&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Ja&&t.status===409)return;throw t}}};function js(n){return n.join("")}var qg=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${js(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Ja&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Ja&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},$g=class{constructor(n){var r;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=Ug({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(r=n.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new Mg(this.client,e),this.tableOps=new qg(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},El=class extends Error{constructor(n,e="storage",t,r){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=r}};function Pl(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Ko=class extends El{constructor(n,e,t,r="storage"){super(n,r,e,t),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Zf=class extends El{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const zg=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Wg=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},iu=n=>{if(Array.isArray(n))return n.map(t=>iu(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=iu(r)}),e},Hg=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function Ya(n){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(n)}function Vg(n,e){if(Ya(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Ya(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gg(n){var e=Vg(n,"string");return Ya(e)=="symbol"?e:e+""}function Kg(n,e,t){return(e=Gg(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kh(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Ye(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kh(Object(t),!0).forEach(function(r){Kg(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Kh(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const Jh=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},Jg=async(n,e,t,r)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const s=n,i=s.status||500;if(typeof s.json=="function")s.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";e(new Ko(Jh(a),i,o,r))}).catch(()=>{if(r==="vectors"){const a=i+"";e(new Ko(s.statusText||`HTTP ${i} error`,i,a,r))}else{const a=i+"";e(new Ko(s.statusText||`HTTP ${i} error`,i,a,r))}});else{const a=i+"";e(new Ko(s.statusText||`HTTP ${i} error`,i,a,r))}}else e(new Zf(Jh(n),n,r))},Yg=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||n==="HEAD"||!r?Ye(Ye({},s),t):(Wg(r)?(s.headers=Ye({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Ye(Ye({},s),t))};async function Da(n,e,t,r,s,i,a){return new Promise((o,u)=>{n(t,Yg(e,r,s,i)).then(h=>{if(!h.ok)throw h;if(r!=null&&r.noResolveJson)return h;if(a==="vectors"){const f=h.headers.get("content-type");if(h.headers.get("content-length")==="0"||h.status===204)return{};if(!f||!f.includes("application/json"))return{}}return h.json()}).then(h=>o(h)).catch(h=>Jg(h,u,r,a))})}function Qf(n="storage"){return{get:async(e,t,r,s)=>Da(e,"GET",t,r,s,void 0,n),post:async(e,t,r,s,i)=>Da(e,"POST",t,s,i,r,n),put:async(e,t,r,s,i)=>Da(e,"PUT",t,s,i,r,n),head:async(e,t,r,s)=>Da(e,"HEAD",t,Ye(Ye({},r),{},{noResolveJson:!0}),s,void 0,n),remove:async(e,t,r,s,i)=>Da(e,"DELETE",t,s,i,r,n)}}const Xg=Qf("storage"),{get:Xa,post:Lr,put:su,head:Zg,remove:Iu}=Xg,ir=Qf("vectors");var aa=class{constructor(n,e={},t,r="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=zg(t),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=Ye(Ye({},this.headers),{},{[n]:e}),this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pl(t))return{data:null,error:t};throw t}}},Qg=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Pl(e))return{data:null,error:e};throw e}}};let ep;ep=Symbol.toStringTag;var e1=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[ep]="BlobDownloadBuilder",this.promise=null}asStream(){return new Qg(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Pl(e))return{data:null,error:e};throw e}}};const t1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var n1=class extends aa{constructor(n,e={},t,r){super(n,e,r,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,r){var s=this;return s.handleOperation(async()=>{let i;const a=Ye(Ye({},Yh),r);let o=Ye(Ye({},s.headers),n==="POST"&&{"x-upsert":String(a.upsert)});const u=a.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),u&&i.append("metadata",s.encodeMetadata(u)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),u&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(u))):(i=t,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,u&&(o["x-metadata"]=s.toBase64(s.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),r!=null&&r.headers&&(o=Ye(Ye({},o),r.headers));const h=s._removeEmptyFolders(e),f=s._getFinalPath(h),m=await(n=="PUT"?su:Lr)(s.fetch,`${s.url}/object/${f}`,i,Ye({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{path:h,id:m.Id,fullPath:m.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,r){var s=this;const i=s._removeEmptyFolders(n),a=s._getFinalPath(i),o=new URL(s.url+`/object/upload/sign/${a}`);return o.searchParams.set("token",e),s.handleOperation(async()=>{let u;const h=Ye({upsert:Yh.upsert},r),f=Ye(Ye({},s.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&t instanceof Blob?(u=new FormData,u.append("cacheControl",h.cacheControl),u.append("",t)):typeof FormData<"u"&&t instanceof FormData?(u=t,u.append("cacheControl",h.cacheControl)):(u=t,f["cache-control"]=`max-age=${h.cacheControl}`,f["content-type"]=h.contentType),{path:i,fullPath:(await su(s.fetch,o.toString(),u,{headers:f})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let r=t._getFinalPath(n);const s=Ye({},t.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const i=await Lr(t.fetch,`${t.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(t.url+i.url),o=a.searchParams.get("token");if(!o)throw new El("No token returned by API");return{signedUrl:a.toString(),path:n,token:o}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var r=this;return r.handleOperation(async()=>await Lr(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:r.headers}))}async copy(n,e,t){var r=this;return r.handleOperation(async()=>({path:(await Lr(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(n,e,t){var r=this;return r.handleOperation(async()=>{let s=r._getFinalPath(n),i=await Lr(r.fetch,`${r.url}/object/sign/${s}`,Ye({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:r.headers});const a=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${r.url}${i.signedURL}${a}`)}})}async createSignedUrls(n,e,t){var r=this;return r.handleOperation(async()=>{const s=await Lr(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:n},{headers:r.headers}),i=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s.map(a=>Ye(Ye({},a),{},{signedUrl:a.signedURL?encodeURI(`${r.url}${a.signedURL}${i}`):null}))})}download(n,e,t){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=s?`?${s}`:"",a=this._getFinalPath(n),o=()=>Xa(this.fetch,`${this.url}/${r}/${a}${i}`,{headers:this.headers,noResolveJson:!0},t);return new e1(o,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>iu(await Xa(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await Zg(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Pl(r)&&r instanceof Zf){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(n,e){const t=this._getFinalPath(n),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&r.push(a);let o=r.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${t}${o}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await Iu(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var r=this;return r.handleOperation(async()=>{const s=Ye(Ye(Ye({},t1),e),{},{prefix:n||""});return await Lr(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const r=Ye({},n);return await Lr(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,r,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const r1="2.97.0",so={"X-Client-Info":`storage-js/${r1}`};var i1=class extends aa{constructor(n,e={},t,r){const s=new URL(n);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const i=s.href.replace(/\/$/,""),a=Ye(Ye({},so),e);super(i,a,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await Xa(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await Xa(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await Lr(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await su(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await Lr(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Iu(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},s1=class extends aa{constructor(n,e={},t){const r=n.replace(/\/$/,""),s=Ye(Ye({},so),e);super(r,s,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await Lr(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const r=t.toString(),s=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return await Xa(e.fetch,s,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Iu(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!Hg(n))throw new El("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new $g({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(t,{get(s,i){const a=s[i];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(s,o),error:null}}catch(u){if(r)throw u;return{data:null,error:u}}}}})}},a1=class extends aa{constructor(n,e={},t){const r=n.replace(/\/$/,""),s=Ye(Ye({},so),{},{"Content-Type":"application/json"},e);super(r,s,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await ir.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await ir.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},o1=class extends aa{constructor(n,e={},t){const r=n.replace(/\/$/,""),s=Ye(Ye({},so),{},{"Content-Type":"application/json"},e);super(r,s,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},l1=class extends aa{constructor(n,e={},t){const r=n.replace(/\/$/,""),s=Ye(Ye({},so),{},{"Content-Type":"application/json"},e);super(r,s,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await ir.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},c1=class extends l1{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new u1(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},u1=class extends a1{constructor(n,e,t,r){super(n,e,r),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new h1(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},h1=class extends o1{constructor(n,e,t,r,s){super(n,e,s),this.vectorBucketName=t,this.indexName=r}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Ye(Ye({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},d1=class extends i1{constructor(n,e={},t,r){super(n,e,t,r)}from(n){return new n1(this.url,this.headers,n,this.fetch)}get vectors(){return new c1(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new s1(this.url+"/iceberg",this.headers,this.fetch)}};const tp="2.97.0",Hs=30*1e3,au=3,vc=au*Hs,f1="http://localhost:9999",p1="supabase.auth.token",g1={"X-Client-Info":`gotrue-js/${tp}`},ou="X-Supabase-Api-Version",np={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,v1=600*1e3;class Za extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ue(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class b1 extends Za{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function y1(n){return Ue(n)&&n.name==="AuthApiError"}class ds extends Za{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class mi extends Za{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class nr extends mi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bc(n){return Ue(n)&&n.name==="AuthSessionMissingError"}class Fs extends mi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jo extends mi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Yo extends mi{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _1(n){return Ue(n)&&n.name==="AuthImplicitGrantRedirectError"}class Xh extends mi{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class w1 extends mi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class lu extends mi{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function yc(n){return Ue(n)&&n.name==="AuthRetryableFetchError"}class Zh extends mi{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class cu extends mi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qh=` 	
\r=`.split(""),x1=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Qh.length;e+=1)n[Qh[e].charCodeAt(0)]=-2;for(let e=0;e<yl.length;e+=1)n[yl[e].charCodeAt(0)]=e;return n})();function ed(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(yl[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(yl[r]),e.queuedBits-=6}}function rp(n,e,t){const r=x1[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function td(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{k1(a,r,t)};for(let a=0;a<n.length;a+=1)rp(n.charCodeAt(a),s,i);return e.join("")}function S1(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function A1(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}S1(r,e)}}function k1(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Xs(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)rp(n.charCodeAt(s),t,r);return new Uint8Array(e)}function N1(n){const e=[];return A1(n,t=>e.push(t)),new Uint8Array(e)}function ps(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>ed(s,t,r)),ed(null,t,r),e.join("")}function L1(n){return Math.round(Date.now()/1e3)+n}function E1(){return Symbol("auth-callback")}const Tn=()=>typeof window<"u"&&typeof document<"u",ss={tested:!1,writable:!1},ip=()=>{if(!Tn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ss.tested)return ss.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ss.tested=!0,ss.writable=!0}catch{ss.tested=!0,ss.writable=!1}return ss.writable};function P1(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const sp=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),C1=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Vs=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},as=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},In=async(n,e)=>{await n.removeItem(e)};class Cl{constructor(){this.promise=new Cl.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Cl.promiseConstructor=Promise;function Xo(n){const e=n.split(".");if(e.length!==3)throw new cu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!m1.test(e[r]))throw new cu("JWT not in base64url format");return{header:JSON.parse(td(e[0])),payload:JSON.parse(td(e[1])),signature:Xs(e[2]),raw:{header:e[0],payload:e[1]}}}async function I1(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function T1(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function O1(n){return("0"+n.toString(16)).substr(-2)}function R1(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,O1).join("")}async function j1(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function F1(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await j1(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ds(n,e,t=!1){const r=R1();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Vs(n,`${e}-code-verifier`,s);const i=await F1(r);return[i,r===i?"plain":"s256"]}const D1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B1(n){const e=n.headers.get(ou);if(!e||!e.match(D1))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function U1(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function M1(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const q1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bs(n){if(!q1.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _c(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $1(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function nd(n){return JSON.parse(JSON.stringify(n))}const ls=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),z1=[502,503,504];async function rd(n){var e;if(!C1(n))throw new lu(ls(n),0);if(z1.includes(n.status))throw new lu(ls(n),n.status);let t;try{t=await n.json()}catch(i){throw new ds(ls(i),i)}let r;const s=B1(n);if(s&&s.getTime()>=np["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Zh(ls(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new nr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Zh(ls(t),n.status,t.weak_password.reasons);throw new b1(ls(t),n.status||500,r)}const W1=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function Qe(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[ou]||(i[ou]=np["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await H1(n,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function H1(n,e,t,r,s,i){const a=W1(e,r,s,i);let o;try{o=await n(t,Object.assign({},a))}catch(u){throw console.error(u),new lu(ls(u),0)}if(o.ok||await rd(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(u){await rd(u)}}function Nr(n){var e;let t=null;K1(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=L1(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function id(n){const e=Nr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Di(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function V1(n){return{data:n,error:null}}function G1(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=Ll(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},u=Object.assign({},a);return{data:{properties:o,user:u},error:null}}function sd(n){return n}function K1(n){return n.access_token&&n.refresh_token&&n.expires_in}const wc=["global","local","others"];class J1{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=sp(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=wc[0]){if(wc.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wc.join(", ")}`);try{return await Qe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Qe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Di})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Ll(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Qe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:G1,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Di})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,u;try{const h={nextPage:null,lastPage:0,total:0},f=await Qe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:sd});if(f.error)throw f.error;const m=await f.json(),y=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(u=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(S.split(";")[1].split("=")[1]);h[`${x}Page`]=_}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Ue(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){Bs(e);try{return await Qe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Di})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Bs(e);try{return await Qe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Di})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Bs(e);try{return await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Di})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Bs(e.userId);try{const{data:t,error:r}=await Qe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Bs(e.userId),Bs(e.id);try{return{data:await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,i,a,o,u;try{const h={nextPage:null,lastPage:0,total:0},f=await Qe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:sd});if(f.error)throw f.error;const m=await f.json(),y=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(u=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return p.length>0&&(p.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(S.split(";")[1].split("=")[1]);h[`${x}Page`]=_}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},m),h),error:null}}catch(h){if(Ue(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Qe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Qe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Qe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}}function ad(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Us={debug:!!(globalThis&&ip()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ap extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class od extends ap{}async function Y1(n,e,t){Us.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;e>0&&setTimeout(()=>{r.abort(),Us.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve();try{return await globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Us.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Us.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Us.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new od(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Us.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}catch(s){throw(s==null?void 0:s.name)==="AbortError"?new od(`Acquiring an exclusive Navigator LockManager lock "${n}" timed out waiting ${e}ms`):s}}function X1(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function op(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function Z1(n){return parseInt(n,16)}function Q1(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function em(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:u,resources:h,scheme:f,uri:m,version:y}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const p=op(n.address),S=f?`${f}://${r}`:r,_=n.statement?`${n.statement}
`:"",x=`${S} wants you to sign in with your Ethereum account:
${p}

${_}`;let w=`URI: ${m}
Version: ${y}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(s&&(w+=`
Expiration Time: ${s.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),u&&(w+=`
Request ID: ${u}`),h){let O=`
Resources:`;for(const C of h){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);O+=`
- ${C}`}w+=O}return`${x}
${w}`}class fn extends Error{constructor({message:e,code:t,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class _l extends fn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function tm({error:n,options:e}){var t,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new fn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new fn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new fn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new fn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new fn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new fn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new fn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new fn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(lp(a)){if(i.rp.id!==a)return new fn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new fn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new fn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new fn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new fn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function nm({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new fn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new fn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(lp(r)){if(t.rpId!==r)return new fn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new fn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new fn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new fn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class rm{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const im=new rm;function sm(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Ll(n,["challenge","user","excludeCredentials"]),i=Xs(e).buffer,a=Object.assign(Object.assign({},t),{id:Xs(t.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:i,user:a});if(r&&r.length>0){o.excludeCredentials=new Array(r.length);for(let u=0;u<r.length;u++){const h=r[u];o.excludeCredentials[u]=Object.assign(Object.assign({},h),{id:Xs(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return o}function am(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Ll(n,["challenge","allowCredentials"]),s=Xs(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const o=t[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Xs(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function om(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:ps(new Uint8Array(n.response.attestationObject)),clientDataJSON:ps(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function lm(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:ps(new Uint8Array(s.authenticatorData)),clientDataJSON:ps(new Uint8Array(s.clientDataJSON)),signature:ps(new Uint8Array(s.signature)),userHandle:s.userHandle?ps(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function lp(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function ld(){var n,e;return!!(Tn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function cm(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _l("Browser returned unexpected credential type",e)}:{data:null,error:new _l("Empty credential response",e)}}catch(e){return{data:null,error:tm({error:e,options:n})}}}async function um(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _l("Browser returned unexpected credential type",e)}:{data:null,error:new _l("Empty credential response",e)}}catch(e){return{data:null,error:nm({error:e,options:n})}}}const hm={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},dm={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function wl(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const i in s){const a=s[i];if(a!==void 0)if(Array.isArray(a))r[i]=a;else if(t(a))r[i]=a;else if(e(a)){const o=r[i];e(o)?r[i]=wl(o,a):r[i]=wl(a)}else r[i]=a}return r}function fm(n,e){return wl(hm,n,e||{})}function pm(n,e){return wl(dm,n,e||{})}class gm{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},i){var a;try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:u};const h=s??im.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;if(!f.name){const m=r;if(m)f.name=`${f.id}:${m}`;else{const p=(await this.client.getUser()).data.user,S=((a=p==null?void 0:p.user_metadata)===null||a===void 0?void 0:a.name)||(p==null?void 0:p.email)||(p==null?void 0:p.id)||"User";f.name=`${f.id}:${S}`}}f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=fm(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:m,error:y}=await cm({publicKey:f,signal:h});return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:y}}case"request":{const f=pm(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:m,error:y}=await um(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:h}));return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:y}}}}catch(o){return Ue(o)?{data:null,error:o}:{data:null,error:new ds("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new Za("rpId is required for WebAuthn authentication")};try{if(!ld())return{data:null,error:new ds("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:i});if(!a)return{data:null,error:o};const{webauthn:u}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:u.type,rpId:t,rpOrigins:r,credential_response:u.credential_response}})}catch(a){return Ue(a)?{data:null,error:a}:{data:null,error:new ds("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new Za("rpId is required for WebAuthn registration")};try{if(!ld())return{data:null,error:new ds("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(f=>{var m;return(m=f.data)===null||m===void 0?void 0:m.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:u,error:h}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:i});return u?this._verify({factorId:a.id,challengeId:u.challengeId,webauthn:{rpId:t,rpOrigins:r,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:h}}catch(a){return Ue(a)?{data:null,error:a}:{data:null,error:new ds("Unexpected error in register",a)}}}}X1();const mm={url:f1,storageKey:p1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:g1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function cd(n,e,t){return await t()}const Ms={};class Qa{get jwks(){var e,t;return(t=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},mm),e);if(this.storageKey=i.storageKey,this.instanceID=(t=Qa.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Qa.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Tn()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new J1({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=sp(i.fetch),this.lock=i.lock||cd,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Tn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Y1:this.lock=cd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new gm(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:ip()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ad(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=ad(this.memoryStorage)),Tn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}i.skipAutoInitialize||this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${tp}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Tn()&&(t=P1(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Tn()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),_1(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ue(t)?this._returnResult({error:t}):this._returnResult({error:new ds("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Nr}),{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const u=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(i){if(Ue(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:f,password:m,options:y}=e;let p=null,S=null;this.flowType==="pkce"&&([p,S]=await Ds(this.storage,this.storageKey)),i=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y==null?void 0:y.emailRedirectTo,body:{email:f,password:m,data:(t=y==null?void 0:y.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:p,code_challenge_method:S},xform:Nr})}else if("phone"in e){const{phone:f,password:m,options:y}=e;i=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(r=y==null?void 0:y.data)!==null&&r!==void 0?r:{},channel:(s=y==null?void 0:y.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}},xform:Nr})}else throw new Jo("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return await In(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const u=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(i){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:id})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:id})}else throw new Jo("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const i=new Fs;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,i,a,o,u,h,f,m,y;let p,S;if("message"in e)p=e.message,S=e.signature;else{const{chain:_,wallet:x,statement:w,options:O}=e;let C;if(Tn())if(typeof x=="object")C=x;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")C=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=x}const F=new URL((t=O==null?void 0:O.url)!==null&&t!==void 0?t:window.location.href),G=await C.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!G||G.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const V=op(G[0]);let re=(r=O==null?void 0:O.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!re){const U=await C.request({method:"eth_chainId"});re=Z1(U)}const J={domain:F.host,address:V,statement:w,uri:F.href,version:"1",chainId:re,nonce:(s=O==null?void 0:O.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(i=O==null?void 0:O.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=O==null?void 0:O.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(u=O==null?void 0:O.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(h=O==null?void 0:O.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(f=O==null?void 0:O.signInWithEthereum)===null||f===void 0?void 0:f.resources};p=em(J),S=await C.request({method:"personal_sign",params:[Q1(p),V]})}try{const{data:_,error:x}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:S},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Nr});if(x)throw x;if(!_||!_.session||!_.user){const w=new Fs;return this._returnResult({data:{user:null,session:null},error:w})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:x})}catch(_){if(Ue(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,r,s,i,a,o,u,h,f,m,y,p;let S,_;if("message"in e)S=e.message,_=e.signature;else{const{chain:x,wallet:w,statement:O,options:C}=e;let F;if(Tn())if(typeof w=="object")F=w;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))F=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");F=w}const G=new URL((t=C==null?void 0:C.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in F&&F.signIn){const V=await F.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),O?{statement:O}:null));let re;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")re=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)re=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in re&&"signature"in re&&(typeof re.signedMessage=="string"||re.signedMessage instanceof Uint8Array)&&re.signature instanceof Uint8Array)S=typeof re.signedMessage=="string"?re.signedMessage:new TextDecoder().decode(re.signedMessage),_=re.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in F)||typeof F.signMessage!="function"||!("publicKey"in F)||typeof F!="object"||!F.publicKey||!("toBase58"in F.publicKey)||typeof F.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${G.host} wants you to sign in with your Solana account:`,F.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(s=(r=C==null?void 0:C.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=C==null?void 0:C.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((a=C==null?void 0:C.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((o=C==null?void 0:C.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((u=C==null?void 0:C.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((h=C==null?void 0:C.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((m=(f=C==null?void 0:C.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||m===void 0)&&m.length?["Resources",...C.signInWithSolana.resources.map(re=>`- ${re}`)]:[]].join(`
`);const V=await F.signMessage(new TextEncoder().encode(S),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=V}}try{const{data:x,error:w}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:ps(_)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Nr});if(w)throw w;if(!x||!x.session||!x.user){const O=new Fs;return this._returnResult({data:{user:null,session:null},error:O})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:w})}catch(x){if(Ue(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const t=await as(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{if(!r&&this.flowType==="pkce")throw new w1;const{data:i,error:a}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Nr});if(await In(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const o=new Fs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Nr}),{data:u,error:h}=o;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u||!u.session||!u.user){const f=new Fs;return this._returnResult({data:{user:null,session:null},error:f})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:h})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if("email"in e){const{email:o,options:u}=e;let h=null,f=null;this.flowType==="pkce"&&([h,f]=await Ds(this.storage,this.storageKey));const{error:m}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=u==null?void 0:u.data)!==null&&t!==void 0?t:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:h,code_challenge_method:f},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:o,options:u}=e,{data:h,error:f}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:f})}throw new Jo("You must provide either an email or phone number.")}catch(o){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await Qe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Nr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const u=a.session,h=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(s){if(Ue(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,i,a;try{let o=null,u=null;this.flowType==="pkce"&&([o,u]=await Ds(this.storage,this.storageKey));const h=await Qe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:u}),headers:this.headers,xform:V1});return!((i=h.data)===null||i===void 0)&&i.url&&Tn()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(o){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new nr;const{error:s}=await Qe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(Ue(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await Qe(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await Qe(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new Jo("You must provide either an email or phone number and a type")}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await as(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<vc:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await as(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=_c()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=$1(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Di}):await this._useSession(async t=>{var r,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new nr}:await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Di})})}catch(t){if(Ue(t))return bc(t)&&(await this._removeSession(),await In(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new nr;const a=s.session;let o=null,u=null;this.flowType==="pkce"&&e.email!=null&&([o,u]=await Ds(this.storage,this.storageKey));const{data:h,error:f}=await Qe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:u}),jwt:a.access_token,xform:Di});if(f)throw f;return a.user=h.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(r){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nr;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:a}=Xo(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{data:o,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(e.access_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(Ue(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new nr;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ue(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Tn())throw new Yo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Yo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Xh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yo("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Xh("No code detected.");const{data:O,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const F=new URL(window.location.href);return F.searchParams.delete("code"),window.history.replaceState(window.history.state,"",F.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:u,token_type:h}=e;if(!i||!o||!a||!h)throw new Yo("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(o);let y=f+m;u&&(y=parseInt(u));const p=y-f;p*1e3<=Hs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${m}s`);const S=y-m;f-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,y,f):f-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,y,f);const{data:_,error:x}=await this._getUser(i);if(x)throw x;const w={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:m,expires_at:y,refresh_token:a,token_type:h,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:e.type},error:null})}catch(r){if(Ue(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await as(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i&&!bc(i))return this._returnResult({error:i});const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(y1(o)&&(o.status===404||o.status===401||o.status===403)||bc(o)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await In(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=E1(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Ds(this.storage,this.storageKey,!0));try{return await Qe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,u,h,f;const{data:m,error:y}=i;if(y)throw y;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Qe(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(h=m.session)===null||h===void 0?void 0:h.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return Tn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(Ue(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:i}}=t;if(s)throw s;const{options:a,provider:o,token:u,access_token:h,nonce:f}=e,m=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:o,id_token:u,access_token:h,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Nr}),{data:y,error:p}=m;return p?this._returnResult({data:{user:null,session:null},error:p}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new Fs}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:p}))}catch(s){if(await In(this.storage,`${this.storageKey}-code-verifier`),Ue(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)throw a;return await Qe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await T1(async s=>(s>0&&await I1(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Qe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Nr})),(s,i)=>{const a=200*Math.pow(2,s);return i&&yc(i)&&Date.now()+a-r<Hs})}catch(r){if(this._debug(t,"error",r),Ue(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Tn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await as(this.storage,this.storageKey);if(s&&this.userStorage){let a=await as(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await Vs(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:_c()}else if(s&&!s.user&&!s.user){const a=await as(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await In(this.storage,this.storageKey+"-user"),await Vs(this.storage,this.storageKey,s)):s.user=_c()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<vc;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${vc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),yc(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Cl;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Ue(i)){const a={data:null,error:i};return yc(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(u){i.push(u)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await In(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Vs(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=nd(s);await Vs(this.storage,this.storageKey,i)}else{const s=nd(t);await Vs(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await In(this.storage,this.storageKey),await In(this.storage,this.storageKey+"-code-verifier"),await In(this.storage,this.storageKey+"-user"),this.userStorage&&await In(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Tn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Hs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Hs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Hs}ms, refresh threshold is ${au} ticks`),s<=au&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ap)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ds(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?this._returnResult({data:null,error:i}):await Qe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:u,error:h}=await Qe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&u.type==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?om(e.webauthn.credential_response):lm(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:u}=await Qe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:u}))})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=await Qe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:sm(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:am(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,r,s,i;if(e)try{const{payload:p}=Xo(e);let S=null;p.aal&&(S=p.aal);let _=S;const{data:{user:x},error:w}=await this.getUser(e);if(w)return this._returnResult({data:null,error:w});((r=(t=x==null?void 0:x.factors)===null||t===void 0?void 0:t.filter(F=>F.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(_="aal2");const C=p.amr||[];return{data:{currentLevel:S,nextLevel:_,currentAuthenticationMethods:C},error:null}}catch(p){if(Ue(p))return this._returnResult({data:null,error:p});throw p}const{data:{session:a},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Xo(a.access_token);let h=null;u.aal&&(h=u.aal);let f=h;((i=(s=a.user.factors)===null||s===void 0?void 0:s.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(f="aal2");const y=u.amr||[];return{data:{currentLevel:h,nextLevel:f,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Qe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new nr})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new nr});const a=await Qe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Tn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new nr});const a=await Qe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Tn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await Qe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new nr})})}catch(e){if(Ue(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?(await Qe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new nr})})}catch(t){if(Ue(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+v1>s)return r;const{data:i,error:a}=await Qe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(o=>o.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:p,error:S}=await this.getSession();if(S||!p.session)return this._returnResult({data:null,error:S});r=p.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:u}}=Xo(r);t!=null&&t.allowExpired||U1(i.exp);const h=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!h){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:s,signature:a},error:null}}const f=M1(s.alg),m=await crypto.subtle.importKey("jwk",h,f,!0,["verify"]);if(!await crypto.subtle.verify(f,m,a,N1(`${o}.${u}`)))throw new cu("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(r){if(Ue(r))return this._returnResult({data:null,error:r});throw r}}}Qa.nextInstanceID={};const vm=Qa,bm="2.97.0";let qa="";typeof Deno<"u"?qa="deno":typeof document<"u"?qa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?qa="react-native":qa="node";const ym={"X-Client-Info":`supabase-js-${qa}/${bm}`},_m={headers:ym},wm={schema:"public"},xm={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Sm={};function eo(n){"@babel/helpers - typeof";return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(n)}function Am(n,e){if(eo(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(eo(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function km(n){var e=Am(n,"string");return eo(e)=="symbol"?e:e+""}function Nm(n,e,t){return(e=km(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ud(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function en(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ud(Object(t),!0).forEach(function(r){Nm(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ud(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const Lm=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Em=()=>Headers,Pm=(n,e,t)=>{const r=Lm(t),s=Em();return async(i,a)=>{var o;const u=(o=await e())!==null&&o!==void 0?o:n;let h=new s(a==null?void 0:a.headers);return h.has("apikey")||h.set("apikey",n),h.has("Authorization")||h.set("Authorization",`Bearer ${u}`),r(i,en(en({},a),{},{headers:h}))}};function Cm(n){return n.endsWith("/")?n:n+"/"}function Im(n,e){var t,r;const{db:s,auth:i,realtime:a,global:o}=n,{db:u,auth:h,realtime:f,global:m}=e,y={db:en(en({},u),s),auth:en(en({},h),i),realtime:en(en({},f),a),storage:{},global:en(en(en({},m),o),{},{headers:en(en({},(t=m==null?void 0:m.headers)!==null&&t!==void 0?t:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?y.accessToken=n.accessToken:delete y.accessToken,y}function Tm(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Cm(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Om=class extends vm{constructor(n){super(n)}},Rm=class{constructor(n,e,t){var r,s;this.supabaseUrl=n,this.supabaseKey=e;const i=Tm(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:wm,realtime:Sm,auth:en(en({},xm),{},{storageKey:a}),global:_m},u=Im(t??{},o);if(this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=u.auth)!==null&&h!==void 0?h:{},this.headers,u.global.fetch)}this.fetch=Pm(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(en({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new yg(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch,timeout:u.db.timeout,urlLengthLimit:u.db.urlLengthLimit}),this.storage=new d1(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new hg(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:r}=await n.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:r,userStorage:s,storageKey:i,flowType:a,lock:o,debug:u,throwOnError:h},f,m){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Om({url:this.authUrl.href,headers:en(en({},y),f),storageKey:i,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:r,userStorage:s,flowType:a,lock:o,debug:u,throwOnError:h,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new Fg(this.realtimeUrl.href,en(en({},n),{},{params:en(en({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const jm=(n,e,t)=>new Rm(n,e,t);function Fm(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Fm()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Dm="https://ujuxhijcomgkqfwaovow.supabase.co",Bm="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqdXhoaWpjb21na3Fmd2Fvdm93Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3NTg0NzgsImV4cCI6MjA4NzMzNDQ3OH0.pZuqL4HDtt5Z8yFf7tQNe5hTEz_W0_zyIV-lPebV_1Q",Ne=jm(Dm,Bm),cp=Pu(null);function Um({children:n}){const[e,t]=Ae(null),[r,s]=Ae(!0);qt(()=>{Ne.auth.getSession().then(({data:{session:u}})=>{t((u==null?void 0:u.user)??null),s(!1)});const{data:{subscription:o}}=Ne.auth.onAuthStateChange((u,h)=>{t((h==null?void 0:h.user)??null)});return()=>o.unsubscribe()},[]);const i=kt(async(o,u)=>{const{error:h}=await Ne.auth.signInWithPassword({email:o,password:u});if(h)throw h},[]),a=kt(async()=>{await Ne.auth.signOut()},[]);return l(cp.Provider,{value:{user:e,loading:r,signIn:i,signOut:a},children:n})}function Il(){const n=Wf(cp);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}const up=Pu(null);function Mm({children:n}){const[e,t]=Ae([]),r=kt((i,a="info")=>{const o=Date.now();t(u=>[...u,{id:o,message:i,type:a}]),setTimeout(()=>{t(u=>u.filter(h=>h.id!==o))},3e3)},[]),s={success:i=>r(i,"success"),error:i=>r(i,"error"),info:i=>r(i,"info")};return l(up.Provider,{value:s,children:[n,l("div",{class:"toast-container",children:e.map(i=>l("div",{class:`toast toast-${i.type}`,children:i.message},i.id))})]})}function mr(){return Wf(up)}var qm={};function Zo(n,e){for(var t in e)n[t]=e[t];return n}function $m(n,e,t){var r,s=/(?:\?([^#]*))?(#.*)?$/,i=n.match(s),a={};if(i&&i[1])for(var o=i[1].split("&"),u=0;u<o.length;u++){var h=o[u].split("=");a[decodeURIComponent(h[0])]=decodeURIComponent(h.slice(1).join("="))}n=uu(n.replace(s,"")),e=uu(e||"");for(var f=Math.max(n.length,e.length),m=0;m<f;m++)if(e[m]&&e[m].charAt(0)===":"){var y=e[m].replace(/(^:|[+*?]+$)/g,""),p=(e[m].match(/[+*?]+$/)||qm)[0]||"",S=~p.indexOf("+"),_=~p.indexOf("*"),x=n[m]||"";if(!x&&!_&&(p.indexOf("?")<0||S)){r=!1;break}if(a[y]=decodeURIComponent(x),S||_){a[y]=n.slice(m).map(decodeURIComponent).join("/");break}}else if(e[m]!==n[m]){r=!1;break}return(t.default===!0||r!==!1)&&a}function zm(n,e){return n.rank<e.rank?1:n.rank>e.rank?-1:n.index-e.index}function Wm(n,e){return n.index=e,n.rank=(function(t){return t.props.default?0:uu(t.props.path).map(Hm).join("")})(n),n.props}function uu(n){return n.replace(/(^\/+|\/+$)/g,"").split("/")}function Hm(n){return n.charAt(0)==":"?1+"*+?".indexOf(n.charAt(n.length-1))||4:5}var Vm={},gs=[],hd=[],rr=null,hp={url:Tu()},Gm=Pu(hp);function Tu(){var n;return""+((n=rr&&rr.location?rr.location:rr&&rr.getCurrentLocation?rr.getCurrentLocation():typeof location<"u"?location:Vm).pathname||"")+(n.search||"")}function Ve(n,e){return e===void 0&&(e=!1),typeof n!="string"&&n.url&&(e=n.replace,n=n.url),(function(t){for(var r=gs.length;r--;)if(gs[r].canRoute(t))return!0;return!1})(n)&&(function(t,r){r===void 0&&(r="push"),rr&&rr[r]?rr[r](t):typeof history<"u"&&history[r+"State"]&&history[r+"State"](null,null,t)})(n,e?"replace":"push"),dp(n)}function dp(n){for(var e=!1,t=0;t<gs.length;t++)gs[t].routeTo(n)&&(e=!0);return e}function Km(n){if(n&&n.getAttribute){var e=n.getAttribute("href"),t=n.getAttribute("target");if(e&&e.match(/^\//g)&&(!t||t.match(/^_?self$/i)))return Ve(e)}}function Jm(n){return n.stopImmediatePropagation&&n.stopImmediatePropagation(),n.stopPropagation&&n.stopPropagation(),n.preventDefault(),!1}function Ym(n){if(!(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button)){var e=n.target;do if(e.localName==="a"&&e.getAttribute("href")){if(e.hasAttribute("data-native")||e.hasAttribute("native"))return;if(Km(e))return Jm(n)}while(e=e.parentNode)}}var dd=!1;function fp(n){n.history&&(rr=n.history),this.state={url:n.url||Tu()}}Zo(fp.prototype=new za,{shouldComponentUpdate:function(n){return n.static!==!0||n.url!==this.props.url||n.onChange!==this.props.onChange},canRoute:function(n){var e=Xc(this.props.children);return this.g(e,n)!==void 0},routeTo:function(n){this.setState({url:n});var e=this.canRoute(n);return this.p||this.forceUpdate(),e},componentWillMount:function(){this.p=!0},componentDidMount:function(){var n=this;dd||(dd=!0,rr||addEventListener("popstate",function(){dp(Tu())}),addEventListener("click",Ym)),gs.push(this),rr&&(this.u=rr.listen(function(e){var t=e.location||e;n.routeTo(""+(t.pathname||"")+(t.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),gs.splice(gs.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(n,e){n=n.filter(Wm).sort(zm);for(var t=0;t<n.length;t++){var r=n[t],s=$m(e,r.props.path,r.props);if(s)return[r,s]}},render:function(n,e){var t,r,s=n.onChange,i=e.url,a=this.c,o=this.g(Xc(n.children),i);if(o&&(r=ng(o[0],Zo(Zo({url:i,matches:t=o[1]},t),{key:void 0,ref:void 0}))),i!==(a&&a.url)){Zo(hp,a=this.c={url:i,previous:a&&a.url,current:r,path:r?r.props.path:null,matches:t}),a.router=this,a.active=r?[r]:[];for(var u=hd.length;u--;)hd[u]({});typeof s=="function"&&s(a)}return Ff(Gm.Provider,{value:a},r)}});function Xm({children:n}){const{signOut:e}=Il(),[t,r]=Ae(!1),s=typeof window<"u"?window.location.pathname:"/crm/";function i(o){r(!1),Ve(o)}return l("div",{class:"app-layout",children:[l("button",{class:"mobile-toggle",onClick:()=>r(!t),"aria-label":"Menu",children:t?"":""}),l("aside",{class:`sidebar ${t?"open":""}`,children:[l("div",{class:"sidebar-brand",onClick:()=>i("/crm/"),style:"cursor:pointer",children:"Beck360 CRM"}),l("nav",{class:"sidebar-nav",children:[{path:"/crm/",label:"Dashboard",icon:""},{path:"/crm/pipeline",label:"Pipeline",icon:""},{path:"/crm/contacts",label:"Kontakte",icon:""},{path:"/crm/companies",label:"Firmen",icon:""},{path:"/crm/invoices",label:"Rechnungen",icon:""},{path:"/crm/campaigns",label:"Kampagnen",icon:""},{path:"/crm/settings",label:"Einstellungen",icon:""}].map(o=>l("a",{class:`nav-item ${s===o.path?"active":""}`,href:o.path,onClick:u=>{u.preventDefault(),i(o.path)},children:[l("span",{class:"nav-icon",children:o.icon}),o.label]},o.path))}),l("div",{class:"sidebar-footer",children:l("button",{class:"btn btn-secondary btn-sm",style:"width: 100%",onClick:e,children:"Abmelden"})})]}),t&&l("div",{style:"position:fixed;inset:0;background:rgba(0,0,0,0.4);z-index:99",onClick:()=>r(!1)}),l("main",{class:"main-content",children:n})]})}function Zm(){const{signIn:n}=Il(),[e,t]=Ae(""),[r,s]=Ae(""),[i,a]=Ae(null),[o,u]=Ae(!1);async function h(f){f.preventDefault(),a(null),u(!0);try{await n(e,r)}catch(m){a(m.message==="Invalid login credentials"?"Ungueltige Anmeldedaten":m.message)}u(!1)}return l("div",{class:"login-page",children:l("form",{class:"login-card",onSubmit:h,children:[l("div",{class:"login-title",children:"Beck360 CRM"}),l("div",{class:"login-subtitle",children:"Anmelden"}),i&&l("div",{class:"login-error",children:i}),l("div",{class:"form-group",children:[l("label",{for:"login-email",children:"E-Mail"}),l("input",{id:"login-email",type:"email",value:e,onInput:f=>t(f.target.value),required:!0,autocomplete:"email"})]}),l("div",{class:"form-group",children:[l("label",{for:"login-password",children:"Passwort"}),l("input",{id:"login-password",type:"password",value:r,onInput:f=>s(f.target.value),required:!0,autocomplete:"current-password"})]}),l("button",{type:"submit",class:"btn btn-primary",style:"width: 100%; justify-content: center",disabled:o,children:o?"Anmelden...":"Anmelden"})]})})}function Qm(){const[n,e]=Ae({totalContacts:0,newLeadsThisMonth:0,pipelineValue:0,wonDeals:0,conversionRate:0,dealsByStage:{}}),[t,r]=Ae([]),[s,i]=Ae(!0),a=kt(async()=>{i(!0);const o=new Date,u=new Date(o.getFullYear(),o.getMonth(),1).toISOString(),[{count:h},{count:f},{data:m},{data:y},{data:p},{data:S}]=await Promise.all([Ne.from("contacts").select("*",{count:"exact",head:!0}).is("deleted_at",null),Ne.from("contacts").select("*",{count:"exact",head:!0}).is("deleted_at",null).gte("created_at",u),Ne.from("deals").select("value, stage").is("deleted_at",null).not("stage","in",'("won","lost")'),Ne.from("deals").select("value").is("deleted_at",null).eq("stage","won"),Ne.from("deals").select("stage").is("deleted_at",null),Ne.from("activities").select("*").order("created_at",{ascending:!1}).limit(10)]),_=(m||[]).reduce((F,G)=>F+(G.value||0),0),x=(y||[]).length,w=(p||[]).length,O=w>0?Math.round(x/w*100):0,C={};for(const F of p||[])C[F.stage]=(C[F.stage]||0)+1;e({totalContacts:h||0,newLeadsThisMonth:f||0,pipelineValue:_,wonDeals:x,conversionRate:O,dealsByStage:C}),r(S||[]),i(!1)},[]);return qt(()=>{a()},[a]),{stats:n,recentActivities:t,loading:s,refetch:a}}function Ou({type:n=null,status:e=null,companyId:t=null,dealId:r=null}={}){const[s,i]=Ae([]),[a,o]=Ae(!0),u=kt(async()=>{o(!0);let h=Ne.from("invoices").select(`
        *,
        company:companies(id, name),
        contact:contacts(id, first_name, last_name)
      `).order("created_at",{ascending:!1});n&&(h=h.eq("type",n)),e&&(h=h.eq("status",e)),t&&(h=h.eq("company_id",t)),r&&(h=h.eq("deal_id",r));const{data:f,error:m}=await h;m||i(f||[]),o(!1)},[n,e,t,r]);return qt(()=>{u()},[u]),{invoices:s,loading:a,refetch:u}}function pp(n){const[e,t]=Ae(null),[r,s]=Ae([]),[i,a]=Ae(!0),o=kt(async()=>{if(!n)return;a(!0);const[{data:h},{data:f}]=await Promise.all([Ne.from("invoices").select(`
          *,
          company:companies(id, name),
          contact:contacts(id, first_name, last_name, email, phone)
        `).eq("id",n).single(),Ne.from("invoice_items").select("*").eq("invoice_id",n).order("position",{ascending:!0})]);t(h),s(f||[]),a(!1)},[n]);qt(()=>{o()},[o]);const u=kt(async h=>{const{error:f}=await Ne.from("invoices").update(h).eq("id",n);return f||await o(),{error:f}},[n,o]);return{invoice:e,items:r,loading:i,refetch:o,update:u}}async function e2(n,e){const{data:t}=await Ne.auth.getUser(),r=t.user.id,{data:s,error:i}=await Ne.from("invoices").insert({...n,owner_id:r}).select().single();if(i)return{error:i};if(e&&e.length>0){const u=e.map((f,m)=>({invoice_id:s.id,position:m+1,description:f.description,sub_description:f.sub_description||null,quantity:parseFloat(f.quantity)||1,unit_price:parseFloat(f.unit_price)||0})),{error:h}=await Ne.from("invoice_items").insert(u);if(h)return{data:s,error:h}}const a=n.type==="quote"?"quote_created":"invoice_created",o=n.type==="quote"?"Angebot":"Rechnung";return await Ne.from("activities").insert({owner_id:r,deal_id:n.deal_id||null,contact_id:n.contact_id||null,company_id:n.company_id||null,type:a,description:`${o} erstellt: ${n.invoice_number}`,metadata:{invoice_id:s.id,invoice_number:n.invoice_number}}),{data:s,error:null}}async function t2(n,e,t){const{error:r}=await Ne.from("invoices").update(e).eq("id",n);if(r)return{error:r};if(await Ne.from("invoice_items").delete().eq("invoice_id",n),t&&t.length>0){const s=t.map((a,o)=>({invoice_id:n,position:o+1,description:a.description,sub_description:a.sub_description||null,quantity:parseFloat(a.quantity)||1,unit_price:parseFloat(a.unit_price)||0})),{error:i}=await Ne.from("invoice_items").insert(s);if(i)return{error:i}}return{error:null}}async function n2(n){const{data:e}=await Ne.auth.getUser(),t=e.user.id,[{data:r},{data:s}]=await Promise.all([Ne.from("invoices").select("*").eq("id",n).single(),Ne.from("invoice_items").select("*").eq("invoice_id",n).order("position")]);if(!r)return{error:{message:"Angebot nicht gefunden"}};const i=new Date,a=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0"),u=String(i.getDate()).padStart(2,"0"),h=(r.customer_name||"").split(" ").pop()||"Kunde",f=`R${a}${o}${u}-${h}`,{id:m,created_at:y,updated_at:p,...S}=r,{data:_,error:x}=await Ne.from("invoices").insert({...S,type:"invoice",invoice_number:f,status:"draft",invoice_date:i.toISOString().slice(0,10),due_date:new Date(i.getTime()+14*864e5).toISOString().slice(0,10),converted_from_quote_id:n,paid_date:null,paid_amount:0}).select().single();if(x)return{error:x};if(s&&s.length>0){const w=s.map(O=>({invoice_id:_.id,position:O.position,description:O.description,sub_description:O.sub_description,quantity:O.quantity,unit_price:O.unit_price}));await Ne.from("invoice_items").insert(w)}return await Ne.from("activities").insert({owner_id:t,deal_id:r.deal_id||null,contact_id:r.contact_id||null,company_id:r.company_id||null,type:"quote_converted",description:`Angebot ${r.invoice_number} in Rechnung ${f} umgewandelt`,metadata:{quote_id:n,invoice_id:_.id}}),{data:_,error:null}}function Ru(){const[n,e]=Ae(null),[t,r]=Ae(!0),s=kt(async()=>{r(!0);const{data:a}=await Ne.from("business_settings").select("*").limit(1).single();e(a),r(!1)},[]);qt(()=>{s()},[s]);const i=kt(async a=>{const{data:o}=await Ne.auth.getUser();if(n){const{error:u}=await Ne.from("business_settings").update(a).eq("id",n.id);return u||await s(),{error:u}}else{const{error:u}=await Ne.from("business_settings").insert({...a,owner_id:o.user.id});return u||await s(),{error:u}}},[n,s]);return{settings:n,loading:t,save:i,refetch:s}}function r2(){const[n,e]=Ae({openCount:0,openAmount:0,monthRevenue:0}),[t,r]=Ae(!0),s=kt(async()=>{r(!0);const i=new Date,a=new Date(i.getFullYear(),i.getMonth(),1).toISOString().slice(0,10),[{data:o},{data:u}]=await Promise.all([Ne.from("invoices").select("total_amount").eq("type","invoice").in("status",["sent","overdue"]),Ne.from("invoices").select("total_amount").eq("type","invoice").eq("status","paid").gte("paid_date",a)]),h=(o||[]).length,f=(o||[]).reduce((y,p)=>y+(parseFloat(p.total_amount)||0),0),m=(u||[]).reduce((y,p)=>y+(parseFloat(p.total_amount)||0),0);e({openCount:h,openAmount:f,monthRevenue:m}),r(!1)},[]);return qt(()=>{s()},[s]),{stats:n,loading:t}}async function i2(n){const{error:e}=await Ne.from("invoices").delete().eq("id",n);return{error:e}}function ju({contactId:n=null,dealId:e=null,companyId:t=null,limit:r=50}={}){const[s,i]=Ae([]),[a,o]=Ae(!0),u=kt(async()=>{o(!0);let h=Ne.from("activities").select("*").order("created_at",{ascending:!1}).limit(r);n&&(h=h.eq("contact_id",n)),e&&(h=h.eq("deal_id",e)),t&&(h=h.eq("company_id",t));const{data:f,error:m}=await h;m||i(f||[]),o(!1)},[n,e,t,r]);return qt(()=>{u()},[u]),{activities:s,loading:a,refetch:u}}async function gp(n){const{data:e}=await Ne.auth.getUser();return Ne.from("activities").insert({...n,owner_id:e.user.id}).select().single()}function s2(){const[n,e]=Ae([]),[t,r]=Ae(!0),s=kt(async()=>{r(!0);const{data:a}=await Ne.from("activities").select(`
        *,
        contact:contacts(id, first_name, last_name),
        deal:deals(id, title)
      `).eq("type","task").eq("completed",!1).not("due_date","is",null).order("due_date",{ascending:!0});e(a||[]),r(!1)},[]);qt(()=>{s()},[s]);const i=kt(async a=>{const{error:o}=await Ne.from("activities").update({completed:!0}).eq("id",a);return o||await s(),{error:o}},[s]);return{tasks:n,loading:t,refetch:s,complete:i}}function os({label:n,value:e,color:t}){return l("div",{class:"card",children:[l("div",{class:"kpi-value",style:t?`color: ${t}`:"",children:e}),l("div",{class:"kpi-label",children:n})]})}function An(n){return n?new Date(n).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function Qo(n){return n?new Date(n).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Kt(n){return n==null?"":new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(n)}function a2(n){if(!n)return"";const e=new Date,t=new Date(n),r=e-t,s=Math.floor(r/6e4),i=Math.floor(r/36e5),a=Math.floor(r/864e5);return s<1?"gerade eben":s<60?`vor ${s} Min.`:i<24?`vor ${i} Std.`:a<7?`vor ${a} Tag${a>1?"en":""}`:An(n)}const gi={new:{label:"Neu",color:"#6366f1"},contacted:{label:"Kontaktiert",color:"#f59e0b"},qualified:{label:"Qualifiziert",color:"#3b82f6"},proposal:{label:"Angebot",color:"#8b5cf6"},won:{label:"Gewonnen",color:"#10b981"},lost:{label:"Verloren",color:"#ef4444"}},hu={"360-tour":"360 Rundgang","drone-photo":"Drohnenfoto","drone-video":"Drohnenvideo","drone-inspection":"PV-Inspektion",streetview:"Google Street View",bundle:"Paket",other:"Sonstiges"},oa={"360-rundgang":"360-Rundgang",firmenrundgang:"Firmenrundgang",manual:"Manuell",referral:"Empfehlung",other:"Sonstiges"},Fu={note:{label:"Notiz",icon:""},call:{label:"Anruf",icon:""},email:{label:"E-Mail",icon:""},meeting:{label:"Treffen",icon:""},form_submission:{label:"Formular",icon:""},stage_change:{label:"Stage",icon:""},created:{label:"Erstellt",icon:""},task:{label:"Aufgabe",icon:""},invoice_created:{label:"Rechnung",icon:""},invoice_sent:{label:"Rechnung versendet",icon:""},quote_created:{label:"Angebot",icon:""},quote_converted:{label:"Angebot umgewandelt",icon:""}},Bi={draft:{label:"Entwurf",color:"#6366f1"},sending:{label:"Wird gesendet",color:"#f59e0b"},sent:{label:"Versendet",color:"#10b981"}},fd=[{id:"follow-up",name:"Angebot nachfassen",subject:"Ihr 360-Rundgang  Noch Fragen offen?",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>vor Kurzem haben wir ueber einen 360-Rundgang fuer {{firma}} gesprochen. Haben Sie noch Fragen zu unserem Angebot?</p>
    <p>Ich stehe Ihnen gerne fuer ein kurzes Gespraech zur Verfuegung.</p>
    <p style="margin-top:24px;">
      <a href="https://360-rundgang-karlsruhe.de" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Termin vereinbaren</a>
    </p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360  360 Rundgaenge & Drohnenaufnahmen<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"new-service",name:"Neue Dienstleistung vorstellen",subject:"Neu bei Beck360: Erweiterte 360-Loesungen",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>wir haben unser Angebot erweitert! Neben professionellen 360-Rundgaengen bieten wir jetzt auch Drohnenaufnahmen und virtuelle Touren an.</p>
    <p><strong>Ihre Vorteile:</strong></p>
    <ul>
      <li>Interaktive 360-Rundgaenge fuer Ihre Raeumlichkeiten</li>
      <li>Professionelle Drohnenfotos und -videos</li>
      <li>Google Street View Integration</li>
    </ul>
    <p style="margin-top:24px;">
      <a href="https://360-rundgang-karlsruhe.de" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Mehr erfahren</a>
    </p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"review",name:"Um Bewertung bitten",subject:"Wie war Ihre Erfahrung mit Beck360?",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p>vielen Dank, dass Sie sich fuer Beck360 entschieden haben! Wir hoffen, Sie sind mit dem Ergebnis zufrieden.</p>
    <p>Wuerden Sie uns mit einer kurzen Google-Bewertung unterstuetzen? Das dauert nur 1 Minute und hilft uns enorm.</p>
    <p style="margin-top:24px;">
      <a href="https://g.page/r/CQyourGoogleReviewLink/review" style="background:#1a5c6b;color:#fff;padding:12px 24px;border-radius:8px;text-decoration:none;display:inline-block;">Jetzt bewerten</a>
    </p>
    <p style="margin-top:24px;">Herzlichen Dank!<br><strong>Eugen Beck</strong><br>Beck360<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`},{id:"blank",name:"Leere Vorlage",subject:"",body:`<!DOCTYPE html>
<html><head><meta charset="UTF-8"></head>
<body style="margin:0;padding:0;font-family:Inter,system-ui,sans-serif;background:#f8fafc;">
<div style="max-width:600px;margin:0 auto;padding:32px 24px;">
  <div style="background:#1a5c6b;padding:24px;border-radius:12px 12px 0 0;text-align:center;">
    <h1 style="color:#fff;margin:0;font-size:20px;">Beck360</h1>
  </div>
  <div style="background:#fff;padding:32px 24px;border-radius:0 0 12px 12px;line-height:1.6;color:#334155;">
    <p>Hallo {{vorname}},</p>
    <p><!-- Ihr Inhalt hier --></p>
    <p style="margin-top:24px;">Beste Gruesse<br><strong>Eugen Beck</strong><br>Beck360  360 Rundgaenge & Drohnenaufnahmen<br>+49 173 468 2501</p>
  </div>
  <div style="text-align:center;padding:16px;font-size:11px;color:#94a3b8;">
    Beck360 | Eichenweg 1, 76275 Ettlingen | <a href="https://360-rundgang-karlsruhe.de/impressum/" style="color:#94a3b8;">Impressum</a>
  </div>
</div>
</body></html>`}],Tl=["Hotel / Pension","Gastronomie","Fitnessstudio","Einzelhandel","Autohaus","Gesundheit / Arztpraxis","Eventlocation","Coworking","Immobilien","Handwerk","Bildung","Sonstige"];function Du({activity:n}){const e=Fu[n.type]||{label:n.type,icon:""};return l("div",{class:"timeline-item",children:l("div",{class:"timeline-content",children:[l("div",{class:"timeline-header",children:[l("span",{class:"timeline-icon",children:e.icon}),l("span",{class:"timeline-type",children:e.label}),l("span",{class:"timeline-time",children:a2(n.created_at)})]}),l("div",{class:"timeline-text",children:n.description})]})})}function Ol({stage:n}){const e=gi[n]||{label:n,color:"#64748b"};return l("span",{class:"stage-badge",style:`color: ${e.color}; background: ${e.color}1a`,children:e.label})}function pd(){const{stats:n,recentActivities:e,loading:t}=Qm(),{stats:r}=r2(),{tasks:s,complete:i}=s2();return t?l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Dashboard"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]}):l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Dashboard"}),l("div",{style:"display:flex;gap:0.5rem",children:[l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/contacts/new"),children:"+ Kontakt"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/deals/new"),children:"+ Deal"})]})]}),l("div",{class:"page-body",children:[l("div",{class:"grid-4",style:"margin-bottom: 1.5rem",children:[l(os,{label:"Kontakte gesamt",value:n.totalContacts}),l(os,{label:"Neue Leads (Monat)",value:n.newLeadsThisMonth,color:"var(--info)"}),l(os,{label:"Pipeline-Wert",value:Kt(n.pipelineValue),color:"var(--primary-light)"}),l(os,{label:"Conversion-Rate",value:`${n.conversionRate}%`,color:"var(--success)"})]}),l("div",{class:"grid-3",style:"margin-bottom: 1.5rem",children:[l(os,{label:"Offene Rechnungen",value:r.openCount,color:"var(--warning)"}),l(os,{label:"Offener Betrag",value:Kt(r.openAmount),color:"var(--error)"}),l(os,{label:"Umsatz (Monat)",value:Kt(r.monthRevenue),color:"var(--success)"})]}),l("div",{class:"grid-2",style:"margin-bottom: 1.5rem",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:[l("span",{class:"card-title",children:"Pipeline-Uebersicht"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:"Oeffnen"})]}),l("div",{style:"display:flex;flex-direction:column;gap:0.5rem",children:Object.entries(gi).filter(([a])=>a!=="won"&&a!=="lost").map(([a,o])=>l("div",{style:"display:flex;align-items:center;justify-content:space-between;padding:0.4rem 0",children:[l(Ol,{stage:a}),l("span",{style:"font-weight:600",children:n.dealsByStage[a]||0})]},a))})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Faellige Aufgaben"})}),s.length===0?l("div",{class:"empty-state",style:"padding:1rem",children:l("div",{class:"empty-state-text",children:"Keine faelligen Aufgaben"})}):l("div",{style:"display:flex;flex-direction:column;gap:0.5rem",children:s.slice(0,5).map(a=>l("div",{style:"display:flex;align-items:center;justify-content:space-between;padding:0.4rem 0;border-bottom:1px solid var(--border)",children:[l("div",{children:[l("div",{style:"font-size:0.85rem",children:a.description}),l("div",{style:"font-size:0.75rem;color:var(--text-dim)",children:["Faellig: ",An(a.due_date),a.contact&&`  ${a.contact.first_name} ${a.contact.last_name}`]})]}),l("button",{class:"btn btn-sm btn-secondary",onClick:()=>i(a.id),children:"Erledigt"})]},a.id))})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Letzte Aktivitaeten"})}),e.length===0?l("div",{class:"empty-state",children:[l("div",{class:"empty-state-icon",children:""}),l("div",{class:"empty-state-text",children:"Noch keine Aktivitaeten"})]}):l("div",{class:"timeline",children:e.map(a=>l(Du,{activity:a},a.id))})]})]})]})}function Bu({stage:n=null,contactId:e=null,companyId:t=null}={}){const[r,s]=Ae([]),[i,a]=Ae(!0),o=kt(async()=>{a(!0);let u=Ne.from("deals").select(`
        *,
        contact:contacts(id, first_name, last_name, email),
        company:companies(id, name)
      `).is("deleted_at",null).order("created_at",{ascending:!1});n&&(u=u.eq("stage",n)),e&&(u=u.eq("contact_id",e)),t&&(u=u.eq("company_id",t));const{data:h,error:f}=await u;f||s((h||[]).map(m=>{var y;return{...m,contact_name:m.contact?`${m.contact.first_name||""} ${m.contact.last_name||""}`.trim()||m.contact.email:null,company_name:((y=m.company)==null?void 0:y.name)||null}})),a(!1)},[n,e,t]);return qt(()=>{o()},[o]),{deals:r,loading:i,refetch:o}}function o2(n){const[e,t]=Ae(null),[r,s]=Ae(!0),i=kt(async()=>{if(!n)return;s(!0);const{data:u}=await Ne.from("deals").select(`
        *,
        contact:contacts(id, first_name, last_name, email, phone),
        company:companies(id, name)
      `).eq("id",n).single();t(u),s(!1)},[n]);qt(()=>{i()},[i]);const a=kt(async u=>{const{error:h}=await Ne.from("deals").update(u).eq("id",n);return h||await i(),{error:h}},[n,i]),o=kt(async u=>{const h=e==null?void 0:e.stage,{error:f}=await Ne.from("deals").update({stage:u,stage_changed_at:new Date().toISOString()}).eq("id",n);if(!f){const{data:m}=await Ne.auth.getUser();await Ne.from("activities").insert({owner_id:m.user.id,deal_id:n,contact_id:e==null?void 0:e.contact_id,type:"stage_change",description:`Stage geaendert: ${h}  ${u}`,metadata:{old_stage:h,new_stage:u}}),await i()}return{error:f}},[n,e,i]);return{deal:e,loading:r,refetch:i,update:a,changeStage:o}}async function l2(n){const{data:e}=await Ne.auth.getUser(),{data:t,error:r}=await Ne.from("deals").insert({...n,owner_id:e.user.id}).select().single();return r||await Ne.from("activities").insert({owner_id:e.user.id,deal_id:t.id,contact_id:n.contact_id||null,type:"created",description:`Deal erstellt: ${n.title}`}),{data:t,error:r}}async function c2(n,e,t,r){const{error:s}=await Ne.from("deals").update({stage:e,stage_changed_at:new Date().toISOString()}).eq("id",n);if(!s){const{data:i}=await Ne.auth.getUser();await Ne.from("activities").insert({owner_id:i.user.id,deal_id:n,contact_id:r||null,type:"stage_change",description:`Stage geaendert: ${t}  ${e}`,metadata:{old_stage:t,new_stage:e}})}return{error:s}}function u2({deal:n,onDragStart:e,onClick:t}){return l("div",{class:"deal-card",draggable:!0,onDragStart:r=>{r.dataTransfer.setData("text/plain",n.id),r.currentTarget.classList.add("dragging"),e&&e(n)},onDragEnd:r=>r.currentTarget.classList.remove("dragging"),onClick:()=>t&&t(n),children:[l("div",{class:"deal-card-title",children:n.title}),l("div",{class:"deal-card-meta",children:[l("span",{children:n.contact_name||""}),l("span",{children:n.value?Kt(n.value):""})]})]})}const gd=["new","contacted","qualified","proposal","won","lost"];function h2(){const{deals:n,loading:e,refetch:t}=Bu(),r=mr(),[s,i]=Ae(null),a={};for(const u of gd)a[u]=n.filter(h=>h.stage===u);const o=kt(async(u,h)=>{u.preventDefault(),i(null);const f=u.dataTransfer.getData("text/plain"),m=n.find(p=>p.id===f);if(!m||m.stage===h)return;const{error:y}=await c2(f,h,m.stage,m.contact_id);y?r.error("Fehler beim Aendern der Stage"):(r.success(`Deal nach "${gi[h].label}" verschoben`),t())},[n,t,r]);return e?l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Pipeline"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]}):l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Pipeline"}),l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/deals/new"),children:"+ Neuer Deal"})]}),l("div",{class:"page-body",children:l("div",{class:"pipeline",children:gd.map(u=>l("div",{class:"pipeline-column",children:[l("div",{class:"pipeline-column-header",style:`border-top: 3px solid ${gi[u].color}`,children:[l("span",{children:gi[u].label}),l("span",{class:"pipeline-column-count",children:a[u].length})]}),l("div",{class:`pipeline-column-body ${s===u?"drag-over":""}`,onDragOver:h=>{h.preventDefault(),i(u)},onDragLeave:()=>i(null),onDrop:h=>o(h,u),children:a[u].length===0?l("div",{style:"text-align:center;padding:1rem;color:var(--text-dim);font-size:0.8rem",children:"Keine Deals"}):a[u].map(h=>l(u2,{deal:h,onClick:()=>Ve(`/crm/deals/${h.id}`)},h.id))})]},u))})})]})}function Uu({search:n="",source:e=null}={}){const[t,r]=Ae([]),[s,i]=Ae(!0),a=kt(async()=>{i(!0);let o=Ne.from("contacts").select("*, company:companies(id, name)").is("deleted_at",null).order("created_at",{ascending:!1});e&&(o=o.eq("source",e)),n&&(o=o.or(`first_name.ilike.%${n}%,last_name.ilike.%${n}%,email.ilike.%${n}%`));const{data:u,error:h}=await o;h||r(u||[]),i(!1)},[n,e]);return qt(()=>{a()},[a]),{contacts:t,loading:s,refetch:a}}function d2(n){const[e,t]=Ae(null),[r,s]=Ae(!0),i=kt(async()=>{if(!n)return;s(!0);const{data:u}=await Ne.from("contacts").select("*, company:companies(id, name)").eq("id",n).single();t(u),s(!1)},[n]);qt(()=>{i()},[i]);const a=kt(async u=>{const{error:h}=await Ne.from("contacts").update(u).eq("id",n);return h||await i(),{error:h}},[n,i]),o=kt(async()=>Ne.from("contacts").update({deleted_at:new Date().toISOString()}).eq("id",n),[n]);return{contact:e,loading:r,refetch:i,update:a,softDelete:o}}async function f2(n){const{data:e}=await Ne.auth.getUser(),{data:t,error:r}=await Ne.from("contacts").insert({...n,owner_id:e.user.id}).select().single();return r||await Ne.from("activities").insert({owner_id:e.user.id,contact_id:t.id,type:"created",description:"Kontakt manuell erstellt"}),{data:t,error:r}}function mp({value:n,onInput:e,placeholder:t="Suchen..."}){return l("input",{type:"search",class:"search-input",placeholder:t,value:n,onInput:r=>e(r.target.value)})}function Mu({filters:n,active:e,onSelect:t}){return l("div",{class:"filter-pills",children:[l("button",{class:`filter-pill ${e?"":"active"}`,onClick:()=>t(null),children:"Alle"}),n.map(r=>l("button",{class:`filter-pill ${e===r.value?"active":""}`,onClick:()=>t(r.value),children:r.label},r.value))]})}const p2=Object.entries(oa).map(([n,e])=>({value:n,label:e}));function g2(){const[n,e]=Ae(""),[t,r]=Ae(null),{contacts:s,loading:i}=Uu({search:n,source:t});return l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Kontakte"}),l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/contacts/new"),children:"+ Neuer Kontakt"})]}),l("div",{class:"page-body",children:[l("div",{class:"search-bar",children:l(mp,{value:n,onInput:e,placeholder:"Name oder E-Mail suchen..."})}),l("div",{style:"margin-bottom: 1rem",children:l(Mu,{filters:p2,active:t,onSelect:r})}),i?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):s.length===0?l("div",{class:"empty-state",children:[l("div",{class:"empty-state-icon",children:""}),l("div",{class:"empty-state-text",children:"Keine Kontakte gefunden"})]}):l("div",{class:"card",children:l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Name"}),l("th",{children:"E-Mail"}),l("th",{children:"Firma"}),l("th",{children:"Quelle"}),l("th",{children:"Erstellt"})]})}),l("tbody",{children:s.map(a=>{var o;return l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/contacts/${a.id}`),children:[l("td",{style:"font-weight:500",children:a.first_name||a.last_name?`${a.first_name||""} ${a.last_name||""}`.trim():""}),l("td",{children:a.email}),l("td",{children:((o=a.company)==null?void 0:o.name)||""}),l("td",{children:l("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem",children:oa[a.source]||a.source})}),l("td",{style:"color:var(--text-dim)",children:An(a.created_at)})]},a.id)})})]})})})]})]})}function ia({title:n,onClose:e,children:t,footer:r}){const s=kt(i=>{i.key==="Escape"&&e()},[e]);return qt(()=>(document.addEventListener("keydown",s),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",s),document.body.style.overflow=""}),[s]),l("div",{class:"modal-overlay",onClick:i=>{i.target===i.currentTarget&&e()},children:l("div",{class:"modal",role:"dialog","aria-modal":"true",children:[l("div",{class:"modal-header",children:[l("span",{children:n}),l("button",{class:"btn-icon",onClick:e,"aria-label":"Schliessen",children:""})]}),l("div",{class:"modal-body",children:t}),r&&l("div",{class:"modal-footer",children:r})]})})}function m2({id:n}){const{contact:e,loading:t,update:r,softDelete:s}=d2(n),{deals:i}=Bu({contactId:n}),{activities:a,refetch:o}=ju({contactId:n}),u=mr(),[h,f]=Ae(!1),[m,y]=Ae({}),[p,S]=Ae(!1),[_,x]=Ae({type:"note",description:"",due_date:""});if(t)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Kontakt"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]});if(!e)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Nicht gefunden"})}),l("div",{class:"page-body",children:l("div",{class:"empty-state",children:l("div",{class:"empty-state-text",children:"Kontakt nicht gefunden"})})})]});function w(){y({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",position:e.position||""}),f(!0)}async function O(){const{error:V}=await r(m);V?u.error("Fehler beim Speichern"):(u.success("Kontakt aktualisiert"),f(!1))}async function C(){if(!confirm("Kontakt wirklich loeschen?"))return;const{error:V}=await s();V?u.error("Fehler beim Loeschen"):(u.success("Kontakt geloescht"),Ve("/crm/contacts"))}async function F(V){V.preventDefault();const{error:re}=await gp({contact_id:n,type:_.type,description:_.description,due_date:_.type==="task"&&_.due_date?_.due_date:null});re?u.error("Fehler beim Erstellen"):(u.success("Aktivitaet hinzugefuegt"),S(!1),x({type:"note",description:"",due_date:""}),o())}const G=`${e.first_name||""} ${e.last_name||""}`.trim()||e.email;return l(bt,{children:[l("div",{class:"page-header",children:[l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/contacts"),children:""}),l("h1",{class:"page-title",children:G})]}),l("div",{style:"display:flex;gap:0.5rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>S(!0),children:"+ Aktivitaet"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve(`/crm/deals/new?contact_id=${n}`),children:"+ Deal"}),!h&&l("button",{class:"btn btn-secondary btn-sm",onClick:w,children:"Bearbeiten"}),l("button",{class:"btn btn-danger btn-sm",onClick:C,children:"Loeschen"})]})]}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Stammdaten"})}),h?l("div",{children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Vorname"}),l("input",{value:m.first_name,onInput:V=>y({...m,first_name:V.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Nachname"}),l("input",{value:m.last_name,onInput:V=>y({...m,last_name:V.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"E-Mail"}),l("input",{type:"email",value:m.email,onInput:V=>y({...m,email:V.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Telefon"}),l("input",{value:m.phone,onInput:V=>y({...m,phone:V.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Position"}),l("input",{value:m.position,onInput:V=>y({...m,position:V.target.value})})]})]}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>f(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary btn-sm",onClick:O,children:"Speichern"})]})]}):l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Vorname"}),l("span",{class:"detail-value",children:e.first_name||""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Nachname"}),l("span",{class:"detail-value",children:e.last_name||""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"E-Mail"}),l("span",{class:"detail-value",children:l("a",{href:`mailto:${e.email}`,children:e.email})})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Telefon"}),l("span",{class:"detail-value",children:e.phone?l("a",{href:`tel:${e.phone}`,children:e.phone}):""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Position"}),l("span",{class:"detail-value",children:e.position||""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Firma"}),l("span",{class:"detail-value",children:e.company?l("a",{href:"#",onClick:V=>{V.preventDefault(),Ve(`/crm/companies/${e.company.id}`)},children:e.company.name}):""})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Deals (",i.length,")"]})}),i.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Deals"}):l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Titel"}),l("th",{children:"Stage"}),l("th",{children:"Wert"})]})}),l("tbody",{children:i.map(V=>l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/deals/${V.id}`),children:[l("td",{children:V.title}),l("td",{children:l(Ol,{stage:V.stage})}),l("td",{children:V.value?Kt(V.value):""})]},V.id))})]})})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Aktivitaeten"})}),a.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Aktivitaeten"}):l("div",{class:"timeline",children:a.map(V=>l(Du,{activity:V},V.id))})]})]}),l("div",{class:"detail-sidebar",children:l("div",{class:"card",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Quelle"}),l("span",{class:"detail-value",children:oa[e.source]||e.source})]}),e.source_detail&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Detail"}),l("span",{class:"detail-value",children:e.source_detail})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"DSGVO-Einwilligung"}),l("span",{class:"detail-value",children:e.gdpr_consent?"Ja":"Nein"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt am"}),l("span",{class:"detail-value",children:An(e.created_at)})]})]})})]})}),p&&l(ia,{title:"Aktivitaet hinzufuegen",onClose:()=>S(!1),children:l("form",{onSubmit:F,children:[l("div",{class:"form-group",children:[l("label",{children:"Typ"}),l("select",{value:_.type,onChange:V=>x({..._,type:V.target.value}),children:Object.entries(Fu).filter(([V])=>!["form_submission","stage_change","created"].includes(V)).map(([V,re])=>l("option",{value:V,children:[re.icon," ",re.label]},V))})]}),l("div",{class:"form-group",children:[l("label",{children:"Beschreibung"}),l("textarea",{value:_.description,onInput:V=>x({..._,description:V.target.value}),required:!0})]}),_.type==="task"&&l("div",{class:"form-group",children:[l("label",{children:"Faellig am"}),l("input",{type:"date",value:_.due_date,onInput:V=>x({..._,due_date:V.target.value})})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>S(!1),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",children:"Speichern"})]})]})})]})}function v2({search:n="",industry:e=null}={}){const[t,r]=Ae([]),[s,i]=Ae(!0),a=kt(async()=>{i(!0);let o=Ne.from("companies").select("*").is("deleted_at",null).order("created_at",{ascending:!1});e&&(o=o.eq("industry",e)),n&&(o=o.or(`name.ilike.%${n}%,city.ilike.%${n}%`));const{data:u,error:h}=await o;h||r(u||[]),i(!1)},[n,e]);return qt(()=>{a()},[a]),{companies:t,loading:s,refetch:a}}function b2(n){const[e,t]=Ae(null),[r,s]=Ae(!0),i=kt(async()=>{if(!n)return;s(!0);const{data:o}=await Ne.from("companies").select("*").eq("id",n).single();t(o),s(!1)},[n]);qt(()=>{i()},[i]);const a=kt(async o=>{const{error:u}=await Ne.from("companies").update(o).eq("id",n);return u||await i(),{error:u}},[n,i]);return{company:e,loading:r,refetch:i,update:a}}async function vp(n){const{data:e}=await Ne.auth.getUser();return Ne.from("companies").insert({...n,owner_id:e.user.id}).select().single()}function y2(){const n=mr(),[e,t]=Ae(!1),[r,s]=Ae({first_name:"",last_name:"",email:"",phone:"",position:"",source:"manual",source_detail:"",company_name:"",gdpr_consent:!1});function i(o,u){s(h=>({...h,[o]:u}))}async function a(o){o.preventDefault(),t(!0);try{let u=null;if(r.company_name.trim()){const{data:m,error:y}=await vp({name:r.company_name.trim()});if(y)throw y;u=m.id}const{data:h,error:f}=await f2({first_name:r.first_name,last_name:r.last_name,email:r.email,phone:r.phone||null,position:r.position||null,source:r.source,source_detail:r.source_detail||null,company_id:u,gdpr_consent:r.gdpr_consent,gdpr_consent_at:r.gdpr_consent?new Date().toISOString():null});if(f)throw f;n.success("Kontakt erstellt"),Ve(`/crm/contacts/${h.id}`)}catch(u){n.error(u.message||"Fehler beim Erstellen")}t(!1)}return l(bt,{children:[l("div",{class:"page-header",children:l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/contacts"),children:""}),l("h1",{class:"page-title",children:"Neuer Kontakt"})]})}),l("div",{class:"page-body",children:l("div",{class:"card",style:"max-width: 640px",children:l("form",{onSubmit:a,children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Vorname"}),l("input",{value:r.first_name,onInput:o=>i("first_name",o.target.value)})]}),l("div",{class:"form-group",children:[l("label",{children:"Nachname"}),l("input",{value:r.last_name,onInput:o=>i("last_name",o.target.value)})]}),l("div",{class:"form-group",children:[l("label",{children:"E-Mail *"}),l("input",{type:"email",required:!0,value:r.email,onInput:o=>i("email",o.target.value)})]}),l("div",{class:"form-group",children:[l("label",{children:"Telefon"}),l("input",{type:"tel",value:r.phone,onInput:o=>i("phone",o.target.value)})]}),l("div",{class:"form-group",children:[l("label",{children:"Position"}),l("input",{value:r.position,onInput:o=>i("position",o.target.value),placeholder:"z.B. Geschaeftsfuehrer"})]}),l("div",{class:"form-group",children:[l("label",{children:"Firma"}),l("input",{value:r.company_name,onInput:o=>i("company_name",o.target.value),placeholder:"Firmenname"})]}),l("div",{class:"form-group",children:[l("label",{children:"Quelle"}),l("select",{value:r.source,onChange:o=>i("source",o.target.value),children:Object.entries(oa).map(([o,u])=>l("option",{value:o,children:u},o))})]}),l("div",{class:"form-group",children:[l("label",{children:"Quelle (Detail)"}),l("input",{value:r.source_detail,onInput:o=>i("source_detail",o.target.value),placeholder:"z.B. Blog: Hotels"})]}),l("div",{class:"form-group form-group-full",children:l("label",{style:"display:flex;align-items:center;gap:0.5rem;text-transform:none;font-size:0.85rem;cursor:pointer",children:[l("input",{type:"checkbox",checked:r.gdpr_consent,onChange:o=>i("gdpr_consent",o.target.checked),style:"width:auto"}),"DSGVO-Einwilligung erteilt"]})})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/contacts"),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",disabled:e,children:e?"Erstelle...":"Kontakt erstellen"})]})]})})})]})}const _2=Tl.map(n=>({value:n,label:n}));function w2(){const[n,e]=Ae(""),[t,r]=Ae(null),{companies:s,loading:i,refetch:a}=v2({search:n,industry:t}),[o,u]=Ae(!1),[h,f]=Ae({name:"",industry:"",city:"",website:""}),m=mr();async function y(p){p.preventDefault();const{data:S,error:_}=await vp({name:h.name,industry:h.industry||null,city:h.city||null,website:h.website||null});_?m.error("Fehler beim Erstellen"):(m.success("Firma erstellt"),u(!1),f({name:"",industry:"",city:"",website:""}),a())}return l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Firmen"}),l("button",{class:"btn btn-primary btn-sm",onClick:()=>u(!0),children:"+ Neue Firma"})]}),l("div",{class:"page-body",children:[l("div",{class:"search-bar",children:l(mp,{value:n,onInput:e,placeholder:"Firma oder Stadt suchen..."})}),l("div",{style:"margin-bottom: 1rem",children:l(Mu,{filters:_2,active:t,onSelect:r})}),i?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):s.length===0?l("div",{class:"empty-state",children:[l("div",{class:"empty-state-icon",children:""}),l("div",{class:"empty-state-text",children:"Keine Firmen gefunden"})]}):l("div",{class:"card",children:l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Name"}),l("th",{children:"Branche"}),l("th",{children:"Stadt"}),l("th",{children:"Website"}),l("th",{children:"Erstellt"})]})}),l("tbody",{children:s.map(p=>l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/companies/${p.id}`),children:[l("td",{style:"font-weight:500",children:p.name}),l("td",{children:p.industry||""}),l("td",{children:p.city||""}),l("td",{children:p.website?l("a",{href:p.website,target:"_blank",rel:"noopener",onClick:S=>S.stopPropagation(),children:p.website}):""}),l("td",{style:"color:var(--text-dim)",children:An(p.created_at)})]},p.id))})]})})})]}),o&&l(ia,{title:"Neue Firma",onClose:()=>u(!1),children:l("form",{onSubmit:y,children:[l("div",{class:"form-group",children:[l("label",{children:"Firmenname *"}),l("input",{required:!0,value:h.name,onInput:p=>f({...h,name:p.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Branche"}),l("select",{value:h.industry,onChange:p=>f({...h,industry:p.target.value}),children:[l("option",{value:"",children:" Auswaehlen "}),Tl.map(p=>l("option",{value:p,children:p},p))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Stadt"}),l("input",{value:h.city,onInput:p=>f({...h,city:p.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Website"}),l("input",{value:h.website,onInput:p=>f({...h,website:p.target.value}),placeholder:"https://"})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>u(!1),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",children:"Erstellen"})]})]})})]})}const sa={invoice:{label:"Rechnung",prefix:"R"},quote:{label:"Angebot",prefix:"A"}},Un={draft:{label:"Entwurf",color:"#6366f1"},sent:{label:"Versendet",color:"#f59e0b"},paid:{label:"Bezahlt",color:"#10b981"},overdue:{label:"Ueberfaellig",color:"#ef4444"},cancelled:{label:"Storniert",color:"#64748b"}};function xc(n,e){var u;const t=new Date,r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),a=((u=sa[n])==null?void 0:u.prefix)||"R",o=(e||"").split(" ").pop()||"Kunde";return`${a}${r}${s}${i}-${o}`}function x2(n,e=0,t=19){const r=n.reduce((u,h)=>u+(parseFloat(h.quantity)||0)*(parseFloat(h.unit_price)||0),0),s=r*(parseFloat(e)||0)/100,i=r-s,a=i*(parseFloat(t)||0)/100,o=i+a;return{subtotal:Ba(r),discount_amount:Ba(s),net_amount:Ba(i),vat_amount:Ba(a),total_amount:Ba(o)}}function Ba(n){return Math.round(n*100)/100}function S2({id:n}){const{company:e,loading:t,update:r}=b2(n),{contacts:s}=Uu(),{deals:i}=Bu({companyId:n}),{invoices:a}=Ou({companyId:n});ju({companyId:n});const o=mr(),[u,h]=Ae(!1),[f,m]=Ae({}),y=s.filter(_=>_.company_id===n);if(t)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Firma"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]});if(!e)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Nicht gefunden"})}),l("div",{class:"page-body",children:l("div",{class:"empty-state",children:l("div",{class:"empty-state-text",children:"Firma nicht gefunden"})})})]});function p(){m({name:e.name||"",industry:e.industry||"",website:e.website||"",address:e.address||"",city:e.city||"",notes:e.notes||""}),h(!0)}async function S(){const{error:_}=await r(f);_?o.error("Fehler beim Speichern"):(o.success("Firma aktualisiert"),h(!1))}return l(bt,{children:[l("div",{class:"page-header",children:[l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/companies"),children:""}),l("h1",{class:"page-title",children:e.name})]}),!u&&l("button",{class:"btn btn-secondary btn-sm",onClick:p,children:"Bearbeiten"})]}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Firmendaten"})}),u?l("div",{children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Name"}),l("input",{value:f.name,onInput:_=>m({...f,name:_.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Branche"}),l("select",{value:f.industry,onChange:_=>m({...f,industry:_.target.value}),children:[l("option",{value:"",children:""}),Tl.map(_=>l("option",{value:_,children:_},_))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Website"}),l("input",{value:f.website,onInput:_=>m({...f,website:_.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Stadt"}),l("input",{value:f.city,onInput:_=>m({...f,city:_.target.value})})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Adresse"}),l("input",{value:f.address,onInput:_=>m({...f,address:_.target.value})})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Notizen"}),l("textarea",{value:f.notes,onInput:_=>m({...f,notes:_.target.value})})]})]}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>h(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary btn-sm",onClick:S,children:"Speichern"})]})]}):l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Name"}),l("span",{class:"detail-value",children:e.name})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Branche"}),l("span",{class:"detail-value",children:e.industry||""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Website"}),l("span",{class:"detail-value",children:e.website?l("a",{href:e.website,target:"_blank",rel:"noopener",children:e.website}):""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Stadt"}),l("span",{class:"detail-value",children:e.city||""})]}),l("div",{class:"detail-field form-group-full",children:[l("span",{class:"detail-label",children:"Adresse"}),l("span",{class:"detail-value",children:e.address||""})]}),e.notes&&l("div",{class:"detail-field form-group-full",children:[l("span",{class:"detail-label",children:"Notizen"}),l("span",{class:"detail-value",children:e.notes})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Kontakte (",y.length,")"]})}),y.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Kontakte"}):l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Name"}),l("th",{children:"E-Mail"}),l("th",{children:"Position"})]})}),l("tbody",{children:y.map(_=>l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/contacts/${_.id}`),children:[l("td",{children:`${_.first_name||""} ${_.last_name||""}`.trim()||""}),l("td",{children:_.email}),l("td",{children:_.position||""})]},_.id))})]})})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Deals (",i.length,")"]})}),i.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Deals"}):l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Titel"}),l("th",{children:"Stage"}),l("th",{children:"Wert"})]})}),l("tbody",{children:i.map(_=>l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/deals/${_.id}`),children:[l("td",{children:_.title}),l("td",{children:l(Ol,{stage:_.stage})}),l("td",{children:_.value?Kt(_.value):""})]},_.id))})]})})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Rechnungen / Angebote (",a.length,")"]})}),a.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Rechnungen"}):l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Nummer"}),l("th",{children:"Typ"}),l("th",{children:"Status"}),l("th",{style:"text-align:right",children:"Betrag"})]})}),l("tbody",{children:a.map(_=>{var x,w,O,C;return l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${_.id}`),children:[l("td",{style:"font-weight:600",children:_.invoice_number}),l("td",{children:(x=sa[_.type])==null?void 0:x.label}),l("td",{children:l("span",{class:"stage-badge",style:`color:${(w=Un[_.status])==null?void 0:w.color};background:${(O=Un[_.status])==null?void 0:O.color}20`,children:(C=Un[_.status])==null?void 0:C.label})}),l("td",{style:"text-align:right",children:Kt(_.total_amount)})]},_.id)})})]})})]})]}),l("div",{class:"detail-sidebar",children:l("div",{class:"card",children:l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt am"}),l("span",{class:"detail-value",children:An(e.created_at)})]})})})]})})]})}function A2({id:n}){const{deal:e,loading:t,update:r,changeStage:s}=o2(n),{activities:i,refetch:a}=ju({dealId:n}),{invoices:o}=Ou({dealId:n}),u=mr(),[h,f]=Ae(!1),[m,y]=Ae({}),[p,S]=Ae(!1),[_,x]=Ae({type:"note",description:"",due_date:""});if(t)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Deal"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]});if(!e)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Nicht gefunden"})}),l("div",{class:"page-body",children:l("div",{class:"empty-state",children:l("div",{class:"empty-state-text",children:"Deal nicht gefunden"})})})]});function w(){y({title:e.title||"",value:e.value||"",service_type:e.service_type||"",expected_close:e.expected_close||"",lost_reason:e.lost_reason||""}),f(!0)}async function O(){const{error:G}=await r({...m,value:m.value?parseFloat(m.value):null,service_type:m.service_type||null,expected_close:m.expected_close||null,lost_reason:m.lost_reason||null});G?u.error("Fehler beim Speichern"):(u.success("Deal aktualisiert"),f(!1))}async function C(G){const{error:V}=await s(G);V?u.error("Fehler beim Aendern"):(u.success(`Stage auf "${gi[G].label}" geaendert`),a())}async function F(G){G.preventDefault();const{error:V}=await gp({deal_id:n,contact_id:e.contact_id||null,type:_.type,description:_.description,due_date:_.type==="task"&&_.due_date?_.due_date:null});V?u.error("Fehler beim Erstellen"):(u.success("Aktivitaet hinzugefuegt"),S(!1),x({type:"note",description:"",due_date:""}),a())}return l(bt,{children:[l("div",{class:"page-header",children:[l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:""}),l("h1",{class:"page-title",children:e.title}),l(Ol,{stage:e.stage})]}),l("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>S(!0),children:"+ Aktivitaet"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve(`/crm/invoices/new?type=quote&deal_id=${n}`),children:"+ Angebot"}),e.stage==="won"&&l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve(`/crm/invoices/new?type=invoice&deal_id=${n}`),children:"+ Rechnung"}),!h&&l("button",{class:"btn btn-secondary btn-sm",onClick:w,children:"Bearbeiten"})]})]}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Deal-Infos"})}),h?l("div",{children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group form-group-full",children:[l("label",{children:"Titel"}),l("input",{value:m.title,onInput:G=>y({...m,title:G.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Wert (EUR)"}),l("input",{type:"number",step:"0.01",value:m.value,onInput:G=>y({...m,value:G.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Service-Typ"}),l("select",{value:m.service_type,onChange:G=>y({...m,service_type:G.target.value}),children:[l("option",{value:"",children:""}),Object.entries(hu).map(([G,V])=>l("option",{value:G,children:V},G))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Erwarteter Abschluss"}),l("input",{type:"date",value:m.expected_close,onInput:G=>y({...m,expected_close:G.target.value})})]}),e.stage==="lost"&&l("div",{class:"form-group",children:[l("label",{children:"Verlustgrund"}),l("input",{value:m.lost_reason,onInput:G=>y({...m,lost_reason:G.target.value})})]})]}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>f(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary btn-sm",onClick:O,children:"Speichern"})]})]}):l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Titel"}),l("span",{class:"detail-value",children:e.title})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Wert"}),l("span",{class:"detail-value",children:e.value?Kt(e.value):""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Service"}),l("span",{class:"detail-value",children:e.service_type?hu[e.service_type]:""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erwarteter Abschluss"}),l("span",{class:"detail-value",children:An(e.expected_close)})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Kontakt"}),l("span",{class:"detail-value",children:e.contact?l("a",{href:"#",onClick:G=>{G.preventDefault(),Ve(`/crm/contacts/${e.contact.id}`)},children:`${e.contact.first_name||""} ${e.contact.last_name||""}`.trim()||e.contact.email}):""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Firma"}),l("span",{class:"detail-value",children:e.company?l("a",{href:"#",onClick:G=>{G.preventDefault(),Ve(`/crm/companies/${e.company.id}`)},children:e.company.name}):""})]}),e.lost_reason&&l("div",{class:"detail-field form-group-full",children:[l("span",{class:"detail-label",children:"Verlustgrund"}),l("span",{class:"detail-value",children:e.lost_reason})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Stage aendern"})}),l("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:Object.entries(gi).map(([G,V])=>l("button",{class:`btn btn-sm ${e.stage===G?"btn-primary":"btn-secondary"}`,onClick:()=>e.stage!==G&&C(G),disabled:e.stage===G,style:e.stage===G?`background:${V.color}`:"",children:V.label},G))})]}),o.length>0&&l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Rechnungen / Angebote (",o.length,")"]})}),l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Nummer"}),l("th",{children:"Typ"}),l("th",{children:"Status"}),l("th",{style:"text-align:right",children:"Betrag"})]})}),l("tbody",{children:o.map(G=>{var V,re,J,U;return l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${G.id}`),children:[l("td",{style:"font-weight:600",children:G.invoice_number}),l("td",{children:(V=sa[G.type])==null?void 0:V.label}),l("td",{children:l("span",{class:"stage-badge",style:`color:${(re=Un[G.status])==null?void 0:re.color};background:${(J=Un[G.status])==null?void 0:J.color}20`,children:(U=Un[G.status])==null?void 0:U.label})}),l("td",{style:"text-align:right",children:Kt(G.total_amount)})]},G.id)})})]})})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Aktivitaeten"})}),i.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Aktivitaeten"}):l("div",{class:"timeline",children:i.map(G=>l(Du,{activity:G},G.id))})]})]}),l("div",{class:"detail-sidebar",children:l("div",{class:"card",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Stage geaendert am"}),l("span",{class:"detail-value",children:An(e.stage_changed_at)})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt am"}),l("span",{class:"detail-value",children:An(e.created_at)})]})]})})]})}),p&&l(ia,{title:"Aktivitaet hinzufuegen",onClose:()=>S(!1),children:l("form",{onSubmit:F,children:[l("div",{class:"form-group",children:[l("label",{children:"Typ"}),l("select",{value:_.type,onChange:G=>x({..._,type:G.target.value}),children:Object.entries(Fu).filter(([G])=>!["form_submission","stage_change","created"].includes(G)).map(([G,V])=>l("option",{value:G,children:[V.icon," ",V.label]},G))})]}),l("div",{class:"form-group",children:[l("label",{children:"Beschreibung"}),l("textarea",{value:_.description,onInput:G=>x({..._,description:G.target.value}),required:!0})]}),_.type==="task"&&l("div",{class:"form-group",children:[l("label",{children:"Faellig am"}),l("input",{type:"date",value:_.due_date,onInput:G=>x({..._,due_date:G.target.value})})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>S(!1),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",children:"Speichern"})]})]})})]})}function k2(){const n=mr(),{contacts:e}=Uu(),[t,r]=Ae(!1),i=new URLSearchParams(typeof window<"u"?window.location.search:"").get("contact_id")||"",[a,o]=Ae({title:"",contact_id:i,service_type:"",value:"",expected_close:""});function u(f,m){o(y=>({...y,[f]:m}))}async function h(f){f.preventDefault(),r(!0);try{let m=null;if(a.contact_id){const S=e.find(_=>_.id===a.contact_id);m=(S==null?void 0:S.company_id)||null}const{data:y,error:p}=await l2({title:a.title,contact_id:a.contact_id||null,company_id:m,service_type:a.service_type||null,value:a.value?parseFloat(a.value):null,expected_close:a.expected_close||null});if(p)throw p;n.success("Deal erstellt"),Ve(`/crm/deals/${y.id}`)}catch(m){n.error(m.message||"Fehler beim Erstellen")}r(!1)}return l(bt,{children:[l("div",{class:"page-header",children:l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/pipeline"),children:""}),l("h1",{class:"page-title",children:"Neuer Deal"})]})}),l("div",{class:"page-body",children:l("div",{class:"card",style:"max-width: 640px",children:l("form",{onSubmit:h,children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group form-group-full",children:[l("label",{children:"Titel *"}),l("input",{required:!0,value:a.title,onInput:f=>u("title",f.target.value),placeholder:"z.B. 360-Tour Restaurant Bellini"})]}),l("div",{class:"form-group",children:[l("label",{children:"Kontakt"}),l("select",{value:a.contact_id,onChange:f=>u("contact_id",f.target.value),children:[l("option",{value:"",children:" Auswaehlen "}),e.map(f=>l("option",{value:f.id,children:`${f.first_name||""} ${f.last_name||""}`.trim()||f.email},f.id))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Service-Typ"}),l("select",{value:a.service_type,onChange:f=>u("service_type",f.target.value),children:[l("option",{value:"",children:" Auswaehlen "}),Object.entries(hu).map(([f,m])=>l("option",{value:f,children:m},f))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Wert (EUR)"}),l("input",{type:"number",step:"0.01",min:"0",value:a.value,onInput:f=>u("value",f.target.value),placeholder:"z.B. 1200"})]}),l("div",{class:"form-group",children:[l("label",{children:"Erwarteter Abschluss"}),l("input",{type:"date",value:a.expected_close,onInput:f=>u("expected_close",f.target.value)})]})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/pipeline"),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",disabled:t,children:t?"Erstelle...":"Deal erstellen"})]})]})})})]})}function N2(){const{user:n}=Il(),e=mr(),{settings:t,save:r,loading:s}=Ru(),[i,a]=Ae({password:"",confirm:""}),[o,u]=Ae(!1),[h,f]=Ae({}),[m,y]=Ae(!1),[p,S]=Ae(!1);qt(()=>{t&&f({company_name:t.company_name||"",owner_name:t.owner_name||"",address_line1:t.address_line1||"",address_zip:t.address_zip||"",address_city:t.address_city||"",phone:t.phone||"",email:t.email||"",website:t.website||"",tax_id:t.tax_id||"",vat_id:t.vat_id||"",bank_name:t.bank_name||"",bank_iban:t.bank_iban||"",bank_bic:t.bank_bic||"",default_payment_days:t.default_payment_days||14,vat_rate:t.vat_rate||19,default_closing_text:t.default_closing_text||""})},[t]);async function _(C){C.preventDefault(),S(!0);const{error:F}=await r({...h,default_payment_days:parseInt(h.default_payment_days)||14,vat_rate:parseFloat(h.vat_rate)||19});F?e.error("Fehler: "+F.message):(e.success("Geschaeftsdaten gespeichert"),y(!1)),S(!1)}async function x(C){if(C.preventDefault(),i.password!==i.confirm){e.error("Passwoerter stimmen nicht ueberein");return}if(i.password.length<8){e.error("Passwort muss mindestens 8 Zeichen lang sein");return}u(!0);const{error:F}=await Ne.auth.updateUser({password:i.password});F?e.error("Fehler: "+F.message):(e.success("Passwort geaendert"),a({password:"",confirm:""})),u(!1)}async function w(){const{data:C,error:F}=await Ne.from("contacts").select("first_name, last_name, email, phone, source, created_at").is("deleted_at",null).order("created_at",{ascending:!1});if(F){e.error("Export fehlgeschlagen");return}const G=["Vorname,Nachname,E-Mail,Telefon,Quelle,Erstellt",...C.map(U=>[U.first_name,U.last_name,U.email,U.phone,U.source,U.created_at].map(I=>`"${(I||"").toString().replace(/"/g,'""')}"`).join(","))].join(`
`),V=new Blob(["\uFEFF"+G],{type:"text/csv;charset=utf-8"}),re=URL.createObjectURL(V),J=document.createElement("a");J.href=re,J.download=`beck360-kontakte-${new Date().toISOString().slice(0,10)}.csv`,J.click(),URL.revokeObjectURL(re),e.success("Export erstellt")}async function O(){if(!confirm("Alle geloeschten Kontakte endgueltig entfernen? Dies kann nicht rueckgaengig gemacht werden."))return;const{error:C}=await Ne.from("contacts").delete().not("deleted_at","is",null);C?e.error("Fehler: "+C.message):e.success("Geloeschte Kontakte endgueltig entfernt")}return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Einstellungen"})}),l("div",{class:"page-body",children:l("div",{style:"display:flex;flex-direction:column;gap:1.5rem;max-width:640px",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Konto"})}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"E-Mail"}),l("span",{class:"detail-value",children:n==null?void 0:n.email})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"User ID"}),l("span",{class:"detail-value",style:"font-size:0.75rem;color:var(--text-dim);word-break:break-all",children:n==null?void 0:n.id})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:[l("span",{class:"card-title",children:"Geschaeftsdaten"}),!m&&l("button",{class:"btn btn-secondary btn-sm",onClick:()=>y(!0),children:"Bearbeiten"})]}),s?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):m?l("form",{onSubmit:_,children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Firmenname"}),l("input",{value:h.company_name,onInput:C=>f({...h,company_name:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Inhaber"}),l("input",{value:h.owner_name,onInput:C=>f({...h,owner_name:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Adresse"}),l("input",{value:h.address_line1,onInput:C=>f({...h,address_line1:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"PLZ"}),l("input",{value:h.address_zip,onInput:C=>f({...h,address_zip:C.target.value}),style:"max-width:120px"})]}),l("div",{class:"form-group",children:[l("label",{children:"Stadt"}),l("input",{value:h.address_city,onInput:C=>f({...h,address_city:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Telefon"}),l("input",{value:h.phone,onInput:C=>f({...h,phone:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"E-Mail"}),l("input",{type:"email",value:h.email,onInput:C=>f({...h,email:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Website"}),l("input",{value:h.website,onInput:C=>f({...h,website:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Steuernummer"}),l("input",{value:h.tax_id,onInput:C=>f({...h,tax_id:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"USt-IdNr."}),l("input",{value:h.vat_id,onInput:C=>f({...h,vat_id:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Bank"}),l("input",{value:h.bank_name,onInput:C=>f({...h,bank_name:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"IBAN"}),l("input",{value:h.bank_iban,onInput:C=>f({...h,bank_iban:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"BIC"}),l("input",{value:h.bank_bic,onInput:C=>f({...h,bank_bic:C.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Zahlungsziel (Tage)"}),l("input",{type:"number",value:h.default_payment_days,onInput:C=>f({...h,default_payment_days:C.target.value}),style:"max-width:100px"})]}),l("div",{class:"form-group",children:[l("label",{children:"MwSt-Satz (%)"}),l("input",{type:"number",step:"0.01",value:h.vat_rate,onInput:C=>f({...h,vat_rate:C.target.value}),style:"max-width:100px"})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Standard-Schlusstext"}),l("textarea",{value:h.default_closing_text,onInput:C=>f({...h,default_closing_text:C.target.value})})]})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:()=>y(!1),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:p,children:p?"Speichern...":"Speichern"})]})]}):l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Firma"}),l("span",{class:"detail-value",children:(t==null?void 0:t.company_name)||"BECK360"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Inhaber"}),l("span",{class:"detail-value",children:(t==null?void 0:t.owner_name)||"Eugen Beck"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Adresse"}),l("span",{class:"detail-value",children:[(t==null?void 0:t.address_line1)||"Eichenweg 1",", ",(t==null?void 0:t.address_zip)||"76275"," ",(t==null?void 0:t.address_city)||"Ettlingen"]})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Telefon"}),l("span",{class:"detail-value",children:(t==null?void 0:t.phone)||"0173-4682501"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"IBAN"}),l("span",{class:"detail-value",children:(t==null?void 0:t.bank_iban)||"DE92 5486 2500 0001 1389 95"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"MwSt."}),l("span",{class:"detail-value",children:[(t==null?void 0:t.vat_rate)||19,"%"]})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Passwort aendern"})}),l("form",{onSubmit:x,children:[l("div",{class:"form-group",children:[l("label",{children:"Neues Passwort"}),l("input",{type:"password",value:i.password,onInput:C=>a({...i,password:C.target.value}),minLength:8,required:!0,autocomplete:"new-password"})]}),l("div",{class:"form-group",children:[l("label",{children:"Passwort bestaetigen"}),l("input",{type:"password",value:i.confirm,onInput:C=>a({...i,confirm:C.target.value}),minLength:8,required:!0,autocomplete:"new-password"})]}),l("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:o,children:o?"Speichern...":"Passwort aendern"})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"DSGVO-Tools"})}),l("div",{style:"display:flex;flex-direction:column;gap:0.75rem",children:[l("div",{children:[l("div",{style:"font-size:0.85rem;margin-bottom:0.35rem",children:"Kontakte als CSV exportieren"}),l("button",{class:"btn btn-secondary btn-sm",onClick:w,children:"CSV Export"})]}),l("div",{children:[l("div",{style:"font-size:0.85rem;margin-bottom:0.35rem",children:"Geloeschte Kontakte endgueltig entfernen (Recht auf Loeschung)"}),l("button",{class:"btn btn-danger btn-sm",onClick:O,children:"Endgueltig loeschen"})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"System-Info"})}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Version"}),l("span",{class:"detail-value",children:"1.0.0"})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Datenbank"}),l("span",{class:"detail-value",children:"Supabase (Frankfurt, EU)"})]})]})]})})]})}function L2({status:n=null}={}){const[e,t]=Ae([]),[r,s]=Ae(!0),i=kt(async()=>{s(!0);let a=Ne.from("campaigns").select("*").order("created_at",{ascending:!1});n&&(a=a.eq("status",n));const{data:o,error:u}=await a;u||t(o||[]),s(!1)},[n]);return qt(()=>{i()},[i]),{campaigns:e,loading:r,refetch:i}}function E2(n){const[e,t]=Ae(null),[r,s]=Ae(!0),i=kt(async()=>{if(!n)return;s(!0);const{data:u}=await Ne.from("campaigns").select("*").eq("id",n).single();t(u),s(!1)},[n]);qt(()=>{i()},[i]);const a=kt(async u=>{const{error:h}=await Ne.from("campaigns").update(u).eq("id",n);return h||await i(),{error:h}},[n,i]),o=kt(async()=>Ne.from("campaigns").delete().eq("id",n),[n]);return{campaign:e,loading:r,refetch:i,update:a,remove:o}}function P2(n){const[e,t]=Ae([]),[r,s]=Ae(!0),i=kt(async()=>{if(!n)return;s(!0);const{data:a}=await Ne.from("campaign_recipients").select("*, contact:contacts(first_name, last_name, email)").eq("campaign_id",n).order("created_at",{ascending:!1});t(a||[]),s(!1)},[n]);return qt(()=>{i()},[i]),{recipients:e,loading:r,refetch:i}}async function Sc(n){const{data:e}=await Ne.auth.getUser();return Ne.from("campaigns").insert({...n,owner_id:e.user.id}).select().single()}async function bp({source:n,stage:e,industry:t}){let r=Ne.from("contacts").select("id, first_name, last_name, email, source, company:companies(name, industry)").is("deleted_at",null).eq("gdpr_consent",!0).not("email","is",null);n&&(r=r.eq("source",n));const{data:s,error:i}=await r;if(i)return{data:[],error:i};let a=s||[];if(t&&(a=a.filter(o=>{var u;return((u=o.company)==null?void 0:u.industry)===t})),e){const{data:o}=await Ne.from("deals").select("contact_id").eq("stage",e).is("deleted_at",null),u=new Set((o||[]).map(h=>h.contact_id).filter(Boolean));a=a.filter(h=>u.has(h.id))}return{data:a,error:null}}async function du(n,e){if(await Ne.from("campaign_recipients").delete().eq("campaign_id",n),e.length===0)return{error:null};const t=e.map(r=>({campaign_id:n,contact_id:r.id,email:r.email}));return Ne.from("campaign_recipients").insert(t)}async function fu(n,{testEmail:e}={}){const{data:{session:t}}=await Ne.auth.getSession();if(!t)throw new Error("Not authenticated");const r={campaign_id:n};e&&(r.test_email=e);const s=await fetch("/api/campaign-send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify(r)}),i=await s.json();if(!s.ok)throw new Error(i.error||"Send failed");return i}const C2=Object.entries(Bi).map(([n,{label:e}])=>({value:n,label:e}));function I2(){const[n,e]=Ae(null),{campaigns:t,loading:r}=L2({status:n});return l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Kampagnen"}),l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/campaigns/new"),children:"+ Neue Kampagne"})]}),l("div",{class:"page-body",children:[l("div",{style:"margin-bottom: 1rem",children:l(Mu,{filters:C2,active:n,onSelect:e})}),r?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):t.length===0?l("div",{class:"empty-state",children:[l("div",{class:"empty-state-icon",children:""}),l("div",{class:"empty-state-text",children:"Keine Kampagnen gefunden"})]}):l("div",{class:"card",children:l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Name"}),l("th",{children:"Betreff"}),l("th",{children:"Status"}),l("th",{children:"Gesendet"}),l("th",{children:"Geoeffnet"}),l("th",{children:"Datum"})]})}),l("tbody",{children:t.map(s=>{var i,a,o;return l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/campaigns/${s.id}`),children:[l("td",{style:"font-weight:500",children:s.name}),l("td",{children:s.subject}),l("td",{children:l("span",{class:"stage-badge",style:`background:${((i=Bi[s.status])==null?void 0:i.color)||"#6366f1"}15;color:${((a=Bi[s.status])==null?void 0:a.color)||"#6366f1"};`,children:((o=Bi[s.status])==null?void 0:o.label)||s.status})}),l("td",{children:s.total_sent||0}),l("td",{children:s.total_opened||0}),l("td",{style:"color:var(--text-dim)",children:An(s.sent_at||s.created_at)})]},s.id)})})]})})})]})]})}function T2(){const n=mr(),[e,t]=Ae({name:"",subject:"",body_html:""}),[r,s]=Ae({source:"",stage:"",industry:""}),[i,a]=Ae(0),[o,u]=Ae([]),[h,f]=Ae(!1),[m,y]=Ae(!1),[p,S]=Ae(!1),[_,x]=Ae(!1),[w,O]=Ae(""),[C,F]=Ae(!1);function G(B,W){t(Z=>({...Z,[B]:W}))}function V(B,W){s(Z=>({...Z,[B]:W}))}function re(B){const W=fd.find(Z=>Z.id===B);W&&t(Z=>({...Z,subject:W.subject||Z.subject,body_html:W.body}))}const J=kt(async()=>{f(!0);const{data:B}=await bp({source:r.source||null,stage:r.stage||null,industry:r.industry||null});u(B),a(B.length),f(!1)},[r.source,r.stage,r.industry]);qt(()=>{J()},[J]);async function U(){if(!e.name||!e.subject||!e.body_html){n.error("Name, Betreff und Inhalt sind Pflichtfelder");return}y(!0);try{const{data:B,error:W}=await Sc({name:e.name,subject:e.subject,body_html:e.body_html,filters:r});if(W)throw W;await du(B.id,o),n.success("Kampagne gespeichert"),Ve(`/crm/campaigns/${B.id}`)}catch(B){n.error(B.message||"Fehler beim Speichern")}y(!1)}async function I(){if(!e.name||!e.subject||!e.body_html){n.error("Name, Betreff und Inhalt sind Pflichtfelder");return}if(i===0){n.error("Keine Empfaenger ausgewaehlt");return}y(!0);try{const{data:B,error:W}=await Sc({name:e.name,subject:e.subject,body_html:e.body_html,filters:r});if(W)throw W;await du(B.id,o);const Z=await fu(B.id);n.success(`Kampagne gesendet an ${Z.total_sent} Empfaenger`),Ve(`/crm/campaigns/${B.id}`)}catch(B){n.error(B.message||"Fehler beim Senden")}y(!1),x(!1)}async function L(){if(!w){n.error("Bitte Test-E-Mail-Adresse eingeben");return}if(!e.subject||!e.body_html){n.error("Betreff und Inhalt muessen ausgefuellt sein");return}F(!0);try{const{data:B,error:W}=await Sc({name:e.name||"Test-Kampagne",subject:e.subject,body_html:e.body_html,filters:r});if(W)throw W;await fu(B.id,{testEmail:w}),n.success(`Test-Mail an ${w} gesendet`)}catch(B){n.error(B.message||"Test-Mail fehlgeschlagen")}F(!1)}const R=e.body_html.replace(/\{\{vorname\}\}/gi,"Max").replace(/\{\{nachname\}\}/gi,"Mustermann").replace(/\{\{firma\}\}/gi,"Musterfirma GmbH").replace(/\{\{email\}\}/gi,"max@example.de");return l(bt,{children:[l("div",{class:"page-header",children:l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/campaigns"),children:""}),l("h1",{class:"page-title",children:"Neue Kampagne"})]})}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Kampagne"})}),l("div",{class:"form-grid",children:[l("div",{class:"form-group form-group-full",children:[l("label",{children:"Name (intern)"}),l("input",{value:e.name,onInput:B=>G("name",B.target.value),placeholder:"z.B. Follow-up Februar 2026"})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Betreff"}),l("input",{value:e.subject,onInput:B=>G("subject",B.target.value),placeholder:"Betreff der E-Mail"})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Vorlage waehlen"})}),l("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:fd.map(B=>l("button",{class:"btn btn-secondary btn-sm",onClick:()=>re(B.id),children:B.name},B.id))})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:[l("span",{class:"card-title",children:"Inhalt (HTML)"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>S(!p),children:p?"Editor":"Vorschau"})]}),l("div",{style:"font-size:0.75rem;color:var(--text-dim);margin-bottom:0.5rem;",children:["Platzhalter: ","{{vorname}}",", ","{{nachname}}",", ","{{firma}}",", ","{{email}}"]}),p?l("div",{style:"border:1px solid var(--border);border-radius:8px;padding:1rem;background:#fff;min-height:300px;",dangerouslySetInnerHTML:{__html:R}}):l("textarea",{value:e.body_html,onInput:B=>G("body_html",B.target.value),style:"width:100%;min-height:300px;font-family:monospace;font-size:0.8rem;border:1px solid var(--border);border-radius:8px;padding:0.75rem;",placeholder:"HTML-Inhalt der E-Mail..."})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Test-Mail senden"})}),l("div",{style:"display:flex;gap:0.5rem;align-items:end;",children:[l("div",{class:"form-group",style:"flex:1;margin:0",children:[l("label",{children:"E-Mail-Adresse"}),l("input",{type:"email",value:w,onInput:B=>O(B.target.value),placeholder:"rundgang@beck360.de"})]}),l("button",{class:"btn btn-secondary btn-sm",onClick:L,disabled:C,style:"white-space:nowrap;",children:C?"Sende...":"Test senden"})]})]})]}),l("div",{class:"detail-sidebar",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Empfaenger-Filter"})}),l("div",{class:"form-group",children:[l("label",{children:"Quelle"}),l("select",{value:r.source,onChange:B=>V("source",B.target.value),children:[l("option",{value:"",children:"Alle Quellen"}),Object.entries(oa).map(([B,W])=>l("option",{value:B,children:W},B))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Deal-Stage"}),l("select",{value:r.stage,onChange:B=>V("stage",B.target.value),children:[l("option",{value:"",children:"Alle Stages"}),Object.entries(gi).map(([B,W])=>l("option",{value:B,children:W.label},B))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Branche"}),l("select",{value:r.industry,onChange:B=>V("industry",B.target.value),children:[l("option",{value:"",children:"Alle Branchen"}),Tl.map(B=>l("option",{value:B,children:B},B))]})]}),l("div",{style:"margin-top:1rem;padding:0.75rem;background:var(--bg-subtle,#f1f5f9);border-radius:8px;text-align:center;",children:h?l("span",{style:"color:var(--text-dim);font-size:0.85rem",children:"Lade..."}):l(bt,{children:[l("div",{style:"font-size:1.5rem;font-weight:700;",children:i}),l("div",{style:"font-size:0.75rem;color:var(--text-dim)",children:"Empfaenger (nur mit DSGVO-Einwilligung)"})]})})]}),l("div",{class:"card",children:l("div",{style:"display:flex;flex-direction:column;gap:0.5rem;",children:[l("button",{class:"btn btn-secondary",onClick:U,disabled:m,children:m?"Speichere...":"Als Entwurf speichern"}),l("button",{class:"btn btn-primary",onClick:()=>x(!0),disabled:m||i===0,children:"Speichern & Senden"})]})})]})]})}),_&&l(ia,{title:"Kampagne senden?",onClose:()=>x(!1),children:[l("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',l("strong",{children:e.name}),'" wird an ',l("strong",{children:[i," Empfaenger"]})," gesendet. Dieser Vorgang kann nicht rueckgaengig gemacht werden."]}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary",onClick:()=>x(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary",onClick:I,disabled:m,children:m?"Sende...":"Jetzt senden"})]})]})]})}const Ac={pending:{label:"Ausstehend",color:"#6366f1"},sent:{label:"Gesendet",color:"#3b82f6"},opened:{label:"Geoeffnet",color:"#10b981"},clicked:{label:"Geklickt",color:"#059669"},bounced:{label:"Bounce",color:"#ef4444"},unsubscribed:{label:"Abgemeldet",color:"#94a3b8"}};function O2({id:n}){var I,L,R,B,W;const{campaign:e,loading:t,update:r,refetch:s,remove:i}=E2(n),{recipients:a,loading:o,refetch:u}=P2(n),h=mr(),[f,m]=Ae(!1),[y,p]=Ae({}),[S,_]=Ae(!1),[x,w]=Ae(!1),[O,C]=Ae(!1);if(t)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Kampagne"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]});if(!e)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Nicht gefunden"})}),l("div",{class:"page-body",children:l("div",{class:"empty-state",children:l("div",{class:"empty-state-text",children:"Kampagne nicht gefunden"})})})]});function F(){p({name:e.name||"",subject:e.subject||"",body_html:e.body_html||""}),m(!0)}async function G(){const{error:Z}=await r(y);Z?h.error("Fehler beim Speichern"):(h.success("Kampagne aktualisiert"),m(!1))}async function V(){w(!0);try{if(e.status==="draft"&&e.filters){const{data:ue}=await bp(e.filters);await du(e.id,ue),await u()}const Z=await fu(e.id);h.success(`Kampagne gesendet an ${Z.total_sent} Empfaenger`),s(),u()}catch(Z){h.error(Z.message||"Senden fehlgeschlagen")}w(!1),_(!1)}async function re(){const{error:Z}=await i();Z?h.error("Fehler beim Loeschen"):(h.success("Kampagne geloescht"),Ve("/crm/campaigns"))}const J=e.total_sent>0?Math.round(e.total_opened/e.total_sent*100):0,U=e.total_sent>0?Math.round(e.total_clicked/e.total_sent*100):0;return l(bt,{children:[l("div",{class:"page-header",children:[l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/campaigns"),children:""}),l("h1",{class:"page-title",children:e.name}),l("span",{class:"stage-badge",style:`background:${((I=Bi[e.status])==null?void 0:I.color)||"#6366f1"}15;color:${((L=Bi[e.status])==null?void 0:L.color)||"#6366f1"};`,children:((R=Bi[e.status])==null?void 0:R.label)||e.status})]}),l("div",{style:"display:flex;gap:0.5rem",children:e.status==="draft"&&l(bt,{children:[!f&&l("button",{class:"btn btn-secondary btn-sm",onClick:F,children:"Bearbeiten"}),l("button",{class:"btn btn-primary btn-sm",onClick:()=>_(!0),children:"Senden"}),l("button",{class:"btn btn-danger btn-sm",onClick:()=>C(!0),children:"Loeschen"})]})})]}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[e.status==="sent"&&l("div",{style:"display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1rem;",children:[l("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[l("div",{class:"kpi-value",children:e.total_sent}),l("div",{class:"kpi-label",children:"Gesendet"})]}),l("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[l("div",{class:"kpi-value",children:[e.total_opened," ",l("span",{style:"font-size:0.85rem;color:var(--text-dim)",children:["(",J,"%)"]})]}),l("div",{class:"kpi-label",children:"Geoeffnet"})]}),l("div",{class:"card",style:"text-align:center;padding:1.25rem;",children:[l("div",{class:"kpi-value",children:[e.total_clicked," ",l("span",{style:"font-size:0.85rem;color:var(--text-dim)",children:["(",U,"%)"]})]}),l("div",{class:"kpi-label",children:"Geklickt"})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Kampagnen-Details"})}),f?l("div",{children:[l("div",{class:"form-grid",children:[l("div",{class:"form-group form-group-full",children:[l("label",{children:"Name"}),l("input",{value:y.name,onInput:Z=>p({...y,name:Z.target.value})})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Betreff"}),l("input",{value:y.subject,onInput:Z=>p({...y,subject:Z.target.value})})]}),l("div",{class:"form-group form-group-full",children:[l("label",{children:"Inhalt (HTML)"}),l("textarea",{value:y.body_html,onInput:Z=>p({...y,body_html:Z.target.value}),style:"width:100%;min-height:200px;font-family:monospace;font-size:0.8rem;"})]})]}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>m(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary btn-sm",onClick:G,children:"Speichern"})]})]}):l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Betreff"}),l("span",{class:"detail-value",children:e.subject})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt am"}),l("span",{class:"detail-value",children:Qo(e.created_at)})]}),e.sent_at&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Gesendet am"}),l("span",{class:"detail-value",children:Qo(e.sent_at)})]}),e.filters&&l("div",{class:"detail-field form-group-full",children:[l("span",{class:"detail-label",children:"Filter"}),l("span",{class:"detail-value",style:"font-size:0.85rem",children:[e.filters.source&&l("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem;margin-right:0.25rem",children:oa[e.filters.source]||e.filters.source}),e.filters.stage&&l("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem;margin-right:0.25rem",children:((B=gi[e.filters.stage])==null?void 0:B.label)||e.filters.stage}),e.filters.industry&&l("span",{class:"filter-pill",style:"cursor:default;font-size:0.7rem;padding:0.15rem 0.5rem",children:e.filters.industry}),!e.filters.source&&!e.filters.stage&&!e.filters.industry&&"Alle Kontakte"]})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"E-Mail-Vorschau"})}),l("div",{style:"border:1px solid var(--border);border-radius:8px;padding:1rem;background:#fff;max-height:400px;overflow:auto;",dangerouslySetInnerHTML:{__html:e.body_html}})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:["Empfaenger (",a.length,")"]})}),o?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):a.length===0?l("div",{style:"color:var(--text-dim);font-size:0.85rem",children:"Keine Empfaenger"}):l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Name"}),l("th",{children:"E-Mail"}),l("th",{children:"Status"}),l("th",{children:"Geoeffnet"}),l("th",{children:"Geklickt"})]})}),l("tbody",{children:a.map(Z=>{var ue,he,ie;return l("tr",{children:[l("td",{children:Z.contact?l("a",{href:"#",onClick:de=>{de.preventDefault(),Ve(`/crm/contacts/${Z.contact_id}`)},children:`${Z.contact.first_name||""} ${Z.contact.last_name||""}`.trim()||Z.email}):Z.email}),l("td",{children:Z.email}),l("td",{children:l("span",{class:"stage-badge",style:`background:${((ue=Ac[Z.status])==null?void 0:ue.color)||"#6366f1"}15;color:${((he=Ac[Z.status])==null?void 0:he.color)||"#6366f1"};`,children:((ie=Ac[Z.status])==null?void 0:ie.label)||Z.status})}),l("td",{style:"color:var(--text-dim)",children:Z.opened_at?Qo(Z.opened_at):""}),l("td",{style:"color:var(--text-dim)",children:Z.clicked_at?Qo(Z.clicked_at):""})]},Z.id)})})]})})]})]}),l("div",{class:"detail-sidebar",children:l("div",{class:"card",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Status"}),l("span",{class:"detail-value",children:(W=Bi[e.status])==null?void 0:W.label})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt"}),l("span",{class:"detail-value",children:An(e.created_at)})]}),e.sent_at&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Gesendet"}),l("span",{class:"detail-value",children:An(e.sent_at)})]})]})})]})}),S&&l(ia,{title:"Kampagne senden?",onClose:()=>_(!1),children:[l("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',l("strong",{children:e.name}),'" wird jetzt versendet. Nur Kontakte mit DSGVO-Einwilligung erhalten die E-Mail.']}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary",onClick:()=>_(!1),children:"Abbrechen"}),l("button",{class:"btn btn-primary",onClick:V,disabled:x,children:x?"Sende...":"Jetzt senden"})]})]}),O&&l(ia,{title:"Kampagne loeschen?",onClose:()=>C(!1),children:[l("p",{style:"margin-bottom:1rem;",children:['Die Kampagne "',l("strong",{children:e.name}),'" wird unwiderruflich geloescht.']}),l("div",{class:"form-actions",children:[l("button",{class:"btn btn-secondary",onClick:()=>C(!1),children:"Abbrechen"}),l("button",{class:"btn btn-danger",onClick:re,children:"Loeschen"})]})]})]})}function R2(){const[n,e]=Ae(null),[t,r]=Ae(null),{invoices:s,loading:i}=Ou({type:n,status:t});return l(bt,{children:[l("div",{class:"page-header",children:[l("h1",{class:"page-title",children:"Rechnungen & Angebote"}),l("div",{style:"display:flex;gap:0.5rem",children:[l("button",{class:"btn btn-primary btn-sm",onClick:()=>Ve("/crm/invoices/new?type=invoice"),children:"+ Rechnung"}),l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices/new?type=quote"),children:"+ Angebot"})]})]}),l("div",{class:"page-body",children:[l("div",{class:"search-bar",children:[l("div",{class:"filter-pills",children:[l("button",{class:`filter-pill ${n?"":"active"}`,onClick:()=>e(null),children:"Alle"}),Object.entries(sa).map(([a,o])=>l("button",{class:`filter-pill ${n===a?"active":""}`,onClick:()=>e(n===a?null:a),children:o.label},a))]}),l("div",{class:"filter-pills",style:"margin-left:1rem",children:Object.entries(Un).map(([a,o])=>l("button",{class:`filter-pill ${t===a?"active":""}`,onClick:()=>r(t===a?null:a),children:o.label},a))})]}),i?l("div",{class:"loading-center",children:l("div",{class:"spinner"})}):s.length===0?l("div",{class:"empty-state",children:[l("div",{class:"empty-state-icon",children:""}),l("div",{class:"empty-state-text",children:"Keine Rechnungen oder Angebote"})]}):l("div",{class:"card",children:l("div",{class:"table-wrapper",children:l("table",{children:[l("thead",{children:l("tr",{children:[l("th",{children:"Nummer"}),l("th",{children:"Typ"}),l("th",{children:"Kunde"}),l("th",{children:"Datum"}),l("th",{children:"Status"}),l("th",{style:"text-align:right",children:"Betrag"})]})}),l("tbody",{children:s.map(a=>{var o,u,h,f;return l("tr",{class:"clickable-row",onClick:()=>Ve(`/crm/invoices/${a.id}`),children:[l("td",{style:"font-weight:600",children:a.invoice_number}),l("td",{children:l("span",{style:`font-size:0.75rem;padding:0.15rem 0.5rem;border-radius:999px;background:${a.type==="quote"?"rgba(139,92,246,0.15);color:#a78bfa":"rgba(59,130,246,0.15);color:#60a5fa"}`,children:(o=sa[a.type])==null?void 0:o.label})}),l("td",{children:a.customer_company||a.customer_name||""}),l("td",{children:An(a.invoice_date)}),l("td",{children:l("span",{class:"stage-badge",style:`color:${(u=Un[a.status])==null?void 0:u.color};background:${(h=Un[a.status])==null?void 0:h.color}20`,children:(f=Un[a.status])==null?void 0:f.label})}),l("td",{style:"text-align:right;font-weight:600",children:Kt(a.total_amount)})]},a.id)})})]})})})]})]})}function j2({items:n,onChange:e}){function t(a,o,u){const h=n.map((f,m)=>m===a?{...f,[o]:u}:f);e(h)}function r(){e([...n,{description:"",sub_description:"",quantity:1,unit_price:0}])}function s(a){e(n.filter((o,u)=>u!==a))}function i(a){return(parseFloat(a)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+" "}return l("div",{children:[l("div",{class:"table-wrapper",children:l("table",{class:"line-items-table",children:[l("thead",{children:l("tr",{children:[l("th",{style:"width:40%",children:"Bezeichnung"}),l("th",{style:"width:15%",children:"Menge"}),l("th",{style:"width:20%",children:"Einzelpreis"}),l("th",{style:"width:15%;text-align:right",children:"Gesamt"}),l("th",{style:"width:10%"})]})}),l("tbody",{children:n.map((a,o)=>{const u=(parseFloat(a.quantity)||0)*(parseFloat(a.unit_price)||0);return l("tr",{children:[l("td",{children:[l("input",{value:a.description,onInput:h=>t(o,"description",h.target.value),placeholder:"Leistung / Produkt",required:!0}),l("input",{value:a.sub_description||"",onInput:h=>t(o,"sub_description",h.target.value),placeholder:"Zusatzinfo (optional)",style:"margin-top:0.25rem;font-size:0.8rem;color:var(--text-muted)"})]}),l("td",{children:l("input",{type:"number",step:"0.01",min:"0",value:a.quantity,onInput:h=>t(o,"quantity",h.target.value),style:"text-align:right"})}),l("td",{children:l("input",{type:"number",step:"0.01",min:"0",value:a.unit_price,onInput:h=>t(o,"unit_price",h.target.value),style:"text-align:right"})}),l("td",{style:"text-align:right;white-space:nowrap;font-weight:500",children:i(u)}),l("td",{style:"text-align:center",children:l("button",{type:"button",class:"btn btn-danger btn-sm",onClick:()=>s(o),title:"Entfernen",children:"x"})})]},o)})})]})}),l("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:r,style:"margin-top:0.75rem",children:"+ Position"})]})}function F2(){const n=mr(),{settings:e}=Ru(),t=new URLSearchParams(window.location.search),r=t.get("type")||"invoice",s=t.get("deal_id"),i=t.get("quote_id"),a=t.get("edit"),{invoice:o,items:u,loading:h}=pp(a),[f,m]=Ae(!1),[y,p]=Ae([]),[S,_]=Ae([]),[x,w]=Ae({type:r,invoice_number:"",invoice_date:new Date().toISOString().slice(0,10),due_date:"",company_id:"",contact_id:"",deal_id:s||"",customer_company:"",customer_name:"",customer_street:"",customer_zip:"",customer_city:"",customer_number:"",discount_percent:0,vat_rate:19,payment_terms:"Diese Rechnung ist zahlbar innerhalb von 14 Tagen ohne Abzug auf das unten angegebene Bankkonto.",closing_message:"",notes:""}),[O,C]=Ae([{description:"",sub_description:"",quantity:1,unit_price:0}]);qt(()=>{Ne.from("companies").select("id, name, address, city").is("deleted_at",null).order("name").then(({data:I})=>p(I||[])),Ne.from("contacts").select("id, first_name, last_name, email, company_id").is("deleted_at",null).order("last_name").then(({data:I})=>_(I||[]))},[]),qt(()=>{if(e&&!a&&!i){const I=new Date;I.setDate(I.getDate()+(e.default_payment_days||14)),w(L=>({...L,vat_rate:parseFloat(e.vat_rate)||19,due_date:L.due_date||I.toISOString().slice(0,10),closing_message:L.closing_message||e.default_closing_text||""}))}},[e,a,i]),qt(()=>{!s||a||Ne.from("deals").select("*, contact:contacts(id, first_name, last_name), company:companies(id, name, address, city)").eq("id",s).single().then(({data:I})=>{if(!I)return;const L=I.contact?`${I.contact.first_name||""} ${I.contact.last_name||""}`.trim():"";w(R=>{var B,W,Z,ue,he,ie;return{...R,deal_id:I.id,company_id:((B=I.company)==null?void 0:B.id)||"",contact_id:((W=I.contact)==null?void 0:W.id)||"",customer_company:((Z=I.company)==null?void 0:Z.name)||"",customer_name:L,customer_street:((ue=I.company)==null?void 0:ue.address)||"",customer_city:((he=I.company)==null?void 0:he.city)||"",invoice_number:xc(r,L||((ie=I.company)==null?void 0:ie.name))}})})},[s,r,a]),qt(()=>{i&&Promise.all([Ne.from("invoices").select("*").eq("id",i).single(),Ne.from("invoice_items").select("*").eq("invoice_id",i).order("position")]).then(([{data:I},{data:L}])=>{I&&(w(R=>({...R,type:"invoice",invoice_number:xc("invoice",I.customer_name||I.customer_company),company_id:I.company_id||"",contact_id:I.contact_id||"",deal_id:I.deal_id||"",customer_company:I.customer_company||"",customer_name:I.customer_name||"",customer_street:I.customer_street||"",customer_zip:I.customer_zip||"",customer_city:I.customer_city||"",customer_number:I.customer_number||"",discount_percent:I.discount_percent||0,vat_rate:I.vat_rate||19,payment_terms:I.payment_terms||R.payment_terms,closing_message:I.closing_message||R.closing_message,notes:I.notes||""})),L&&L.length>0&&C(L.map(R=>({description:R.description,sub_description:R.sub_description||"",quantity:R.quantity,unit_price:R.unit_price}))))})},[i]),qt(()=>{!a||h||!o||(w({type:o.type,invoice_number:o.invoice_number,invoice_date:o.invoice_date,due_date:o.due_date||"",company_id:o.company_id||"",contact_id:o.contact_id||"",deal_id:o.deal_id||"",customer_company:o.customer_company||"",customer_name:o.customer_name||"",customer_street:o.customer_street||"",customer_zip:o.customer_zip||"",customer_city:o.customer_city||"",customer_number:o.customer_number||"",discount_percent:o.discount_percent||0,vat_rate:o.vat_rate||19,payment_terms:o.payment_terms||"",closing_message:o.closing_message||"",notes:o.notes||""}),u.length>0&&C(u.map(I=>({description:I.description,sub_description:I.sub_description||"",quantity:I.quantity,unit_price:I.unit_price}))))},[a,h,o,u]),qt(()=>{if(a||i||!x.customer_name&&!x.customer_company)return;const I=x.customer_name||x.customer_company;w(L=>({...L,invoice_number:xc(L.type,I)}))},[x.type,x.customer_name,x.customer_company,a,i]);function F(I){const L=y.find(R=>R.id===I);w(R=>({...R,company_id:I,customer_company:(L==null?void 0:L.name)||R.customer_company,customer_street:(L==null?void 0:L.address)||R.customer_street,customer_city:(L==null?void 0:L.city)||R.customer_city}))}function G(I){const L=S.find(B=>B.id===I);if(!L)return;const R=`${L.first_name||""} ${L.last_name||""}`.trim();w(B=>({...B,contact_id:I,customer_name:R,company_id:L.company_id||B.company_id})),L.company_id&&!x.company_id&&F(L.company_id)}const V=x2(O,x.discount_percent,x.vat_rate),re=x.type==="quote",J=a?`${re?"Angebot":"Rechnung"} bearbeiten`:i?"Rechnung aus Angebot erstellen":`Neue${re?"s Angebot":" Rechnung"} erstellen`;async function U(I){if(I.preventDefault(),O.length===0||!O.some(B=>B.description)){n.error("Mindestens eine Position erforderlich");return}m(!0);const L={...x,company_id:x.company_id||null,contact_id:x.contact_id||null,deal_id:x.deal_id||null,subtotal:V.subtotal,net_amount:V.net_amount,vat_amount:V.vat_amount,total_amount:V.total_amount,due_date:x.due_date||null};let R;a?(R=await t2(a,L,O),R.error||(n.success("Gespeichert"),Ve(`/crm/invoices/${a}`))):(i&&(L.converted_from_quote_id=i),R=await e2(L,O),R.error||(n.success(`${re?"Angebot":"Rechnung"} erstellt`),Ve(`/crm/invoices/${R.data.id}`))),R.error&&n.error("Fehler: "+R.error.message),m(!1)}return a&&h?l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Laden..."})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]}):l(bt,{children:[l("div",{class:"page-header",children:l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices"),children:""}),l("h1",{class:"page-title",children:J})]})}),l("div",{class:"page-body",children:l("form",{onSubmit:U,style:"max-width:900px",children:[l("div",{class:"card",style:"margin-bottom:1.5rem",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Dokument"})}),l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Typ"}),l("select",{value:x.type,onChange:I=>w({...x,type:I.target.value}),disabled:!!a||!!i,children:[l("option",{value:"invoice",children:"Rechnung"}),l("option",{value:"quote",children:"Angebot"})]})]}),l("div",{class:"form-group",children:[l("label",{children:re?"Angebotsnr.":"Rechnungsnr."}),l("input",{value:x.invoice_number,onInput:I=>w({...x,invoice_number:I.target.value}),required:!0})]}),l("div",{class:"form-group",children:[l("label",{children:"Datum"}),l("input",{type:"date",value:x.invoice_date,onInput:I=>w({...x,invoice_date:I.target.value}),required:!0})]}),l("div",{class:"form-group",children:[l("label",{children:re?"Gueltig bis":"Faellig am"}),l("input",{type:"date",value:x.due_date,onInput:I=>w({...x,due_date:I.target.value})})]})]})]}),l("div",{class:"card",style:"margin-bottom:1.5rem",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Kunde"})}),l("div",{class:"form-grid",children:[l("div",{class:"form-group",children:[l("label",{children:"Firma (CRM)"}),l("select",{value:x.company_id,onChange:I=>F(I.target.value),children:[l("option",{value:"",children:" Firma waehlen "}),y.map(I=>l("option",{value:I.id,children:I.name},I.id))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Kontakt (CRM)"}),l("select",{value:x.contact_id,onChange:I=>G(I.target.value),children:[l("option",{value:"",children:" Kontakt waehlen "}),S.map(I=>l("option",{value:I.id,children:`${I.first_name||""} ${I.last_name||""}`.trim()||I.email},I.id))]})]}),l("div",{class:"form-group",children:[l("label",{children:"Firmenname (Rechnung)"}),l("input",{value:x.customer_company,onInput:I=>w({...x,customer_company:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Ansprechpartner"}),l("input",{value:x.customer_name,onInput:I=>w({...x,customer_name:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Strasse"}),l("input",{value:x.customer_street,onInput:I=>w({...x,customer_street:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"PLZ"}),l("input",{value:x.customer_zip,onInput:I=>w({...x,customer_zip:I.target.value}),style:"max-width:120px"})]}),l("div",{class:"form-group",children:[l("label",{children:"Stadt"}),l("input",{value:x.customer_city,onInput:I=>w({...x,customer_city:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Kundennummer"}),l("input",{value:x.customer_number,onInput:I=>w({...x,customer_number:I.target.value}),placeholder:"Optional"})]})]})]}),l("div",{class:"card",style:"margin-bottom:1.5rem",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Positionen"})}),l(j2,{items:O,onChange:C})]}),l("div",{class:"card",style:"margin-bottom:1.5rem",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Betraege"})}),l("div",{style:"display:flex;gap:1.5rem;align-items:flex-start",children:[l("div",{style:"flex:1",children:[l("div",{class:"form-group",style:"max-width:200px",children:[l("label",{children:"Rabatt (%)"}),l("input",{type:"number",step:"0.01",min:"0",max:"100",value:x.discount_percent,onInput:I=>w({...x,discount_percent:I.target.value}),style:"text-align:right"})]}),l("div",{class:"form-group",style:"max-width:200px",children:[l("label",{children:"MwSt. (%)"}),l("input",{type:"number",step:"0.01",min:"0",value:x.vat_rate,onInput:I=>w({...x,vat_rate:I.target.value}),style:"text-align:right"})]})]}),l("div",{class:"invoice-totals",children:[l("div",{class:"invoice-totals-row",children:[l("span",{children:"Zwischensumme"}),l("span",{children:Kt(V.subtotal)})]}),parseFloat(x.discount_percent)>0&&l("div",{class:"invoice-totals-row",children:[l("span",{children:["Rabatt (-",x.discount_percent,"%)"]}),l("span",{children:["-",Kt(V.discount_amount)]})]}),l("div",{class:"invoice-totals-row",children:[l("span",{children:"Nettobetrag"}),l("span",{children:Kt(V.net_amount)})]}),l("div",{class:"invoice-totals-row",children:[l("span",{children:[x.vat_rate,"% MwSt."]}),l("span",{children:Kt(V.vat_amount)})]}),l("div",{class:"invoice-totals-row",style:"font-weight:700;font-size:1.1rem;border-top:2px solid var(--border);padding-top:0.5rem",children:[l("span",{children:"Gesamtbetrag"}),l("span",{children:Kt(V.total_amount)})]})]})]})]}),l("div",{class:"card",style:"margin-bottom:1.5rem",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Texte"})}),l("div",{class:"form-group",children:[l("label",{children:"Zahlungsbedingungen"}),l("textarea",{value:x.payment_terms,onInput:I=>w({...x,payment_terms:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Schlussnachricht"}),l("textarea",{value:x.closing_message,onInput:I=>w({...x,closing_message:I.target.value})})]}),l("div",{class:"form-group",children:[l("label",{children:"Interne Notizen"}),l("textarea",{value:x.notes,onInput:I=>w({...x,notes:I.target.value}),placeholder:"Nur intern sichtbar"})]})]}),l("div",{class:"form-actions",children:[l("button",{type:"button",class:"btn btn-secondary",onClick:()=>Ve("/crm/invoices"),children:"Abbrechen"}),l("button",{type:"submit",class:"btn btn-primary",disabled:f,children:f?"Speichern...":a?"Speichern":"Erstellen"})]})]})})]})}const D2="modulepreload",B2=function(n){return"/crm/"+n},md={},kc=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let a=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(t.map(h=>{if(h=B2(h),h in md)return;md[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":D2,f||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),f)return new Promise((p,S)=>{y.addEventListener("load",p),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function Tt(n){"@babel/helpers - typeof";return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(n)}var Pr=Uint8Array,sr=Uint16Array,qu=Int32Array,$u=new Pr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zu=new Pr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vd=new Pr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yp=function(n,e){for(var t=new sr(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var s=new qu(t[30]),r=1;r<30;++r)for(var i=t[r];i<t[r+1];++i)s[i]=i-t[r]<<5|r;return{b:t,r:s}},_p=yp($u,2),U2=_p.b,pu=_p.r;U2[28]=258,pu[258]=28;var M2=yp(zu,0),bd=M2.r,gu=new sr(32768);for(var zt=0;zt<32768;++zt){var Oi=(zt&43690)>>1|(zt&21845)<<1;Oi=(Oi&52428)>>2|(Oi&13107)<<2,Oi=(Oi&61680)>>4|(Oi&3855)<<4,gu[zt]=((Oi&65280)>>8|(Oi&255)<<8)>>1}var Va=(function(n,e,t){for(var r=n.length,s=0,i=new sr(e);s<r;++s)n[s]&&++i[n[s]-1];var a=new sr(e);for(s=1;s<e;++s)a[s]=a[s-1]+i[s-1]<<1;var o;if(t){o=new sr(1<<e);var u=15-e;for(s=0;s<r;++s)if(n[s])for(var h=s<<4|n[s],f=e-n[s],m=a[n[s]-1]++<<f,y=m|(1<<f)-1;m<=y;++m)o[gu[m]>>u]=h}else for(o=new sr(r),s=0;s<r;++s)n[s]&&(o[s]=gu[a[n[s]-1]++]>>15-n[s]);return o}),vs=new Pr(288);for(var zt=0;zt<144;++zt)vs[zt]=8;for(var zt=144;zt<256;++zt)vs[zt]=9;for(var zt=256;zt<280;++zt)vs[zt]=7;for(var zt=280;zt<288;++zt)vs[zt]=8;var xl=new Pr(32);for(var zt=0;zt<32;++zt)xl[zt]=5;var q2=Va(vs,9,0),$2=Va(xl,5,0),wp=function(n){return(n+7)/8|0},z2=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Pr(n.subarray(e,t))},ui=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},Ua=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},Nc=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var s=t.length,i=t.slice();if(!s)return{t:Sp,l:0};if(s==1){var a=new Pr(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(G,V){return G.f-V.f}),t.push({s:-1,f:25001});var o=t[0],u=t[1],h=0,f=1,m=2;for(t[0]={s:-1,f:o.f+u.f,l:o,r:u};f!=s-1;)o=t[t[h].f<t[m].f?h++:m++],u=t[h!=f&&t[h].f<t[m].f?h++:m++],t[f++]={s:-1,f:o.f+u.f,l:o,r:u};for(var y=i[0].s,r=1;r<s;++r)i[r].s>y&&(y=i[r].s);var p=new sr(y+1),S=mu(t[f-1],p,0);if(S>e){var r=0,_=0,x=S-e,w=1<<x;for(i.sort(function(V,re){return p[re.s]-p[V.s]||V.f-re.f});r<s;++r){var O=i[r].s;if(p[O]>e)_+=w-(1<<S-p[O]),p[O]=e;else break}for(_>>=x;_>0;){var C=i[r].s;p[C]<e?_-=1<<e-p[C]++-1:++r}for(;r>=0&&_;--r){var F=i[r].s;p[F]==e&&(--p[F],++_)}S=e}return{t:new Pr(p),l:S}},mu=function(n,e,t){return n.s==-1?Math.max(mu(n.l,e,t+1),mu(n.r,e,t+1)):e[n.s]=t},yd=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new sr(++e),r=0,s=n[0],i=1,a=function(u){t[r++]=u},o=1;o<=e;++o)if(n[o]==s&&o!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=n[o]}return{c:t.subarray(0,r),n:e}},Ma=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},xp=function(n,e,t){var r=t.length,s=wp(e+2);n[s]=r&255,n[s+1]=r>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var i=0;i<r;++i)n[s+i+4]=t[i];return(s+4+r)*8},_d=function(n,e,t,r,s,i,a,o,u,h,f){ui(e,f++,t),++s[256];for(var m=Nc(s,15),y=m.t,p=m.l,S=Nc(i,15),_=S.t,x=S.l,w=yd(y),O=w.c,C=w.n,F=yd(_),G=F.c,V=F.n,re=new sr(19),J=0;J<O.length;++J)++re[O[J]&31];for(var J=0;J<G.length;++J)++re[G[J]&31];for(var U=Nc(re,7),I=U.t,L=U.l,R=19;R>4&&!I[vd[R-1]];--R);var B=h+5<<3,W=Ma(s,vs)+Ma(i,xl)+a,Z=Ma(s,y)+Ma(i,_)+a+14+3*R+Ma(re,I)+2*re[16]+3*re[17]+7*re[18];if(u>=0&&B<=W&&B<=Z)return xp(e,f,n.subarray(u,u+h));var ue,he,ie,de;if(ui(e,f,1+(Z<W)),f+=2,Z<W){ue=Va(y,p,0),he=y,ie=Va(_,x,0),de=_;var ke=Va(I,L,0);ui(e,f,C-257),ui(e,f+5,V-1),ui(e,f+10,R-4),f+=14;for(var J=0;J<R;++J)ui(e,f+3*J,I[vd[J]]);f+=3*R;for(var be=[O,G],E=0;E<2;++E)for(var z=be[E],J=0;J<z.length;++J){var H=z[J]&31;ui(e,f,ke[H]),f+=I[H],H>15&&(ui(e,f,z[J]>>5&127),f+=z[J]>>12)}}else ue=q2,he=vs,ie=$2,de=xl;for(var J=0;J<o;++J){var Y=r[J];if(Y>255){var H=Y>>18&31;Ua(e,f,ue[H+257]),f+=he[H+257],H>7&&(ui(e,f,Y>>23&31),f+=$u[H]);var ee=Y&31;Ua(e,f,ie[ee]),f+=de[ee],ee>3&&(Ua(e,f,Y>>5&8191),f+=zu[ee])}else Ua(e,f,ue[Y]),f+=he[Y]}return Ua(e,f,ue[256]),f+he[256]},W2=new qu([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sp=new Pr(0),H2=function(n,e,t,r,s,i){var a=i.z||n.length,o=new Pr(r+a+5*(1+Math.ceil(a/7e3))+s),u=o.subarray(r,o.length-s),h=i.l,f=(i.r||0)&7;if(e){f&&(u[0]=i.r>>3);for(var m=W2[e-1],y=m>>13,p=m&8191,S=(1<<t)-1,_=i.p||new sr(32768),x=i.h||new sr(S+1),w=Math.ceil(t/3),O=2*w,C=function(ze){return(n[ze]^n[ze+1]<<w^n[ze+2]<<O)&S},F=new qu(25e3),G=new sr(288),V=new sr(32),re=0,J=0,U=i.i||0,I=0,L=i.w||0,R=0;U+2<a;++U){var B=C(U),W=U&32767,Z=x[B];if(_[W]=Z,x[B]=W,L<=U){var ue=a-U;if((re>7e3||I>24576)&&(ue>423||!h)){f=_d(n,u,0,F,G,V,J,I,R,U-R,f),I=re=J=0,R=U;for(var he=0;he<286;++he)G[he]=0;for(var he=0;he<30;++he)V[he]=0}var ie=2,de=0,ke=p,be=W-Z&32767;if(ue>2&&B==C(U-be))for(var E=Math.min(y,ue)-1,z=Math.min(32767,U),H=Math.min(258,ue);be<=z&&--ke&&W!=Z;){if(n[U+ie]==n[U+ie-be]){for(var Y=0;Y<H&&n[U+Y]==n[U+Y-be];++Y);if(Y>ie){if(ie=Y,de=be,Y>E)break;for(var ee=Math.min(be,Y-2),te=0,he=0;he<ee;++he){var le=U-be+he&32767,ce=_[le],ve=le-ce&32767;ve>te&&(te=ve,Z=le)}}}W=Z,Z=_[W],be+=W-Z&32767}if(de){F[I++]=268435456|pu[ie]<<18|bd[de];var Se=pu[ie]&31,Ce=bd[de]&31;J+=$u[Se]+zu[Ce],++G[257+Se],++V[Ce],L=U+ie,++re}else F[I++]=n[U],++G[n[U]]}}for(U=Math.max(U,L);U<a;++U)F[I++]=n[U],++G[n[U]];f=_d(n,u,h,F,G,V,J,I,R,U-R,f),h||(i.r=f&7|u[f/8|0]<<3,f-=7,i.h=x,i.p=_,i.i=U,i.w=L)}else{for(var U=i.w||0;U<a+h;U+=65535){var Pe=U+65535;Pe>=a&&(u[f/8|0]=h,Pe=a),f=xp(u,f+1,n.subarray(U,Pe))}i.i=a}return z2(o,0,r+wp(f)+s)},Ap=function(){var n=1,e=0;return{p:function(t){for(var r=n,s=e,i=t.length|0,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)s+=r+=t[a];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}n=r,e=s},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},V2=function(n,e,t,r,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new Pr(i.length+n.length);a.set(i),a.set(n,i.length),n=a,s.w=i.length}return H2(n,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,s)},kp=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},G2=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var s=Ap();s.p(e.dictionary),kp(n,2,s.d())}};function vu(n,e){e||(e={});var t=Ap();t.p(n);var r=V2(n,e,e.dictionary?6:2,4);return G2(r,e),kp(r,r.length-4,t.d()),r}var K2=typeof TextDecoder<"u"&&new TextDecoder,J2=0;try{K2.decode(Sp,{stream:!0}),J2=1}catch{}function Y2(n){if(Array.isArray(n))return n}function X2(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,s,i,a,o=[],u=!0,h=!1;try{if(i=(t=t.call(n)).next,e!==0)for(;!(u=(r=i.call(t)).done)&&(o.push(r.value),o.length!==e);u=!0);}catch(f){h=!0,s=f}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(h)throw s}}return o}}function wd(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function Z2(n,e){if(n){if(typeof n=="string")return wd(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?wd(n,e):void 0}}function Q2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xd(n,e){return Y2(n)||X2(n,e)||Z2(n,e)||Q2()}function Sd(n,e="utf8"){return new TextDecoder(e).decode(n)}const e5=new TextEncoder;function t5(n){return e5.encode(n)}const n5=1024*8,r5=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),Lc={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Wu{constructor(e=n5,t={}){It(this,"buffer");It(this,"byteLength");It(this,"byteOffset");It(this,"length");It(this,"offset");It(this,"lastWrittenByte");It(this,"littleEndian");It(this,"_data");It(this,"_mark");It(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const s=t.offset?t.offset>>>0:0,i=e.byteLength-s;let a=s;(ArrayBuffer.isView(e)||e instanceof Wu)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+s),e=e.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,s=new Uint8Array(r);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const r=Lc[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+r);if(this.littleEndian===r5&&t!=="uint8"&&t!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+r));o.reverse();const u=new Lc[t](o.buffer);return this.offset+=r,u.reverse(),u}const a=new Lc[t](i);return this.offset+=r,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return Sd(this.readBytes(e))}decodeText(e=1,t="utf8"){return Sd(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(t5(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function la(n){let e=n.length;for(;--e>=0;)n[e]=0}const i5=3,s5=258,Np=29,a5=256,o5=a5+1+Np,Lp=30,l5=512,c5=new Array((o5+2)*2);la(c5);const u5=new Array(Lp*2);la(u5);const h5=new Array(l5);la(h5);const d5=new Array(s5-i5+1);la(d5);const f5=new Array(Np);la(f5);const p5=new Array(Lp);la(p5);const g5=(n,e,t,r)=>{let s=n&65535|0,i=n>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do s=s+e[r++]|0,i=i+s|0;while(--a);s%=65521,i%=65521}return s|i<<16|0};var bu=g5;const m5=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},v5=new Uint32Array(m5()),b5=(n,e,t,r)=>{const s=v5,i=r+t;n^=-1;for(let a=r;a<i;a++)n=n>>>8^s[(n^e[a])&255];return n^-1};var qr=b5,yu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ep={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const y5=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var _5=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)y5(t,r)&&(n[r]=t[r])}}return n},w5=n=>{let e=0;for(let r=0,s=n.length;r<s;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,s=0,i=n.length;r<i;r++){let a=n[r];t.set(a,s),s+=a.length}return t},Pp={assign:_5,flattenChunks:w5};let Cp=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Cp=!1}const to=new Uint8Array(256);for(let n=0;n<256;n++)to[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;to[254]=to[254]=1;var x5=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,s,i,a=n.length,o=0;for(s=0;s<a;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<a&&(r=n.charCodeAt(s+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),s++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),i=0,s=0;i<o;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<a&&(r=n.charCodeAt(s+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),s++)),t<128?e[i++]=t:t<2048?(e[i++]=192|t>>>6,e[i++]=128|t&63):t<65536?(e[i++]=224|t>>>12,e[i++]=128|t>>>6&63,e[i++]=128|t&63):(e[i++]=240|t>>>18,e[i++]=128|t>>>12&63,e[i++]=128|t>>>6&63,e[i++]=128|t&63);return e};const S5=(n,e)=>{if(e<65534&&n.subarray&&Cp)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var A5=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,s;const i=new Array(t*2);for(s=0,r=0;r<t;){let a=n[r++];if(a<128){i[s++]=a;continue}let o=to[a];if(o>4){i[s++]=65533,r+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&r<t;)a=a<<6|n[r++]&63,o--;if(o>1){i[s++]=65533;continue}a<65536?i[s++]=a:(a-=65536,i[s++]=55296|a>>10&1023,i[s++]=56320|a&1023)}return S5(i,s)},k5=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+to[n[t]]>e?t:e},_u={string2buf:x5,buf2string:A5,utf8border:k5};function N5(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var L5=N5;const el=16209,E5=16191;var P5=function(e,t){let r,s,i,a,o,u,h,f,m,y,p,S,_,x,w,O,C,F,G,V,re,J,U,I;const L=e.state;r=e.next_in,U=e.input,s=r+(e.avail_in-5),i=e.next_out,I=e.output,a=i-(t-e.avail_out),o=i+(e.avail_out-257),u=L.dmax,h=L.wsize,f=L.whave,m=L.wnext,y=L.window,p=L.hold,S=L.bits,_=L.lencode,x=L.distcode,w=(1<<L.lenbits)-1,O=(1<<L.distbits)-1;e:do{S<15&&(p+=U[r++]<<S,S+=8,p+=U[r++]<<S,S+=8),C=_[p&w];t:for(;;){if(F=C>>>24,p>>>=F,S-=F,F=C>>>16&255,F===0)I[i++]=C&65535;else if(F&16){G=C&65535,F&=15,F&&(S<F&&(p+=U[r++]<<S,S+=8),G+=p&(1<<F)-1,p>>>=F,S-=F),S<15&&(p+=U[r++]<<S,S+=8,p+=U[r++]<<S,S+=8),C=x[p&O];n:for(;;){if(F=C>>>24,p>>>=F,S-=F,F=C>>>16&255,F&16){if(V=C&65535,F&=15,S<F&&(p+=U[r++]<<S,S+=8,S<F&&(p+=U[r++]<<S,S+=8)),V+=p&(1<<F)-1,V>u){e.msg="invalid distance too far back",L.mode=el;break e}if(p>>>=F,S-=F,F=i-a,V>F){if(F=V-F,F>f&&L.sane){e.msg="invalid distance too far back",L.mode=el;break e}if(re=0,J=y,m===0){if(re+=h-F,F<G){G-=F;do I[i++]=y[re++];while(--F);re=i-V,J=I}}else if(m<F){if(re+=h+m-F,F-=m,F<G){G-=F;do I[i++]=y[re++];while(--F);if(re=0,m<G){F=m,G-=F;do I[i++]=y[re++];while(--F);re=i-V,J=I}}}else if(re+=m-F,F<G){G-=F;do I[i++]=y[re++];while(--F);re=i-V,J=I}for(;G>2;)I[i++]=J[re++],I[i++]=J[re++],I[i++]=J[re++],G-=3;G&&(I[i++]=J[re++],G>1&&(I[i++]=J[re++]))}else{re=i-V;do I[i++]=I[re++],I[i++]=I[re++],I[i++]=I[re++],G-=3;while(G>2);G&&(I[i++]=I[re++],G>1&&(I[i++]=I[re++]))}}else if((F&64)===0){C=x[(C&65535)+(p&(1<<F)-1)];continue n}else{e.msg="invalid distance code",L.mode=el;break e}break}}else if((F&64)===0){C=_[(C&65535)+(p&(1<<F)-1)];continue t}else if(F&32){L.mode=E5;break e}else{e.msg="invalid literal/length code",L.mode=el;break e}break}}while(r<s&&i<o);G=S>>3,r-=G,S-=G<<3,p&=(1<<S)-1,e.next_in=r,e.next_out=i,e.avail_in=r<s?5+(s-r):5-(r-s),e.avail_out=i<o?257+(o-i):257-(i-o),L.hold=p,L.bits=S};const qs=15,Ad=852,kd=592,Nd=0,Ec=1,Ld=2,C5=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),I5=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),T5=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),O5=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),R5=(n,e,t,r,s,i,a,o)=>{const u=o.bits;let h=0,f=0,m=0,y=0,p=0,S=0,_=0,x=0,w=0,O=0,C,F,G,V,re,J=null,U;const I=new Uint16Array(qs+1),L=new Uint16Array(qs+1);let R=null,B,W,Z;for(h=0;h<=qs;h++)I[h]=0;for(f=0;f<r;f++)I[e[t+f]]++;for(p=u,y=qs;y>=1&&I[y]===0;y--);if(p>y&&(p=y),y===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<y&&I[m]===0;m++);for(p<m&&(p=m),x=1,h=1;h<=qs;h++)if(x<<=1,x-=I[h],x<0)return-1;if(x>0&&(n===Nd||y!==1))return-1;for(L[1]=0,h=1;h<qs;h++)L[h+1]=L[h]+I[h];for(f=0;f<r;f++)e[t+f]!==0&&(a[L[e[t+f]]++]=f);if(n===Nd?(J=R=a,U=20):n===Ec?(J=C5,R=I5,U=257):(J=T5,R=O5,U=0),O=0,f=0,h=m,re=i,S=p,_=0,G=-1,w=1<<p,V=w-1,n===Ec&&w>Ad||n===Ld&&w>kd)return 1;for(;;){B=h-_,a[f]+1<U?(W=0,Z=a[f]):a[f]>=U?(W=R[a[f]-U],Z=J[a[f]-U]):(W=96,Z=0),C=1<<h-_,F=1<<S,m=F;do F-=C,s[re+(O>>_)+F]=B<<24|W<<16|Z|0;while(F!==0);for(C=1<<h-1;O&C;)C>>=1;if(C!==0?(O&=C-1,O+=C):O=0,f++,--I[h]===0){if(h===y)break;h=e[t+a[f]]}if(h>p&&(O&V)!==G){for(_===0&&(_=p),re+=m,S=h-_,x=1<<S;S+_<y&&(x-=I[S+_],!(x<=0));)S++,x<<=1;if(w+=1<<S,n===Ec&&w>Ad||n===Ld&&w>kd)return 1;G=O&V,s[G]=p<<24|S<<16|re-i|0}}return O!==0&&(s[re+O]=h-_<<24|64<<16|0),o.bits=p,0};var Ga=R5;const j5=0,Ip=1,Tp=2,{Z_FINISH:Ed,Z_BLOCK:F5,Z_TREES:tl,Z_OK:bs,Z_STREAM_END:D5,Z_NEED_DICT:B5,Z_STREAM_ERROR:gr,Z_DATA_ERROR:Op,Z_MEM_ERROR:Rp,Z_BUF_ERROR:U5,Z_DEFLATED:Pd}=Ep,Rl=16180,Cd=16181,Id=16182,Td=16183,Od=16184,Rd=16185,jd=16186,Fd=16187,Dd=16188,Bd=16189,Sl=16190,hi=16191,Pc=16192,Ud=16193,Cc=16194,Md=16195,qd=16196,$d=16197,zd=16198,nl=16199,rl=16200,Wd=16201,Hd=16202,Vd=16203,Gd=16204,Kd=16205,Ic=16206,Jd=16207,Yd=16208,Vt=16209,jp=16210,Fp=16211,M5=852,q5=592,$5=15,z5=$5,Xd=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function W5(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _s=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<Rl||e.mode>Fp?1:0},Dp=n=>{if(_s(n))return gr;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=Rl,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(M5),e.distcode=e.distdyn=new Int32Array(q5),e.sane=1,e.back=-1,bs},Bp=n=>{if(_s(n))return gr;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,Dp(n)},Up=(n,e)=>{let t;if(_s(n))return gr;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?gr:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,Bp(n))},Mp=(n,e)=>{if(!n)return gr;const t=new W5;n.state=t,t.strm=n,t.window=null,t.mode=Rl;const r=Up(n,e);return r!==bs&&(n.state=null),r},H5=n=>Mp(n,z5);let Zd=!0,Tc,Oc;const V5=n=>{if(Zd){Tc=new Int32Array(512),Oc=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Ga(Ip,n.lens,0,288,Tc,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Ga(Tp,n.lens,0,32,Oc,0,n.work,{bits:5}),Zd=!1}n.lencode=Tc,n.lenbits=9,n.distcode=Oc,n.distbits=5},qp=(n,e,t,r)=>{let s;const i=n.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(e.subarray(t-i.wsize,t),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(e.subarray(t-r,t-r+s),i.wnext),r-=s,r?(i.window.set(e.subarray(t-r,t),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},G5=(n,e)=>{let t,r,s,i,a,o,u,h,f,m,y,p,S,_,x=0,w,O,C,F,G,V,re,J;const U=new Uint8Array(4);let I,L;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_s(n)||!n.output||!n.input&&n.avail_in!==0)return gr;t=n.state,t.mode===hi&&(t.mode=Pc),a=n.next_out,s=n.output,u=n.avail_out,i=n.next_in,r=n.input,o=n.avail_in,h=t.hold,f=t.bits,m=o,y=u,J=bs;e:for(;;)switch(t.mode){case Rl:if(t.wrap===0){t.mode=Pc;break}for(;f<16;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(t.wrap&2&&h===35615){t.wbits===0&&(t.wbits=15),t.check=0,U[0]=h&255,U[1]=h>>>8&255,t.check=qr(t.check,U,2,0),h=0,f=0,t.mode=Cd;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((h&255)<<8)+(h>>8))%31){n.msg="incorrect header check",t.mode=Vt;break}if((h&15)!==Pd){n.msg="unknown compression method",t.mode=Vt;break}if(h>>>=4,f-=4,re=(h&15)+8,t.wbits===0&&(t.wbits=re),re>15||re>t.wbits){n.msg="invalid window size",t.mode=Vt;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=h&512?Bd:hi,h=0,f=0;break;case Cd:for(;f<16;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(t.flags=h,(t.flags&255)!==Pd){n.msg="unknown compression method",t.mode=Vt;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Vt;break}t.head&&(t.head.text=h>>8&1),t.flags&512&&t.wrap&4&&(U[0]=h&255,U[1]=h>>>8&255,t.check=qr(t.check,U,2,0)),h=0,f=0,t.mode=Id;case Id:for(;f<32;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.head&&(t.head.time=h),t.flags&512&&t.wrap&4&&(U[0]=h&255,U[1]=h>>>8&255,U[2]=h>>>16&255,U[3]=h>>>24&255,t.check=qr(t.check,U,4,0)),h=0,f=0,t.mode=Td;case Td:for(;f<16;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.head&&(t.head.xflags=h&255,t.head.os=h>>8),t.flags&512&&t.wrap&4&&(U[0]=h&255,U[1]=h>>>8&255,t.check=qr(t.check,U,2,0)),h=0,f=0,t.mode=Od;case Od:if(t.flags&1024){for(;f<16;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.length=h,t.head&&(t.head.extra_len=h),t.flags&512&&t.wrap&4&&(U[0]=h&255,U[1]=h>>>8&255,t.check=qr(t.check,U,2,0)),h=0,f=0}else t.head&&(t.head.extra=null);t.mode=Rd;case Rd:if(t.flags&1024&&(p=t.length,p>o&&(p=o),p&&(t.head&&(re=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(i,i+p),re)),t.flags&512&&t.wrap&4&&(t.check=qr(t.check,r,p,i)),o-=p,i+=p,t.length-=p),t.length))break e;t.length=0,t.mode=jd;case jd:if(t.flags&2048){if(o===0)break e;p=0;do re=r[i+p++],t.head&&re&&t.length<65536&&(t.head.name+=String.fromCharCode(re));while(re&&p<o);if(t.flags&512&&t.wrap&4&&(t.check=qr(t.check,r,p,i)),o-=p,i+=p,re)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Fd;case Fd:if(t.flags&4096){if(o===0)break e;p=0;do re=r[i+p++],t.head&&re&&t.length<65536&&(t.head.comment+=String.fromCharCode(re));while(re&&p<o);if(t.flags&512&&t.wrap&4&&(t.check=qr(t.check,r,p,i)),o-=p,i+=p,re)break e}else t.head&&(t.head.comment=null);t.mode=Dd;case Dd:if(t.flags&512){for(;f<16;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(t.wrap&4&&h!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Vt;break}h=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=hi;break;case Bd:for(;f<32;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}n.adler=t.check=Xd(h),h=0,f=0,t.mode=Sl;case Sl:if(t.havedict===0)return n.next_out=a,n.avail_out=u,n.next_in=i,n.avail_in=o,t.hold=h,t.bits=f,B5;n.adler=t.check=1,t.mode=hi;case hi:if(e===F5||e===tl)break e;case Pc:if(t.last){h>>>=f&7,f-=f&7,t.mode=Ic;break}for(;f<3;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}switch(t.last=h&1,h>>>=1,f-=1,h&3){case 0:t.mode=Ud;break;case 1:if(V5(t),t.mode=nl,e===tl){h>>>=2,f-=2;break e}break;case 2:t.mode=qd;break;case 3:n.msg="invalid block type",t.mode=Vt}h>>>=2,f-=2;break;case Ud:for(h>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if((h&65535)!==(h>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Vt;break}if(t.length=h&65535,h=0,f=0,t.mode=Cc,e===tl)break e;case Cc:t.mode=Md;case Md:if(p=t.length,p){if(p>o&&(p=o),p>u&&(p=u),p===0)break e;s.set(r.subarray(i,i+p),a),o-=p,i+=p,u-=p,a+=p,t.length-=p;break}t.mode=hi;break;case qd:for(;f<14;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(t.nlen=(h&31)+257,h>>>=5,f-=5,t.ndist=(h&31)+1,h>>>=5,f-=5,t.ncode=(h&15)+4,h>>>=4,f-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Vt;break}t.have=0,t.mode=$d;case $d:for(;t.have<t.ncode;){for(;f<3;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.lens[R[t.have++]]=h&7,h>>>=3,f-=3}for(;t.have<19;)t.lens[R[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},J=Ga(j5,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,J){n.msg="invalid code lengths set",t.mode=Vt;break}t.have=0,t.mode=zd;case zd:for(;t.have<t.nlen+t.ndist;){for(;x=t.lencode[h&(1<<t.lenbits)-1],w=x>>>24,O=x>>>16&255,C=x&65535,!(w<=f);){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(C<16)h>>>=w,f-=w,t.lens[t.have++]=C;else{if(C===16){for(L=w+2;f<L;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(h>>>=w,f-=w,t.have===0){n.msg="invalid bit length repeat",t.mode=Vt;break}re=t.lens[t.have-1],p=3+(h&3),h>>>=2,f-=2}else if(C===17){for(L=w+3;f<L;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}h>>>=w,f-=w,re=0,p=3+(h&7),h>>>=3,f-=3}else{for(L=w+7;f<L;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}h>>>=w,f-=w,re=0,p=11+(h&127),h>>>=7,f-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Vt;break}for(;p--;)t.lens[t.have++]=re}}if(t.mode===Vt)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Vt;break}if(t.lenbits=9,I={bits:t.lenbits},J=Ga(Ip,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,J){n.msg="invalid literal/lengths set",t.mode=Vt;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},J=Ga(Tp,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,J){n.msg="invalid distances set",t.mode=Vt;break}if(t.mode=nl,e===tl)break e;case nl:t.mode=rl;case rl:if(o>=6&&u>=258){n.next_out=a,n.avail_out=u,n.next_in=i,n.avail_in=o,t.hold=h,t.bits=f,P5(n,y),a=n.next_out,s=n.output,u=n.avail_out,i=n.next_in,r=n.input,o=n.avail_in,h=t.hold,f=t.bits,t.mode===hi&&(t.back=-1);break}for(t.back=0;x=t.lencode[h&(1<<t.lenbits)-1],w=x>>>24,O=x>>>16&255,C=x&65535,!(w<=f);){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(O&&(O&240)===0){for(F=w,G=O,V=C;x=t.lencode[V+((h&(1<<F+G)-1)>>F)],w=x>>>24,O=x>>>16&255,C=x&65535,!(F+w<=f);){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}h>>>=F,f-=F,t.back+=F}if(h>>>=w,f-=w,t.back+=w,t.length=C,O===0){t.mode=Kd;break}if(O&32){t.back=-1,t.mode=hi;break}if(O&64){n.msg="invalid literal/length code",t.mode=Vt;break}t.extra=O&15,t.mode=Wd;case Wd:if(t.extra){for(L=t.extra;f<L;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.length+=h&(1<<t.extra)-1,h>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Hd;case Hd:for(;x=t.distcode[h&(1<<t.distbits)-1],w=x>>>24,O=x>>>16&255,C=x&65535,!(w<=f);){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if((O&240)===0){for(F=w,G=O,V=C;x=t.distcode[V+((h&(1<<F+G)-1)>>F)],w=x>>>24,O=x>>>16&255,C=x&65535,!(F+w<=f);){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}h>>>=F,f-=F,t.back+=F}if(h>>>=w,f-=w,t.back+=w,O&64){n.msg="invalid distance code",t.mode=Vt;break}t.offset=C,t.extra=O&15,t.mode=Vd;case Vd:if(t.extra){for(L=t.extra;f<L;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}t.offset+=h&(1<<t.extra)-1,h>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Vt;break}t.mode=Gd;case Gd:if(u===0)break e;if(p=y-u,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Vt;break}p>t.wnext?(p-=t.wnext,S=t.wsize-p):S=t.wnext-p,p>t.length&&(p=t.length),_=t.window}else _=s,S=a-t.offset,p=t.length;p>u&&(p=u),u-=p,t.length-=p;do s[a++]=_[S++];while(--p);t.length===0&&(t.mode=rl);break;case Kd:if(u===0)break e;s[a++]=t.length,u--,t.mode=rl;break;case Ic:if(t.wrap){for(;f<32;){if(o===0)break e;o--,h|=r[i++]<<f,f+=8}if(y-=u,n.total_out+=y,t.total+=y,t.wrap&4&&y&&(n.adler=t.check=t.flags?qr(t.check,s,y,a-y):bu(t.check,s,y,a-y)),y=u,t.wrap&4&&(t.flags?h:Xd(h))!==t.check){n.msg="incorrect data check",t.mode=Vt;break}h=0,f=0}t.mode=Jd;case Jd:if(t.wrap&&t.flags){for(;f<32;){if(o===0)break e;o--,h+=r[i++]<<f,f+=8}if(t.wrap&4&&h!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Vt;break}h=0,f=0}t.mode=Yd;case Yd:J=D5;break e;case Vt:J=Op;break e;case jp:return Rp;case Fp:default:return gr}return n.next_out=a,n.avail_out=u,n.next_in=i,n.avail_in=o,t.hold=h,t.bits=f,(t.wsize||y!==n.avail_out&&t.mode<Vt&&(t.mode<Ic||e!==Ed))&&qp(n,n.output,n.next_out,y-n.avail_out),m-=n.avail_in,y-=n.avail_out,n.total_in+=m,n.total_out+=y,t.total+=y,t.wrap&4&&y&&(n.adler=t.check=t.flags?qr(t.check,s,y,n.next_out-y):bu(t.check,s,y,n.next_out-y)),n.data_type=t.bits+(t.last?64:0)+(t.mode===hi?128:0)+(t.mode===nl||t.mode===Cc?256:0),(m===0&&y===0||e===Ed)&&J===bs&&(J=U5),J},K5=n=>{if(_s(n))return gr;let e=n.state;return e.window&&(e.window=null),n.state=null,bs},J5=(n,e)=>{if(_s(n))return gr;const t=n.state;return(t.wrap&2)===0?gr:(t.head=e,e.done=!1,bs)},Y5=(n,e)=>{const t=e.length;let r,s,i;return _s(n)||(r=n.state,r.wrap!==0&&r.mode!==Sl)?gr:r.mode===Sl&&(s=1,s=bu(s,e,t,0),s!==r.check)?Op:(i=qp(n,e,t,t),i?(r.mode=jp,Rp):(r.havedict=1,bs))};var X5=Bp,Z5=Up,Q5=Dp,ev=H5,tv=Mp,nv=G5,rv=K5,iv=J5,sv=Y5,av="pako inflate (from Nodeca project)",pi={inflateReset:X5,inflateReset2:Z5,inflateResetKeep:Q5,inflateInit:ev,inflateInit2:tv,inflate:nv,inflateEnd:rv,inflateGetHeader:iv,inflateSetDictionary:sv,inflateInfo:av};function ov(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var lv=ov;const $p=Object.prototype.toString,{Z_NO_FLUSH:cv,Z_FINISH:uv,Z_OK:no,Z_STREAM_END:Rc,Z_NEED_DICT:jc,Z_STREAM_ERROR:hv,Z_DATA_ERROR:Qd,Z_MEM_ERROR:dv}=Ep;function ao(n){this.options=Pp.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L5,this.strm.avail_out=0;let t=pi.inflateInit2(this.strm,e.windowBits);if(t!==no)throw new Error(yu[t]);if(this.header=new lv,pi.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_u.string2buf(e.dictionary):$p.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=pi.inflateSetDictionary(this.strm,e.dictionary),t!==no)))throw new Error(yu[t])}ao.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?uv:cv,$p.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),i=pi.inflate(t,a),i===jc&&s&&(i=pi.inflateSetDictionary(t,s),i===no?i=pi.inflate(t,a):i===Qd&&(i=jc));t.avail_in>0&&i===Rc&&t.state.wrap>0&&n[t.next_in]!==0;)pi.inflateReset(t),i=pi.inflate(t,a);switch(i){case hv:case Qd:case jc:case dv:return this.onEnd(i),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||i===Rc))if(this.options.to==="string"){let u=_u.utf8border(t.output,t.next_out),h=t.next_out-u,f=_u.buf2string(t.output,u);t.next_out=h,t.avail_out=r-h,h&&t.output.set(t.output.subarray(u,u+h),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(i===no&&o===0)){if(i===Rc)return i=pi.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};ao.prototype.onData=function(n){this.chunks.push(n)};ao.prototype.onEnd=function(n){n===no&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Pp.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function fv(n,e){const t=new ao(e);if(t.push(n),t.err)throw t.msg||yu[t.err];return t.result}var pv=ao,gv=fv,mv={Inflate:pv,inflate:gv};const{Inflate:vv,inflate:bv}=mv;var ef=vv,yv=bv;const zp=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;zp[n]=e}const tf=4294967295;function _v(n,e,t){let r=n;for(let s=0;s<t;s++)r=zp[(r^e[s])&255]^r>>>8;return r}function wv(n,e){return(_v(tf,n,e)^tf)>>>0}function nf(n,e,t){const r=n.readUint32(),s=wv(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(s!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${s}`)}function Wp(n,e,t){for(let r=0;r<t;r++)e[r]=n[r]}function Hp(n,e,t,r){let s=0;for(;s<r;s++)e[s]=n[s];for(;s<t;s++)e[s]=n[s]+e[s-r]&255}function Vp(n,e,t,r){let s=0;if(t.length===0)for(;s<r;s++)e[s]=n[s];else for(;s<r;s++)e[s]=n[s]+t[s]&255}function Gp(n,e,t,r,s){let i=0;if(t.length===0){for(;i<s;i++)e[i]=n[i];for(;i<r;i++)e[i]=n[i]+(e[i-s]>>1)&255}else{for(;i<s;i++)e[i]=n[i]+(t[i]>>1)&255;for(;i<r;i++)e[i]=n[i]+(e[i-s]+t[i]>>1)&255}}function Kp(n,e,t,r,s){let i=0;if(t.length===0){for(;i<s;i++)e[i]=n[i];for(;i<r;i++)e[i]=n[i]+e[i-s]&255}else{for(;i<s;i++)e[i]=n[i]+t[i]&255;for(;i<r;i++)e[i]=n[i]+xv(e[i-s],t[i],t[i-s])&255}}function xv(n,e,t){const r=n+e-t,s=Math.abs(r-n),i=Math.abs(r-e),a=Math.abs(r-t);return s<=i&&s<=a?n:i<=a?e:t}function Sv(n,e,t,r,s,i){switch(n){case 0:Wp(e,t,s);break;case 1:Hp(e,t,s,i);break;case 2:Vp(e,t,r,s);break;case 3:Gp(e,t,r,s,i);break;case 4:Kp(e,t,r,s,i);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Av=new Uint16Array([255]),kv=new Uint8Array(Av.buffer),Nv=kv[0]===255;function Lv(n){const{data:e,width:t,height:r,channels:s,depth:i}=n,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*s,u=new Uint8Array(r*t*o);let h=0;for(let f=0;f<7;f++){const m=a[f],y=Math.ceil((t-m.x)/m.xStep),p=Math.ceil((r-m.y)/m.yStep);if(y<=0||p<=0)continue;const S=y*o,_=new Uint8Array(S);for(let x=0;x<p;x++){const w=e[h++],O=e.subarray(h,h+S);h+=S;const C=new Uint8Array(S);Sv(w,O,C,_,S,o),_.set(C);for(let F=0;F<y;F++){const G=m.x+F*m.xStep,V=m.y+x*m.yStep;if(!(G>=t||V>=r))for(let re=0;re<o;re++)u[(V*t+G)*o+re]=C[F*o+re]}}}if(i===16){const f=new Uint16Array(u.buffer);if(Nv)for(let m=0;m<f.length;m++)f[m]=Ev(f[m]);return f}else return u}function Ev(n){return(n&255)<<8|n>>8&255}const Pv=new Uint16Array([255]),Cv=new Uint8Array(Pv.buffer),Iv=Cv[0]===255,Tv=new Uint8Array(0);function rf(n){const{data:e,width:t,height:r,channels:s,depth:i}=n,a=Math.ceil(i/8)*s,o=Math.ceil(i/8*s*t),u=new Uint8Array(r*o);let h=Tv,f=0,m,y;for(let p=0;p<r;p++){switch(m=e.subarray(f+1,f+1+o),y=u.subarray(p*o,(p+1)*o),e[f]){case 0:Wp(m,y,o);break;case 1:Hp(m,y,o,a);break;case 2:Vp(m,y,h,o);break;case 3:Gp(m,y,h,o,a);break;case 4:Kp(m,y,h,o,a);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}h=y,f+=o+1}if(i===16){const p=new Uint16Array(u.buffer);if(Iv)for(let S=0;S<p.length;S++)p[S]=Ov(p[S]);return p}else return u}function Ov(n){return(n&255)<<8|n>>8&255}const cl=Uint8Array.of(137,80,78,71,13,10,26,10);function sf(n){if(!Rv(n.readBytes(cl.length)))throw new Error("wrong PNG signature")}function Rv(n){if(n.length<cl.length)return!1;for(let e=0;e<cl.length;e++)if(n[e]!==cl[e])return!1;return!0}const jv="tEXt",Fv=0,Jp=new TextDecoder("latin1");function Dv(n){if(Uv(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Bv=/^[\u0000-\u00FF]*$/;function Uv(n){if(!Bv.test(n))throw new Error("invalid latin1 text")}function Mv(n,e,t){const r=Yp(e);n[r]=qv(e,t-r.length-1)}function Yp(n){for(n.mark();n.readByte()!==Fv;);const e=n.offset;n.reset();const t=Jp.decode(n.readBytes(e-n.offset-1));return n.skip(1),Dv(t),t}function qv(n,e){return Jp.decode(n.readBytes(e))}const tr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Fc={UNKNOWN:-1,DEFLATE:0},af={UNKNOWN:-1,ADAPTIVE:0},Dc={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},il={NONE:0,BACKGROUND:1,PREVIOUS:2},Bc={SOURCE:0,OVER:1};class $v extends Wu{constructor(t,r={}){super(t);It(this,"_checkCrc");It(this,"_inflator");It(this,"_png");It(this,"_apng");It(this,"_end");It(this,"_hasPalette");It(this,"_palette");It(this,"_hasTransparency");It(this,"_transparency");It(this,"_compressionMethod");It(this,"_filterMethod");It(this,"_interlaceMethod");It(this,"_colorType");It(this,"_isAnimated");It(this,"_numberOfFrames");It(this,"_numberOfPlays");It(this,"_frames");It(this,"_writingDataChunks");const{checkCrc:s=!1}=r;this._checkCrc=s,this._inflator=new ef,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Fc.UNKNOWN,this._filterMethod=af.UNKNOWN,this._interlaceMethod=Dc.UNKNOWN,this._colorType=tr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(sf(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(sf(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const s=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case jv:Mv(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-s!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?nf(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const s=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=s+t;break}if(this.offset-s!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?nf(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=zv(this.readUint8());const r=this.readUint8();this._colorType=r;let s;switch(r){case tr.GREYSCALE:s=1;break;case tr.TRUECOLOUR:s=3;break;case tr.INDEXED_COLOUR:s=1;break;case tr.GREYSCALE_ALPHA:s=2;break;case tr.TRUECOLOUR_ALPHA:s=4;break;case tr.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Fc.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<r;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,s=this.offset+this.byteOffset;if(s+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case tr.GREYSCALE:case tr.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case tr.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const s=this.readByte();this._palette[r].push(s)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case tr.UNKNOWN:case tr.GREYSCALE_ALPHA:case tr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=Yp(this),s=this.readUint8();if(s!==Fc.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:yv(i)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),s=this.readByte();this._png.resolution={x:t,y:r,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(t);if(s){if(s.data=rf({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)r.data=s.data;else{const i=this._apng.frames.at(t-1);this.disposeFrame(s,i,r),this.addFrameDataToCanvas(r,s)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,s){switch(t.disposeOp){case il.NONE:break;case il.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const o=(i*t.width+a)*this._png.channels;for(let u=0;u<this._png.channels;u++)s.data[o+u]=0}break;case il.PREVIOUS:s.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const s=1<<this._png.depth,i=(a,o)=>{const u=((a+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,h=(a*r.width+o)*this._png.channels;return{index:u,frameIndex:h}};switch(r.blendOp){case Bc.SOURCE:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:u,frameIndex:h}=i(a,o);for(let f=0;f<this._png.channels;f++)t.data[u+f]=r.data[h+f]}break;case Bc.OVER:for(let a=0;a<r.height;a++)for(let o=0;o<r.width;o++){const{index:u,frameIndex:h}=i(a,o);for(let f=0;f<this._png.channels;f++){const m=r.data[h+this._png.channels-1]/s,y=f%(this._png.channels-1)===0?1:r.data[h+f],p=Math.floor(m*y+(1-m)*t.data[u+f]);t.data[u+f]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==af.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Dc.NO_INTERLACE)this._png.data=rf({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Dc.ADAM7)this._png.data=Lv({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:il.NONE,blendOp:Bc.SOURCE,data:t}),this._inflator=new ef,this._writingDataChunks=!1}}function zv(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var of;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(of||(of={}));function Wv(n,e){return new $v(n,e).decode()}var tt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Uc(){tt.console&&typeof tt.console.log=="function"&&tt.console.log.apply(tt.console,arguments)}var jt={log:Uc,warn:function(n){tt.console&&(typeof tt.console.warn=="function"?tt.console.warn.apply(tt.console,arguments):Uc.call(null,arguments))},error:function(n){tt.console&&(typeof tt.console.error=="function"?tt.console.error.apply(tt.console,arguments):Uc(n))}};function Mc(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){cs(r.response,e,t)},r.onerror=function(){jt.error("could not download file")},r.send()}function lf(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function sl(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var cs=tt.saveAs||((typeof window>"u"?"undefined":Tt(window))!=="object"||window!==tt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=tt.URL||tt.webkitURL,s=document.createElement("a");e=e||n.name||"download",s.download=e,s.rel="noopener",typeof n=="string"?(s.href=n,s.origin!==location.origin?lf(s.href)?Mc(n,e,t):sl(s,s.target="_blank"):sl(s)):(s.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){sl(s)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(lf(n))Mc(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){sl(r)})}else navigator.msSaveOrOpenBlob((function(s,i){return i===void 0?i={autoBom:!1}:Tt(i)!=="object"&&(jt.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return Mc(n,e,t);var s=n.type==="application/octet-stream",i=/constructor/i.test(tt.HTMLElement)||tt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||s&&i)&&(typeof FileReader>"u"?"undefined":Tt(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=a?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},o.readAsDataURL(n)}else{var u=tt.URL||tt.webkitURL,h=u.createObjectURL(n);r?r.location=h:location.href=h,r=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Xp(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],r=0;r<t.length;r++){var s=t[r].re,i=t[r].process,a=s.exec(n);a&&(e=i(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+o+u+h}}var ul=tt.atob.bind(tt),cf=tt.btoa.bind(tt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function qc(n,e){var t=n[0],r=n[1],s=n[2],i=n[3];t=jn(t,r,s,i,e[0],7,-680876936),i=jn(i,t,r,s,e[1],12,-389564586),s=jn(s,i,t,r,e[2],17,606105819),r=jn(r,s,i,t,e[3],22,-1044525330),t=jn(t,r,s,i,e[4],7,-176418897),i=jn(i,t,r,s,e[5],12,1200080426),s=jn(s,i,t,r,e[6],17,-1473231341),r=jn(r,s,i,t,e[7],22,-45705983),t=jn(t,r,s,i,e[8],7,1770035416),i=jn(i,t,r,s,e[9],12,-1958414417),s=jn(s,i,t,r,e[10],17,-42063),r=jn(r,s,i,t,e[11],22,-1990404162),t=jn(t,r,s,i,e[12],7,1804603682),i=jn(i,t,r,s,e[13],12,-40341101),s=jn(s,i,t,r,e[14],17,-1502002290),t=Fn(t,r=jn(r,s,i,t,e[15],22,1236535329),s,i,e[1],5,-165796510),i=Fn(i,t,r,s,e[6],9,-1069501632),s=Fn(s,i,t,r,e[11],14,643717713),r=Fn(r,s,i,t,e[0],20,-373897302),t=Fn(t,r,s,i,e[5],5,-701558691),i=Fn(i,t,r,s,e[10],9,38016083),s=Fn(s,i,t,r,e[15],14,-660478335),r=Fn(r,s,i,t,e[4],20,-405537848),t=Fn(t,r,s,i,e[9],5,568446438),i=Fn(i,t,r,s,e[14],9,-1019803690),s=Fn(s,i,t,r,e[3],14,-187363961),r=Fn(r,s,i,t,e[8],20,1163531501),t=Fn(t,r,s,i,e[13],5,-1444681467),i=Fn(i,t,r,s,e[2],9,-51403784),s=Fn(s,i,t,r,e[7],14,1735328473),t=Dn(t,r=Fn(r,s,i,t,e[12],20,-1926607734),s,i,e[5],4,-378558),i=Dn(i,t,r,s,e[8],11,-2022574463),s=Dn(s,i,t,r,e[11],16,1839030562),r=Dn(r,s,i,t,e[14],23,-35309556),t=Dn(t,r,s,i,e[1],4,-1530992060),i=Dn(i,t,r,s,e[4],11,1272893353),s=Dn(s,i,t,r,e[7],16,-155497632),r=Dn(r,s,i,t,e[10],23,-1094730640),t=Dn(t,r,s,i,e[13],4,681279174),i=Dn(i,t,r,s,e[0],11,-358537222),s=Dn(s,i,t,r,e[3],16,-722521979),r=Dn(r,s,i,t,e[6],23,76029189),t=Dn(t,r,s,i,e[9],4,-640364487),i=Dn(i,t,r,s,e[12],11,-421815835),s=Dn(s,i,t,r,e[15],16,530742520),t=Bn(t,r=Dn(r,s,i,t,e[2],23,-995338651),s,i,e[0],6,-198630844),i=Bn(i,t,r,s,e[7],10,1126891415),s=Bn(s,i,t,r,e[14],15,-1416354905),r=Bn(r,s,i,t,e[5],21,-57434055),t=Bn(t,r,s,i,e[12],6,1700485571),i=Bn(i,t,r,s,e[3],10,-1894986606),s=Bn(s,i,t,r,e[10],15,-1051523),r=Bn(r,s,i,t,e[1],21,-2054922799),t=Bn(t,r,s,i,e[8],6,1873313359),i=Bn(i,t,r,s,e[15],10,-30611744),s=Bn(s,i,t,r,e[6],15,-1560198380),r=Bn(r,s,i,t,e[13],21,1309151649),t=Bn(t,r,s,i,e[4],6,-145523070),i=Bn(i,t,r,s,e[11],10,-1120210379),s=Bn(s,i,t,r,e[2],15,718787259),r=Bn(r,s,i,t,e[9],21,-343485551),n[0]=Ui(t,n[0]),n[1]=Ui(r,n[1]),n[2]=Ui(s,n[2]),n[3]=Ui(i,n[3])}function jl(n,e,t,r,s,i){return e=Ui(Ui(e,n),Ui(r,i)),Ui(e<<s|e>>>32-s,t)}function jn(n,e,t,r,s,i,a){return jl(e&t|~e&r,n,e,s,i,a)}function Fn(n,e,t,r,s,i,a){return jl(e&r|t&~r,n,e,s,i,a)}function Dn(n,e,t,r,s,i,a){return jl(e^t^r,n,e,s,i,a)}function Bn(n,e,t,r,s,i,a){return jl(t^(e|~r),n,e,s,i,a)}function Zp(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)qc(r,Hv(n.substring(e-64,e)));n=n.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)s[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(qc(r,s),e=0;e<16;e++)s[e]=0;return s[14]=8*t,qc(r,s),r}function Hv(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var uf="0123456789abcdef".split("");function Vv(n){for(var e="",t=0;t<4;t++)e+=uf[n>>8*t+4&15]+uf[n>>8*t&15];return e}function Gv(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function wu(n){return Zp(n).map(Gv).join("")}var Kv=(function(n){for(var e=0;e<n.length;e++)n[e]=Vv(n[e]);return n.join("")})(Zp("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ui(n,e){if(Kv){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function xu(n,e){var t,r,s,i;if(n!==t){for(var a=(s=n,i=1+(256/n.length|0),new Array(i+1).join(s)),o=[],u=0;u<256;u++)o[u]=u;var h=0;for(u=0;u<256;u++){var f=o[u];h=(h+f+a.charCodeAt(u))%256,o[u]=o[h],o[h]=f}t=n,r=o}else o=r;var m=e.length,y=0,p=0,S="";for(u=0;u<m;u++)p=(p+(f=o[y=(y+1)%256]))%256,o[y]=o[p],o[p]=f,a=o[(o[y]+o[p])%256],S+=String.fromCharCode(e.charCodeAt(u)^a);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hf={print:4,modify:8,copy:16,"annot-forms":32};function Gs(n,e,t,r){this.v=1,this.r=2;var s=192;n.forEach(function(o){if(hf.perm!==void 0)throw new Error("Invalid permission: "+o);s+=hf[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^s)),this.encryptionKey=wu(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=xu(this.encryptionKey,this.padding)}function Ks(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var s=n.charCodeAt(r);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):n[r]}return e}function df(n){if(Tt(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,s){if(s=s||!1,typeof t!="string"||typeof r!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[r,!!s],i},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[t]){var a=e[t][i];try{a[0].apply(n,r)}catch(o){tt.console&&jt.error("jsPDF PubSub Error",o.message,o)}a[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Al(n){if(!(this instanceof Al))return new Al(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function Qp(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function fs(n,e,t,r,s){if(!(this instanceof fs))return new fs(n,e,t,r,s);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,Qp.call(this,r,s)}function Ys(n,e,t,r,s){if(!(this instanceof Ys))return new Ys(n,e,t,r,s);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,Qp.call(this,r,s)}function qe(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],s=arguments[2],i=arguments[3],a=[],o=1,u=16,h="S",f=null;Tt(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,s=n.format||s,i=n.compress||n.compressPdf||i,(f=n.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(u=n.floatPrecision),h=n.defaultPathOperation||"S"),a=n.filters||(i===!0?["FlateEncode"]:a),r=r||"mm",t=(""+(t||"P")).toLowerCase();var m=n.putOnlyUsedFonts||!1,y={},p={internal:{},__private__:{}};p.__private__.PubSub=df;var S="1.3",_=p.__private__.getPdfVersion=function(){return S};p.__private__.setPdfVersion=function(g){S=g};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return x};var w=p.__private__.getPageFormat=function(g){return x[g]};s=s||"a4";var O="compat",C="advanced",F=O;function G(){this.saveGraphicsState(),D(new Ze(lt,0,0,-lt,0,Ji()*lt).toString()+" cm"),this.setFontSize(this.getFontSize()/lt),h="n",F=C}function V(){this.restoreGraphicsState(),h="S",F=O}var re=p.__private__.combineFontStyleAndFontWeight=function(g,A){if(g=="bold"&&A=="normal"||g=="bold"&&A==400||g=="normal"&&A=="italic"||g=="bold"&&A=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return A&&(g=A==400||A==="normal"?g==="italic"?"italic":"normal":A!=700&&A!=="bold"||g!=="normal"?(A==700?"bold":A)+""+g:"bold"),g};p.advancedAPI=function(g){var A=F===O;return A&&G.call(this),typeof g!="function"||(g(this),A&&V.call(this)),this},p.compatAPI=function(g){var A=F===C;return A&&V.call(this),typeof g!="function"||(g(this),A&&G.call(this)),this},p.isAdvancedAPI=function(){return F===C};var J,U=function(g){if(F!==C)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},I=p.roundToPrecision=p.__private__.roundToPrecision=function(g,A){var $=e||A;if(isNaN(g)||isNaN($))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed($).replace(/0+$/,"")};J=p.hpf=p.__private__.hpf=typeof u=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return I(g,u)}:u==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return I(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return I(g,16)};var L=p.f2=p.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return I(g,2)},R=p.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return I(g,3)},B=p.scale=p.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return F===O?g*lt:F===C?g:void 0},W=function(g){return B((function(A){return F===O?Ji()-A:F===C?A:void 0})(g))};p.__private__.setPrecision=p.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(e=parseInt(g,10))};var Z,ue="00000000000000000000000000000000",he=p.__private__.getFileId=function(){return ue},ie=p.__private__.setFileId=function(g){return ue=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():ue.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(gn=new Gs(f.userPermissions,f.userPassword,f.ownerPassword,ue)),ue};p.setFileId=function(g){return ie(g),this},p.getFileId=function(){return he()};var de=p.__private__.convertDateToPDFDate=function(g){var A=g.getTimezoneOffset(),$=A<0?"+":"-",K=Math.floor(Math.abs(A/60)),ne=Math.abs(A%60),ge=[$,H(K),"'",H(ne),"'"].join("");return["D:",g.getFullYear(),H(g.getMonth()+1),H(g.getDate()),H(g.getHours()),H(g.getMinutes()),H(g.getSeconds()),ge].join("")},ke=p.__private__.convertPDFDateToDate=function(g){var A=parseInt(g.substr(2,4),10),$=parseInt(g.substr(6,2),10)-1,K=parseInt(g.substr(8,2),10),ne=parseInt(g.substr(10,2),10),ge=parseInt(g.substr(12,2),10),ye=parseInt(g.substr(14,2),10);return new Date(A,$,K,ne,ge,ye,0)},be=p.__private__.setCreationDate=function(g){var A;if(g===void 0&&(g=new Date),g instanceof Date)A=de(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");A=g}return Z=A},E=p.__private__.getCreationDate=function(g){var A=Z;return g==="jsDate"&&(A=ke(Z)),A};p.setCreationDate=function(g){return be(g),this},p.getCreationDate=function(g){return E(g)};var z,H=p.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},Y=p.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},ee=0,te=[],le=[],ce=0,ve=[],Se=[],Ce=!1,Pe=le;p.__private__.setCustomOutputDestination=function(g){Ce=!0,Pe=g};var ze=function(g){Ce||(Pe=g)};p.__private__.resetCustomOutputDestination=function(){Ce=!1,Pe=le};var D=p.__private__.out=function(g){return g=g.toString(),ce+=g.length+1,Pe.push(g),Pe},Ee=p.__private__.write=function(g){return D(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},dt=p.__private__.getArrayBuffer=function(g){for(var A=g.length,$=new ArrayBuffer(A),K=new Uint8Array($);A--;)K[A]=g.charCodeAt(A);return $},Ke=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return Ke};var we=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(g){return we=F===C?g/lt:g,this};var Je,Te=p.__private__.getFontSize=p.getFontSize=function(){return F===O?we:we*lt},Ge=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(g){return Ge=g,this},p.__private__.getR2L=p.getR2L=function(){return Ge};var We,Nt=p.__private__.setZoomMode=function(g){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))Je=g;else if(isNaN(g)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');Je=g}else Je=parseInt(g,10)};p.__private__.getZoomMode=function(){return Je};var mt,st=p.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');We=g};p.__private__.getPageMode=function(){return We};var yt=p.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');mt=g};p.__private__.getLayoutMode=function(){return mt},p.__private__.setDisplayMode=p.setDisplayMode=function(g,A,$){return Nt(g),yt(A),st($),this};var vt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(g){if(Object.keys(vt).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return vt[g]},p.__private__.getDocumentProperties=function(){return vt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(g){for(var A in vt)vt.hasOwnProperty(A)&&g[A]&&(vt[A]=g[A]);return this},p.__private__.setDocumentProperty=function(g,A){if(Object.keys(vt).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return vt[g]=A};var De,lt,$e,tn,xt,ft={},pt={},Wt=[],He={},Dt={},et={},at={},Ht=null,gt=0,Xe=[],Lt=new df(p),qi=n.hotfixes||[],On={},Vr={},Tr=[],Ze=function g(A,$,K,ne,ge,ye){if(!(this instanceof g))return new g(A,$,K,ne,ge,ye);isNaN(A)&&(A=1),isNaN($)&&($=0),isNaN(K)&&(K=0),isNaN(ne)&&(ne=1),isNaN(ge)&&(ge=0),isNaN(ye)&&(ye=0),this._matrix=[A,$,K,ne,ge,ye]};Object.defineProperty(Ze.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Ze.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Ze.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Ze.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Ze.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Ze.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Ze.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Ze.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Ze.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Ze.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Ze.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Ze.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Ze.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ze.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ze.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ze.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ze.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(J).join(g)},Ze.prototype.multiply=function(g){var A=g.sx*this.sx+g.shy*this.shx,$=g.sx*this.shy+g.shy*this.sy,K=g.shx*this.sx+g.sy*this.shx,ne=g.shx*this.shy+g.sy*this.sy,ge=g.tx*this.sx+g.ty*this.shx+this.tx,ye=g.tx*this.shy+g.ty*this.sy+this.ty;return new Ze(A,$,K,ne,ge,ye)},Ze.prototype.decompose=function(){var g=this.sx,A=this.shy,$=this.shx,K=this.sy,ne=this.tx,ge=this.ty,ye=Math.sqrt(g*g+A*A),Re=(g/=ye)*$+(A/=ye)*K;$-=g*Re,K-=A*Re;var Be=Math.sqrt($*$+K*K);return Re/=Be,g*(K/=Be)<A*($/=Be)&&(g=-g,A=-A,Re=-Re,ye=-ye),{scale:new Ze(ye,0,0,Be,0,0),translate:new Ze(1,0,0,1,ne,ge),rotate:new Ze(g,A,-A,g,0,0),skew:new Ze(1,0,Re,1,0,0)}},Ze.prototype.toString=function(g){return this.join(" ")},Ze.prototype.inversed=function(){var g=this.sx,A=this.shy,$=this.shx,K=this.sy,ne=this.tx,ge=this.ty,ye=1/(g*K-A*$),Re=K*ye,Be=-A*ye,nt=-$*ye,ct=g*ye;return new Ze(Re,Be,nt,ct,-Re*ne-nt*ge,-Be*ne-ct*ge)},Ze.prototype.applyToPoint=function(g){var A=g.x*this.sx+g.y*this.shx+this.tx,$=g.x*this.shy+g.y*this.sy+this.ty;return new Qr(A,$)},Ze.prototype.applyToRectangle=function(g){var A=this.applyToPoint(g),$=this.applyToPoint(new Qr(g.x+g.w,g.y+g.h));return new va(A.x,A.y,$.x-A.x,$.y-A.y)},Ze.prototype.clone=function(){var g=this.sx,A=this.shy,$=this.shx,K=this.sy,ne=this.tx,ge=this.ty;return new Ze(g,A,$,K,ne,ge)},p.Matrix=Ze;var Gr=p.matrixMult=function(g,A){return A.multiply(g)},Kr=new Ze(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Kr;var ar=function(g,A){if(!Dt[g]){var $=(A instanceof fs?"Sh":"P")+(Object.keys(He).length+1).toString(10);A.id=$,Dt[g]=$,He[$]=A,Lt.publish("addPattern",A)}};p.ShadingPattern=fs,p.TilingPattern=Ys,p.addShadingPattern=function(g,A){return U("addShadingPattern()"),ar(g,A),this},p.beginTilingPattern=function(g){U("beginTilingPattern()"),ba(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},p.endTilingPattern=function(g,A){U("endTilingPattern()"),A.stream=Se[z].join(`
`),ar(g,A),Lt.publish("endTilingPattern",A),Tr.pop().restore()};var or,Yt=p.__private__.newObject=function(){var g=xn();return kn(g,!0),g},xn=p.__private__.newObjectDeferred=function(){return ee++,te[ee]=function(){return ce},ee},kn=function(g,A){return A=typeof A=="boolean"&&A,te[g]=ce,A&&D(g+" 0 obj"),g},$i=p.__private__.newAdditionalObject=function(){var g={objId:xn(),content:""};return ve.push(g),g},vi=xn(),vr=xn(),Or=p.__private__.decodeColorString=function(g){var A=g.split(" ");if(A.length!==2||A[1]!=="g"&&A[1]!=="G")A.length!==5||A[4]!=="k"&&A[4]!=="K"||(A=[(1-A[0])*(1-A[3]),(1-A[1])*(1-A[3]),(1-A[2])*(1-A[3]),"r"]);else{var $=parseFloat(A[0]);A=[$,$,$,"r"]}for(var K="#",ne=0;ne<3;ne++)K+=("0"+Math.floor(255*parseFloat(A[ne])).toString(16)).slice(-2);return K},br=p.__private__.encodeColorString=function(g){var A;typeof g=="string"&&(g={ch1:g});var $=g.ch1,K=g.ch2,ne=g.ch3,ge=g.ch4,ye=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $=="string"&&$.charAt(0)!=="#"){var Re=new Xp($);if(Re.ok)$=Re.toHex();else if(!/^\d*\.?\d*$/.test($))throw new Error('Invalid color "'+$+'" passed to jsPDF.encodeColorString.')}if(typeof $=="string"&&/^#[0-9A-Fa-f]{3}$/.test($)&&($="#"+$[1]+$[1]+$[2]+$[2]+$[3]+$[3]),typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($)){var Be=parseInt($.substr(1),16);$=Be>>16&255,K=Be>>8&255,ne=255&Be}if(K===void 0||ge===void 0&&$===K&&K===ne)A=typeof $=="string"?$+" "+ye[0]:g.precision===2?L($/255)+" "+ye[0]:R($/255)+" "+ye[0];else if(ge===void 0||Tt(ge)==="object"){if(ge&&!isNaN(ge.a)&&ge.a===0)return["1.","1.","1.",ye[1]].join(" ");A=typeof $=="string"?[$,K,ne,ye[1]].join(" "):g.precision===2?[L($/255),L(K/255),L(ne/255),ye[1]].join(" "):[R($/255),R(K/255),R(ne/255),ye[1]].join(" ")}else A=typeof $=="string"?[$,K,ne,ge,ye[2]].join(" "):g.precision===2?[L($),L(K),L(ne),L(ge),ye[2]].join(" "):[R($),R(K),R(ne),R(ge),ye[2]].join(" ");return A},yr=p.__private__.getFilters=function(){return a},lr=p.__private__.putStream=function(g){var A=(g=g||{}).data||"",$=g.filters||yr(),K=g.alreadyAppliedFilters||[],ne=g.addLength1||!1,ge=A.length,ye=g.objectId,Re=function(mn){return mn};if(f!==null&&ye===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Re=gn.encryptor(ye,0));var Be={};$===!0&&($=["FlateEncode"]);var nt=g.additionalKeyValues||[],ct=(Be=qe.API.processDataByFilters!==void 0?qe.API.processDataByFilters(A,$):{data:A,reverseChain:[]}).reverseChain+(Array.isArray(K)?K.join(" "):K.toString());if(Be.data.length!==0&&(nt.push({key:"Length",value:Be.data.length}),ne===!0&&nt.push({key:"Length1",value:ge})),ct.length!=0)if(ct.split("/").length-1==1)nt.push({key:"Filter",value:ct});else{nt.push({key:"Filter",value:"["+ct+"]"});for(var St=0;St<nt.length;St+=1)if(nt[St].key==="DecodeParms"){for(var Gt=[],hn=0;hn<Be.reverseChain.split("/").length-1;hn+=1)Gt.push("null");Gt.push(nt[St].value),nt[St].value="["+Gt.join(" ")+"]"}}D("<<");for(var Bt=0;Bt<nt.length;Bt++)D("/"+nt[Bt].key+" "+nt[Bt].value);D(">>"),Be.data.length!==0&&(D("stream"),D(Re(Be.data)),D("endstream"))},zi=p.__private__.putPage=function(g){var A=g.number,$=g.data,K=g.objId,ne=g.contentsObjId;kn(K,!0),D("<</Type /Page"),D("/Parent "+g.rootDictionaryObjId+" 0 R"),D("/Resources "+g.resourceDictionaryObjId+" 0 R"),D("/MediaBox ["+parseFloat(J(g.mediaBox.bottomLeftX))+" "+parseFloat(J(g.mediaBox.bottomLeftY))+" "+J(g.mediaBox.topRightX)+" "+J(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&D("/CropBox ["+J(g.cropBox.bottomLeftX)+" "+J(g.cropBox.bottomLeftY)+" "+J(g.cropBox.topRightX)+" "+J(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&D("/BleedBox ["+J(g.bleedBox.bottomLeftX)+" "+J(g.bleedBox.bottomLeftY)+" "+J(g.bleedBox.topRightX)+" "+J(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&D("/TrimBox ["+J(g.trimBox.bottomLeftX)+" "+J(g.trimBox.bottomLeftY)+" "+J(g.trimBox.topRightX)+" "+J(g.trimBox.topRightY)+"]"),g.artBox!==null&&D("/ArtBox ["+J(g.artBox.bottomLeftX)+" "+J(g.artBox.bottomLeftY)+" "+J(g.artBox.topRightX)+" "+J(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&D("/UserUnit "+g.userUnit),Lt.publish("putPage",{objId:K,pageContext:Xe[A],pageNumber:A,page:$}),D("/Contents "+ne+" 0 R"),D(">>"),D("endobj");var ge=$.join(`
`);return F===C&&(ge+=`
Q`),kn(ne,!0),lr({data:ge,filters:yr(),objectId:ne}),D("endobj"),K},Rr=p.__private__.putPages=function(){var g,A,$=[];for(g=1;g<=gt;g++)Xe[g].objId=xn(),Xe[g].contentsObjId=xn();for(g=1;g<=gt;g++)$.push(zi({number:g,data:Se[g],objId:Xe[g].objId,contentsObjId:Xe[g].contentsObjId,mediaBox:Xe[g].mediaBox,cropBox:Xe[g].cropBox,bleedBox:Xe[g].bleedBox,trimBox:Xe[g].trimBox,artBox:Xe[g].artBox,userUnit:Xe[g].userUnit,rootDictionaryObjId:vi,resourceDictionaryObjId:vr}));kn(vi,!0),D("<</Type /Pages");var K="/Kids [";for(A=0;A<gt;A++)K+=$[A]+" 0 R ";D(K+"]"),D("/Count "+gt),D(">>"),D("endobj"),Lt.publish("postPutPages")},Wi=function(g){Lt.publish("putFont",{font:g,out:D,newObject:Yt,putStream:lr}),g.isAlreadyPutted!==!0&&(g.objectNumber=Yt(),D("<<"),D("/Type /Font"),D("/BaseFont /"+Ks(g.postScriptName)),D("/Subtype /Type1"),typeof g.encoding=="string"&&D("/Encoding /"+g.encoding),D("/FirstChar 32"),D("/LastChar 255"),D(">>"),D("endobj"))},xs=function(g){g.objectNumber=Yt();var A=[];A.push({key:"Type",value:"/XObject"}),A.push({key:"Subtype",value:"/Form"}),A.push({key:"BBox",value:"["+[J(g.x),J(g.y),J(g.x+g.width),J(g.y+g.height)].join(" ")+"]"}),A.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var $=g.pages[1].join(`
`);lr({data:$,additionalKeyValues:A,objectId:g.objectNumber}),D("endobj")},Ss=function(g,A){A||(A=21);var $=Yt(),K=(function(ye,Re){var Be,nt=[],ct=1/(Re-1);for(Be=0;Be<1;Be+=ct)nt.push(Be);if(nt.push(1),ye[0].offset!=0){var St={offset:0,color:ye[0].color};ye.unshift(St)}if(ye[ye.length-1].offset!=1){var Gt={offset:1,color:ye[ye.length-1].color};ye.push(Gt)}for(var hn="",Bt=0,mn=0;mn<nt.length;mn++){for(Be=nt[mn];Be>ye[Bt+1].offset;)Bt++;var dn=ye[Bt].offset,Nn=(Be-dn)/(ye[Bt+1].offset-dn),ni=ye[Bt].color,wr=ye[Bt+1].color;hn+=Y(Math.round((1-Nn)*ni[0]+Nn*wr[0]).toString(16))+Y(Math.round((1-Nn)*ni[1]+Nn*wr[1]).toString(16))+Y(Math.round((1-Nn)*ni[2]+Nn*wr[2]).toString(16))}return hn.trim()})(g.colors,A),ne=[];ne.push({key:"FunctionType",value:"0"}),ne.push({key:"Domain",value:"[0.0 1.0]"}),ne.push({key:"Size",value:"["+A+"]"}),ne.push({key:"BitsPerSample",value:"8"}),ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lr({data:K,additionalKeyValues:ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$}),D("endobj"),g.objectNumber=Yt(),D("<< /ShadingType "+g.type),D("/ColorSpace /DeviceRGB");var ge="/Coords ["+J(parseFloat(g.coords[0]))+" "+J(parseFloat(g.coords[1]))+" ";g.type===2?ge+=J(parseFloat(g.coords[2]))+" "+J(parseFloat(g.coords[3])):ge+=J(parseFloat(g.coords[2]))+" "+J(parseFloat(g.coords[3]))+" "+J(parseFloat(g.coords[4]))+" "+J(parseFloat(g.coords[5])),D(ge+="]"),g.matrix&&D("/Matrix ["+g.matrix.toString()+"]"),D("/Function "+$+" 0 R"),D("/Extend [true true]"),D(">>"),D("endobj")},As=function(g,A){var $=xn(),K=Yt();A.push({resourcesOid:$,objectOid:K}),g.objectNumber=K;var ne=[];ne.push({key:"Type",value:"/Pattern"}),ne.push({key:"PatternType",value:"1"}),ne.push({key:"PaintType",value:"1"}),ne.push({key:"TilingType",value:"1"}),ne.push({key:"BBox",value:"["+g.boundingBox.map(J).join(" ")+"]"}),ne.push({key:"XStep",value:J(g.xStep)}),ne.push({key:"YStep",value:J(g.yStep)}),ne.push({key:"Resources",value:$+" 0 R"}),g.matrix&&ne.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),lr({data:g.stream,additionalKeyValues:ne,objectId:g.objectNumber}),D("endobj")},Fl=function(g){for(var A in g.objectNumber=Yt(),D("<<"),g)switch(A){case"opacity":D("/ca "+L(g[A]));break;case"stroke-opacity":D("/CA "+L(g[A]))}D(">>"),D("endobj")},ca=function(g){kn(g.resourcesOid,!0),D("<<"),D("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var A in D("/Font <<"),ft)ft.hasOwnProperty(A)&&(m===!1||m===!0&&y.hasOwnProperty(A))&&D("/"+A+" "+ft[A].objectNumber+" 0 R");D(">>")})(),(function(){if(Object.keys(He).length>0){for(var A in D("/Shading <<"),He)He.hasOwnProperty(A)&&He[A]instanceof fs&&He[A].objectNumber>=0&&D("/"+A+" "+He[A].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),D(">>")}})(),(function(A){if(Object.keys(He).length>0){for(var $ in D("/Pattern <<"),He)He.hasOwnProperty($)&&He[$]instanceof p.TilingPattern&&He[$].objectNumber>=0&&He[$].objectNumber<A&&D("/"+$+" "+He[$].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),D(">>")}})(g.objectOid),(function(){if(Object.keys(et).length>0){var A;for(A in D("/ExtGState <<"),et)et.hasOwnProperty(A)&&et[A].objectNumber>=0&&D("/"+A+" "+et[A].objectNumber+" 0 R");Lt.publish("putGStateDict"),D(">>")}})(),(function(){for(var A in D("/XObject <<"),On)On.hasOwnProperty(A)&&On[A].objectNumber>=0&&D("/"+A+" "+On[A].objectNumber+" 0 R");Lt.publish("putXobjectDict"),D(">>")})(),D(">>"),D("endobj")},oo=function(g){pt[g.fontName]=pt[g.fontName]||{},pt[g.fontName][g.fontStyle]=g.id},lo=function(g,A,$,K,ne){var ge={id:"F"+(Object.keys(ft).length+1).toString(10),postScriptName:g,fontName:A,fontStyle:$,encoding:K,isStandardFont:ne||!1,metadata:{}};return Lt.publish("addFont",{font:ge,instance:this}),ft[ge.id]=ge,oo(ge),ge.id},cr=p.__private__.pdfEscape=p.pdfEscape=function(g,A){return(function($,K){var ne,ge,ye,Re,Be,nt,ct,St,Gt;if(ye=(K=K||{}).sourceEncoding||"Unicode",Be=K.outputEncoding,(K.autoencode||Be)&&ft[De].metadata&&ft[De].metadata[ye]&&ft[De].metadata[ye].encoding&&(Re=ft[De].metadata[ye].encoding,!Be&&ft[De].encoding&&(Be=ft[De].encoding),!Be&&Re.codePages&&(Be=Re.codePages[0]),typeof Be=="string"&&(Be=Re[Be]),Be)){for(ct=!1,nt=[],ne=0,ge=$.length;ne<ge;ne++)(St=Be[$.charCodeAt(ne)])?nt.push(String.fromCharCode(St)):nt.push($[ne]),nt[ne].charCodeAt(0)>>8&&(ct=!0);$=nt.join("")}for(ne=$.length;ct===void 0&&ne!==0;)$.charCodeAt(ne-1)>>8&&(ct=!0),ne--;if(!ct)return $;for(nt=K.noBOM?[]:[254,255],ne=0,ge=$.length;ne<ge;ne++){if((Gt=(St=$.charCodeAt(ne))>>8)>>8)throw new Error("Character at position "+ne+" of string '"+$+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");nt.push(Gt),nt.push(St-(Gt<<8))}return String.fromCharCode.apply(void 0,nt)})(g,A).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ua=p.__private__.beginPage=function(g){Se[++gt]=[],Xe[gt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},uo(gt),ze(Se[z])},co=function(g,A){var $,K,ne;switch(t=A||t,typeof g=="string"&&($=w(g.toLowerCase()),Array.isArray($)&&(K=$[0],ne=$[1])),Array.isArray(g)&&(K=g[0]*lt,ne=g[1]*lt),isNaN(K)&&(K=s[0],ne=s[1]),(K>14400||ne>14400)&&(jt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),K=Math.min(14400,K),ne=Math.min(14400,ne)),s=[K,ne],t.substr(0,1)){case"l":ne>K&&(s=[ne,K]);break;case"p":K>ne&&(s=[ne,K])}ua(s),rt(fa),D(Es),ga!==0&&D(ga+" J"),ma!==0&&D(ma+" j"),Lt.publish("addPage",{pageNumber:gt})},ha=function(g){g>0&&g<=gt&&(Se.splice(g,1),Xe.splice(g,1),gt--,z>gt&&(z=gt),this.setPage(z))},uo=function(g){g>0&&g<=gt&&(z=g)},ho=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Se.length-1},fo=function(g,A,$){var K,ne=void 0;return $=$||{},g=g!==void 0?g:ft[De].fontName,A=A!==void 0?A:ft[De].fontStyle,K=g.toLowerCase(),pt[K]!==void 0&&pt[K][A]!==void 0?ne=pt[K][A]:pt[g]!==void 0&&pt[g][A]!==void 0?ne=pt[g][A]:$.disableWarning===!1&&jt.warn("Unable to look up font label for font '"+g+"', '"+A+"'. Refer to getFontList() for available fonts."),ne||$.noFallback||(ne=pt.times[A])==null&&(ne=pt.times.normal),ne},jr=p.__private__.putInfo=function(){var g=Yt(),A=function(K){return K};for(var $ in f!==null&&(A=gn.encryptor(g,0)),D("<<"),D("/Producer ("+cr(A("jsPDF "+qe.version))+")"),vt)vt.hasOwnProperty($)&&vt[$]&&D("/"+$.substr(0,1).toUpperCase()+$.substr(1)+" ("+cr(A(vt[$]))+")");D("/CreationDate ("+cr(A(Z))+")"),D(">>"),D("endobj")},ks=p.__private__.putCatalog=function(g){var A=(g=g||{}).rootDictionaryObjId||vi;switch(Yt(),D("<<"),D("/Type /Catalog"),D("/Pages "+A+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":D("/OpenAction [3 0 R /FitH null]");break;case"fullheight":D("/OpenAction [3 0 R /FitV null]");break;case"fullpage":D("/OpenAction [3 0 R /Fit]");break;case"original":D("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $=""+Je;$.substr($.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&D("/OpenAction [3 0 R /XYZ null null "+L(Je)+"]")}switch(mt||(mt="continuous"),mt){case"continuous":D("/PageLayout /OneColumn");break;case"single":D("/PageLayout /SinglePage");break;case"two":case"twoleft":D("/PageLayout /TwoColumnLeft");break;case"tworight":D("/PageLayout /TwoColumnRight")}We&&D("/PageMode /"+We),Lt.publish("putCatalog"),D(">>"),D("endobj")},Dl=p.__private__.putTrailer=function(){D("trailer"),D("<<"),D("/Size "+(ee+1)),D("/Root "+ee+" 0 R"),D("/Info "+(ee-1)+" 0 R"),f!==null&&D("/Encrypt "+gn.oid+" 0 R"),D("/ID [ <"+ue+"> <"+ue+"> ]"),D(">>")},un=p.__private__.putHeader=function(){D("%PDF-"+S),D("%")},po=p.__private__.putXRef=function(){var g="0000000000";D("xref"),D("0 "+(ee+1)),D("0000000000 65535 f ");for(var A=1;A<=ee;A++)typeof te[A]=="function"?D((g+te[A]()).slice(-10)+" 00000 n "):te[A]!==void 0?D((g+te[A]).slice(-10)+" 00000 n "):D("0000000000 00000 n ")},Fr=p.__private__.buildDocument=function(){var g;ee=0,ce=0,le=[],te=[],ve=[],vi=xn(),vr=xn(),ze(le),Lt.publish("buildDocument"),un(),Rr(),(function(){Lt.publish("putAdditionalObjects");for(var $=0;$<ve.length;$++){var K=ve[$];kn(K.objId,!0),D(K.content),D("endobj")}Lt.publish("postPutAdditionalObjects")})(),g=[],(function(){for(var $ in ft)ft.hasOwnProperty($)&&(m===!1||m===!0&&y.hasOwnProperty($))&&Wi(ft[$])})(),(function(){var $;for($ in et)et.hasOwnProperty($)&&Fl(et[$])})(),(function(){for(var $ in On)On.hasOwnProperty($)&&xs(On[$])})(),(function($){var K;for(K in He)He.hasOwnProperty(K)&&(He[K]instanceof fs?Ss(He[K]):He[K]instanceof Ys&&As(He[K],$))})(g),Lt.publish("putResources"),g.forEach(ca),ca({resourcesOid:vr,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),f!==null&&(gn.oid=Yt(),D("<<"),D("/Filter /Standard"),D("/V "+gn.v),D("/R "+gn.r),D("/U <"+gn.toHexString(gn.U)+">"),D("/O <"+gn.toHexString(gn.O)+">"),D("/P "+gn.P),D(">>"),D("endobj")),jr(),ks();var A=ce;return po(),Dl(),D("startxref"),D(""+A),D("%%EOF"),ze(Se[z]),le.join(`
`)},Ns=p.__private__.getBlob=function(g){return new Blob([dt(g)],{type:"application/pdf"})},go=p.output=p.__private__.output=(or=function(g,A){switch(typeof(A=A||{})=="string"?A={filename:A}:A.filename=A.filename||"generated.pdf",g){case void 0:return Fr();case"save":p.save(A.filename);break;case"arraybuffer":return dt(Fr());case"blob":return Ns(Fr());case"bloburi":case"bloburl":if(tt.URL!==void 0&&typeof tt.URL.createObjectURL=="function")return tt.URL&&tt.URL.createObjectURL(Ns(Fr()))||void 0;jt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $="",K=Fr();try{$=cf(K)}catch{$=cf(unescape(encodeURIComponent(K)))}return"data:application/pdf;filename="+A.filename+";base64,"+$;case"pdfobjectnewwindow":if(Object.prototype.toString.call(tt)==="[object Window]"){var ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';A.pdfObjectUrl&&(ne=A.pdfObjectUrl,ge="");var ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ne+'"'+ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(A)+");<\/script></body></html>",Re=tt.open();return Re!==null&&Re.document.write(ye),Re}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(tt)==="[object Window]"){var Be='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(A.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+A.filename+'" width="500px" height="400px" /></body></html>',nt=tt.open();if(nt!==null){nt.document.write(Be);var ct=this;nt.document.documentElement.querySelector("#pdfViewer").onload=function(){nt.document.title=A.filename,nt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ct.output("bloburl"))}}return nt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(tt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",A)+'"></iframe></body></html>',Gt=tt.open();if(Gt!==null&&(Gt.document.write(St),Gt.document.title=A.filename),Gt||typeof safari>"u")return Gt;break;case"datauri":case"dataurl":return tt.document.location.href=this.output("datauristring",A);default:return null}},or.foo=function(){try{return or.apply(this,arguments)}catch($){var g=$.stack||"";~g.indexOf(" at ")&&(g=g.split(" at ")[1]);var A="Error in function "+g.split(`
`)[0].split("<")[0]+": "+$.message;if(!tt.console)throw new Error(A);tt.console.error(A,$),tt.alert&&alert(A)}},or.foo.bar=or,or.foo),ur=function(g){return Array.isArray(qi)===!0&&qi.indexOf(g)>-1};switch(r){case"pt":lt=1;break;case"mm":lt=72/25.4;break;case"cm":lt=72/2.54;break;case"in":lt=72;break;case"px":lt=ur("px_scaling")==1?.75:96/72;break;case"pc":case"em":lt=12;break;case"ex":lt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);lt=r}var gn=null;be(),ie();var Jr=p.__private__.getPageInfo=p.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Xe[g].objId,pageNumber:g,pageContext:Xe[g]}},mo=p.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var A in Xe)if(Xe[A].objId===g)break;return Jr(A)},Bl=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Xe[z].objId,pageNumber:z,pageContext:Xe[z]}};p.addPage=function(){return co.apply(this,arguments),this},p.setPage=function(){return uo.apply(this,arguments),ze.call(this,Se[z]),this},p.insertPage=function(g){return this.addPage(),this.movePage(z,g),this},p.movePage=function(g,A){var $,K;if(g>A){$=Se[g],K=Xe[g];for(var ne=g;ne>A;ne--)Se[ne]=Se[ne-1],Xe[ne]=Xe[ne-1];Se[A]=$,Xe[A]=K,this.setPage(A)}else if(g<A){$=Se[g],K=Xe[g];for(var ge=g;ge<A;ge++)Se[ge]=Se[ge+1],Xe[ge]=Xe[ge+1];Se[A]=$,Xe[A]=K,this.setPage(A)}return this},p.deletePage=function(){return ha.apply(this,arguments),this},p.__private__.text=p.text=function(g,A,$,K,ne){var ge,ye,Re,Be,nt,ct,St,Gt,hn,Bt=(K=K||{}).scope||this;if(typeof g=="number"&&typeof A=="number"&&(typeof $=="string"||Array.isArray($))){var mn=$;$=A,A=g,g=mn}if(arguments[3]instanceof Ze==0?(Re=arguments[4],Be=arguments[5],Tt(St=arguments[3])==="object"&&St!==null||(typeof Re=="string"&&(Be=Re,Re=null),typeof St=="string"&&(Be=St,St=null),typeof St=="number"&&(Re=St,St=null),K={flags:St,angle:Re,align:Be})):(U("The transform parameter of text() with a Matrix value"),hn=ne),isNaN(A)||isNaN($)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return Bt;var dn,Nn="",ni=typeof K.lineHeightFactor=="number"?K.lineHeightFactor:Vi,wr=Bt.internal.scaleFactor;function ri(Et){return Et=Et.split("	").join(Array(K.TabLen||9).join(" ")),cr(Et,St)}function _a(Et){for(var Ot,rn=Et.concat(),vn=[],ai=rn.length;ai--;)typeof(Ot=rn.shift())=="string"?vn.push(Ot):Array.isArray(Et)&&(Ot.length===1||Ot[1]===void 0&&Ot[2]===void 0)?vn.push(Ot[0]):vn.push([Ot[0],Ot[1],Ot[2]]);return vn}function Cs(Et,Ot){var rn;if(typeof Et=="string")rn=Ot(Et)[0];else if(Array.isArray(Et)){for(var vn,ai,Ca=Et.concat(),Os=[],Lo=Ca.length;Lo--;)typeof(vn=Ca.shift())=="string"?Os.push(Ot(vn)[0]):Array.isArray(vn)&&typeof vn[0]=="string"&&(ai=Ot(vn[0],vn[1],vn[2]),Os.push([ai[0],ai[1],ai[2]]));rn=Os}return rn}var bi=!1,Yi=!0;if(typeof g=="string")bi=!0;else if(Array.isArray(g)){var Xi=g.concat();ye=[];for(var yi,Ln=Xi.length;Ln--;)(typeof(yi=Xi.shift())!="string"||Array.isArray(yi)&&typeof yi[0]!="string")&&(Yi=!1);bi=Yi}if(bi===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var Zi=we/Bt.internal.scaleFactor,Qi=Zi*(ni-1);switch(K.baseline){case"bottom":$-=Qi;break;case"top":$+=Zi-Qi;break;case"hanging":$+=Zi-2*Qi;break;case"middle":$+=Zi/2-Qi}if((ct=K.maxWidth||0)>0&&(typeof g=="string"?g=Bt.splitTextToSize(g,ct):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(Et,Ot){return Et.concat(Bt.splitTextToSize(Ot,ct))},[]))),ge={text:g,x:A,y:$,options:K,mutex:{pdfEscape:cr,activeFontKey:De,fonts:ft,activeFontSize:we}},Lt.publish("preProcessText",ge),g=ge.text,Re=(K=ge.options).angle,hn instanceof Ze==0&&Re&&typeof Re=="number"){Re*=Math.PI/180,K.rotationDirection===0&&(Re=-Re),F===C&&(Re=-Re);var wa=Math.cos(Re),xa=Math.sin(Re);hn=new Ze(wa,xa,-xa,wa,0,0)}else Re&&Re instanceof Ze&&(hn=Re);F!==C||hn||(hn=Kr),(nt=K.charSpace||Zr)!==void 0&&(Nn+=J(B(nt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Gt=K.horizontalScale)!==void 0&&(Nn+=J(100*Gt)+` Tz
`),K.lang;var Mn=-1,ii=K.renderingMode!==void 0?K.renderingMode:K.stroke,Is=Bt.internal.getCurrentPageInfo().pageContext;switch(ii){case 0:case!1:case"fill":Mn=0;break;case 1:case!0:case"stroke":Mn=1;break;case 2:case"fillThenStroke":Mn=2;break;case 3:case"invisible":Mn=3;break;case 4:case"fillAndAddForClipping":Mn=4;break;case 5:case"strokeAndAddPathForClipping":Mn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mn=6;break;case 7:case"addToPathForClipping":Mn=7}var ko=Is.usedRenderingMode!==void 0?Is.usedRenderingMode:-1;Mn!==-1?Nn+=Mn+` Tr
`:ko!==-1&&(Nn+=`0 Tr
`),Mn!==-1&&(Is.usedRenderingMode=Mn),Be=K.align||"left";var hr,es=we*ni,Sa=Bt.internal.pageSize.getWidth(),Aa=ft[De];nt=K.charSpace||Zr,ct=K.maxWidth||0,St=Object.assign({autoencode:!0,noBOM:!0},K.flags);var _i=[],ts=function(Et){return Bt.getStringUnitWidth(Et,{font:Aa,charSpace:nt,fontSize:we,doKerning:!1})*we/wr};if(Object.prototype.toString.call(g)==="[object Array]"){var Gn;ye=_a(g),Be!=="left"&&(hr=ye.map(ts));var Kn,wi=0;if(Be==="right"){A-=hr[0],g=[],Ln=ye.length;for(var si=0;si<Ln;si++)si===0?(Kn=Yr(A),Gn=Xr($)):(Kn=B(wi-hr[si]),Gn=-es),g.push([ye[si],Kn,Gn]),wi=hr[si]}else if(Be==="center"){A-=hr[0]/2,g=[],Ln=ye.length;for(var xi=0;xi<Ln;xi++)xi===0?(Kn=Yr(A),Gn=Xr($)):(Kn=B((wi-hr[xi])/2),Gn=-es),g.push([ye[xi],Kn,Gn]),wi=hr[xi]}else if(Be==="left"){g=[],Ln=ye.length;for(var ka=0;ka<Ln;ka++)g.push(ye[ka])}else if(Be==="justify"&&Aa.encoding==="Identity-H"){g=[],Ln=ye.length,ct=ct!==0?ct:Sa;for(var Ts=0,nn=0;nn<Ln;nn++)if(Gn=nn===0?Xr($):-es,Kn=nn===0?Yr(A):Ts,nn<Ln-1){var No=B((ct-hr[nn])/(ye[nn].split(" ").length-1)),Br=ye[nn].split(" ");g.push([Br[0]+" ",Kn,Gn]),Ts=0;for(var Ur=1;Ur<Br.length;Ur++){var Na=(ts(Br[Ur-1]+" "+Br[Ur])-ts(Br[Ur]))*wr+No;Ur==Br.length-1?g.push([Br[Ur],Na,0]):g.push([Br[Ur]+" ",Na,0]),Ts-=Na}}else g.push([ye[nn],Kn,Gn]);g.push(["",Ts,0])}else{if(Be!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],Ln=ye.length,ct=ct!==0?ct:Sa,nn=0;nn<Ln;nn++){Gn=nn===0?Xr($):-es,Kn=nn===0?Yr(A):0;var La=ye[nn].split(" ").length-1,Ea=La>0?(ct-hr[nn])/La:0;nn<Ln-1?_i.push(J(B(Ea))):_i.push(0),g.push([ye[nn],Kn,Gn])}}}(typeof K.R2L=="boolean"?K.R2L:Ge)===!0&&(g=Cs(g,function(Et,Ot,rn){return[Et.split("").reverse().join(""),Ot,rn]})),ge={text:g,x:A,y:$,options:K,mutex:{pdfEscape:cr,activeFontKey:De,fonts:ft,activeFontSize:we}},Lt.publish("postProcessText",ge),g=ge.text,dn=ge.mutex.isHex||!1;var Pa=ft[De].encoding;Pa!=="WinAnsiEncoding"&&Pa!=="StandardEncoding"||(g=Cs(g,function(Et,Ot,rn){return[ri(Et),Ot,rn]})),ye=_a(g),g=[];for(var Si,Ai,ki,ns=Array.isArray(ye[0])?1:0,Ni="",rs=function(Et,Ot,rn){var vn="";return rn instanceof Ze?(rn=typeof K.angle=="number"?Gr(rn,new Ze(1,0,0,1,Et,Ot)):Gr(new Ze(1,0,0,1,Et,Ot),rn),F===C&&(rn=Gr(new Ze(1,0,0,-1,0,0),rn)),vn=rn.join(" ")+` Tm
`):vn=J(Et)+" "+J(Ot)+` Td
`,vn},dr=0;dr<ye.length;dr++){switch(Ni="",ns){case 1:ki=(dn?"<":"(")+ye[dr][0]+(dn?">":")"),Si=parseFloat(ye[dr][1]),Ai=parseFloat(ye[dr][2]);break;case 0:ki=(dn?"<":"(")+ye[dr]+(dn?">":")"),Si=Yr(A),Ai=Xr($)}_i!==void 0&&_i[dr]!==void 0&&(Ni=_i[dr]+` Tw
`),dr===0?g.push(Ni+rs(Si,Ai,hn)+ki):ns===0?g.push(Ni+ki):ns===1&&g.push(Ni+rs(Si,Ai,hn)+ki)}g=ns===0?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var Mr=`BT
/`;return Mr+=De+" "+we+` Tf
`,Mr+=J(we*ni)+` TL
`,Mr+=Gi+`
`,Mr+=Nn,Mr+=g,D(Mr+="ET"),y[De]=!0,Bt};var Ul=p.__private__.clip=p.clip=function(g){return D(g==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Ul("evenodd")},p.__private__.discardPath=p.discardPath=function(){return D("n"),this};var Dr=p.__private__.isValidStyle=function(g){var A=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(A=!0),A};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(g){return Dr(g)&&(h=g),this};var vo=p.__private__.getStyle=p.getStyle=function(g){var A=h;switch(g){case"D":case"S":A="S";break;case"F":A="f";break;case"FD":case"DF":A="B";break;case"f":case"f*":case"B":case"B*":A=g}return A},bo=p.close=function(){return D("h"),this};p.stroke=function(){return D("S"),this},p.fill=function(g){return Ls("f",g),this},p.fillEvenOdd=function(g){return Ls("f*",g),this},p.fillStroke=function(g){return Ls("B",g),this},p.fillStrokeEvenOdd=function(g){return Ls("B*",g),this};var Ls=function(g,A){Tt(A)==="object"?ql(A,g):D(g)},Hi=function(g){g===null||F===C&&g===void 0||(g=vo(g),D(g))};function Ml(g,A,$,K,ne){var ge=new Ys(A||this.boundingBox,$||this.xStep,K||this.yStep,this.gState,ne||this.matrix);ge.stream=this.stream;var ye=g+"$$"+this.cloneIndex+++"$$";return ar(ye,ge),ge}var ql=function(g,A){var $=Dt[g.key],K=He[$];if(K instanceof fs)D("q"),D($l(A)),K.gState&&p.setGState(K.gState),D(g.matrix.toString()+" cm"),D("/"+$+" sh"),D("Q");else if(K instanceof Ys){var ne=new Ze(1,0,0,-1,0,Ji());g.matrix&&(ne=ne.multiply(g.matrix||Kr),$=Ml.call(K,g.key,g.boundingBox,g.xStep,g.yStep,ne).id),D("q"),D("/Pattern cs"),D("/"+$+" scn"),K.gState&&p.setGState(K.gState),D(A),D("Q")}},$l=function(g){switch(g){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},da=p.moveTo=function(g,A){return D(J(B(g))+" "+J(W(A))+" m"),this},yo=p.lineTo=function(g,A){return D(J(B(g))+" "+J(W(A))+" l"),this},_r=p.curveTo=function(g,A,$,K,ne,ge){return D([J(B(g)),J(W(A)),J(B($)),J(W(K)),J(B(ne)),J(W(ge)),"c"].join(" ")),this};p.__private__.line=p.line=function(g,A,$,K,ne){if(isNaN(g)||isNaN(A)||isNaN($)||isNaN(K)||!Dr(ne))throw new Error("Invalid arguments passed to jsPDF.line");return F===O?this.lines([[$-g,K-A]],g,A,[1,1],ne||"S"):this.lines([[$-g,K-A]],g,A,[1,1]).stroke()},p.__private__.lines=p.lines=function(g,A,$,K,ne,ge){var ye,Re,Be,nt,ct,St,Gt,hn,Bt,mn,dn,Nn;if(typeof g=="number"&&(Nn=$,$=A,A=g,g=Nn),K=K||[1,1],ge=ge||!1,isNaN(A)||isNaN($)||!Array.isArray(g)||!Array.isArray(K)||!Dr(ne)||typeof ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(da(A,$),ye=K[0],Re=K[1],nt=g.length,mn=A,dn=$,Be=0;Be<nt;Be++)(ct=g[Be]).length===2?(mn=ct[0]*ye+mn,dn=ct[1]*Re+dn,yo(mn,dn)):(St=ct[0]*ye+mn,Gt=ct[1]*Re+dn,hn=ct[2]*ye+mn,Bt=ct[3]*Re+dn,mn=ct[4]*ye+mn,dn=ct[5]*Re+dn,_r(St,Gt,hn,Bt,mn,dn));return ge&&bo(),Hi(ne),this},p.path=function(g){for(var A=0;A<g.length;A++){var $=g[A],K=$.c;switch($.op){case"m":da(K[0],K[1]);break;case"l":yo(K[0],K[1]);break;case"c":_r.apply(this,K);break;case"h":bo()}}return this},p.__private__.rect=p.rect=function(g,A,$,K,ne){if(isNaN(g)||isNaN(A)||isNaN($)||isNaN(K)||!Dr(ne))throw new Error("Invalid arguments passed to jsPDF.rect");return F===O&&(K=-K),D([J(B(g)),J(W(A)),J(B($)),J(B(K)),"re"].join(" ")),Hi(ne),this},p.__private__.triangle=p.triangle=function(g,A,$,K,ne,ge,ye){if(isNaN(g)||isNaN(A)||isNaN($)||isNaN(K)||isNaN(ne)||isNaN(ge)||!Dr(ye))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$-g,K-A],[ne-$,ge-K],[g-ne,A-ge]],g,A,[1,1],ye,!0),this},p.__private__.roundedRect=p.roundedRect=function(g,A,$,K,ne,ge,ye){if(isNaN(g)||isNaN(A)||isNaN($)||isNaN(K)||isNaN(ne)||isNaN(ge)||!Dr(ye))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Re=4/3*(Math.SQRT2-1);return ne=Math.min(ne,.5*$),ge=Math.min(ge,.5*K),this.lines([[$-2*ne,0],[ne*Re,0,ne,ge-ge*Re,ne,ge],[0,K-2*ge],[0,ge*Re,-ne*Re,ge,-ne,ge],[2*ne-$,0],[-ne*Re,0,-ne,-ge*Re,-ne,-ge],[0,2*ge-K],[0,-ge*Re,ne*Re,-ge,ne,-ge]],g+ne,A,[1,1],ye,!0),this},p.__private__.ellipse=p.ellipse=function(g,A,$,K,ne){if(isNaN(g)||isNaN(A)||isNaN($)||isNaN(K)||!Dr(ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ge=4/3*(Math.SQRT2-1)*$,ye=4/3*(Math.SQRT2-1)*K;return da(g+$,A),_r(g+$,A-ye,g+ge,A-K,g,A-K),_r(g-ge,A-K,g-$,A-ye,g-$,A),_r(g-$,A+ye,g-ge,A+K,g,A+K),_r(g+ge,A+K,g+$,A+ye,g+$,A),Hi(ne),this},p.__private__.circle=p.circle=function(g,A,$,K){if(isNaN(g)||isNaN(A)||isNaN($)||!Dr(K))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,A,$,$,K)},p.setFont=function(g,A,$){return $&&(A=re(A,$)),De=fo(g,A,{disableWarning:!1}),this};var zl=p.__private__.getFont=p.getFont=function(){return ft[fo.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var g,A,$={};for(g in pt)if(pt.hasOwnProperty(g))for(A in $[g]=[],pt[g])pt[g].hasOwnProperty(A)&&$[g].push(A);return $},p.addFont=function(g,A,$,K,ne){var ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ge.indexOf(arguments[3])!==-1?ne=arguments[3]:arguments[3]&&ge.indexOf(arguments[3])==-1&&($=re($,K)),lo.call(this,g,A,$,ne=ne||"Identity-H")};var Vi,fa=n.lineWidth||.200025,Wl=p.__private__.getLineWidth=p.getLineWidth=function(){return fa},rt=p.__private__.setLineWidth=p.setLineWidth=function(g){return fa=g,D(J(B(g))+" w"),this};p.__private__.setLineDash=qe.API.setLineDash=qe.API.setLineDashPattern=function(g,A){if(g=g||[],A=A||0,isNaN(A)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function($){return J(B($))}).join(" "),A=J(B(A)),D("["+g+"] "+A+" d"),this};var Hl=p.__private__.getLineHeight=p.getLineHeight=function(){return we*Vi};p.__private__.getLineHeight=p.getLineHeight=function(){return we*Vi};var Vl=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(Vi=g),this},Gl=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Vi};Vl(n.lineHeight);var Yr=p.__private__.getHorizontalCoordinate=function(g){return B(g)},Xr=p.__private__.getVerticalCoordinate=function(g){return F===C?g:Xe[z].mediaBox.topRightY-Xe[z].mediaBox.bottomLeftY-B(g)},Kl=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(g){return J(Yr(g))},Jl=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(g){return J(Xr(g))},Es=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Or(Es)},p.__private__.setStrokeColor=p.setDrawColor=function(g,A,$,K){return Es=br({ch1:g,ch2:A,ch3:$,ch4:K,pdfColorType:"draw",precision:2}),D(Es),this};var pa=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Or(pa)},p.__private__.setFillColor=p.setFillColor=function(g,A,$,K){return pa=br({ch1:g,ch2:A,ch3:$,ch4:K,pdfColorType:"fill",precision:2}),D(pa),this};var Gi=n.textColor||"0 g",Yl=p.__private__.getTextColor=p.getTextColor=function(){return Or(Gi)};p.__private__.setTextColor=p.setTextColor=function(g,A,$,K){return Gi=br({ch1:g,ch2:A,ch3:$,ch4:K,pdfColorType:"text",precision:3}),this};var Zr=n.charSpace,Xl=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Zr||0)};p.__private__.setCharSpace=p.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zr=g,this};var ga=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(g){var A=p.CapJoinStyles[g];if(A===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ga=A,D(A+" J"),this};var ma=0;p.__private__.setLineJoin=p.setLineJoin=function(g){var A=p.CapJoinStyles[g];if(A===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ma=A,D(A+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return D(J(B(g))+" M"),this},p.GState=Al,p.setGState=function(g){(g=typeof g=="string"?et[at[g]]:_o(null,g)).equals(Ht)||(D("/"+g.id+" gs"),Ht=g)};var _o=function(g,A){if(!g||!at[g]){var $=!1;for(var K in et)if(et.hasOwnProperty(K)&&et[K].equals(A)){$=!0;break}if($)A=et[K];else{var ne="GS"+(Object.keys(et).length+1).toString(10);et[ne]=A,A.id=ne}return g&&(at[g]=A.id),Lt.publish("addGState",A),A}};p.addGState=function(g,A){return _o(g,A),this},p.saveGraphicsState=function(){return D("q"),Wt.push({key:De,size:we,color:Gi}),this},p.restoreGraphicsState=function(){D("Q");var g=Wt.pop();return De=g.key,we=g.size,Gi=g.color,Ht=null,this},p.setCurrentTransformationMatrix=function(g){return D(g.toString()+" cm"),this},p.comment=function(g){return D("#"+g),this};var Qr=function(g,A){var $=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $},set:function(ge){isNaN(ge)||($=parseFloat(ge))}});var K=A||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return K},set:function(ge){isNaN(ge)||(K=parseFloat(ge))}});var ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ne},set:function(ge){ne=ge.toString()}}),this},va=function(g,A,$,K){Qr.call(this,g,A),this.type="rect";var ne=$||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ne},set:function(ye){isNaN(ye)||(ne=parseFloat(ye))}});var ge=K||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ge},set:function(ye){isNaN(ye)||(ge=parseFloat(ye))}}),this},Ps=function(){this.page=gt,this.currentPage=z,this.pages=Se.slice(0),this.pagesContext=Xe.slice(0),this.x=$e,this.y=tn,this.matrix=xt,this.width=ya(z),this.height=xo(z),this.outputDestination=Pe,this.id="",this.objectNumber=-1};Ps.prototype.restore=function(){gt=this.page,z=this.currentPage,Xe=this.pagesContext,Se=this.pages,$e=this.x,tn=this.y,xt=this.matrix,wo(z,this.width),ei(z,this.height),Pe=this.outputDestination};var ba=function(g,A,$,K,ne){Tr.push(new Ps),gt=z=0,Se=[],$e=g,tn=A,xt=ne,ua([$,K])};for(var Ki in p.beginFormObject=function(g,A,$,K,ne){return ba(g,A,$,K,ne),this},p.endFormObject=function(g){return(function(A){if(Vr[A])Tr.pop().restore();else{var $=new Ps,K="Xo"+(Object.keys(On).length+1).toString(10);$.id=K,Vr[A]=K,On[K]=$,Lt.publish("addFormObject",$),Tr.pop().restore()}})(g),this},p.doFormObject=function(g,A){var $=On[Vr[g]];return D("q"),D(A.toString()+" cm"),D("/"+$.id+" Do"),D("Q"),this},p.getFormObject=function(g){var A=On[Vr[g]];return{x:A.x,y:A.y,width:A.width,height:A.height,matrix:A.matrix}},p.save=function(g,A){return g=g||"generated.pdf",(A=A||{}).returnPromise=A.returnPromise||!1,A.returnPromise===!1?(cs(Ns(Fr()),g),typeof cs.unload=="function"&&tt.setTimeout&&setTimeout(cs.unload,911),this):new Promise(function($,K){try{var ne=cs(Ns(Fr()),g);typeof cs.unload=="function"&&tt.setTimeout&&setTimeout(cs.unload,911),$(ne)}catch(ge){K(ge.message)}})},qe.API)qe.API.hasOwnProperty(Ki)&&(Ki==="events"&&qe.API.events.length?(function(g,A){var $,K,ne;for(ne=A.length-1;ne!==-1;ne--)$=A[ne][0],K=A[ne][1],g.subscribe.apply(g,[$].concat(typeof K=="function"?[K]:K))})(Lt,qe.API.events):p[Ki]=qe.API[Ki]);function ya(g){return Xe[g].mediaBox.topRightX-Xe[g].mediaBox.bottomLeftX}function wo(g,A){Xe[g].mediaBox.topRightX=A+Xe[g].mediaBox.bottomLeftX}function xo(g){return Xe[g].mediaBox.topRightY-Xe[g].mediaBox.bottomLeftY}function ei(g,A){Xe[g].mediaBox.topRightY=A+Xe[g].mediaBox.bottomLeftY}var ti=p.getPageWidth=function(g){return ya(g=g||z)/lt},So=p.setPageWidth=function(g,A){wo(g,A*lt)},Ji=p.getPageHeight=function(g){return xo(g=g||z)/lt},Ao=p.setPageHeight=function(g,A){ei(g,A*lt)};return p.internal={pdfEscape:cr,getStyle:vo,getFont:zl,getFontSize:Te,getCharSpace:Xl,getTextColor:Yl,getLineHeight:Hl,getLineHeightFactor:Gl,getLineWidth:Wl,write:Ee,getHorizontalCoordinate:Yr,getVerticalCoordinate:Xr,getCoordinateString:Kl,getVerticalCoordinateString:Jl,collections:{},newObject:Yt,newAdditionalObject:$i,newObjectDeferred:xn,newObjectDeferredBegin:kn,getFilters:yr,putStream:lr,events:Lt,scaleFactor:lt,pageSize:{getWidth:function(){return ti(z)},setWidth:function(g){So(z,g)},getHeight:function(){return Ji(z)},setHeight:function(g){Ao(z,g)}},encryptionOptions:f,encryption:gn,getEncryptor:function(g){return f!==null?gn.encryptor(g,0):function(A){return A}},output:go,getNumberOfPages:ho,get pages(){return Se},out:D,f2:L,f3:R,getPageInfo:Jr,getPageInfoByObjId:mo,getCurrentPageInfo:Bl,getPDFVersion:_,Point:Qr,Rectangle:va,Matrix:Ze,hasHotfix:ur},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return ti(z)},set:function(g){So(z,g)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Ji(z)},set:function(g){Ao(z,g)},enumerable:!0,configurable:!0}),(function(g){for(var A=0,$=Ke.length;A<$;A++){var K=lo.call(this,g[A][0],g[A][1],g[A][2],Ke[A][3],!0);m===!1&&(y[K]=!0);var ne=g[A][0].split("-");oo({id:K,fontName:ne[0],fontStyle:ne[1]||""})}Lt.publish("addFonts",{fonts:ft,dictionary:pt})}).call(p,Ke),De="F1",co(s,t),Lt.publish("initialized"),p}Gs.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},Gs.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Gs.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},Gs.prototype.processOwnerPassword=function(n,e){return xu(wu(e).substr(0,5),n)},Gs.prototype.encryptor=function(n,e){var t=wu(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return xu(t,r)}},Al.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Tt(n)!==Tt(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},qe.API={events:[]},qe.version="4.2.0";var Qt=qe.API,Hu=1,ws=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$s=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ys=function(n){return n.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"#"+(t.length===1?"0"+t:t)})},it=function(n){return n.toFixed(2)},Ri=function(n){return n.toFixed(5)};Qt.__acroform__={};var Vn=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},ff=function(n){return n*Hu},$r=function(n){var e=new t0,t=Oe.internal.getHeight(n)||0,r=Oe.internal.getWidth(n)||0;return e.BBox=[0,0,Number(it(r)),Number(it(t))],e},Jv=Qt.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},Yv=Qt.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},Xv=Qt.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},on=Qt.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Xv(n,e-1)},ln=Qt.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Jv(n,e-1)},cn=Qt.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Yv(n,e-1)},Zv=Qt.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,s=n[0],i=n[1],a=n[2],o=n[3],u={};return u.lowerLeft_X=t(s)||0,u.lowerLeft_Y=r(i+o)||0,u.upperRight_X=t(s+a)||0,u.upperRight_Y=r(i)||0,[Number(it(u.lowerLeft_X)),Number(it(u.lowerLeft_Y)),Number(it(u.upperRight_X)),Number(it(u.upperRight_Y))]},Qv=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Su(n,t),s=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+s+" "+it(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=$r(n);return i.scope=n.scope,i.stream=e.join(`
`),i}},Su=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=n.multiline?s.map(function(L){return L.split(`
`)}):s.map(function(L){return[L]});var i=t,a=Oe.internal.getHeight(n)||0;a=a<0?-a:a;var o=Oe.internal.getWidth(n)||0;o=o<0?-o:o;var u=function(L,R,B){if(L+1<s.length){var W=R+" "+s[L+1][0];return al(W,n,B).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var h,f,m=al("3",n,i).height,y=n.multiline?a-i:(a-m)/2,p=y+=2,S=0,_=0,x=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+al(e,n,i=12).width+", FieldWidth:"+o+`
`;break}for(var w="",O=0,C=0;C<s.length;C++)if(s.hasOwnProperty(C)){var F=!1;if(s[C].length!==1&&x!==s[C].length-1){if((m+2)*(O+2)+2>a)continue e;w+=s[C][x],F=!0,_=C,C--}else{w=(w+=s[C][x]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var G=parseInt(C),V=u(G,w,i),re=C>=s.length-1;if(V&&!re){w+=" ",x=0;continue}if(V||re){if(re)_=G;else if(n.multiline&&(m+2)*(O+2)+2>a)continue e}else{if(!n.multiline||(m+2)*(O+2)+2>a)continue e;_=G}}for(var J="",U=S;U<=_;U++){var I=s[U];if(n.multiline){if(U===_){J+=I[x]+" ",x=(x+1)%I.length;continue}if(U===S){J+=I[I.length-1]+" ";continue}}J+=I[0]+" "}switch(J=J.substr(J.length-1)==" "?J.substr(0,J.length-1):J,f=al(J,n,i).width,n.textAlign){case"right":h=o-f-2;break;case"center":h=(o-f)/2;break;default:h=2}e+=it(h)+" "+it(p)+` Td
`,e+="("+ws(J)+`) Tj
`,e+=-it(h)+` 0 Td
`,p=-(i+2),f=0,S=F?_:_+1,O++,w=""}break}return r.text=e,r.fontSize=i,r},al=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},eb={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},tb=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},nb=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Cr.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(eb)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Hu=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new n0,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in r)if(r.hasOwnProperty(s)){var i=r[s];i.objId=void 0,i.hasAnnotation&&tb(i,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,s){var i=!r;for(var a in r||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(a)){var o=r[a],u=[],h=o.Rect;if(o.Rect&&(o.Rect=Zv(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Oe.createDefaultAppearanceStream(o),Tt(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=Qv(o);u.push({key:"AP",value:"<</N "+f+">>"}),s.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var m="";for(var y in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(y)){var p=o.appearanceStreamContent[y];if(m+="/"+y+" ",m+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var a in p)if(p.hasOwnProperty(a)){var S=p[a];typeof S=="function"&&(S=S.call(s,o)),m+="/"+a+" "+S+" ",s.internal.acroformPlugin.xForms.indexOf(S)>=0||s.internal.acroformPlugin.xForms.push(S)}}else typeof(S=p)=="function"&&(S=S.call(s,o)),m+="/"+a+" "+S,s.internal.acroformPlugin.xForms.indexOf(S)>=0||s.internal.acroformPlugin.xForms.push(S);m+=">>"}u.push({key:"AP",value:`<<
`+m+">>"})}s.internal.putStream({additionalKeyValues:u,objectId:o.objId}),s.internal.out("endobj")}i&&(function(_,x){for(var w in _)if(_.hasOwnProperty(w)){var O=w,C=_[w];x.internal.newObjectDeferredBegin(C.objId,!0),Tt(C)==="object"&&typeof C.putStream=="function"&&C.putStream(),delete _[O]}})(s.internal.acroformPlugin.xForms,s)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},e0=Qt.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(a){return a};if(Array.isArray(n)){for(var s="[",i=0;i<n.length;i++)switch(i!==0&&(s+=" "),Tt(n[i])){case"boolean":case"number":case"object":s+=n[i].toString();break;case"string":n[i].substr(0,1)==="/"?s+="/"+ys(n[i].substr(1)):(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),s+="("+ws(r(n[i].toString()))+")")}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},$c=function(n,e,t){var r=function(s){return s};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+ws(r(n))+")"},Wr=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Wr.prototype.toString=function(){return this.objId+" 0 R"},Wr.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Wr.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],s=this[r];s&&(Array.isArray(s)?n.push({key:r,value:e0(s,this.objId,this.scope)}):s instanceof Wr?(s.scope=this.scope,n.push({key:r,value:s.objId+" 0 R"})):typeof s!="function"&&n.push({key:r,value:s}))}return n};var t0=function(){Wr.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Vn(t0,Wr);var n0=function(){Wr.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ws(t(n))+")"}},set:function(t){n=t}})};Vn(n0,Wr);var Cr=function n(){Wr.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!on(e,3)},set:function(w){w?this.F=ln(e,3):this.F=cn(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(w){r=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(w){r[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(w){r[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(w){r[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(w){r[3]=w}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof kl)return;i="FieldObject"+n.FieldNum++}var w=function(O){return O};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+ws(w(i))+")"},set:function(w){i=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(w){i=w}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Hu:h},set:function(w){h=w}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(w){f=w}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof kl||this instanceof ms))return $c(m,this.objId,this.scope)},set:function(w){w=w.toString(),m=w}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Sn==0?$c(y,this.objId,this.scope):y},set:function(w){w=w.toString(),y=this instanceof Sn==0?w.substr(0,1)==="("?$s(w.substr(1,w.length-2)):$s(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Sn==1?$s(y.substr(1,y.length-1)):y},set:function(w){w=w.toString(),y=this instanceof Sn==1?"/"+ys(w):w}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Sn==0?$c(p,this.objId,this.scope):p},set:function(w){w=w.toString(),p=this instanceof Sn==0?w.substr(0,1)==="("?$s(w.substr(1,w.length-2)):$s(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Sn==1?$s(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof Sn==1?"/"+ys(w):w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(w){w=!!w,_=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(w){S=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,1)},set:function(w){w?this.Ff=ln(this.Ff,1):this.Ff=cn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,2)},set:function(w){w?this.Ff=ln(this.Ff,2):this.Ff=cn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,3)},set:function(w){w?this.Ff=ln(this.Ff,3):this.Ff=cn(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');x=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(x){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};Vn(Cr,Wr);var Zs=function(){Cr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return e0(e,this.objId,this.scope)},set:function(t){var r,s;s=[],typeof(r=t)=="string"&&(s=(function(i,a,o){o||(o=1);for(var u,h=[];u=a.exec(i);)h.push(u[o]);return h})(r,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,18)},set:function(t){t?this.Ff=ln(this.Ff,18):this.Ff=cn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ln(this.Ff,19):this.Ff=cn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,20)},set:function(t){t?(this.Ff=ln(this.Ff,20),e.sort()):this.Ff=cn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,22)},set:function(t){t?this.Ff=ln(this.Ff,22):this.Ff=cn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,23)},set:function(t){t?this.Ff=ln(this.Ff,23):this.Ff=cn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,27)},set:function(t){t?this.Ff=ln(this.Ff,27):this.Ff=cn(this.Ff,27)}}),this.hasAppearanceStream=!1};Vn(Zs,Cr);var Qs=function(){Zs.call(this),this.fontName="helvetica",this.combo=!1};Vn(Qs,Zs);var ea=function(){Qs.call(this),this.combo=!0};Vn(ea,Qs);var hl=function(){ea.call(this),this.edit=!0};Vn(hl,ea);var Sn=function(){Cr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,15)},set:function(t){t?this.Ff=ln(this.Ff,15):this.Ff=cn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,16)},set:function(t){t?this.Ff=ln(this.Ff,16):this.Ff=cn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,17)},set:function(t){t?this.Ff=ln(this.Ff,17):this.Ff=cn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,26)},set:function(t){t?this.Ff=ln(this.Ff,26):this.Ff=cn(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,s=[];for(r in s.push("<<"),e)s.push("/"+r+" ("+ws(t(e[r]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){Tt(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){var r=t==null?"":t.toString();r.substr(0,1)==="/"&&(r=r.substr(1)),n="/"+ys(r)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+ys(t)}})};Vn(Sn,Cr);var dl=function(){Sn.call(this),this.pushButton=!0};Vn(dl,Sn);var ta=function(){Sn.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};Vn(ta,Sn);var kl=function(){var n,e;Cr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),r)a.push("/"+i+" ("+ws(s(r[i]))+")");return a.push(">>"),a.join(`
`)},set:function(s){Tt(s)==="object"&&(r=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(s){typeof s=="string"&&(r.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){var i=s==null?"":s.toString();i.substr(0,1)==="/"&&(i=i.substr(1)),t="/"+ys(i)}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){var i=s==null?"":s.toString();i.substr(0,1)==="/"&&(i=i.substr(1)),t="/"+ys(i)}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Oe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Vn(kl,Cr),ta.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},ta.prototype.createOption=function(n){var e=new kl;return e.Parent=this,e.optionName=n,this.Kids.push(e),rb.call(this.scope,e),e};var fl=function(){Sn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Oe.CheckBox.createAppearanceStream()};Vn(fl,Sn);var ms=function(){Cr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,13)},set:function(e){e?this.Ff=ln(this.Ff,13):this.Ff=cn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,21)},set:function(e){e?this.Ff=ln(this.Ff,21):this.Ff=cn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,23)},set:function(e){e?this.Ff=ln(this.Ff,23):this.Ff=cn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,24)},set:function(e){e?this.Ff=ln(this.Ff,24):this.Ff=cn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,25)},set:function(e){e?this.Ff=ln(this.Ff,25):this.Ff=cn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,26)},set:function(e){e?this.Ff=ln(this.Ff,26):this.Ff=cn(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Vn(ms,Cr);var pl=function(){ms.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!on(this.Ff,14)},set:function(n){n?this.Ff=ln(this.Ff,14):this.Ff=cn(this.Ff,14)}}),this.password=!0};Vn(pl,ms);var Oe={CheckBox:{createAppearanceStream:function(){return{N:{On:Oe.CheckBox.YesNormal},D:{On:Oe.CheckBox.YesPushDown,Off:Oe.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),i=Su(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+it(Oe.internal.getWidth(n))+" "+it(Oe.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+it(i.fontSize)+" Tf "+s),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=$r(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),s=[],i=Oe.internal.getHeight(n),a=Oe.internal.getWidth(n),o=Su(n,n.caption);return s.push("1 g"),s.push("0 0 "+it(a)+" "+it(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+it(a-1)+" "+it(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+it(o.fontSize)+" Tf "+r),s.push(o.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+it(Oe.internal.getWidth(n))+" "+it(Oe.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Oe.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Oe.RadioButton.Circle.YesNormal,e.D[n]=Oe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=$r(n);e.scope=n.scope;var t=[],r=Oe.internal.getWidth(n)<=Oe.internal.getHeight(n)?Oe.internal.getWidth(n)/4:Oe.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=Oe.internal.Bezier_C,i=Number((r*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Ri(Oe.internal.getWidth(n)/2)+" "+Ri(Oe.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=[],r=Oe.internal.getWidth(n)<=Oe.internal.getHeight(n)?Oe.internal.getWidth(n)/4:Oe.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*Oe.internal.Bezier_C).toFixed(5)),a=Number((r*Oe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ri(Oe.internal.getWidth(n)/2)+" "+Ri(Oe.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Ri(Oe.internal.getWidth(n)/2)+" "+Ri(Oe.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=[],r=Oe.internal.getWidth(n)<=Oe.internal.getHeight(n)?Oe.internal.getWidth(n)/4:Oe.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*Oe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ri(Oe.internal.getWidth(n)/2)+" "+Ri(Oe.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Oe.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Oe.RadioButton.Cross.YesNormal,e.D[n]=Oe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=$r(n);e.scope=n.scope;var t=[],r=Oe.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+it(Oe.internal.getWidth(n)-2)+" "+it(Oe.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(it(r.x1.x)+" "+it(r.x1.y)+" m"),t.push(it(r.x2.x)+" "+it(r.x2.y)+" l"),t.push(it(r.x4.x)+" "+it(r.x4.y)+" m"),t.push(it(r.x3.x)+" "+it(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=Oe.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+it(Oe.internal.getWidth(n))+" "+it(Oe.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+it(Oe.internal.getWidth(n)-2)+" "+it(Oe.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(it(t.x1.x)+" "+it(t.x1.y)+" m"),r.push(it(t.x2.x)+" "+it(t.x2.y)+" l"),r.push(it(t.x4.x)+" "+it(t.x4.y)+" m"),r.push(it(t.x3.x)+" "+it(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=$r(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+it(Oe.internal.getWidth(n))+" "+it(Oe.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};Oe.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Oe.internal.getWidth(n),t=Oe.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},Oe.internal.getWidth=function(n){var e=0;return Tt(n)==="object"&&(e=ff(n.Rect[2])),e},Oe.internal.getHeight=function(n){var e=0;return Tt(n)==="object"&&(e=ff(n.Rect[3])),e};var rb=Qt.addField=function(n){if(nb(this,n),!(n instanceof Cr))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Qt.AcroFormChoiceField=Zs,Qt.AcroFormListBox=Qs,Qt.AcroFormComboBox=ea,Qt.AcroFormEditBox=hl,Qt.AcroFormButton=Sn,Qt.AcroFormPushButton=dl,Qt.AcroFormRadioButton=ta,Qt.AcroFormCheckBox=fl,Qt.AcroFormTextField=ms,Qt.AcroFormPasswordField=pl,Qt.AcroFormAppearance=Oe,Qt.AcroForm={ChoiceField:Zs,ListBox:Qs,ComboBox:ea,EditBox:hl,Button:Sn,PushButton:dl,RadioButton:ta,CheckBox:fl,TextField:ms,PasswordField:pl,Appearance:Oe},qe.AcroForm={ChoiceField:Zs,ListBox:Qs,ComboBox:ea,EditBox:hl,Button:Sn,PushButton:dl,RadioButton:ta,CheckBox:fl,TextField:ms,PasswordField:pl,Appearance:Oe};qe.AcroForm;function r0(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=n.__addimage__.getImageFileTypeByImageData=function(L,R){var B,W,Z,ue,he,ie=t;if((R=R||t)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(V(L))for(he in r)for(Z=r[he],B=0;B<Z.length;B+=1){for(ue=!0,W=0;W<Z[B].length;W+=1)if(Z[B][W]!==void 0&&Z[B][W]!==L[W]){ue=!1;break}if(ue===!0){ie=he;break}}else for(he in r)for(Z=r[he],B=0;B<Z.length;B+=1){for(ue=!0,W=0;W<Z[B].length;W+=1)if(Z[B][W]!==void 0&&Z[B][W]!==L.charCodeAt(W)){ue=!1;break}if(ue===!0){ie=he;break}}return ie===t&&R!==t&&(ie=R),ie},i=function L(R){for(var B=this.internal.write,W=this.internal.putStream,Z=(0,this.internal.getFilters)();Z.indexOf("FlateEncode")!==-1;)Z.splice(Z.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var ue=[];if(ue.push({key:"Type",value:"/XObject"}),ue.push({key:"Subtype",value:"/Image"}),ue.push({key:"Width",value:R.width}),ue.push({key:"Height",value:R.height}),R.colorSpace===w.INDEXED?ue.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(ue.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===w.DEVICE_CMYK&&ue.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ue.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&ue.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)&&R.transparency.length>0){for(var he="",ie=0,de=R.transparency.length;ie<de;ie++)he+=R.transparency[ie]+" "+R.transparency[ie]+" ";ue.push({key:"Mask",value:"["+he+"]"})}R.sMask!==void 0&&ue.push({key:"SMask",value:R.objectId+1+" 0 R"});var ke=R.filter!==void 0?["/"+R.filter]:void 0;if(W({data:R.data,additionalKeyValues:ue,alreadyAppliedFilters:ke,objectId:R.objectId}),B("endobj"),"sMask"in R&&R.sMask!==void 0){var be,E=(be=R.sMaskBitsPerComponent)!==null&&be!==void 0?be:R.bitsPerComponent,z={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:R.sMask};"filter"in R&&(z.decodeParameters="/Predictor ".concat(R.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(R.width),z.filter=R.filter),L.call(this,z)}if(R.colorSpace===w.INDEXED){var H=this.internal.newObject();W({data:J(new Uint8Array(R.palette)),objectId:H}),B("endobj")}},a=function(){var L=this.internal.collections[e+"images"];for(var R in L)i.call(this,L[R])},o=function(){var L,R=this.internal.collections[e+"images"],B=this.internal.write;for(var W in R)B("/I"+(L=R[W]).index,L.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var L=this.internal.collections[e+"images"];return u.call(this),L},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},m=function(L){return typeof n["process"+L.toUpperCase()]=="function"},y=function(L){return Tt(L)==="object"&&L.nodeType===1},p=function(L,R){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var B=""+L.getAttribute("src");if(B.indexOf("data:image/")===0)return ul(unescape(B).split("base64,").pop());var W=n.loadFile(B,!0);if(W!==void 0)return W}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var Z;switch(R){case"PNG":Z="image/png";break;case"WEBP":Z="image/webp";break;default:Z="image/jpeg"}return ul(L.toDataURL(Z,1).split("base64,").pop())}},S=function(L){var R=this.internal.collections[e+"images"];if(R){for(var B in R)if(L===R[B].alias)return R[B]}},_=function(L,R,B){return L||R||(L=-96,R=-96),L<0&&(L=-1*B.width*72/L/this.internal.scaleFactor),R<0&&(R=-1*B.height*72/R/this.internal.scaleFactor),L===0&&(L=R*B.width/B.height),R===0&&(R=L*B.height/B.width),[L,R]},x=function(L,R,B,W,Z,ue){var he=_.call(this,B,W,Z),ie=this.internal.getCoordinateString,de=this.internal.getVerticalCoordinateString,ke=h.call(this);if(B=he[0],W=he[1],ke[Z.index]=Z,ue){ue*=Math.PI/180;var be=Math.cos(ue),E=Math.sin(ue),z=function(Y){return Y.toFixed(4)},H=[z(be),z(E),z(-1*E),z(be),0,0,"cm"]}this.internal.write("q"),ue?(this.internal.write([1,"0","0",1,ie(L),de(R+W),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([ie(B),"0","0",ie(W),"0","0","cm"].join(" "))):this.internal.write([ie(B),"0","0",ie(W),ie(L),de(R+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Z.index+" Do"),this.internal.write("Q")},w=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},C=n.__addimage__.sHashCode=function(L){var R,B,W=0;if(typeof L=="string")for(B=L.length,R=0;R<B;R++)W=(W<<5)-W+L.charCodeAt(R),W|=0;else if(V(L))for(B=L.byteLength/2,R=0;R<B;R++)W=(W<<5)-W+L[R],W|=0;return W},F=n.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var R=!0;return L.length===0&&(R=!1),L.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(R=!1),R},G=n.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var R=L.indexOf(",");return R<0?null:L.substring(0,R).trim().endsWith("base64")?L.substring(R+1):null};n.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var V=n.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},re=n.__addimage__.binaryStringToUint8Array=function(L){for(var R=L.length,B=new Uint8Array(R),W=0;W<R;W++)B[W]=L.charCodeAt(W);return B},J=n.__addimage__.arrayBufferToBinaryString=function(L){for(var R="",B=V(L)?L:new Uint8Array(L),W=0;W<B.length;W+=8192)R+=String.fromCharCode.apply(null,B.subarray(W,W+8192));return R};n.addImage=function(){var L,R,B,W,Z,ue,he,ie,de;if(typeof arguments[1]=="number"?(R=t,B=arguments[1],W=arguments[2],Z=arguments[3],ue=arguments[4],he=arguments[5],ie=arguments[6],de=arguments[7]):(R=arguments[1],B=arguments[2],W=arguments[3],Z=arguments[4],ue=arguments[5],he=arguments[6],ie=arguments[7],de=arguments[8]),Tt(L=arguments[0])==="object"&&!y(L)&&"imageData"in L){var ke=L;L=ke.imageData,R=ke.format||R||t,B=ke.x||B||0,W=ke.y||W||0,Z=ke.w||ke.width||Z,ue=ke.h||ke.height||ue,he=ke.alias||he,ie=ke.compression||ie,de=ke.rotation||ke.angle||de}var be=this.internal.getFilters();if(ie===void 0&&be.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(B)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var E=U.call(this,L,R,he,ie);return x.call(this,B,W,Z,ue,E,de),this};var U=function(L,R,B,W){var Z,ue,he;if(typeof L=="string"&&s(L)===t){L=unescape(L);var ie=I(L,!1);(ie!==""||(ie=n.loadFile(L,!0))!==void 0)&&(L=ie)}if(y(L)&&(L=p(L,R)),R=s(L,R),!m(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((he=B)==null||he.length===0)&&(B=(function(de){return typeof de=="string"||V(de)?C(de):V(de.data)?C(de.data):null})(L)),(Z=S.call(this,B))||(L instanceof Uint8Array||R==="RGBA"||(ue=L,L=re(L)),Z=this["process"+R.toUpperCase()](L,f.call(this),B,(function(de){return de&&typeof de=="string"&&(de=de.toUpperCase()),de in n.image_compression?de:O.NONE})(W),ue)),!Z)throw new Error("An unknown error occurred whilst processing the image.");return Z},I=n.__addimage__.convertBase64ToBinaryString=function(L,R){R=typeof R!="boolean"||R;var B,W="";if(typeof L=="string"){var Z;B=(Z=G(L))!==null&&Z!==void 0?Z:L;try{W=ul(B)}catch(ue){if(R)throw F(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ue.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};n.getImageProperties=function(L){var R,B,W="";if(y(L)&&(L=p(L)),typeof L=="string"&&s(L)===t&&((W=I(L,!1))===""&&(W=n.loadFile(L)||""),L=W),B=s(L),!m(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(L instanceof Uint8Array||(L=re(L)),!(R=this["process"+B.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=B,R}})(qe.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};qe.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,s,i,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,f=!1,m=0;m<h.length&&!f;m++)switch((r=h[m]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var y=0;y<h.length;y++){r=h[y];var p=this.internal.pdfEscape,S=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(_.objId),O=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+a(r.bounds.x)+" "+o(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y)+"] ")+"/Contents ("+p(w(r.contents))+")",i+=" /Popup "+x.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+p(w(O))+") >>",_.content=i;var C=_.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+a(r.bounds.x+30)+" "+o(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w+30)+" "+o(r.bounds.y)+"] ")+" /Parent "+C,r.open&&(i+=" /Open true"),i+=" >>",x.content=i,this.internal.write(_.objId,"0 R",x.objId,"0 R");break;case"freetext":s="/Rect ["+a(r.bounds.x)+" "+o(r.bounds.y)+" "+a(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y+r.bounds.h)+"] ";var F=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+p(S(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var G=this.annotations._nameMap[r.options.name];r.options.pageNumber=G.page,r.options.top=G.y}else r.options.top||(r.options.top=0);if(s="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+p(S(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;default:var V=o(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+V+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,s,i,a){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(t),y:h(r),w:u(t+s),h:h(r+i)},options:a,type:"link"})},n.textWithLink=function(t,r,s,i){var a,o,u=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var f=this.splitTextToSize(t,o).length;a=Math.ceil(h*f)}else o=u,a=h;return this.text(t,r,s,i),s+=.2*h,i.align==="center"&&(r-=u/2),i.align==="right"&&(r-=u),this.link(r,s-h,o,a,i),u},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(qe.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];n.__arabicParser__={};var i=n.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},a=n.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},o=n.__arabicParser__.isArabicEndLetter=function(_){return a(_)&&i(_)&&e[_.charCodeAt(0)].length<=2},u=n.__arabicParser__.isArabicAlfLetter=function(_){return a(_)&&s.indexOf(_.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return a(_)&&i(_)&&e[_.charCodeAt(0)].length>=1};var h=n.__arabicParser__.arabicLetterHasFinalForm=function(_){return a(_)&&i(_)&&e[_.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(_){return a(_)&&i(_)&&e[_.charCodeAt(0)].length>=3};var f=n.__arabicParser__.arabicLetterHasMedialForm=function(_){return a(_)&&i(_)&&e[_.charCodeAt(0)].length==4},m=n.__arabicParser__.resolveLigatures=function(_){var x=0,w=t,O="",C=0;for(x=0;x<_.length;x+=1)w[_.charCodeAt(x)]!==void 0?(C++,typeof(w=w[_.charCodeAt(x)])=="number"&&(O+=String.fromCharCode(w),w=t,C=0),x===_.length-1&&(w=t,O+=_.charAt(x-(C-1)),x-=C-1,C=0)):(w=t,O+=_.charAt(x-C),x-=C,C=0);return O};n.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&r[_.charCodeAt(0)]!==void 0};var y=n.__arabicParser__.getCorrectForm=function(_,x,w){return a(_)?i(_)===!1?-1:!h(_)||!a(x)&&!a(w)||!a(w)&&o(x)||o(_)&&!a(x)||o(_)&&u(x)||o(_)&&o(x)?0:f(_)&&a(x)&&!o(x)&&a(w)&&h(w)?3:o(_)||!a(w)?1:2:-1},p=function(_){var x=0,w=0,O=0,C="",F="",G="",V=(_=_||"").split("\\s+"),re=[];for(x=0;x<V.length;x+=1){for(re.push(""),w=0;w<V[x].length;w+=1)C=V[x][w],F=V[x][w-1],G=V[x][w+1],a(C)?(O=y(C,F,G),re[x]+=O!==-1?String.fromCharCode(e[C.charCodeAt(0)][O]):C):re[x]+=C;re[x]=m(re[x])}return re.join(" ")},S=n.__arabicParser__.processArabic=n.processArabic=function(){var _,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(x)){var O=0;for(w=[],O=0;O<x.length;O+=1)Array.isArray(x[O])?w.push([p(x[O][0]),x[O][1],x[O][2]]):w.push([p(x[O])]);_=w}else _=p(x);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};n.events.push(["preProcessText",S])})(qe.API),qe.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var s;if((t=t||"2d")!=="2d")return null;for(s in r)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=r[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(qe.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(_){u=_}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(_){h=_}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(_){y=_}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(_){p=_}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(_){S=_}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},n.getTextDimensions=function(u,h){r.call(this);var f=(h=h||{}).fontSize||this.getFontSize(),m=h.font||this.getFont(),y=h.scaleFactor||this.internal.scaleFactor,p=0,S=0,_=0,x=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var w=h.maxWidth;w>0?typeof u=="string"?u=this.splitTextToSize(u,w):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(C,F){return C.concat(x.splitTextToSize(F,w))},[])):u=Array.isArray(u)?u:[u];for(var O=0;O<u.length;O++)p<(_=this.getStringUnitWidth(u[O],{font:m})*f)&&(p=_);return p!==0&&(S=u.length),{w:p/=y,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/y,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=n.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var h=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=m.top,p&&y&&(this.printHeaderRow(u.lineNumber,!0),u.y+=y[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,t===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-f,u.y+f,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+f,{align:"center",baseline:"top",maxWidth:u.width-f-f}):this.text(u.text,u.x+f,u.y+f,{align:"left",baseline:"top",maxWidth:u.width-f-f})),this.internal.__cell__.lastCell=u,this};n.table=function(u,h,f,m,y){if(r.call(this),!f)throw new Error("No data for PDF table.");var p,S,_,x,w=[],O=[],C=[],F={},G={},V=[],re=[],J=(y=y||{}).autoSize||!1,U=y.printHeaders!==!1,I=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,L=y.margins||Object.assign({width:this.getPageWidth()},e),R=typeof y.padding=="number"?y.padding:3,B=y.headerBackgroundColor||"#c8c8c8",W=y.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=W,this.setFontSize(I),m==null)O=w=Object.keys(f[0]),C=w.map(function(){return"left"});else if(Array.isArray(m)&&Tt(m[0])==="object")for(w=m.map(function(ke){return ke.name}),O=m.map(function(ke){return ke.prompt||ke.name||""}),C=m.map(function(ke){return ke.align||"left"}),p=0;p<m.length;p+=1)G[m[p].name]=.7499990551181103*m[p].width;else Array.isArray(m)&&typeof m[0]=="string"&&(O=w=m,C=w.map(function(){return"left"}));if(J||Array.isArray(m)&&typeof m[0]=="string")for(p=0;p<w.length;p+=1){for(F[x=w[p]]=f.map(function(ke){return ke[x]}),this.setFont(void 0,"bold"),V.push(this.getTextDimensions(O[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=F[x],this.setFont(void 0,"normal"),_=0;_<S.length;_+=1)V.push(this.getTextDimensions(S[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);G[x]=Math.max.apply(null,V)+R+R,V=[]}if(U){var Z={};for(p=0;p<w.length;p+=1)Z[w[p]]={},Z[w[p]].text=O[p],Z[w[p]].align=C[p];var ue=o.call(this,Z,G);re=w.map(function(ke){return new i(u,h,G[ke],ue,Z[ke].text,void 0,Z[ke].align)}),this.setTableHeaderRow(re),this.printHeaderRow(1,!1)}var he=m.reduce(function(ke,be){return ke[be.name]=be.align,ke},{});for(p=0;p<f.length;p+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:p,data:f[p]},this);var ie=o.call(this,f[p],G);for(_=0;_<w.length;_+=1){var de=f[p][w[_]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:p,col:_,data:de},this),a.call(this,new i(u,h,G[w[_]],ie,de,p+2,he[w[_]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var o=function(u,h){var f=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(u).map(function(p){var S=u[p];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,h[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*m/y+f+f},this).reduce(function(p,S){return Math.max(p,S)},0)};n.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},n.printHeaderRow=function(u,h){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),h&&(f.y=this.internal.__cell__.margins.top||0,y.push(f)),f.lineNumber=u;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,f),this.setTextColor(S)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),t=!1}})(qe.API);var i0={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},s0=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Au=r0(s0),a0=[100,200,300,400,500,600,700,800,900],ib=r0(a0);function zc(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(i){return i0[i=i||"normal"]?i:"normal"})(n.style),r=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(n.weight),s=(function(i){return typeof Au[i=i||"normal"]=="number"?i:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:s,src:n.src||[],ref:n.ref||{name:e,style:[s,t,r].join(" ")}}}function pf(n,e,t,r){var s;for(s=t;s>=0&&s<e.length;s+=r)if(n[e[s]])return n[e[s]];for(s=t;s>=0&&s<e.length;s-=r)if(n[e[s]])return n[e[s]]}var sb={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},gf={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mf(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function vf(n){return n.trimLeft()}function ab(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function ob(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var zs,ol,bf,yf,_f,Wc=["times"];function wf(n,e,t,r,s){var i=4,a=Sf;switch(s){case qe.API.image_compression.FAST:i=1,a=xf;break;case qe.API.image_compression.MEDIUM:i=6,a=Af;break;case qe.API.image_compression.SLOW:i=9,a=kf}n=(function(u,h,f,m){for(var y,p=u.length/h,S=new Uint8Array(u.length+p),_=[lb,xf,Sf,Af,kf],x=0;x<p;x+=1){var w=x*h,O=u.subarray(w,w+h);if(m)S.set(m(O,f,y),w+x);else{for(var C=_.length,F=[],G=0;G<C;G+=1)F[G]=_[G](O,f,y);var V=ub(F.concat());S.set(F[V],w+x)}y=O}return S})(n,e,Math.ceil(t*r/8),a);var o=vu(n,{level:i});return qe.API.__addimage__.arrayBufferToBinaryString(o)}function lb(n){var e=Array.apply([],n);return e.unshift(0),e}function xf(n,e){var t=n.length,r=[];r[0]=1;for(var s=0;s<t;s+=1){var i=n[s-e]||0;r[s+1]=n[s]-i+256&255}return r}function Sf(n,e,t){var r=n.length,s=[];s[0]=2;for(var i=0;i<r;i+=1){var a=t&&t[i]||0;s[i+1]=n[i]-a+256&255}return s}function Af(n,e,t){var r=n.length,s=[];s[0]=3;for(var i=0;i<r;i+=1){var a=n[i-e]||0,o=t&&t[i]||0;s[i+1]=n[i]+256-(a+o>>>1)&255}return s}function kf(n,e,t){var r=n.length,s=[];s[0]=4;for(var i=0;i<r;i+=1){var a=cb(n[i-e]||0,t&&t[i]||0,t&&t[i-e]||0);s[i+1]=n[i]-a+256&255}return s}function cb(n,e,t){if(n===e&&e===t)return n;var r=Math.abs(e-t),s=Math.abs(n-t),i=Math.abs(n+e-t-t);return r<=s&&r<=i?n:s<=i?e:t}function ub(n){var e=n.map(function(t){return t.reduce(function(r,s){return r+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function Hc(n,e,t){var r=e*t,s=Math.floor(r/8),i=16-(r-8*s+t),a=(1<<t)-1;return o0(n,s)>>i&a}function Nf(n,e,t,r){var s=t*r,i=Math.floor(s/8),a=16-(s-8*i+r),o=(1<<r)-1,u=(e&o)<<a;(function(h,f,m){if(f+1<h.byteLength)h.setUint16(f,m,!1);else{var y=m>>8&255;h.setUint8(f,y)}})(n,i,o0(n,i)&~(o<<a)&65535|u)}function o0(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function hb(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,s=n[e++],i=s>>7,a=1<<1+(7&s);n[e++],n[e++];var o=null,u=null;i&&(o=e,u=a,e+=3*a);var h=!0,f=[],m=0,y=null,p=0,S=null;for(this.width=t,this.height=r;h&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,S=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=n[e++];m=n[e++]|n[e++]<<8,y=n[e++],1&_||(y=null),p=_>>2&7,e++;break;case 254:for(;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var x=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,O=n[e++]|n[e++]<<8,C=n[e++]|n[e++]<<8,F=n[e++],G=F>>6&1,V=1<<1+(7&F),re=o,J=u,U=!1;F>>7&&(U=!0,re=e,J=V,e+=3*V);var I=e;for(e++;;){var L;if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}f.push({x,y:w,width:O,height:C,has_local_palette:U,palette_offset:re,palette_size:J,data_offset:I,data_length:e-I,transparent_index:y,interlaced:!!G,delay:m,disposal:p});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(R){if(R<0||R>=f.length)throw new Error("Frame index out of range.");return f[R]},this.decodeAndBlitFrameBGRA=function(R,B){var W=this.frameInfo(R),Z=W.width*W.height;if(Z>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var ue=new Uint8Array(Z);Lf(n,W.data_offset,ue,Z);var he=W.palette_offset,ie=W.transparent_index;ie===null&&(ie=256);var de=W.width,ke=t-de,be=de,E=4*(W.y*t+W.x),z=4*((W.y+W.height)*t+W.x),H=E,Y=4*ke;W.interlaced===!0&&(Y+=4*t*7);for(var ee=8,te=0,le=ue.length;te<le;++te){var ce=ue[te];if(be===0&&(be=de,(H+=Y)>=z&&(Y=4*ke+4*t*(ee-1),H=E+(de+ke)*(ee<<1),ee>>=1)),ce===ie)H+=4;else{var ve=n[he+3*ce],Se=n[he+3*ce+1],Ce=n[he+3*ce+2];B[H++]=Ce,B[H++]=Se,B[H++]=ve,B[H++]=255}--be}},this.decodeAndBlitFrameRGBA=function(R,B){var W=this.frameInfo(R),Z=W.width*W.height;if(Z>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");var ue=new Uint8Array(Z);Lf(n,W.data_offset,ue,Z);var he=W.palette_offset,ie=W.transparent_index;ie===null&&(ie=256);var de=W.width,ke=t-de,be=de,E=4*(W.y*t+W.x),z=4*((W.y+W.height)*t+W.x),H=E,Y=4*ke;W.interlaced===!0&&(Y+=4*t*7);for(var ee=8,te=0,le=ue.length;te<le;++te){var ce=ue[te];if(be===0&&(be=de,(H+=Y)>=z&&(Y=4*ke+4*t*(ee-1),H=E+(de+ke)*(ee<<1),ee>>=1)),ce===ie)H+=4;else{var ve=n[he+3*ce],Se=n[he+3*ce+1],Ce=n[he+3*ce+2];B[H++]=ve,B[H++]=Se,B[H++]=Ce,B[H++]=255}--be}}}function Lf(n,e,t,r){for(var s=n[e++],i=1<<s,a=i+1,o=a+1,u=s+1,h=(1<<u)-1,f=0,m=0,y=0,p=n[e++],S=new Int32Array(4096),_=null;;){for(;f<16&&p!==0;)m|=n[e++]<<f,f+=8,p===1?p=n[e++]:--p;if(f<u)break;var x=m&h;if(m>>=u,f-=u,x!==i){if(x===a)break;for(var w=x<o?x:_,O=0,C=w;C>i;)C=S[C]>>8,++O;var F=C;if(y+O+(w!==x?1:0)>r)return void jt.log("Warning, gif stream longer than expected.");t[y++]=F;var G=y+=O;for(w!==x&&(t[y++]=F),C=w;O--;)C=S[C],t[--G]=255&C,C>>=8;_!==null&&o<4096&&(S[o++]=_<<8|F,o>=h+1&&u<12&&(++u,h=h<<1|1)),_=x}else o=a+1,h=(1<<(u=s+1))-1,_=null}return y!==r&&jt.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Vc(n){var e,t,r,s,i,a=Math.floor,o=new Array(64),u=new Array(64),h=new Array(64),f=new Array(64),m=new Array(65535),y=new Array(65535),p=new Array(64),S=new Array(64),_=[],x=0,w=7,O=new Array(64),C=new Array(64),F=new Array(64),G=new Array(256),V=new Array(2048),re=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],J=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ue(E,z){for(var H=0,Y=0,ee=new Array,te=1;te<=16;te++){for(var le=1;le<=E[te];le++)ee[z[Y]]=[],ee[z[Y]][0]=H,ee[z[Y]][1]=te,Y++,H++;H*=2}return ee}function he(E){for(var z=E[0],H=E[1]-1;H>=0;)z&1<<H&&(x|=1<<w),H--,--w<0&&(x==255?(ie(255),ie(0)):ie(x),w=7,x=0)}function ie(E){_.push(E)}function de(E){ie(E>>8&255),ie(255&E)}function ke(E,z,H,Y,ee){for(var te,le=ee[0],ce=ee[240],ve=(function(we,Je){var Te,Ge,We,Nt,mt,st,yt,vt,De,lt,$e=0;for(De=0;De<8;++De){Te=we[$e],Ge=we[$e+1],We=we[$e+2],Nt=we[$e+3],mt=we[$e+4],st=we[$e+5],yt=we[$e+6];var tn=Te+(vt=we[$e+7]),xt=Te-vt,ft=Ge+yt,pt=Ge-yt,Wt=We+st,He=We-st,Dt=Nt+mt,et=Nt-mt,at=tn+Dt,Ht=tn-Dt,gt=ft+Wt,Xe=ft-Wt;we[$e]=at+gt,we[$e+4]=at-gt;var Lt=.707106781*(Xe+Ht);we[$e+2]=Ht+Lt,we[$e+6]=Ht-Lt;var qi=.382683433*((at=et+He)-(Xe=pt+xt)),On=.5411961*at+qi,Vr=1.306562965*Xe+qi,Tr=.707106781*(gt=He+pt),Ze=xt+Tr,Gr=xt-Tr;we[$e+5]=Gr+On,we[$e+3]=Gr-On,we[$e+1]=Ze+Vr,we[$e+7]=Ze-Vr,$e+=8}for($e=0,De=0;De<8;++De){Te=we[$e],Ge=we[$e+8],We=we[$e+16],Nt=we[$e+24],mt=we[$e+32],st=we[$e+40],yt=we[$e+48];var Kr=Te+(vt=we[$e+56]),ar=Te-vt,or=Ge+yt,Yt=Ge-yt,xn=We+st,kn=We-st,$i=Nt+mt,vi=Nt-mt,vr=Kr+$i,Or=Kr-$i,br=or+xn,yr=or-xn;we[$e]=vr+br,we[$e+32]=vr-br;var lr=.707106781*(yr+Or);we[$e+16]=Or+lr,we[$e+48]=Or-lr;var zi=.382683433*((vr=vi+kn)-(yr=Yt+ar)),Rr=.5411961*vr+zi,Wi=1.306562965*yr+zi,xs=.707106781*(br=kn+Yt),Ss=ar+xs,As=ar-xs;we[$e+40]=As+Rr,we[$e+24]=As-Rr,we[$e+8]=Ss+Wi,we[$e+56]=Ss-Wi,$e++}for(De=0;De<64;++De)lt=we[De]*Je[De],p[De]=lt>0?lt+.5|0:lt-.5|0;return p})(E,z),Se=0;Se<64;++Se)S[re[Se]]=ve[Se];var Ce=S[0]-H;H=S[0],Ce==0?he(Y[0]):(he(Y[y[te=32767+Ce]]),he(m[te]));for(var Pe=63;Pe>0&&S[Pe]==0;)Pe--;if(Pe==0)return he(le),H;for(var ze,D=1;D<=Pe;){for(var Ee=D;S[D]==0&&D<=Pe;)++D;var dt=D-Ee;if(dt>=16){ze=dt>>4;for(var Ke=1;Ke<=ze;++Ke)he(ce);dt&=15}te=32767+S[D],he(ee[(dt<<4)+y[te]]),he(m[te]),D++}return Pe!=63&&he(le),H}function be(E){E=Math.min(Math.max(E,1),100),i!=E&&((function(z){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Y=0;Y<64;Y++){var ee=a((H[Y]*z+50)/100);ee=Math.min(Math.max(ee,1),255),o[re[Y]]=ee}for(var te=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],le=0;le<64;le++){var ce=a((te[le]*z+50)/100);ce=Math.min(Math.max(ce,1),255),u[re[le]]=ce}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,Ce=0;Ce<8;Ce++)for(var Pe=0;Pe<8;Pe++)h[Se]=1/(o[re[Se]]*ve[Ce]*ve[Pe]*8),f[Se]=1/(u[re[Se]]*ve[Ce]*ve[Pe]*8),Se++})(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),i=E)}this.encode=function(E,z){z&&be(z),_=new Array,x=0,w=7,de(65496),de(65504),de(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),de(1),de(1),ie(0),ie(0),(function(){de(65499),de(132),ie(0);for(var Ge=0;Ge<64;Ge++)ie(o[Ge]);ie(1);for(var We=0;We<64;We++)ie(u[We])})(),(function(Ge,We){de(65472),de(17),ie(8),de(We),de(Ge),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)})(E.width,E.height),(function(){de(65476),de(418),ie(0);for(var Ge=0;Ge<16;Ge++)ie(J[Ge+1]);for(var We=0;We<=11;We++)ie(U[We]);ie(16);for(var Nt=0;Nt<16;Nt++)ie(I[Nt+1]);for(var mt=0;mt<=161;mt++)ie(L[mt]);ie(1);for(var st=0;st<16;st++)ie(R[st+1]);for(var yt=0;yt<=11;yt++)ie(B[yt]);ie(17);for(var vt=0;vt<16;vt++)ie(W[vt+1]);for(var De=0;De<=161;De++)ie(Z[De])})(),de(65498),de(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var H=0,Y=0,ee=0;x=0,w=7,this.encode.displayName="_encode_";for(var te,le,ce,ve,Se,Ce,Pe,ze,D,Ee=E.data,dt=E.width,Ke=E.height,we=4*dt,Je=0;Je<Ke;){for(te=0;te<we;){for(Se=we*Je+te,Pe=-1,ze=0,D=0;D<64;D++)Ce=Se+(ze=D>>3)*we+(Pe=4*(7&D)),Je+ze>=Ke&&(Ce-=we*(Je+1+ze-Ke)),te+Pe>=we&&(Ce-=te+Pe-we+4),le=Ee[Ce++],ce=Ee[Ce++],ve=Ee[Ce++],O[D]=(V[le]+V[ce+256|0]+V[ve+512|0]>>16)-128,C[D]=(V[le+768|0]+V[ce+1024|0]+V[ve+1280|0]>>16)-128,F[D]=(V[le+1280|0]+V[ce+1536|0]+V[ve+1792|0]>>16)-128;H=ke(O,h,H,e,r),Y=ke(C,f,Y,t,s),ee=ke(F,f,ee,t,s),te+=32}Je+=8}if(w>=0){var Te=[];Te[1]=w+1,Te[0]=(1<<w+1)-1,he(Te)}return de(65497),new Uint8Array(_)},n=n||50,(function(){for(var E=String.fromCharCode,z=0;z<256;z++)G[z]=E(z)})(),e=ue(J,U),t=ue(R,B),r=ue(I,L),s=ue(W,Z),(function(){for(var E=1,z=2,H=1;H<=15;H++){for(var Y=E;Y<z;Y++)y[32767+Y]=H,m[32767+Y]=[],m[32767+Y][1]=H,m[32767+Y][0]=Y;for(var ee=-(z-1);ee<=-E;ee++)y[32767+ee]=H,m[32767+ee]=[],m[32767+ee][1]=H,m[32767+ee][0]=z-1+ee;E<<=1,z<<=1}})(),(function(){for(var E=0;E<256;E++)V[E]=19595*E,V[E+256|0]=38470*E,V[E+512|0]=7471*E+32768,V[E+768|0]=-11059*E,V[E+1024|0]=-21709*E,V[E+1280|0]=32768*E+8421375,V[E+1536|0]=-27439*E,V[E+1792|0]=-5329*E})(),be(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function kr(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ef(n){function e(U){if(!U)throw Error("assert :P")}function t(U,I,L){for(var R=0;4>R;R++)if(U[I+R]!=L.charCodeAt(R))return!0;return!1}function r(U,I,L,R,B){for(var W=0;W<B;W++)U[I+W]=L[R+W]}function s(U,I,L,R){for(var B=0;B<R;B++)U[I+B]=L}function i(U){return new Int32Array(U)}function a(U,I){for(var L=[],R=0;R<U;R++)L.push(new I);return L}function o(U,I){var L=[];return(function R(B,W,Z){for(var ue=Z[W],he=0;he<ue&&(B.push(Z.length>W+1?[]:new I),!(Z.length<W+1));he++)R(B[he],W+1,Z)})(L,0,U),L}var u=function(){var U=this;function I(c,d){for(var v=1<<d-1>>>0;c&v;)v>>>=1;return v?(c&v-1)+v:c}function L(c,d,v,b,k){e(!(b%v));do c[d+(b-=v)]=k;while(0<b)}function R(c,d,v,b,k){if(e(2328>=k),512>=k)var N=i(512);else if((N=i(k))==null)return 0;return(function(P,T,j,M,X,oe){var q,Q,se=T,fe=1<<j,ae=i(16),pe=i(16);for(e(X!=0),e(M!=null),e(P!=null),e(0<j),Q=0;Q<X;++Q){if(15<M[Q])return 0;++ae[M[Q]]}if(ae[0]==X)return 0;for(pe[1]=0,q=1;15>q;++q){if(ae[q]>1<<q)return 0;pe[q+1]=pe[q]+ae[q]}for(Q=0;Q<X;++Q)q=M[Q],0<M[Q]&&(oe[pe[q]++]=Q);if(pe[15]==1)return(M=new B).g=0,M.value=oe[0],L(P,se,1,fe,M),fe;var me,xe=-1,_e=fe-1,Me=0,Ie=1,ut=1,je=1<<j;for(Q=0,q=1,X=2;q<=j;++q,X<<=1){if(Ie+=ut<<=1,0>(ut-=ae[q]))return 0;for(;0<ae[q];--ae[q])(M=new B).g=q,M.value=oe[Q++],L(P,se+Me,X,je,M),Me=I(Me,q)}for(q=j+1,X=2;15>=q;++q,X<<=1){if(Ie+=ut<<=1,0>(ut-=ae[q]))return 0;for(;0<ae[q];--ae[q]){if(M=new B,(Me&_e)!=xe){for(se+=je,me=1<<(xe=q)-j;15>xe&&!(0>=(me-=ae[xe]));)++xe,me<<=1;fe+=je=1<<(me=xe-j),P[T+(xe=Me&_e)].g=me+j,P[T+xe].value=se-T-xe}M.g=q-j,M.value=oe[Q++],L(P,se+(Me>>j),X,je,M),Me=I(Me,q)}}return Ie!=2*pe[15]-1?0:fe})(c,d,v,b,k,N)}function B(){this.value=this.g=0}function W(){this.value=this.g=0}function Z(){this.G=a(5,B),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(ts,W)}function ue(c,d,v,b){e(c!=null),e(d!=null),e(2147483648>b),c.Ca=254,c.I=0,c.b=-8,c.Ka=0,c.oa=d,c.pa=v,c.Jd=d,c.Yc=v+b,c.Zc=4<=b?v+b-4+1:v,le(c)}function he(c,d){for(var v=0;0<d--;)v|=ve(c,128)<<d;return v}function ie(c,d){var v=he(c,d);return ce(c)?-v:v}function de(c,d,v,b){var k,N=0;for(e(c!=null),e(d!=null),e(4294967288>b),c.Sb=b,c.Ra=0,c.u=0,c.h=0,4<b&&(b=4),k=0;k<b;++k)N+=d[v+k]<<8*k;c.Ra=N,c.bb=b,c.oa=d,c.pa=v}function ke(c){for(;8<=c.u&&c.bb<c.Sb;)c.Ra>>>=8,c.Ra+=c.oa[c.pa+c.bb]<<wi-8>>>0,++c.bb,c.u-=8;Y(c)&&(c.h=1,c.u=0)}function be(c,d){if(e(0<=d),!c.h&&d<=Kn){var v=H(c)&Gn[d];return c.u+=d,ke(c),v}return c.h=1,c.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(c){return c.Ra>>>(c.u&wi-1)>>>0}function Y(c){return e(c.bb<=c.Sb),c.h||c.bb==c.Sb&&c.u>wi}function ee(c,d){c.u=d,c.h=Y(c)}function te(c){c.u>=si&&(e(c.u>=si),ke(c))}function le(c){e(c!=null&&c.oa!=null),c.pa<c.Zc?(c.I=(c.oa[c.pa++]|c.I<<8)>>>0,c.b+=8):(e(c!=null&&c.oa!=null),c.pa<c.Yc?(c.b+=8,c.I=c.oa[c.pa++]|c.I<<8):c.Ka?c.b=0:(c.I<<=8,c.b+=8,c.Ka=1))}function ce(c){return he(c,1)}function ve(c,d){var v=c.Ca;0>c.b&&le(c);var b=c.b,k=v*d>>>8,N=(c.I>>>b>k)+0;for(N?(v-=k,c.I-=k+1<<b>>>0):v=k+1,b=v,k=0;256<=b;)k+=8,b>>=8;return b=7^k+xi[b],c.b-=b,c.Ca=(v<<b)-1,N}function Se(c,d,v){c[d+0]=v>>24&255,c[d+1]=v>>16&255,c[d+2]=v>>8&255,c[d+3]=255&v}function Ce(c,d){return c[d+0]|c[d+1]<<8}function Pe(c,d){return Ce(c,d)|c[d+2]<<16}function ze(c,d){return Ce(c,d)|Ce(c,d+2)<<16}function D(c,d){var v=1<<d;return e(c!=null),e(0<d),c.X=i(v),c.X==null?0:(c.Mb=32-d,c.Xa=d,1)}function Ee(c,d){e(c!=null),e(d!=null),e(c.Xa==d.Xa),r(d.X,0,c.X,0,1<<d.Xa)}function dt(){this.X=[],this.Xa=this.Mb=0}function Ke(c,d,v,b){e(v!=null),e(b!=null);var k=v[0],N=b[0];return k==0&&(k=(c*N+d/2)/d),N==0&&(N=(d*k+c/2)/c),0>=k||0>=N?0:(v[0]=k,b[0]=N,1)}function we(c,d){return c+(1<<d)-1>>>d}function Je(c,d){return((4278255360&c)+(4278255360&d)>>>0&4278255360)+((16711935&c)+(16711935&d)>>>0&16711935)>>>0}function Te(c,d){U[d]=function(v,b,k,N,P,T,j){var M;for(M=0;M<P;++M){var X=U[c](T[j+M-1],k,N+M);T[j+M]=Je(v[b+M],X)}}}function Ge(){this.ud=this.hd=this.jd=0}function We(c,d){return((4278124286&(c^d))>>>1)+(c&d)>>>0}function Nt(c){return 0<=c&&256>c?c:0>c?0:255<c?255:void 0}function mt(c,d){return Nt(c+(c-d+.5>>1))}function st(c,d,v){return Math.abs(d-v)-Math.abs(c-v)}function yt(c,d,v,b,k,N,P){for(b=N[P-1],v=0;v<k;++v)N[P+v]=b=Je(c[d+v],b)}function vt(c,d,v,b,k){var N;for(N=0;N<v;++N){var P=c[d+N],T=P>>8&255,j=16711935&(j=(j=16711935&P)+((T<<16)+T));b[k+N]=(4278255360&P)+j>>>0}}function De(c,d){d.jd=255&c,d.hd=c>>8&255,d.ud=c>>16&255}function lt(c,d,v,b,k,N){var P;for(P=0;P<b;++P){var T=d[v+P],j=T>>>8,M=T,X=255&(X=(X=T>>>16)+((c.jd<<24>>24)*(j<<24>>24)>>>5));M=255&(M=(M+=(c.hd<<24>>24)*(j<<24>>24)>>>5)+((c.ud<<24>>24)*(X<<24>>24)>>>5)),k[N+P]=(4278255360&T)+(X<<16)+M}}function $e(c,d,v,b,k){U[d]=function(N,P,T,j,M,X,oe,q,Q){for(j=oe;j<q;++j)for(oe=0;oe<Q;++oe)M[X++]=k(T[b(N[P++])])},U[c]=function(N,P,T,j,M,X,oe){var q=8>>N.b,Q=N.Ea,se=N.K[0],fe=N.w;if(8>q)for(N=(1<<N.b)-1,fe=(1<<q)-1;P<T;++P){var ae,pe=0;for(ae=0;ae<Q;++ae)ae&N||(pe=b(j[M++])),X[oe++]=k(se[pe&fe]),pe>>=q}else U["VP8LMapColor"+v](j,M,se,fe,X,oe,P,T,Q)}}function tn(c,d,v,b,k){for(v=d+v;d<v;){var N=c[d++];b[k++]=N>>16&255,b[k++]=N>>8&255,b[k++]=255&N}}function xt(c,d,v,b,k){for(v=d+v;d<v;){var N=c[d++];b[k++]=N>>16&255,b[k++]=N>>8&255,b[k++]=255&N,b[k++]=N>>24&255}}function ft(c,d,v,b,k){for(v=d+v;d<v;){var N=(P=c[d++])>>16&240|P>>12&15,P=240&P|P>>28&15;b[k++]=N,b[k++]=P}}function pt(c,d,v,b,k){for(v=d+v;d<v;){var N=(P=c[d++])>>16&248|P>>13&7,P=P>>5&224|P>>3&31;b[k++]=N,b[k++]=P}}function Wt(c,d,v,b,k){for(v=d+v;d<v;){var N=c[d++];b[k++]=255&N,b[k++]=N>>8&255,b[k++]=N>>16&255}}function He(c,d,v,b,k,N){if(N==0)for(v=d+v;d<v;)Se(b,((N=c[d++])[0]>>24|N[1]>>8&65280|N[2]<<8&16711680|N[3]<<24)>>>0),k+=32;else r(b,k,c,d,v)}function Dt(c,d){U[d][0]=U[c+"0"],U[d][1]=U[c+"1"],U[d][2]=U[c+"2"],U[d][3]=U[c+"3"],U[d][4]=U[c+"4"],U[d][5]=U[c+"5"],U[d][6]=U[c+"6"],U[d][7]=U[c+"7"],U[d][8]=U[c+"8"],U[d][9]=U[c+"9"],U[d][10]=U[c+"10"],U[d][11]=U[c+"11"],U[d][12]=U[c+"12"],U[d][13]=U[c+"13"],U[d][14]=U[c+"0"],U[d][15]=U[c+"0"]}function et(c){return c==ec||c==tc||c==Oo||c==nc}function at(){this.eb=[],this.size=this.A=this.fb=0}function Ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function gt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new at,this.f.kb=new Ht,this.sd=null}function Xe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function qi(c){return alert("todo:WebPSamplerProcessPlane"),c.T}function On(c,d){var v=c.T,b=d.ba.f.RGBA,k=b.eb,N=b.fb+c.ka*b.A,P=pr[d.ba.S],T=c.y,j=c.O,M=c.f,X=c.N,oe=c.ea,q=c.W,Q=d.cc,se=d.dc,fe=d.Mc,ae=d.Nc,pe=c.ka,me=c.ka+c.T,xe=c.U,_e=xe+1>>1;for(pe==0?P(T,j,null,null,M,X,oe,q,M,X,oe,q,k,N,null,null,xe):(P(d.ec,d.fc,T,j,Q,se,fe,ae,M,X,oe,q,k,N-b.A,k,N,xe),++v);pe+2<me;pe+=2)Q=M,se=X,fe=oe,ae=q,X+=c.Rc,q+=c.Rc,N+=2*b.A,P(T,(j+=2*c.fa)-c.fa,T,j,Q,se,fe,ae,M,X,oe,q,k,N-b.A,k,N,xe);return j+=c.fa,c.j+me<c.o?(r(d.ec,d.fc,T,j,xe),r(d.cc,d.dc,M,X,_e),r(d.Mc,d.Nc,oe,q,_e),v--):1&me||P(T,j,null,null,M,X,oe,q,M,X,oe,q,k,N+b.A,null,null,xe),v}function Vr(c,d,v){var b=c.F,k=[c.J];if(b!=null){var N=c.U,P=d.ba.S,T=P==To||P==Oo;d=d.ba.f.RGBA;var j=[0],M=c.ka;j[0]=c.T,c.Kb&&(M==0?--j[0]:(--M,k[0]-=c.width),c.j+c.ka+c.T==c.o&&(j[0]=c.o-c.j-M));var X=d.eb;M=d.fb+M*d.A,c=Qu(b,k[0],c.width,N,j,X,M+(T?0:3),d.A),e(v==j),c&&et(P)&&Ia(X,M,T,N,j,d.A)}return 0}function Tr(c){var d=c.ma,v=d.ba.S,b=11>v,k=v==Co||v==Io||v==To||v==Ql||v==12||et(v);if(d.memory=null,d.Ib=null,d.Jb=null,d.Nd=null,!Sa(d.Oa,c,k?11:12))return 0;if(k&&et(v)&&_a(),c.da)alert("todo:use_scaling");else{if(b){if(d.Ib=qi,c.Kb){if(v=c.U+1>>1,d.memory=i(c.U+2*v),d.memory==null)return 0;d.ec=d.memory,d.fc=0,d.cc=d.ec,d.dc=d.fc+c.U,d.Mc=d.cc,d.Nc=d.dc+v,d.Ib=On,_a()}}else alert("todo:EmitYUV");k&&(d.Jb=Vr,b&&wr())}if(b&&!gh){for(c=0;256>c;++c)E0[c]=89858*(c-128)+jo>>Ro,I0[c]=-22014*(c-128)+jo,C0[c]=-45773*(c-128),P0[c]=113618*(c-128)+jo>>Ro;for(c=Oa;c<sc;++c)d=76283*(c-16)+jo>>Ro,T0[c-Oa]=jr(d,255),O0[c-Oa]=jr(d+8>>4,15);gh=1}return 1}function Ze(c){var d=c.ma,v=c.U,b=c.T;return e(!(1&c.ka)),0>=v||0>=b?0:(v=d.Ib(c,d),d.Jb!=null&&d.Jb(c,d,v),d.Dc+=v,1)}function Gr(c){c.ma.memory=null}function Kr(c,d,v,b){return be(c,8)!=47?0:(d[0]=be(c,14)+1,v[0]=be(c,14)+1,b[0]=be(c,1),be(c,3)!=0?0:!c.h)}function ar(c,d){if(4>c)return c+1;var v=c-2>>1;return(2+(1&c)<<v)+be(d,v)+1}function or(c,d){return 120<d?d-120:1<=(v=((v=p0[d-1])>>4)*c+(8-(15&v)))?v:1;var v}function Yt(c,d,v){var b=H(v),k=c[d+=255&b].g-8;return 0<k&&(ee(v,v.u+8),b=H(v),d+=c[d].value,d+=b&(1<<k)-1),ee(v,v.u+c[d].g),c[d].value}function xn(c,d,v){return v.g+=c.g,v.value+=c.value<<d>>>0,e(8>=v.g),c.g}function kn(c,d,v){var b=c.xc;return e((d=b==0?0:c.vc[c.md*(v>>b)+(d>>b)])<c.Wb),c.Ya[d]}function $i(c,d,v,b){var k=c.ab,N=c.c*d,P=c.C;d=P+d;var T=v,j=b;for(b=c.Ta,v=c.Ua;0<k--;){var M=c.gc[k],X=P,oe=d,q=T,Q=j,se=(j=b,T=v,M.Ea);switch(e(X<oe),e(oe<=M.nc),M.hc){case 2:nn(q,Q,(oe-X)*se,j,T);break;case 0:var fe=X,ae=oe,pe=j,me=T,xe=(je=M).Ea;fe==0&&(ka(q,Q,null,null,1,pe,me),yt(q,Q+1,0,0,xe-1,pe,me+1),Q+=xe,me+=xe,++fe);for(var _e=1<<je.b,Me=_e-1,Ie=we(xe,je.b),ut=je.K,je=je.w+(fe>>je.b)*Ie;fe<ae;){var _t=ut,bn=je,ht=1;for(Ts(q,Q,pe,me-xe,1,pe,me);ht<xe;){var Fe=(ht&~Me)+_e;Fe>xe&&(Fe=xe),(0,La[_t[bn++]>>8&15])(q,Q+ +ht,pe,me+ht-xe,Fe-ht,pe,me+ht),ht=Fe}Q+=xe,me+=xe,++fe&Me||(je+=Ie)}oe!=M.nc&&r(j,T-se,j,T+(oe-X-1)*se,se);break;case 1:for(se=q,ae=Q,xe=(q=M.Ea)-(me=q&~(pe=(Q=1<<M.b)-1)),fe=we(q,M.b),_e=M.K,M=M.w+(X>>M.b)*fe;X<oe;){for(Me=_e,Ie=M,ut=new Ge,je=ae+me,_t=ae+q;ae<je;)De(Me[Ie++],ut),Ea(ut,se,ae,Q,j,T),ae+=Q,T+=Q;ae<_t&&(De(Me[Ie++],ut),Ea(ut,se,ae,xe,j,T),ae+=xe,T+=xe),++X&pe||(M+=fe)}break;case 3:if(q==j&&Q==T&&0<M.b){for(ae=j,q=se=T+(oe-X)*se-(me=(oe-X)*we(M.Ea,M.b)),Q=j,pe=T,fe=[],me=(xe=me)-1;0<=me;--me)fe[me]=Q[pe+me];for(me=xe-1;0<=me;--me)ae[q+me]=fe[me];No(M,X,oe,j,se,j,T)}else No(M,X,oe,q,Q,j,T)}T=b,j=v}j!=v&&r(b,v,T,j,N)}function vi(c,d){var v=c.V,b=c.Ba+c.c*c.C,k=d-c.C;if(e(d<=c.l.o),e(16>=k),0<k){var N=c.l,P=c.Ta,T=c.Ua,j=N.width;if($i(c,k,v,b),k=T=[T],e((v=c.C)<(b=d)),e(N.v<N.va),b>N.o&&(b=N.o),v<N.j){var M=N.j-v;v=N.j,k[0]+=M*j}if(v>=b?v=0:(k[0]+=4*N.v,N.ka=v-N.j,N.U=N.va-N.v,N.T=b-v,v=1),v){if(T=T[0],11>(v=c.ca).S){var X=v.f.RGBA,oe=(b=v.S,k=N.U,N=N.T,M=X.eb,X.A),q=N;for(X=X.fb+c.Ma*X.A;0<q--;){var Q=P,se=T,fe=k,ae=M,pe=X;switch(b){case Po:Pa(Q,se,fe,ae,pe);break;case Co:Si(Q,se,fe,ae,pe);break;case ec:Si(Q,se,fe,ae,pe),Ia(ae,pe,0,fe,1,0);break;case ah:ns(Q,se,fe,ae,pe);break;case Io:He(Q,se,fe,ae,pe,1);break;case tc:He(Q,se,fe,ae,pe,1),Ia(ae,pe,0,fe,1,0);break;case To:He(Q,se,fe,ae,pe,0);break;case Oo:He(Q,se,fe,ae,pe,0),Ia(ae,pe,1,fe,1,0);break;case Ql:Ai(Q,se,fe,ae,pe);break;case nc:Ai(Q,se,fe,ae,pe),Zu(ae,pe,fe,1,0);break;case oh:ki(Q,se,fe,ae,pe);break;default:e(0)}T+=j,X+=oe}c.Ma+=N}else alert("todo:EmitRescaledRowsYUVA");e(c.Ma<=v.height)}}c.C=d,e(c.C<=c.i)}function vr(c){var d;if(0<c.ua)return 0;for(d=0;d<c.Wb;++d){var v=c.Ya[d].G,b=c.Ya[d].H;if(0<v[1][b[1]+0].g||0<v[2][b[2]+0].g||0<v[3][b[3]+0].g)return 0}return 1}function Or(c,d,v,b,k,N){if(c.Z!=0){var P=c.qd,T=c.rd;for(e(Ei[c.Z]!=null);d<v;++d)Ei[c.Z](P,T,b,k,b,k,N),P=b,T=k,k+=N;c.qd=P,c.rd=T}}function br(c,d){var v=c.l.ma,b=v.Z==0||v.Z==1?c.l.j:c.C;if(b=c.C<b?b:c.C,e(d<=c.l.o),d>b){var k=c.l.width,N=v.ca,P=v.tb+k*b,T=c.V,j=c.Ba+c.c*b,M=c.gc;e(c.ab==1),e(M[0].hc==3),Ur(M[0],b,d,T,j,N,P),Or(v,b,d,N,P,k)}c.C=c.Ma=d}function yr(c,d,v,b,k,N,P){var T=c.$/b,j=c.$%b,M=c.m,X=c.s,oe=v+c.$,q=oe;k=v+b*k;var Q=v+b*N,se=280+X.ua,fe=c.Pb?T:16777216,ae=0<X.ua?X.Wa:null,pe=X.wc,me=oe<Q?kn(X,j,T):null;e(c.C<N),e(Q<=k);var xe=!1;e:for(;;){for(;xe||oe<Q;){var _e=0;if(T>=fe){var Me=oe-v;e((fe=c).Pb),fe.wd=fe.m,fe.xd=Me,0<fe.s.ua&&Ee(fe.s.Wa,fe.s.vb),fe=T+m0}if(j&pe||(me=kn(X,j,T)),e(me!=null),me.Qb&&(d[oe]=me.qb,xe=!0),!xe)if(te(M),me.jc){_e=M,Me=d;var Ie=oe,ut=me.pd[H(_e)&ts-1];e(me.jc),256>ut.g?(ee(_e,_e.u+ut.g),Me[Ie]=ut.value,_e=0):(ee(_e,_e.u+ut.g-256),e(256<=ut.value),_e=ut.value),_e==0&&(xe=!0)}else _e=Yt(me.G[0],me.H[0],M);if(M.h)break;if(xe||256>_e){if(!xe)if(me.nd)d[oe]=(me.qb|_e<<8)>>>0;else{if(te(M),xe=Yt(me.G[1],me.H[1],M),te(M),Me=Yt(me.G[2],me.H[2],M),Ie=Yt(me.G[3],me.H[3],M),M.h)break;d[oe]=(Ie<<24|xe<<16|_e<<8|Me)>>>0}if(xe=!1,++oe,++j>=b&&(j=0,++T,P!=null&&T<=N&&!(T%16)&&P(c,T),ae!=null))for(;q<oe;)_e=d[q++],ae.X[(506832829*_e&4294967295)>>>ae.Mb]=_e}else if(280>_e){if(_e=ar(_e-256,M),Me=Yt(me.G[4],me.H[4],M),te(M),Me=or(b,Me=ar(Me,M)),M.h)break;if(oe-v<Me||k-oe<_e)break e;for(Ie=0;Ie<_e;++Ie)d[oe+Ie]=d[oe+Ie-Me];for(oe+=_e,j+=_e;j>=b;)j-=b,++T,P!=null&&T<=N&&!(T%16)&&P(c,T);if(e(oe<=k),j&pe&&(me=kn(X,j,T)),ae!=null)for(;q<oe;)_e=d[q++],ae.X[(506832829*_e&4294967295)>>>ae.Mb]=_e}else{if(!(_e<se))break e;for(xe=_e-280,e(ae!=null);q<oe;)_e=d[q++],ae.X[(506832829*_e&4294967295)>>>ae.Mb]=_e;_e=oe,e(!(xe>>>(Me=ae).Xa)),d[_e]=Me.X[xe],xe=!0}xe||e(M.h==Y(M))}if(c.Pb&&M.h&&oe<k)e(c.m.h),c.a=5,c.m=c.wd,c.$=c.xd,0<c.s.ua&&Ee(c.s.vb,c.s.Wa);else{if(M.h)break e;P!=null&&P(c,T>N?N:T),c.a=0,c.$=oe-v}return 1}return c.a=3,0}function lr(c){e(c!=null),c.vc=null,c.yc=null,c.Ya=null;var d=c.Wa;d!=null&&(d.X=null),c.vb=null,e(c!=null)}function zi(){var c=new nt;return c==null?null:(c.a=0,c.xb=uh,Dt("Predictor","VP8LPredictors"),Dt("Predictor","VP8LPredictors_C"),Dt("PredictorAdd","VP8LPredictorsAdd"),Dt("PredictorAdd","VP8LPredictorsAdd_C"),nn=vt,Ea=lt,Pa=tn,Si=xt,Ai=ft,ki=pt,ns=Wt,U.VP8LMapColor32b=Br,U.VP8LMapColor8b=Na,c)}function Rr(c,d,v,b,k){var N=1,P=[c],T=[d],j=b.m,M=b.s,X=null,oe=0;e:for(;;){if(v)for(;N&&be(j,1);){var q=P,Q=T,se=b,fe=1,ae=se.m,pe=se.gc[se.ab],me=be(ae,2);if(se.Oc&1<<me)N=0;else{switch(se.Oc|=1<<me,pe.hc=me,pe.Ea=q[0],pe.nc=Q[0],pe.K=[null],++se.ab,e(4>=se.ab),me){case 0:case 1:pe.b=be(ae,3)+2,fe=Rr(we(pe.Ea,pe.b),we(pe.nc,pe.b),0,se,pe.K),pe.K=pe.K[0];break;case 3:var xe,_e=be(ae,8)+1,Me=16<_e?0:4<_e?1:2<_e?2:3;if(q[0]=we(pe.Ea,Me),pe.b=Me,xe=fe=Rr(_e,1,0,se,pe.K)){var Ie,ut=_e,je=pe,_t=1<<(8>>je.b),bn=i(_t);if(bn==null)xe=0;else{var ht=je.K[0],Fe=je.w;for(bn[0]=je.K[0][0],Ie=1;Ie<1*ut;++Ie)bn[Ie]=Je(ht[Fe+Ie],bn[Ie-1]);for(;Ie<4*_t;++Ie)bn[Ie]=0;je.K[0]=null,je.K[0]=bn,xe=1}}fe=xe;break;case 2:break;default:e(0)}N=fe}}if(P=P[0],T=T[0],N&&be(j,1)&&!(N=1<=(oe=be(j,4))&&11>=oe)){b.a=3;break e}var Le;if(Le=N)t:{var sn,ot,wt,$t=b,En=P,qn=T,Xt=oe,Rn=v,$n=$t.m,yn=$t.s,At=[null],Pt=1,Zt=0,Ct=g0[Xt];n:for(;;){if(Rn&&be($n,1)){var Pn=be($n,3)+2,Sr=we(En,Pn),an=we(qn,Pn),Wn=Sr*an;if(!Rr(Sr,an,0,$t,At))break n;for(At=At[0],yn.xc=Pn,sn=0;sn<Wn;++sn){var Rt=At[sn]>>8&65535;At[sn]=Rt,Rt>=Pt&&(Pt=Rt+1)}}if($n.h)break n;for(ot=0;5>ot;++ot){var _n=lh[ot];!ot&&0<Xt&&(_n+=1<<Xt),Zt<_n&&(Zt=_n)}var Yn=a(Pt*Ct,B),zn=Pt,Xn=a(zn,Z);if(Xn==null)var Zn=null;else e(65536>=zn),Zn=Xn;var Hn=i(Zt);if(Zn==null||Hn==null||Yn==null){$t.a=1;break n}var Qn=Yn;for(sn=wt=0;sn<Pt;++sn){var Ut=Zn[sn],er=Ut.G,Ar=Ut.H,is=0,li=1,Cn=0;for(ot=0;5>ot;++ot){_n=lh[ot],er[ot]=Qn,Ar[ot]=wt,!ot&&0<Xt&&(_n+=1<<Xt);i:{var Do,ac=_n,Bo=$t,Ra=Hn,F0=Qn,D0=wt,oc=0,Pi=Bo.m,B0=be(Pi,1);if(s(Ra,0,0,ac),B0){var U0=be(Pi,1)+1,M0=be(Pi,1),bh=be(Pi,M0==0?1:8);Ra[bh]=1,U0==2&&(Ra[bh=be(Pi,8)]=1);var Uo=1}else{var yh=i(19),_h=be(Pi,4)+4;if(19<_h){Bo.a=3;var Mo=0;break i}for(Do=0;Do<_h;++Do)yh[f0[Do]]=be(Pi,3);var lc=void 0,ja=void 0,wh=Bo,q0=yh,qo=ac,xh=Ra,cc=0,Ci=wh.m,Sh=8,Ah=a(128,B);r:for(;R(Ah,0,7,q0,19);){if(be(Ci,1)){var $0=2+2*be(Ci,3);if((lc=2+be(Ci,$0))>qo)break r}else lc=qo;for(ja=0;ja<qo&&lc--;){te(Ci);var kh=Ah[0+(127&H(Ci))];ee(Ci,Ci.u+kh.g);var Rs=kh.value;if(16>Rs)xh[ja++]=Rs,Rs!=0&&(Sh=Rs);else{var z0=Rs==16,Nh=Rs-16,W0=h0[Nh],Lh=be(Ci,u0[Nh])+W0;if(ja+Lh>qo)break r;for(var H0=z0?Sh:0;0<Lh--;)xh[ja++]=H0}}cc=1;break r}cc||(wh.a=3),Uo=cc}(Uo=Uo&&!Pi.h)&&(oc=R(F0,D0,8,Ra,ac)),Uo&&oc!=0?Mo=oc:(Bo.a=3,Mo=0)}if(Mo==0)break n;if(li&&d0[ot]==1&&(li=Qn[wt].g==0),is+=Qn[wt].g,wt+=Mo,3>=ot){var Fa,uc=Hn[0];for(Fa=1;Fa<_n;++Fa)Hn[Fa]>uc&&(uc=Hn[Fa]);Cn+=uc}}if(Ut.nd=li,Ut.Qb=0,li&&(Ut.qb=(er[3][Ar[3]+0].value<<24|er[1][Ar[1]+0].value<<16|er[2][Ar[2]+0].value)>>>0,is==0&&256>er[0][Ar[0]+0].value&&(Ut.Qb=1,Ut.qb+=er[0][Ar[0]+0].value<<8)),Ut.jc=!Ut.Qb&&6>Cn,Ut.jc){var $o,ci=Ut;for($o=0;$o<ts;++$o){var Ii=$o,Ti=ci.pd[Ii],zo=ci.G[0][ci.H[0]+Ii];256<=zo.value?(Ti.g=zo.g+256,Ti.value=zo.value):(Ti.g=0,Ti.value=0,Ii>>=xn(zo,8,Ti),Ii>>=xn(ci.G[1][ci.H[1]+Ii],16,Ti),Ii>>=xn(ci.G[2][ci.H[2]+Ii],0,Ti),xn(ci.G[3][ci.H[3]+Ii],24,Ti))}}}yn.vc=At,yn.Wb=Pt,yn.Ya=Zn,yn.yc=Yn,Le=1;break t}Le=0}if(!(N=Le)){b.a=3;break e}if(0<oe){if(M.ua=1<<oe,!D(M.Wa,oe)){b.a=1,N=0;break e}}else M.ua=0;var hc=b,Eh=P,V0=T,dc=hc.s,fc=dc.xc;if(hc.c=Eh,hc.i=V0,dc.md=we(Eh,fc),dc.wc=fc==0?-1:(1<<fc)-1,v){b.xb=S0;break e}if((X=i(P*T))==null){b.a=1,N=0;break e}N=(N=yr(b,X,0,P,T,T,null))&&!j.h;break e}return N?(k!=null?k[0]=X:(e(X==null),e(v)),b.$=0,v||lr(M)):lr(M),N}function Wi(c,d){var v=c.c*c.i,b=v+d+16*d;return e(c.c<=d),c.V=i(b),c.V==null?(c.Ta=null,c.Ua=0,c.a=1,0):(c.Ta=c.V,c.Ua=c.Ba+v+d,1)}function xs(c,d){var v=c.C,b=d-v,k=c.V,N=c.Ba+c.c*v;for(e(d<=c.l.o);0<b;){var P=16<b?16:b,T=c.l.ma,j=c.l.width,M=j*P,X=T.ca,oe=T.tb+j*v,q=c.Ta,Q=c.Ua;$i(c,P,k,N),eh(q,Q,X,oe,M),Or(T,v,v+P,X,oe,j),b-=P,k+=P*c.c,v+=P}e(v==d),c.C=c.Ma=d}function Ss(){this.ub=this.yd=this.td=this.Rb=0}function As(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Fl(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ca(){this.Yb=(function(){var c=[];return(function d(v,b,k){for(var N=k[b],P=0;P<N&&(v.push(k.length>b+1?[]:0),!(k.length<b+1));P++)d(v[P],b+1,k)})(c,0,[3,11]),c})()}function oo(){this.jb=i(3),this.Wc=o([4,8],ca),this.Xc=o([4,17],ca)}function lo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function cr(){this.ld=this.La=this.dd=this.tc=0}function ua(){this.Na=this.la=0}function co(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ha(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function uo(){this.uc=this.M=this.Nb=0,this.wa=Array(new cr),this.Y=0,this.ya=Array(new ha),this.aa=0,this.l=new ks}function ho(){this.y=i(16),this.f=i(8),this.ea=i(8)}function fo(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new Ss,this.Kc=new As,this.ed=new lo,this.Qa=new Fl,this.Ic=this.$c=this.Aa=0,this.D=new uo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,E),this.ia=0,this.pb=a(4,co),this.Pa=new oo,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ho),this.Hd=0,this.rb=Array(new ua),this.sb=0,this.wa=Array(new cr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ha),this.L=this.aa=0,this.gd=o([4,2],cr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function jr(c,d){return 0>c?0:c>d?d:c}function ks(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Dl(){var c=new fo;return c!=null&&(c.a=0,c.sc="OK",c.cb=0,c.Xb=0,Ta||(Ta=Ns)),c}function un(c,d,v){return c.a==0&&(c.a=d,c.sc=v,c.cb=0),0}function po(c,d,v){return 3<=v&&c[d+0]==157&&c[d+1]==1&&c[d+2]==42}function Fr(c,d){if(c==null)return 0;if(c.a=0,c.sc="OK",d==null)return un(c,2,"null VP8Io passed to VP8GetHeaders()");var v=d.data,b=d.w,k=d.ha;if(4>k)return un(c,7,"Truncated header.");var N=v[b+0]|v[b+1]<<8|v[b+2]<<16,P=c.Od;if(P.Rb=!(1&N),P.td=N>>1&7,P.yd=N>>4&1,P.ub=N>>5,3<P.td)return un(c,3,"Incorrect keyframe parameters.");if(!P.yd)return un(c,4,"Frame not displayable.");b+=3,k-=3;var T=c.Kc;if(P.Rb){if(7>k)return un(c,7,"cannot parse picture header");if(!po(v,b,k))return un(c,3,"Bad code word");T.c=16383&(v[b+4]<<8|v[b+3]),T.Td=v[b+4]>>6,T.i=16383&(v[b+6]<<8|v[b+5]),T.Ud=v[b+6]>>6,b+=7,k-=7,c.za=T.c+15>>4,c.Ub=T.i+15>>4,d.width=T.c,d.height=T.i,d.Da=0,d.j=0,d.v=0,d.va=d.width,d.o=d.height,d.da=0,d.ib=d.width,d.hb=d.height,d.U=d.width,d.T=d.height,s((N=c.Pa).jb,0,255,N.jb.length),e((N=c.Qa)!=null),N.Cb=0,N.Bb=0,N.Fb=1,s(N.Zb,0,0,N.Zb.length),s(N.Lb,0,0,N.Lb)}if(P.ub>k)return un(c,7,"bad partition length");ue(N=c.m,v,b,P.ub),b+=P.ub,k-=P.ub,P.Rb&&(T.Ld=ce(N),T.Kd=ce(N)),T=c.Qa;var j,M=c.Pa;if(e(N!=null),e(T!=null),T.Cb=ce(N),T.Cb){if(T.Bb=ce(N),ce(N)){for(T.Fb=ce(N),j=0;4>j;++j)T.Zb[j]=ce(N)?ie(N,7):0;for(j=0;4>j;++j)T.Lb[j]=ce(N)?ie(N,6):0}if(T.Bb)for(j=0;3>j;++j)M.jb[j]=ce(N)?he(N,8):255}else T.Bb=0;if(N.Ka)return un(c,3,"cannot parse segment header");if((T=c.ed).zd=ce(N),T.Tb=he(N,6),T.wb=he(N,3),T.Pc=ce(N),T.Pc&&ce(N)){for(M=0;4>M;++M)ce(N)&&(T.vd[M]=ie(N,6));for(M=0;4>M;++M)ce(N)&&(T.od[M]=ie(N,6))}if(c.L=T.Tb==0?0:T.zd?1:2,N.Ka)return un(c,3,"cannot parse filter header");var X=k;if(k=j=b,b=j+X,T=X,c.Xb=(1<<he(c.m,2))-1,X<3*(M=c.Xb))v=7;else{for(j+=3*M,T-=3*M,X=0;X<M;++X){var oe=v[k+0]|v[k+1]<<8|v[k+2]<<16;oe>T&&(oe=T),ue(c.Jc[+X],v,j,oe),j+=oe,T-=oe,k+=3}ue(c.Jc[+M],v,j,T),v=j<b?0:5}if(v!=0)return un(c,v,"cannot parse partitions");for(v=he(j=c.m,7),k=ce(j)?ie(j,4):0,b=ce(j)?ie(j,4):0,T=ce(j)?ie(j,4):0,M=ce(j)?ie(j,4):0,j=ce(j)?ie(j,4):0,X=c.Qa,oe=0;4>oe;++oe){if(X.Cb){var q=X.Zb[oe];X.Fb||(q+=v)}else{if(0<oe){c.pb[oe]=c.pb[0];continue}q=v}var Q=c.pb[oe];Q.Sc[0]=rc[jr(q+k,127)],Q.Sc[1]=ic[jr(q+0,127)],Q.Eb[0]=2*rc[jr(q+b,127)],Q.Eb[1]=101581*ic[jr(q+T,127)]>>16,8>Q.Eb[1]&&(Q.Eb[1]=8),Q.Qc[0]=rc[jr(q+M,117)],Q.Qc[1]=ic[jr(q+j,127)],Q.lc=q+j}if(!P.Rb)return un(c,4,"Not a key frame.");for(ce(N),P=c.Pa,v=0;4>v;++v){for(k=0;8>k;++k)for(b=0;3>b;++b)for(T=0;11>T;++T)M=ve(N,w0[v][k][b][T])?he(N,8):y0[v][k][b][T],P.Wc[v][k].Yb[b][T]=M;for(k=0;17>k;++k)P.Xc[v][k]=P.Wc[v][x0[k]]}return c.kc=ce(N),c.kc&&(c.Bd=he(N,8)),c.cb=1}function Ns(c,d,v,b,k,N,P){var T=d[k].Yb[v];for(v=0;16>k;++k){if(!ve(c,T[v+0]))return k;for(;!ve(c,T[v+1]);)if(T=d[++k].Yb[0],v=0,k==16)return 16;var j=d[k+1].Yb;if(ve(c,T[v+2])){var M=c,X=0;if(ve(M,(q=T)[(oe=v)+3]))if(ve(M,q[oe+6])){for(T=0,oe=2*(X=ve(M,q[oe+8]))+(q=ve(M,q[oe+9+X])),X=0,q=v0[oe];q[T];++T)X+=X+ve(M,q[T]);X+=3+(8<<oe)}else ve(M,q[oe+7])?(X=7+2*ve(M,165),X+=ve(M,145)):X=5+ve(M,159);else X=ve(M,q[oe+4])?3+ve(M,q[oe+5]):2;T=j[2]}else X=1,T=j[1];j=P+b0[k],0>(M=c).b&&le(M);var oe,q=M.b,Q=(oe=M.Ca>>1)-(M.I>>q)>>31;--M.b,M.Ca+=Q,M.Ca|=1,M.I-=(oe+1&Q)<<q,N[j]=((X^Q)-Q)*b[(0<k)+0]}return 16}function go(c){var d=c.rb[c.sb-1];d.la=0,d.Na=0,s(c.zc,0,0,c.zc.length),c.ja=0}function ur(c,d,v,b,k){k=c[d+v+32*b]+(k>>3),c[d+v+32*b]=-256&k?0>k?0:255:k}function gn(c,d,v,b,k,N){ur(c,d,0,v,b+k),ur(c,d,1,v,b+N),ur(c,d,2,v,b-N),ur(c,d,3,v,b-k)}function Jr(c){return(20091*c>>16)+c}function mo(c,d,v,b){var k,N=0,P=i(16);for(k=0;4>k;++k){var T=c[d+0]+c[d+8],j=c[d+0]-c[d+8],M=(35468*c[d+4]>>16)-Jr(c[d+12]),X=Jr(c[d+4])+(35468*c[d+12]>>16);P[N+0]=T+X,P[N+1]=j+M,P[N+2]=j-M,P[N+3]=T-X,N+=4,d++}for(k=N=0;4>k;++k)T=(c=P[N+0]+4)+P[N+8],j=c-P[N+8],M=(35468*P[N+4]>>16)-Jr(P[N+12]),ur(v,b,0,0,T+(X=Jr(P[N+4])+(35468*P[N+12]>>16))),ur(v,b,1,0,j+M),ur(v,b,2,0,j-M),ur(v,b,3,0,T-X),N++,b+=32}function Bl(c,d,v,b){var k=c[d+0]+4,N=35468*c[d+4]>>16,P=Jr(c[d+4]),T=35468*c[d+1]>>16;gn(v,b,0,k+P,c=Jr(c[d+1]),T),gn(v,b,1,k+N,c,T),gn(v,b,2,k-N,c,T),gn(v,b,3,k-P,c,T)}function Ul(c,d,v,b,k){mo(c,d,v,b),k&&mo(c,d+16,v,b+4)}function Dr(c,d,v,b){rs(c,d+0,v,b,1),rs(c,d+32,v,b+128,1)}function vo(c,d,v,b){var k;for(c=c[d+0]+4,k=0;4>k;++k)for(d=0;4>d;++d)ur(v,b,d,k,c)}function bo(c,d,v,b){c[d+0]&&Et(c,d+0,v,b),c[d+16]&&Et(c,d+16,v,b+4),c[d+32]&&Et(c,d+32,v,b+128),c[d+48]&&Et(c,d+48,v,b+128+4)}function Ls(c,d,v,b){var k,N=i(16);for(k=0;4>k;++k){var P=c[d+0+k]+c[d+12+k],T=c[d+4+k]+c[d+8+k],j=c[d+4+k]-c[d+8+k],M=c[d+0+k]-c[d+12+k];N[0+k]=P+T,N[8+k]=P-T,N[4+k]=M+j,N[12+k]=M-j}for(k=0;4>k;++k)P=(c=N[0+4*k]+3)+N[3+4*k],T=N[1+4*k]+N[2+4*k],j=N[1+4*k]-N[2+4*k],M=c-N[3+4*k],v[b+0]=P+T>>3,v[b+16]=M+j>>3,v[b+32]=P-T>>3,v[b+48]=M-j>>3,b+=64}function Hi(c,d,v){var b,k=d-32,N=Jn,P=255-c[k-1];for(b=0;b<v;++b){var T,j=N,M=P+c[d-1];for(T=0;T<v;++T)c[d+T]=j[M+c[k+T]];d+=32}}function Ml(c,d){Hi(c,d,4)}function ql(c,d){Hi(c,d,8)}function $l(c,d){Hi(c,d,16)}function da(c,d){var v;for(v=0;16>v;++v)r(c,d+32*v,c,d-32,16)}function yo(c,d){var v;for(v=16;0<v;--v)s(c,d,c[d-1],16),d+=32}function _r(c,d,v){var b;for(b=0;16>b;++b)s(d,v+32*b,c,16)}function zl(c,d){var v,b=16;for(v=0;16>v;++v)b+=c[d-1+32*v]+c[d+v-32];_r(b>>5,c,d)}function Vi(c,d){var v,b=8;for(v=0;16>v;++v)b+=c[d-1+32*v];_r(b>>4,c,d)}function fa(c,d){var v,b=8;for(v=0;16>v;++v)b+=c[d+v-32];_r(b>>4,c,d)}function Wl(c,d){_r(128,c,d)}function rt(c,d,v){return c+2*d+v+2>>2}function Hl(c,d){var v,b=d-32;for(b=new Uint8Array([rt(c[b-1],c[b+0],c[b+1]),rt(c[b+0],c[b+1],c[b+2]),rt(c[b+1],c[b+2],c[b+3]),rt(c[b+2],c[b+3],c[b+4])]),v=0;4>v;++v)r(c,d+32*v,b,0,b.length)}function Vl(c,d){var v=c[d-1],b=c[d-1+32],k=c[d-1+64],N=c[d-1+96];Se(c,d+0,16843009*rt(c[d-1-32],v,b)),Se(c,d+32,16843009*rt(v,b,k)),Se(c,d+64,16843009*rt(b,k,N)),Se(c,d+96,16843009*rt(k,N,N))}function Gl(c,d){var v,b=4;for(v=0;4>v;++v)b+=c[d+v-32]+c[d-1+32*v];for(b>>=3,v=0;4>v;++v)s(c,d+32*v,b,4)}function Yr(c,d){var v=c[d-1+0],b=c[d-1+32],k=c[d-1+64],N=c[d-1-32],P=c[d+0-32],T=c[d+1-32],j=c[d+2-32],M=c[d+3-32];c[d+0+96]=rt(b,k,c[d-1+96]),c[d+1+96]=c[d+0+64]=rt(v,b,k),c[d+2+96]=c[d+1+64]=c[d+0+32]=rt(N,v,b),c[d+3+96]=c[d+2+64]=c[d+1+32]=c[d+0+0]=rt(P,N,v),c[d+3+64]=c[d+2+32]=c[d+1+0]=rt(T,P,N),c[d+3+32]=c[d+2+0]=rt(j,T,P),c[d+3+0]=rt(M,j,T)}function Xr(c,d){var v=c[d+1-32],b=c[d+2-32],k=c[d+3-32],N=c[d+4-32],P=c[d+5-32],T=c[d+6-32],j=c[d+7-32];c[d+0+0]=rt(c[d+0-32],v,b),c[d+1+0]=c[d+0+32]=rt(v,b,k),c[d+2+0]=c[d+1+32]=c[d+0+64]=rt(b,k,N),c[d+3+0]=c[d+2+32]=c[d+1+64]=c[d+0+96]=rt(k,N,P),c[d+3+32]=c[d+2+64]=c[d+1+96]=rt(N,P,T),c[d+3+64]=c[d+2+96]=rt(P,T,j),c[d+3+96]=rt(T,j,j)}function Kl(c,d){var v=c[d-1+0],b=c[d-1+32],k=c[d-1+64],N=c[d-1-32],P=c[d+0-32],T=c[d+1-32],j=c[d+2-32],M=c[d+3-32];c[d+0+0]=c[d+1+64]=N+P+1>>1,c[d+1+0]=c[d+2+64]=P+T+1>>1,c[d+2+0]=c[d+3+64]=T+j+1>>1,c[d+3+0]=j+M+1>>1,c[d+0+96]=rt(k,b,v),c[d+0+64]=rt(b,v,N),c[d+0+32]=c[d+1+96]=rt(v,N,P),c[d+1+32]=c[d+2+96]=rt(N,P,T),c[d+2+32]=c[d+3+96]=rt(P,T,j),c[d+3+32]=rt(T,j,M)}function Jl(c,d){var v=c[d+0-32],b=c[d+1-32],k=c[d+2-32],N=c[d+3-32],P=c[d+4-32],T=c[d+5-32],j=c[d+6-32],M=c[d+7-32];c[d+0+0]=v+b+1>>1,c[d+1+0]=c[d+0+64]=b+k+1>>1,c[d+2+0]=c[d+1+64]=k+N+1>>1,c[d+3+0]=c[d+2+64]=N+P+1>>1,c[d+0+32]=rt(v,b,k),c[d+1+32]=c[d+0+96]=rt(b,k,N),c[d+2+32]=c[d+1+96]=rt(k,N,P),c[d+3+32]=c[d+2+96]=rt(N,P,T),c[d+3+64]=rt(P,T,j),c[d+3+96]=rt(T,j,M)}function Es(c,d){var v=c[d-1+0],b=c[d-1+32],k=c[d-1+64],N=c[d-1+96];c[d+0+0]=v+b+1>>1,c[d+2+0]=c[d+0+32]=b+k+1>>1,c[d+2+32]=c[d+0+64]=k+N+1>>1,c[d+1+0]=rt(v,b,k),c[d+3+0]=c[d+1+32]=rt(b,k,N),c[d+3+32]=c[d+1+64]=rt(k,N,N),c[d+3+64]=c[d+2+64]=c[d+0+96]=c[d+1+96]=c[d+2+96]=c[d+3+96]=N}function pa(c,d){var v=c[d-1+0],b=c[d-1+32],k=c[d-1+64],N=c[d-1+96],P=c[d-1-32],T=c[d+0-32],j=c[d+1-32],M=c[d+2-32];c[d+0+0]=c[d+2+32]=v+P+1>>1,c[d+0+32]=c[d+2+64]=b+v+1>>1,c[d+0+64]=c[d+2+96]=k+b+1>>1,c[d+0+96]=N+k+1>>1,c[d+3+0]=rt(T,j,M),c[d+2+0]=rt(P,T,j),c[d+1+0]=c[d+3+32]=rt(v,P,T),c[d+1+32]=c[d+3+64]=rt(b,v,P),c[d+1+64]=c[d+3+96]=rt(k,b,v),c[d+1+96]=rt(N,k,b)}function Gi(c,d){var v;for(v=0;8>v;++v)r(c,d+32*v,c,d-32,8)}function Yl(c,d){var v;for(v=0;8>v;++v)s(c,d,c[d-1],8),d+=32}function Zr(c,d,v){var b;for(b=0;8>b;++b)s(d,v+32*b,c,8)}function Xl(c,d){var v,b=8;for(v=0;8>v;++v)b+=c[d+v-32]+c[d-1+32*v];Zr(b>>4,c,d)}function ga(c,d){var v,b=4;for(v=0;8>v;++v)b+=c[d+v-32];Zr(b>>3,c,d)}function ma(c,d){var v,b=4;for(v=0;8>v;++v)b+=c[d-1+32*v];Zr(b>>3,c,d)}function _o(c,d){Zr(128,c,d)}function Qr(c,d,v){var b=c[d-v],k=c[d+0],N=3*(k-b)+Zl[1020+c[d-2*v]-c[d+v]],P=Eo[112+(N+4>>3)];c[d-v]=Jn[255+b+Eo[112+(N+3>>3)]],c[d+0]=Jn[255+k-P]}function va(c,d,v,b){var k=c[d+0],N=c[d+v];return fr[255+c[d-2*v]-c[d-v]]>b||fr[255+N-k]>b}function Ps(c,d,v,b){return 4*fr[255+c[d-v]-c[d+0]]+fr[255+c[d-2*v]-c[d+v]]<=b}function ba(c,d,v,b,k){var N=c[d-3*v],P=c[d-2*v],T=c[d-v],j=c[d+0],M=c[d+v],X=c[d+2*v],oe=c[d+3*v];return 4*fr[255+T-j]+fr[255+P-M]>b?0:fr[255+c[d-4*v]-N]<=k&&fr[255+N-P]<=k&&fr[255+P-T]<=k&&fr[255+oe-X]<=k&&fr[255+X-M]<=k&&fr[255+M-j]<=k}function Ki(c,d,v,b){var k=2*b+1;for(b=0;16>b;++b)Ps(c,d+b,v,k)&&Qr(c,d+b,v)}function ya(c,d,v,b){var k=2*b+1;for(b=0;16>b;++b)Ps(c,d+b*v,1,k)&&Qr(c,d+b*v,1)}function wo(c,d,v,b){var k;for(k=3;0<k;--k)Ki(c,d+=4*v,v,b)}function xo(c,d,v,b){var k;for(k=3;0<k;--k)ya(c,d+=4,v,b)}function ei(c,d,v,b,k,N,P,T){for(N=2*N+1;0<k--;){if(ba(c,d,v,N,P))if(va(c,d,v,T))Qr(c,d,v);else{var j=c,M=d,X=v,oe=j[M-2*X],q=j[M-X],Q=j[M+0],se=j[M+X],fe=j[M+2*X],ae=27*(me=Zl[1020+3*(Q-q)+Zl[1020+oe-se]])+63>>7,pe=18*me+63>>7,me=9*me+63>>7;j[M-3*X]=Jn[255+j[M-3*X]+me],j[M-2*X]=Jn[255+oe+pe],j[M-X]=Jn[255+q+ae],j[M+0]=Jn[255+Q-ae],j[M+X]=Jn[255+se-pe],j[M+2*X]=Jn[255+fe-me]}d+=b}}function ti(c,d,v,b,k,N,P,T){for(N=2*N+1;0<k--;){if(ba(c,d,v,N,P))if(va(c,d,v,T))Qr(c,d,v);else{var j=c,M=d,X=v,oe=j[M-X],q=j[M+0],Q=j[M+X],se=Eo[112+(4+(fe=3*(q-oe))>>3)],fe=Eo[112+(fe+3>>3)],ae=se+1>>1;j[M-2*X]=Jn[255+j[M-2*X]+ae],j[M-X]=Jn[255+oe+fe],j[M+0]=Jn[255+q-se],j[M+X]=Jn[255+Q-ae]}d+=b}}function So(c,d,v,b,k,N){ei(c,d,v,1,16,b,k,N)}function Ji(c,d,v,b,k,N){ei(c,d,1,v,16,b,k,N)}function Ao(c,d,v,b,k,N){var P;for(P=3;0<P;--P)ti(c,d+=4*v,v,1,16,b,k,N)}function g(c,d,v,b,k,N){var P;for(P=3;0<P;--P)ti(c,d+=4,1,v,16,b,k,N)}function A(c,d,v,b,k,N,P,T){ei(c,d,k,1,8,N,P,T),ei(v,b,k,1,8,N,P,T)}function $(c,d,v,b,k,N,P,T){ei(c,d,1,k,8,N,P,T),ei(v,b,1,k,8,N,P,T)}function K(c,d,v,b,k,N,P,T){ti(c,d+4*k,k,1,8,N,P,T),ti(v,b+4*k,k,1,8,N,P,T)}function ne(c,d,v,b,k,N,P,T){ti(c,d+4,1,k,8,N,P,T),ti(v,b+4,1,k,8,N,P,T)}function ge(){this.ba=new gt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ye(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Re(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Be(){this.ua=0,this.Wa=new dt,this.vb=new dt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Z,this.yc=new B}function nt(){this.xb=this.a=0,this.l=new ks,this.ca=new gt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Be,this.ab=0,this.gc=a(4,Re),this.Oc=0}function ct(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ks,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function St(c,d,v,b,k,N,P){for(c=c==null?0:c[d+0],d=0;d<P;++d)k[N+d]=c+v[b+d]&255,c=k[N+d]}function Gt(c,d,v,b,k,N,P){var T;if(c==null)St(null,null,v,b,k,N,P);else for(T=0;T<P;++T)k[N+T]=c[d+T]+v[b+T]&255}function hn(c,d,v,b,k,N,P){if(c==null)St(null,null,v,b,k,N,P);else{var T,j=c[d+0],M=j,X=j;for(T=0;T<P;++T)M=X+(j=c[d+T])-M,X=v[b+T]+(-256&M?0>M?0:255:M)&255,M=j,k[N+T]=X}}function Bt(c,d,v,b){var k=d.width,N=d.o;if(e(c!=null&&d!=null),0>v||0>=b||v+b>N)return null;if(!c.Cc){if(c.ga==null){var P;if(c.ga=new ct,(P=c.ga==null)||(P=d.width*d.o,e(c.Gb.length==0),c.Gb=i(P),c.Uc=0,c.Gb==null?P=0:(c.mb=c.Gb,c.nb=c.Uc,c.rc=null,P=1),P=!P),!P){P=c.ga;var T=c.Fa,j=c.P,M=c.qc,X=c.mb,oe=c.nb,q=j+1,Q=M-1,se=P.l;if(e(T!=null&&X!=null&&d!=null),Ei[0]=null,Ei[1]=St,Ei[2]=Gt,Ei[3]=hn,P.ca=X,P.tb=oe,P.c=d.width,P.i=d.height,e(0<P.c&&0<P.i),1>=M)d=0;else if(P.$a=3&T[j+0],P.Z=T[j+0]>>2&3,P.Lc=T[j+0]>>4&3,j=T[j+0]>>6&3,0>P.$a||1<P.$a||4<=P.Z||1<P.Lc||j)d=0;else if(se.put=Ze,se.ac=Tr,se.bc=Gr,se.ma=P,se.width=d.width,se.height=d.height,se.Da=d.Da,se.v=d.v,se.va=d.va,se.j=d.j,se.o=d.o,P.$a)e:{e(P.$a==1),d=zi();t:for(;;){if(d==null){d=0;break e}if(e(P!=null),P.mc=d,d.c=P.c,d.i=P.i,d.l=P.l,d.l.ma=P,d.l.width=P.c,d.l.height=P.i,d.a=0,de(d.m,T,q,Q),!Rr(P.c,P.i,1,d,null)||(d.ab==1&&d.gc[0].hc==3&&vr(d.s)?(P.ic=1,T=d.c*d.i,d.Ta=null,d.Ua=0,d.V=i(T),d.Ba=0,d.V==null?(d.a=1,d=0):d=1):(P.ic=0,d=Wi(d,P.c)),!d))break t;d=1;break e}P.mc=null,d=0}else d=Q>=P.c*P.i;P=!d}if(P)return null;c.ga.Lc!=1?c.Ga=0:b=N-v}e(c.ga!=null),e(v+b<=N);e:{if(d=(T=c.ga).c,N=T.l.o,T.$a==0){if(q=c.rc,Q=c.Vc,se=c.Fa,j=c.P+1+v*d,M=c.mb,X=c.nb+v*d,e(j<=c.P+c.qc),T.Z!=0)for(e(Ei[T.Z]!=null),P=0;P<b;++P)Ei[T.Z](q,Q,se,j,M,X,d),q=M,Q=X,X+=d,j+=d;else for(P=0;P<b;++P)r(M,X,se,j,d),q=M,Q=X,X+=d,j+=d;c.rc=q,c.Vc=Q}else{if(e(T.mc!=null),d=v+b,e((P=T.mc)!=null),e(d<=P.i),P.C>=d)d=1;else if(T.ic||wr(),T.ic){T=P.V,q=P.Ba,Q=P.c;var fe=P.i,ae=(se=1,j=P.$/Q,M=P.$%Q,X=P.m,oe=P.s,P.$),pe=Q*fe,me=Q*d,xe=oe.wc,_e=ae<me?kn(oe,M,j):null;e(ae<=pe),e(d<=fe),e(vr(oe));t:for(;;){for(;!X.h&&ae<me;){if(M&xe||(_e=kn(oe,M,j)),e(_e!=null),te(X),256>(fe=Yt(_e.G[0],_e.H[0],X)))T[q+ae]=fe,++ae,++M>=Q&&(M=0,++j<=d&&!(j%16)&&br(P,j));else{if(!(280>fe)){se=0;break t}fe=ar(fe-256,X);var Me,Ie=Yt(_e.G[4],_e.H[4],X);if(te(X),!(ae>=(Ie=or(Q,Ie=ar(Ie,X)))&&pe-ae>=fe)){se=0;break t}for(Me=0;Me<fe;++Me)T[q+ae+Me]=T[q+ae+Me-Ie];for(ae+=fe,M+=fe;M>=Q;)M-=Q,++j<=d&&!(j%16)&&br(P,j);ae<me&&M&xe&&(_e=kn(oe,M,j))}e(X.h==Y(X))}br(P,j>d?d:j);break t}!se||X.h&&ae<pe?(se=0,P.a=X.h?5:3):P.$=ae,d=se}else d=yr(P,P.V,P.Ba,P.c,P.i,d,xs);if(!d){b=0;break e}}v+b>=N&&(c.Cc=1),b=1}if(!b)return null;if(c.Cc&&((b=c.ga)!=null&&(b.mc=null),c.ga=null,0<c.Ga))return alert("todo:WebPDequantizeLevels"),null}return c.nb+v*k}function mn(c,d,v,b,k,N){for(;0<k--;){var P,T=c,j=d+(v?1:0),M=c,X=d+(v?0:3);for(P=0;P<b;++P){var oe=M[X+4*P];oe!=255&&(oe*=32897,T[j+4*P+0]=T[j+4*P+0]*oe>>23,T[j+4*P+1]=T[j+4*P+1]*oe>>23,T[j+4*P+2]=T[j+4*P+2]*oe>>23)}d+=N}}function dn(c,d,v,b,k){for(;0<b--;){var N;for(N=0;N<v;++N){var P=c[d+2*N+0],T=15&(M=c[d+2*N+1]),j=4369*T,M=(240&M|M>>4)*j>>16;c[d+2*N+0]=(240&P|P>>4)*j>>16&240|(15&P|P<<4)*j>>16>>4&15,c[d+2*N+1]=240&M|T}d+=k}}function Nn(c,d,v,b,k,N,P,T){var j,M,X=255;for(M=0;M<k;++M){for(j=0;j<b;++j){var oe=c[d+j];N[P+4*j]=oe,X&=oe}d+=v,P+=T}return X!=255}function ni(c,d,v,b,k){var N;for(N=0;N<k;++N)v[b+N]=c[d+N]>>8}function wr(){Ia=mn,Zu=dn,Qu=Nn,eh=ni}function ri(c,d,v){U[c]=function(b,k,N,P,T,j,M,X,oe,q,Q,se,fe,ae,pe,me,xe){var _e,Me=xe-1>>1,Ie=T[j+0]|M[X+0]<<16,ut=oe[q+0]|Q[se+0]<<16;e(b!=null);var je=3*Ie+ut+131074>>2;for(d(b[k+0],255&je,je>>16,fe,ae),N!=null&&(je=3*ut+Ie+131074>>2,d(N[P+0],255&je,je>>16,pe,me)),_e=1;_e<=Me;++_e){var _t=T[j+_e]|M[X+_e]<<16,bn=oe[q+_e]|Q[se+_e]<<16,ht=Ie+_t+ut+bn+524296,Fe=ht+2*(_t+ut)>>3;je=Fe+Ie>>1,Ie=(ht=ht+2*(Ie+bn)>>3)+_t>>1,d(b[k+2*_e-1],255&je,je>>16,fe,ae+(2*_e-1)*v),d(b[k+2*_e-0],255&Ie,Ie>>16,fe,ae+(2*_e-0)*v),N!=null&&(je=ht+ut>>1,Ie=Fe+bn>>1,d(N[P+2*_e-1],255&je,je>>16,pe,me+(2*_e-1)*v),d(N[P+2*_e+0],255&Ie,Ie>>16,pe,me+(2*_e+0)*v)),Ie=_t,ut=bn}1&xe||(je=3*Ie+ut+131074>>2,d(b[k+xe-1],255&je,je>>16,fe,ae+(xe-1)*v),N!=null&&(je=3*ut+Ie+131074>>2,d(N[P+xe-1],255&je,je>>16,pe,me+(xe-1)*v)))}}function _a(){pr[Po]=A0,pr[Co]=hh,pr[ah]=k0,pr[Io]=dh,pr[To]=fh,pr[Ql]=ph,pr[oh]=N0,pr[ec]=hh,pr[tc]=dh,pr[Oo]=fh,pr[nc]=ph}function Cs(c){return c&-16384?0>c?0:255:c>>L0}function bi(c,d){return Cs((19077*c>>8)+(26149*d>>8)-14234)}function Yi(c,d,v){return Cs((19077*c>>8)-(6419*d>>8)-(13320*v>>8)+8708)}function Xi(c,d){return Cs((19077*c>>8)+(33050*d>>8)-17685)}function yi(c,d,v,b,k){b[k+0]=bi(c,v),b[k+1]=Yi(c,d,v),b[k+2]=Xi(c,d)}function Ln(c,d,v,b,k){b[k+0]=Xi(c,d),b[k+1]=Yi(c,d,v),b[k+2]=bi(c,v)}function Zi(c,d,v,b,k){var N=Yi(c,d,v);d=N<<3&224|Xi(c,d)>>3,b[k+0]=248&bi(c,v)|N>>5,b[k+1]=d}function Qi(c,d,v,b,k){var N=240&Xi(c,d)|15;b[k+0]=240&bi(c,v)|Yi(c,d,v)>>4,b[k+1]=N}function wa(c,d,v,b,k){b[k+0]=255,yi(c,d,v,b,k+1)}function xa(c,d,v,b,k){Ln(c,d,v,b,k),b[k+3]=255}function Mn(c,d,v,b,k){yi(c,d,v,b,k),b[k+3]=255}function ii(c,d,v){U[c]=function(b,k,N,P,T,j,M,X,oe){for(var q=X+(-2&oe)*v;X!=q;)d(b[k+0],N[P+0],T[j+0],M,X),d(b[k+1],N[P+0],T[j+0],M,X+v),k+=2,++P,++j,X+=2*v;1&oe&&d(b[k+0],N[P+0],T[j+0],M,X)}}function Is(c,d,v){return v==0?c==0?d==0?6:5:d==0?4:0:v}function ko(c,d,v,b,k){switch(c>>>30){case 3:rs(d,v,b,k,0);break;case 2:dr(d,v,b,k);break;case 1:Et(d,v,b,k)}}function hr(c,d){var v,b,k=d.M,N=d.Nb,P=c.oc,T=c.pc+40,j=c.oc,M=c.pc+584,X=c.oc,oe=c.pc+600;for(v=0;16>v;++v)P[T+32*v-1]=129;for(v=0;8>v;++v)j[M+32*v-1]=129,X[oe+32*v-1]=129;for(0<k?P[T-1-32]=j[M-1-32]=X[oe-1-32]=129:(s(P,T-32-1,127,21),s(j,M-32-1,127,9),s(X,oe-32-1,127,9)),b=0;b<c.za;++b){var q=d.ya[d.aa+b];if(0<b){for(v=-1;16>v;++v)r(P,T+32*v-4,P,T+32*v+12,4);for(v=-1;8>v;++v)r(j,M+32*v-4,j,M+32*v+4,4),r(X,oe+32*v-4,X,oe+32*v+4,4)}var Q=c.Gd,se=c.Hd+b,fe=q.ad,ae=q.Hc;if(0<k&&(r(P,T-32,Q[se].y,0,16),r(j,M-32,Q[se].f,0,8),r(X,oe-32,Q[se].ea,0,8)),q.Za){var pe=P,me=T-32+16;for(0<k&&(b>=c.za-1?s(pe,me,Q[se].y[15],4):r(pe,me,Q[se+1].y,0,4)),v=0;4>v;v++)pe[me+128+v]=pe[me+256+v]=pe[me+384+v]=pe[me+0+v];for(v=0;16>v;++v,ae<<=2)pe=P,me=T+mh[v],xr[q.Ob[v]](pe,me),ko(ae,fe,16*+v,pe,me)}else if(pe=Is(b,k,q.Ob[0]),Li[pe](P,T),ae!=0)for(v=0;16>v;++v,ae<<=2)ko(ae,fe,16*+v,P,T+mh[v]);for(v=q.Gc,pe=Is(b,k,q.Dd),oi[pe](j,M),oi[pe](X,oe),ae=fe,pe=j,me=M,255&(q=0|v)&&(170&q?Mr(ae,256,pe,me):Ot(ae,256,pe,me)),q=X,ae=oe,255&(v>>=8)&&(170&v?Mr(fe,320,q,ae):Ot(fe,320,q,ae)),k<c.Ub-1&&(r(Q[se].y,0,P,T+480,16),r(Q[se].f,0,j,M+224,8),r(Q[se].ea,0,X,oe+224,8)),v=8*N*c.B,Q=c.sa,se=c.ta+16*b+16*N*c.R,fe=c.qa,q=c.ra+8*b+v,ae=c.Ha,pe=c.Ia+8*b+v,v=0;16>v;++v)r(Q,se+v*c.R,P,T+32*v,16);for(v=0;8>v;++v)r(fe,q+v*c.B,j,M+32*v,8),r(ae,pe+v*c.B,X,oe+32*v,8)}}function es(c,d,v,b,k,N,P,T,j){var M=[0],X=[0],oe=0,q=j!=null?j.kd:0,Q=j??new ye;if(c==null||12>v)return 7;Q.data=c,Q.w=d,Q.ha=v,d=[d],v=[v],Q.gb=[Q.gb];e:{var se=d,fe=v,ae=Q.gb;if(e(c!=null),e(fe!=null),e(ae!=null),ae[0]=0,12<=fe[0]&&!t(c,se[0],"RIFF")){if(t(c,se[0]+8,"WEBP")){ae=3;break e}var pe=ze(c,se[0]+4);if(12>pe||4294967286<pe){ae=3;break e}if(q&&pe>fe[0]-8){ae=7;break e}ae[0]=pe,se[0]+=12,fe[0]-=12}ae=0}if(ae!=0)return ae;for(pe=0<Q.gb[0],v=v[0];;){e:{var me=c;fe=d,ae=v;var xe=M,_e=X,Me=se=[0];if((je=oe=[oe])[0]=0,8>ae[0])ae=7;else{if(!t(me,fe[0],"VP8X")){if(ze(me,fe[0]+4)!=10){ae=3;break e}if(18>ae[0]){ae=7;break e}var Ie=ze(me,fe[0]+8),ut=1+Pe(me,fe[0]+12);if(2147483648<=ut*(me=1+Pe(me,fe[0]+15))){ae=3;break e}Me!=null&&(Me[0]=Ie),xe!=null&&(xe[0]=ut),_e!=null&&(_e[0]=me),fe[0]+=18,ae[0]-=18,je[0]=1}ae=0}}if(oe=oe[0],se=se[0],ae!=0)return ae;if(fe=!!(2&se),!pe&&oe)return 3;if(N!=null&&(N[0]=!!(16&se)),P!=null&&(P[0]=fe),T!=null&&(T[0]=0),P=M[0],se=X[0],oe&&fe&&j==null){ae=0;break}if(4>v){ae=7;break}if(pe&&oe||!pe&&!oe&&!t(c,d[0],"ALPH")){v=[v],Q.na=[Q.na],Q.P=[Q.P],Q.Sa=[Q.Sa];e:{Ie=c,ae=d,pe=v;var je=Q.gb;xe=Q.na,_e=Q.P,Me=Q.Sa,ut=22,e(Ie!=null),e(pe!=null),me=ae[0];var _t=pe[0];for(e(xe!=null),e(Me!=null),xe[0]=null,_e[0]=null,Me[0]=0;;){if(ae[0]=me,pe[0]=_t,8>_t){ae=7;break e}var bn=ze(Ie,me+4);if(4294967286<bn){ae=3;break e}var ht=8+bn+1&-2;if(ut+=ht,0<je&&ut>je){ae=3;break e}if(!t(Ie,me,"VP8 ")||!t(Ie,me,"VP8L")){ae=0;break e}if(_t[0]<ht){ae=7;break e}t(Ie,me,"ALPH")||(xe[0]=Ie,_e[0]=me+8,Me[0]=bn),me+=ht,_t-=ht}}if(v=v[0],Q.na=Q.na[0],Q.P=Q.P[0],Q.Sa=Q.Sa[0],ae!=0)break}v=[v],Q.Ja=[Q.Ja],Q.xa=[Q.xa];e:if(je=c,ae=d,pe=v,xe=Q.gb[0],_e=Q.Ja,Me=Q.xa,Ie=ae[0],me=!t(je,Ie,"VP8 "),ut=!t(je,Ie,"VP8L"),e(je!=null),e(pe!=null),e(_e!=null),e(Me!=null),8>pe[0])ae=7;else{if(me||ut){if(je=ze(je,Ie+4),12<=xe&&je>xe-12){ae=3;break e}if(q&&je>pe[0]-8){ae=7;break e}_e[0]=je,ae[0]+=8,pe[0]-=8,Me[0]=ut}else Me[0]=5<=pe[0]&&je[Ie+0]==47&&!(je[Ie+4]>>5),_e[0]=pe[0];ae=0}if(v=v[0],Q.Ja=Q.Ja[0],Q.xa=Q.xa[0],d=d[0],ae!=0)break;if(4294967286<Q.Ja)return 3;if(T==null||fe||(T[0]=Q.xa?2:1),P=[P],se=[se],Q.xa){if(5>v){ae=7;break}T=P,q=se,fe=N,c==null||5>v?c=0:5<=v&&c[d+0]==47&&!(c[d+4]>>5)?(pe=[0],je=[0],xe=[0],de(_e=new z,c,d,v),Kr(_e,pe,je,xe)?(T!=null&&(T[0]=pe[0]),q!=null&&(q[0]=je[0]),fe!=null&&(fe[0]=xe[0]),c=1):c=0):c=0}else{if(10>v){ae=7;break}T=se,c==null||10>v||!po(c,d+3,v-3)?c=0:(q=c[d+0]|c[d+1]<<8|c[d+2]<<16,fe=16383&(c[d+7]<<8|c[d+6]),c=16383&(c[d+9]<<8|c[d+8]),1&q||3<(q>>1&7)||!(q>>4&1)||q>>5>=Q.Ja||!fe||!c?c=0:(P&&(P[0]=fe),T&&(T[0]=c),c=1))}if(!c||(P=P[0],se=se[0],oe&&(M[0]!=P||X[0]!=se)))return 3;j!=null&&(j[0]=Q,j.offset=d-j.w,e(4294967286>d-j.w),e(j.offset==j.ha-v));break}return ae==0||ae==7&&oe&&j==null?(N!=null&&(N[0]|=Q.na!=null&&0<Q.na.length),b!=null&&(b[0]=P),k!=null&&(k[0]=se),0):ae}function Sa(c,d,v){var b=d.width,k=d.height,N=0,P=0,T=b,j=k;if(d.Da=c!=null&&0<c.Da,d.Da&&(T=c.cd,j=c.bd,N=c.v,P=c.j,11>v||(N&=-2,P&=-2),0>N||0>P||0>=T||0>=j||N+T>b||P+j>k))return 0;if(d.v=N,d.j=P,d.va=N+T,d.o=P+j,d.U=T,d.T=j,d.da=c!=null&&0<c.da,d.da){if(!Ke(T,j,v=[c.ib],N=[c.hb]))return 0;d.ib=v[0],d.hb=N[0]}return d.ob=c!=null&&c.ob,d.Kb=c==null||!c.Sd,d.da&&(d.ob=d.ib<3*b/4&&d.hb<3*k/4,d.Kb=0),1}function Aa(c){if(c==null)return 2;if(11>c.S){var d=c.f.RGBA;d.fb+=(c.height-1)*d.A,d.A=-d.A}else d=c.f.kb,c=c.height,d.O+=(c-1)*d.fa,d.fa=-d.fa,d.N+=(c-1>>1)*d.Ab,d.Ab=-d.Ab,d.W+=(c-1>>1)*d.Db,d.Db=-d.Db,d.F!=null&&(d.J+=(c-1)*d.lb,d.lb=-d.lb);return 0}function _i(c,d,v,b){if(b==null||0>=c||0>=d)return 2;if(v!=null){if(v.Da){var k=v.cd,N=v.bd,P=-2&v.v,T=-2&v.j;if(0>P||0>T||0>=k||0>=N||P+k>c||T+N>d)return 2;c=k,d=N}if(v.da){if(!Ke(c,d,k=[v.ib],N=[v.hb]))return 2;c=k[0],d=N[0]}}b.width=c,b.height=d;e:{var j=b.width,M=b.height;if(c=b.S,0>=j||0>=M||!(c>=Po&&13>c))c=2;else{if(0>=b.Rd&&b.sd==null){P=N=k=d=0;var X=(T=j*vh[c])*M;if(11>c||(N=(M+1)/2*(d=(j+1)/2),c==12&&(P=(k=j)*M)),(M=i(X+2*N+P))==null){c=1;break e}b.sd=M,11>c?((j=b.f.RGBA).eb=M,j.fb=0,j.A=T,j.size=X):((j=b.f.kb).y=M,j.O=0,j.fa=T,j.Fd=X,j.f=M,j.N=0+X,j.Ab=d,j.Cd=N,j.ea=M,j.W=0+X+N,j.Db=d,j.Ed=N,c==12&&(j.F=M,j.J=0+X+2*N),j.Tc=P,j.lb=k)}if(d=1,k=b.S,N=b.width,P=b.height,k>=Po&&13>k)if(11>k)c=b.f.RGBA,d&=(T=Math.abs(c.A))*(P-1)+N<=c.size,d&=T>=N*vh[k],d&=c.eb!=null;else{c=b.f.kb,T=(N+1)/2,X=(P+1)/2,j=Math.abs(c.fa),M=Math.abs(c.Ab);var oe=Math.abs(c.Db),q=Math.abs(c.lb),Q=q*(P-1)+N;d&=j*(P-1)+N<=c.Fd,d&=M*(X-1)+T<=c.Cd,d=(d&=oe*(X-1)+T<=c.Ed)&j>=N&M>=T&oe>=T,d&=c.y!=null,d&=c.f!=null,d&=c.ea!=null,k==12&&(d&=q>=N,d&=Q<=c.Tc,d&=c.F!=null)}else d=0;c=d?0:2}}return c!=0||v!=null&&v.fd&&(c=Aa(b)),c}var ts=64,Gn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Kn=24,wi=32,si=8,xi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Te("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(c){return c},U.Predictor2=function(c,d,v){return d[v+0]},U.Predictor3=function(c,d,v){return d[v+1]},U.Predictor4=function(c,d,v){return d[v-1]},U.Predictor5=function(c,d,v){return We(We(c,d[v+1]),d[v+0])},U.Predictor6=function(c,d,v){return We(c,d[v-1])},U.Predictor7=function(c,d,v){return We(c,d[v+0])},U.Predictor8=function(c,d,v){return We(d[v-1],d[v+0])},U.Predictor9=function(c,d,v){return We(d[v+0],d[v+1])},U.Predictor10=function(c,d,v){return We(We(c,d[v-1]),We(d[v+0],d[v+1]))},U.Predictor11=function(c,d,v){var b=d[v+0];return 0>=st(b>>24&255,c>>24&255,(d=d[v-1])>>24&255)+st(b>>16&255,c>>16&255,d>>16&255)+st(b>>8&255,c>>8&255,d>>8&255)+st(255&b,255&c,255&d)?b:c},U.Predictor12=function(c,d,v){var b=d[v+0];return(Nt((c>>24&255)+(b>>24&255)-((d=d[v-1])>>24&255))<<24|Nt((c>>16&255)+(b>>16&255)-(d>>16&255))<<16|Nt((c>>8&255)+(b>>8&255)-(d>>8&255))<<8|Nt((255&c)+(255&b)-(255&d)))>>>0},U.Predictor13=function(c,d,v){var b=d[v-1];return(mt((c=We(c,d[v+0]))>>24&255,b>>24&255)<<24|mt(c>>16&255,b>>16&255)<<16|mt(c>>8&255,b>>8&255)<<8|mt(255&c,255&b))>>>0};var ka=U.PredictorAdd0;U.PredictorAdd1=yt,Te("Predictor2","PredictorAdd2"),Te("Predictor3","PredictorAdd3"),Te("Predictor4","PredictorAdd4"),Te("Predictor5","PredictorAdd5"),Te("Predictor6","PredictorAdd6"),Te("Predictor7","PredictorAdd7"),Te("Predictor8","PredictorAdd8"),Te("Predictor9","PredictorAdd9"),Te("Predictor10","PredictorAdd10"),Te("Predictor11","PredictorAdd11"),Te("Predictor12","PredictorAdd12"),Te("Predictor13","PredictorAdd13");var Ts=U.PredictorAdd2;$e("ColorIndexInverseTransform","MapARGB","32b",function(c){return c>>8&255},function(c){return c}),$e("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(c){return c},function(c){return c>>8&255});var nn,No=U.ColorIndexInverseTransform,Br=U.MapARGB,Ur=U.VP8LColorIndexInverseTransformAlpha,Na=U.MapAlpha,La=U.VP8LPredictorsAdd=[];La.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var Ea,Pa,Si,Ai,ki,ns,Ni,rs,dr,Mr,Et,Ot,rn,vn,ai,Ca,Os,Lo,Vu,Gu,Ku,Ju,Yu,Xu,Ia,Zu,Qu,eh,th=i(511),nh=i(2041),rh=i(225),ih=i(767),sh=0,Zl=nh,Eo=rh,Jn=ih,fr=th,Po=0,Co=1,ah=2,Io=3,To=4,Ql=5,oh=6,ec=7,tc=8,Oo=9,nc=10,u0=[2,3,7],h0=[3,3,11],lh=[280,256,256,256,40],d0=[0,1,1,1,0],f0=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],p0=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],g0=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],m0=8,rc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ic=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ta=null,v0=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],b0=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ch=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],y0=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_0=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],w0=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],x0=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Li=[],xr=[],oi=[],S0=1,uh=2,Ei=[],pr=[];ri("UpsampleRgbLinePair",yi,3),ri("UpsampleBgrLinePair",Ln,3),ri("UpsampleRgbaLinePair",Mn,4),ri("UpsampleBgraLinePair",xa,4),ri("UpsampleArgbLinePair",wa,4),ri("UpsampleRgba4444LinePair",Qi,2),ri("UpsampleRgb565LinePair",Zi,2);var A0=U.UpsampleRgbLinePair,k0=U.UpsampleBgrLinePair,hh=U.UpsampleRgbaLinePair,dh=U.UpsampleBgraLinePair,fh=U.UpsampleArgbLinePair,ph=U.UpsampleRgba4444LinePair,N0=U.UpsampleRgb565LinePair,Ro=16,jo=1<<Ro-1,Oa=-227,sc=482,L0=6,gh=0,E0=i(256),P0=i(256),C0=i(256),I0=i(256),T0=i(sc-Oa),O0=i(sc-Oa);ii("YuvToRgbRow",yi,3),ii("YuvToBgrRow",Ln,3),ii("YuvToRgbaRow",Mn,4),ii("YuvToBgraRow",xa,4),ii("YuvToArgbRow",wa,4),ii("YuvToRgba4444Row",Qi,2),ii("YuvToRgb565Row",Zi,2);var mh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Fo=[0,2,8],R0=[8,7,6,4,4,2,2,2,1,1,1,1],j0=1;this.WebPDecodeRGBA=function(c,d,v,b,k){var N=Co,P=new ge,T=new gt;P.ba=T,T.S=N,T.width=[T.width],T.height=[T.height];var j=T.width,M=T.height,X=new Xe;if(X==null||c==null)var oe=2;else e(X!=null),oe=es(c,d,v,X.width,X.height,X.Pd,X.Qd,X.format,null);if(oe!=0?j=0:(j!=null&&(j[0]=X.width[0]),M!=null&&(M[0]=X.height[0]),j=1),j){T.width=T.width[0],T.height=T.height[0],b!=null&&(b[0]=T.width),k!=null&&(k[0]=T.height);e:{if(b=new ks,(k=new ye).data=c,k.w=d,k.ha=v,k.kd=1,d=[0],e(k!=null),((c=es(k.data,k.w,k.ha,null,null,null,d,null,k))==0||c==7)&&d[0]&&(c=4),(d=c)==0){if(e(P!=null),b.data=k.data,b.w=k.w+k.offset,b.ha=k.ha-k.offset,b.put=Ze,b.ac=Tr,b.bc=Gr,b.ma=P,k.xa){if((c=zi())==null){P=1;break e}if((function(q,Q){var se=[0],fe=[0],ae=[0];t:for(;;){if(q==null)return 0;if(Q==null)return q.a=2,0;if(q.l=Q,q.a=0,de(q.m,Q.data,Q.w,Q.ha),!Kr(q.m,se,fe,ae)){q.a=3;break t}if(q.xb=uh,Q.width=se[0],Q.height=fe[0],!Rr(se[0],fe[0],1,q,null))break t;return 1}return e(q.a!=0),0})(c,b)){if(b=(d=_i(b.width,b.height,P.Oa,P.ba))==0){t:{b=c;n:for(;;){if(b==null){b=0;break t}if(e(b.s.yc!=null),e(b.s.Ya!=null),e(0<b.s.Wb),e((v=b.l)!=null),e((k=v.ma)!=null),b.xb!=0){if(b.ca=k.ba,b.tb=k.tb,e(b.ca!=null),!Sa(k.Oa,v,Io)){b.a=2;break n}if(!Wi(b,v.width)||v.da)break n;if((v.da||et(b.ca.S))&&wr(),11>b.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),b.ca.f.kb.F!=null&&wr()),b.Pb&&0<b.s.ua&&b.s.vb.X==null&&!D(b.s.vb,b.s.Wa.Xa)){b.a=1;break n}b.xb=0}if(!yr(b,b.V,b.Ba,b.c,b.i,v.o,vi))break n;k.Dc=b.Ma,b=1;break t}e(b.a!=0),b=0}b=!b}b&&(d=c.a)}else d=c.a}else{if((c=new Dl)==null){P=1;break e}if(c.Fa=k.na,c.P=k.P,c.qc=k.Sa,Fr(c,b)){if((d=_i(b.width,b.height,P.Oa,P.ba))==0){if(c.Aa=0,v=P.Oa,e((k=c)!=null),v!=null){if(0<(j=0>(j=v.Md)?0:100<j?255:255*j/100)){for(M=X=0;4>M;++M)12>(oe=k.pb[M]).lc&&(oe.ia=j*R0[0>oe.lc?0:oe.lc]>>3),X|=oe.ia;X&&(alert("todo:VP8InitRandom"),k.ia=1)}k.Ga=v.Id,100<k.Ga?k.Ga=100:0>k.Ga&&(k.Ga=0)}(function(q,Q){if(q==null)return 0;if(Q==null)return un(q,2,"NULL VP8Io parameter in VP8Decode().");if(!q.cb&&!Fr(q,Q))return 0;if(e(q.cb),Q.ac==null||Q.ac(Q)){Q.ob&&(q.L=0);var se=Fo[q.L];if(q.L==2?(q.yb=0,q.zb=0):(q.yb=Q.v-se>>4,q.zb=Q.j-se>>4,0>q.yb&&(q.yb=0),0>q.zb&&(q.zb=0)),q.Va=Q.o+15+se>>4,q.Hb=Q.va+15+se>>4,q.Hb>q.za&&(q.Hb=q.za),q.Va>q.Ub&&(q.Va=q.Ub),0<q.L){var fe=q.ed;for(se=0;4>se;++se){var ae;if(q.Qa.Cb){var pe=q.Qa.Lb[se];q.Qa.Fb||(pe+=fe.Tb)}else pe=fe.Tb;for(ae=0;1>=ae;++ae){var me=q.gd[se][ae],xe=pe;if(fe.Pc&&(xe+=fe.vd[0],ae&&(xe+=fe.od[0])),0<(xe=0>xe?0:63<xe?63:xe)){var _e=xe;0<fe.wb&&(_e=4<fe.wb?_e>>2:_e>>1)>9-fe.wb&&(_e=9-fe.wb),1>_e&&(_e=1),me.dd=_e,me.tc=2*xe+_e,me.ld=40<=xe?2:15<=xe?1:0}else me.tc=0;me.La=ae}}}se=0}else un(q,6,"Frame setup failed"),se=q.a;if(se=se==0){if(se){q.$c=0,0<q.Aa||(q.Ic=j0);t:{se=q.Ic,fe=4*(_e=q.za);var Me=32*_e,Ie=_e+1,ut=0<q.L?_e*(0<q.Aa?2:1):0,je=(q.Aa==2?2:1)*_e;if((me=fe+832+(ae=3*(16*se+Fo[q.L])/2*Me)+(pe=q.Fa!=null&&0<q.Fa.length?q.Kc.c*q.Kc.i:0))!=me)se=0;else{if(me>q.Vb){if(q.Vb=0,q.Ec=i(me),q.Fc=0,q.Ec==null){se=un(q,1,"no memory during frame initialization.");break t}q.Vb=me}me=q.Ec,xe=q.Fc,q.Ac=me,q.Bc=xe,xe+=fe,q.Gd=a(Me,ho),q.Hd=0,q.rb=a(Ie+1,ua),q.sb=1,q.wa=ut?a(ut,cr):null,q.Y=0,q.D.Nb=0,q.D.wa=q.wa,q.D.Y=q.Y,0<q.Aa&&(q.D.Y+=_e),e(!0),q.oc=me,q.pc=xe,xe+=832,q.ya=a(je,ha),q.aa=0,q.D.ya=q.ya,q.D.aa=q.aa,q.Aa==2&&(q.D.aa+=_e),q.R=16*_e,q.B=8*_e,_e=(Me=Fo[q.L])*q.R,Me=Me/2*q.B,q.sa=me,q.ta=xe+_e,q.qa=q.sa,q.ra=q.ta+16*se*q.R+Me,q.Ha=q.qa,q.Ia=q.ra+8*se*q.B+Me,q.$c=0,xe+=ae,q.mb=pe?me:null,q.nb=pe?xe:null,e(xe+pe<=q.Fc+q.Vb),go(q),s(q.Ac,q.Bc,0,fe),se=1}}if(se){if(Q.ka=0,Q.y=q.sa,Q.O=q.ta,Q.f=q.qa,Q.N=q.ra,Q.ea=q.Ha,Q.Vd=q.Ia,Q.fa=q.R,Q.Rc=q.B,Q.F=null,Q.J=0,!sh){for(se=-255;255>=se;++se)th[255+se]=0>se?-se:se;for(se=-1020;1020>=se;++se)nh[1020+se]=-128>se?-128:127<se?127:se;for(se=-112;112>=se;++se)rh[112+se]=-16>se?-16:15<se?15:se;for(se=-255;510>=se;++se)ih[255+se]=0>se?0:255<se?255:se;sh=1}Ni=Ls,rs=Ul,Mr=Dr,Et=vo,Ot=bo,dr=Bl,rn=So,vn=Ji,ai=A,Ca=$,Os=Ao,Lo=g,Vu=K,Gu=ne,Ku=Ki,Ju=ya,Yu=wo,Xu=xo,xr[0]=Gl,xr[1]=Ml,xr[2]=Hl,xr[3]=Vl,xr[4]=Yr,xr[5]=Kl,xr[6]=Xr,xr[7]=Jl,xr[8]=pa,xr[9]=Es,Li[0]=zl,Li[1]=$l,Li[2]=da,Li[3]=yo,Li[4]=Vi,Li[5]=fa,Li[6]=Wl,oi[0]=Xl,oi[1]=ql,oi[2]=Gi,oi[3]=Yl,oi[4]=ma,oi[5]=ga,oi[6]=_o,se=1}else se=0}se&&(se=(function(_t,bn){for(_t.M=0;_t.M<_t.Va;++_t.M){var ht,Fe=_t.Jc[_t.M&_t.Xb],Le=_t.m,sn=_t;for(ht=0;ht<sn.za;++ht){var ot=Le,wt=sn,$t=wt.Ac,En=wt.Bc+4*ht,qn=wt.zc,Xt=wt.ya[wt.aa+ht];if(wt.Qa.Bb?Xt.$b=ve(ot,wt.Pa.jb[0])?2+ve(ot,wt.Pa.jb[2]):ve(ot,wt.Pa.jb[1]):Xt.$b=0,wt.kc&&(Xt.Ad=ve(ot,wt.Bd)),Xt.Za=!ve(ot,145)+0,Xt.Za){var Rn=Xt.Ob,$n=0;for(wt=0;4>wt;++wt){var yn,At=qn[0+wt];for(yn=0;4>yn;++yn){At=_0[$t[En+yn]][At];for(var Pt=ch[ve(ot,At[0])];0<Pt;)Pt=ch[2*Pt+ve(ot,At[Pt])];At=-Pt,$t[En+yn]=At}r(Rn,$n,$t,En,4),$n+=4,qn[0+wt]=At}}else At=ve(ot,156)?ve(ot,128)?1:3:ve(ot,163)?2:0,Xt.Ob[0]=At,s($t,En,At,4),s(qn,0,At,4);Xt.Dd=ve(ot,142)?ve(ot,114)?ve(ot,183)?1:3:2:0}if(sn.m.Ka)return un(_t,7,"Premature end-of-partition0 encountered.");for(;_t.ja<_t.za;++_t.ja){if(sn=Fe,ot=(Le=_t).rb[Le.sb-1],$t=Le.rb[Le.sb+Le.ja],ht=Le.ya[Le.aa+Le.ja],En=Le.kc?ht.Ad:0)ot.la=$t.la=0,ht.Za||(ot.Na=$t.Na=0),ht.Hc=0,ht.Gc=0,ht.ia=0;else{var Zt,Ct;if(ot=$t,$t=sn,En=Le.Pa.Xc,qn=Le.ya[Le.aa+Le.ja],Xt=Le.pb[qn.$b],wt=qn.ad,Rn=0,$n=Le.rb[Le.sb-1],At=yn=0,s(wt,Rn,0,384),qn.Za)var Pn=0,Sr=En[3];else{Pt=i(16);var an=ot.Na+$n.Na;if(an=Ta($t,En[1],an,Xt.Eb,0,Pt,0),ot.Na=$n.Na=(0<an)+0,1<an)Ni(Pt,0,wt,Rn);else{var Wn=Pt[0]+3>>3;for(Pt=0;256>Pt;Pt+=16)wt[Rn+Pt]=Wn}Pn=1,Sr=En[0]}var Rt=15&ot.la,_n=15&$n.la;for(Pt=0;4>Pt;++Pt){var Yn=1&_n;for(Wn=Ct=0;4>Wn;++Wn)Rt=Rt>>1|(Yn=(an=Ta($t,Sr,an=Yn+(1&Rt),Xt.Sc,Pn,wt,Rn))>Pn)<<7,Ct=Ct<<2|(3<an?3:1<an?2:wt[Rn+0]!=0),Rn+=16;Rt>>=4,_n=_n>>1|Yn<<7,yn=(yn<<8|Ct)>>>0}for(Sr=Rt,Pn=_n>>4,Zt=0;4>Zt;Zt+=2){for(Ct=0,Rt=ot.la>>4+Zt,_n=$n.la>>4+Zt,Pt=0;2>Pt;++Pt){for(Yn=1&_n,Wn=0;2>Wn;++Wn)an=Yn+(1&Rt),Rt=Rt>>1|(Yn=0<(an=Ta($t,En[2],an,Xt.Qc,0,wt,Rn)))<<3,Ct=Ct<<2|(3<an?3:1<an?2:wt[Rn+0]!=0),Rn+=16;Rt>>=2,_n=_n>>1|Yn<<5}At|=Ct<<4*Zt,Sr|=Rt<<4<<Zt,Pn|=(240&_n)<<Zt}ot.la=Sr,$n.la=Pn,qn.Hc=yn,qn.Gc=At,qn.ia=43690&At?0:Xt.ia,En=!(yn|At)}if(0<Le.L&&(Le.wa[Le.Y+Le.ja]=Le.gd[ht.$b][ht.Za],Le.wa[Le.Y+Le.ja].La|=!En),sn.Ka)return un(_t,7,"Premature end-of-file encountered.")}if(go(_t),Le=bn,sn=1,ht=(Fe=_t).D,ot=0<Fe.L&&Fe.M>=Fe.zb&&Fe.M<=Fe.Va,Fe.Aa==0)t:{if(ht.M=Fe.M,ht.uc=ot,hr(Fe,ht),sn=1,ht=(Ct=Fe.D).Nb,ot=(At=Fo[Fe.L])*Fe.R,$t=At/2*Fe.B,Pt=16*ht*Fe.R,Wn=8*ht*Fe.B,En=Fe.sa,qn=Fe.ta-ot+Pt,Xt=Fe.qa,wt=Fe.ra-$t+Wn,Rn=Fe.Ha,$n=Fe.Ia-$t+Wn,_n=(Rt=Ct.M)==0,yn=Rt>=Fe.Va-1,Fe.Aa==2&&hr(Fe,Ct),Ct.uc)for(Yn=(an=Fe).D.M,e(an.D.uc),Ct=an.yb;Ct<an.Hb;++Ct){Pn=Ct,Sr=Yn;var zn=(Xn=(Cn=an).D).Nb;Zt=Cn.R;var Xn=Xn.wa[Xn.Y+Pn],Zn=Cn.sa,Hn=Cn.ta+16*zn*Zt+16*Pn,Qn=Xn.dd,Ut=Xn.tc;if(Ut!=0)if(e(3<=Ut),Cn.L==1)0<Pn&&Ju(Zn,Hn,Zt,Ut+4),Xn.La&&Xu(Zn,Hn,Zt,Ut),0<Sr&&Ku(Zn,Hn,Zt,Ut+4),Xn.La&&Yu(Zn,Hn,Zt,Ut);else{var er=Cn.B,Ar=Cn.qa,is=Cn.ra+8*zn*er+8*Pn,li=Cn.Ha,Cn=Cn.Ia+8*zn*er+8*Pn;zn=Xn.ld,0<Pn&&(vn(Zn,Hn,Zt,Ut+4,Qn,zn),Ca(Ar,is,li,Cn,er,Ut+4,Qn,zn)),Xn.La&&(Lo(Zn,Hn,Zt,Ut,Qn,zn),Gu(Ar,is,li,Cn,er,Ut,Qn,zn)),0<Sr&&(rn(Zn,Hn,Zt,Ut+4,Qn,zn),ai(Ar,is,li,Cn,er,Ut+4,Qn,zn)),Xn.La&&(Os(Zn,Hn,Zt,Ut,Qn,zn),Vu(Ar,is,li,Cn,er,Ut,Qn,zn))}}if(Fe.ia&&alert("todo:DitherRow"),Le.put!=null){if(Ct=16*Rt,Rt=16*(Rt+1),_n?(Le.y=Fe.sa,Le.O=Fe.ta+Pt,Le.f=Fe.qa,Le.N=Fe.ra+Wn,Le.ea=Fe.Ha,Le.W=Fe.Ia+Wn):(Ct-=At,Le.y=En,Le.O=qn,Le.f=Xt,Le.N=wt,Le.ea=Rn,Le.W=$n),yn||(Rt-=At),Rt>Le.o&&(Rt=Le.o),Le.F=null,Le.J=null,Fe.Fa!=null&&0<Fe.Fa.length&&Ct<Rt&&(Le.J=Bt(Fe,Le,Ct,Rt-Ct),Le.F=Fe.mb,Le.F==null&&Le.F.length==0)){sn=un(Fe,3,"Could not decode alpha data.");break t}Ct<Le.j&&(At=Le.j-Ct,Ct=Le.j,e(!(1&At)),Le.O+=Fe.R*At,Le.N+=Fe.B*(At>>1),Le.W+=Fe.B*(At>>1),Le.F!=null&&(Le.J+=Le.width*At)),Ct<Rt&&(Le.O+=Le.v,Le.N+=Le.v>>1,Le.W+=Le.v>>1,Le.F!=null&&(Le.J+=Le.v),Le.ka=Ct-Le.j,Le.U=Le.va-Le.v,Le.T=Rt-Ct,sn=Le.put(Le))}ht+1!=Fe.Ic||yn||(r(Fe.sa,Fe.ta-ot,En,qn+16*Fe.R,ot),r(Fe.qa,Fe.ra-$t,Xt,wt+8*Fe.B,$t),r(Fe.Ha,Fe.Ia-$t,Rn,$n+8*Fe.B,$t))}if(!sn)return un(_t,6,"Output aborted.")}return 1})(q,Q)),Q.bc!=null&&Q.bc(Q),se&=1}return se?(q.cb=0,se):0})(c,b)||(d=c.a)}}else d=c.a}d==0&&P.Oa!=null&&P.Oa.fd&&(d=Aa(P.ba))}P=d}N=P!=0?null:11>N?T.f.RGBA.eb:T.f.kb.y}else N=null;return N};var vh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(U,I){for(var L="",R=0;R<4;R++)L+=String.fromCharCode(U[I++]);return L}function f(U,I){return U[I+0]|U[I+1]<<8}function m(U,I){return(U[I+0]|U[I+1]<<8|U[I+2]<<16)>>>0}function y(U,I){return(U[I+0]|U[I+1]<<8|U[I+2]<<16|U[I+3]<<24)>>>0}new u;var p=[0],S=[0],_=[],x=new u,w=n,O=(function(U,I){var L={},R=0,B=!1,W=0,Z=0;if(L.frames=[],!(function(E,z){for(var H=0;H<4;H++)if(E[z+H]!="RIFF".charCodeAt(H))return!0;return!1})(U,I)){for(y(U,I+=4),I+=8;I<U.length;){var ue=h(U,I),he=y(U,I+=4);I+=4;var ie=he+(1&he);switch(ue){case"VP8 ":case"VP8L":L.frames[R]===void 0&&(L.frames[R]={}),(be=L.frames[R]).src_off=B?Z:I-8,be.src_size=W+he+8,R++,B&&(B=!1,W=0,Z=0);break;case"VP8X":(be=L.header={}).feature_flags=U[I];var de=I+4;be.canvas_width=1+m(U,de),de+=3,be.canvas_height=1+m(U,de),de+=3;break;case"ALPH":B=!0,W=ie+8,Z=I-8;break;case"ANIM":(be=L.header).bgcolor=y(U,I),de=I+4,be.loop_count=f(U,de),de+=2;break;case"ANMF":var ke,be;(be=L.frames[R]={}).offset_x=2*m(U,I),I+=3,be.offset_y=2*m(U,I),I+=3,be.width=1+m(U,I),I+=3,be.height=1+m(U,I),I+=3,be.duration=m(U,I),I+=3,ke=U[I++],be.dispose=1&ke,be.blend=ke>>1&1}ue!="ANMF"&&(I+=ie)}return L}})(w,0);O.response=w,O.rgbaoutput=!0,O.dataurl=!1;var C=O.header?O.header:null,F=O.frames?O.frames:null;if(C){C.loop_counter=C.loop_count,p=[C.canvas_height],S=[C.canvas_width];for(var G=0;G<F.length&&F[G].blend!=0;G++);}var V=F[0],re=x.WebPDecodeRGBA(w,V.src_off,V.src_size,S,p);V.rgba=re,V.imgwidth=S[0],V.imgheight=p[0];for(var J=0;J<S[0]*p[0]*4;J++)_[J]=re[J];return this.width=S,this.height=p,this.data=_,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function db(){var n,e=this.internal.__metadata__.metadata,t=unescape(encodeURIComponent(e));n=this.internal.__metadata__.rawXml?t:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+n.length+" >>"),this.internal.write("stream"),this.internal.write(n),this.internal.write("endstream"),this.internal.write("endobj")}function fb(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(n){var e,t,r,s,i,a,o,u,h,f=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new u,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new a,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new a,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,h=new f}]);var m=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=E;Object.defineProperty(this,"pdf",{get:function(){return z}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(D){H=!!D}});var Y=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Y},set:function(D){Y=!!D}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(D){isNaN(D)||(ee=D)}});var te=0;Object.defineProperty(this,"posY",{get:function(){return te},set:function(D){isNaN(D)||(te=D)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(D){var Ee;typeof D=="number"?Ee=[D,D,D,D]:((Ee=new Array(4))[0]=D[0],Ee[1]=D.length>=2?D[1]:Ee[0],Ee[2]=D.length>=3?D[2]:Ee[0],Ee[3]=D.length>=4?D[3]:Ee[1]),h.margin=Ee}});var le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return le},set:function(D){le=D}});var ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return ce},set:function(D){ce=D}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(D){ve=D}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(D){D instanceof f&&(h=D)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(D){h.path=D}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(D){Se=D}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(D){var Ee;Ee=y(D),this.ctx.fillStyle=Ee.style,this.ctx.isFillTransparent=Ee.a===0,this.ctx.fillOpacity=Ee.a,this.pdf.setFillColor(Ee.r,Ee.g,Ee.b,{a:Ee.a}),this.pdf.setTextColor(Ee.r,Ee.g,Ee.b,{a:Ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(D){var Ee=y(D);this.ctx.strokeStyle=Ee.style,this.ctx.isStrokeTransparent=Ee.a===0,this.ctx.strokeOpacity=Ee.a,Ee.a===0?this.pdf.setDrawColor(255,255,255):(Ee.a,this.pdf.setDrawColor(Ee.r,Ee.g,Ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(D){["butt","round","square"].indexOf(D)!==-1&&(this.ctx.lineCap=D,this.pdf.setLineCap(D))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(D){isNaN(D)||(this.ctx.lineWidth=D,this.pdf.setLineWidth(D))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(D){["bevel","round","miter"].indexOf(D)!==-1&&(this.ctx.lineJoin=D,this.pdf.setLineJoin(D))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(D){isNaN(D)||(this.ctx.miterLimit=D,this.pdf.setMiterLimit(D))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(D){this.ctx.textBaseline=D}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(D){["right","end","center","left","start"].indexOf(D)!==-1&&(this.ctx.textAlign=D)}});var Ce=null,Pe=null,ze=null;Object.defineProperty(this,"fontFaces",{get:function(){return ze},set:function(D){Ce=null,Pe=null,ze=D}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(D){var Ee;if(this.ctx.font=D,(Ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(D))!==null){var dt=Ee[1];Ee[2];var Ke=Ee[3],we=Ee[4];Ee[5];var Je=Ee[6],Te=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(we)[2];we=Math.floor(Te==="px"?parseFloat(we)*this.pdf.internal.scaleFactor:Te==="em"?parseFloat(we)*this.pdf.getFontSize():parseFloat(we)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(we);var Ge=(function($e){var tn,xt,ft=[],pt=$e.trim();if(pt==="")return Wc;if(pt in gf)return[gf[pt]];for(;pt!=="";){switch(xt=null,tn=(pt=vf(pt)).charAt(0)){case'"':case"'":xt=ab(pt.substring(1),tn);break;default:xt=ob(pt)}if(xt===null||(ft.push(xt[0]),(pt=vf(xt[1]))!==""&&pt.charAt(0)!==","))return Wc;pt=pt.replace(/^,/,"")}return ft})(Je);if(this.fontFaces){var We=(function($e,tn){var xt=$e.getFontList(),ft=JSON.stringify(xt);if(Ce===null||Pe!==ft){var pt=(function(Wt){var He=[];return Object.keys(Wt).forEach(function(Dt){Wt[Dt].forEach(function(et){var at=null;switch(et){case"bold":at={family:Dt,weight:"bold"};break;case"italic":at={family:Dt,style:"italic"};break;case"bolditalic":at={family:Dt,weight:"bold",style:"italic"};break;case"":case"normal":at={family:Dt}}at!==null&&(at.ref={name:Dt,style:et},He.push(at))})}),He})(xt);Ce=(function(Wt){for(var He={},Dt=0;Dt<Wt.length;++Dt){var et=zc(Wt[Dt]),at=et.family,Ht=et.stretch,gt=et.style,Xe=et.weight;He[at]=He[at]||{},He[at][Ht]=He[at][Ht]||{},He[at][Ht][gt]=He[at][Ht][gt]||{},He[at][Ht][gt][Xe]=et}return He})(pt.concat(tn)),Pe=ft}return Ce})(this.pdf,this.fontFaces),Nt=Ge.map(function($e){return{family:$e,stretch:"normal",weight:Ke,style:dt}}),mt=(function($e,tn,xt){for(var ft=(xt=xt||{}).defaultFontFamily||"times",pt=Object.assign({},sb,xt.genericFontFamilies||{}),Wt=null,He=null,Dt=0;Dt<tn.length;++Dt)if(pt[(Wt=zc(tn[Dt])).family]&&(Wt.family=pt[Wt.family]),$e.hasOwnProperty(Wt.family)){He=$e[Wt.family];break}if(!(He=He||$e[ft]))throw new Error("Could not find a font-family for the rule '"+mf(Wt)+"' and default family '"+ft+"'.");if(He=(function(et,at){if(at[et])return at[et];var Ht=Au[et],gt=Ht<=Au.normal?-1:1,Xe=pf(at,s0,Ht,gt);if(!Xe)throw new Error("Could not find a matching font-stretch value for "+et);return Xe})(Wt.stretch,He),He=(function(et,at){if(at[et])return at[et];for(var Ht=i0[et],gt=0;gt<Ht.length;++gt)if(at[Ht[gt]])return at[Ht[gt]];throw new Error("Could not find a matching font-style for "+et)})(Wt.style,He),!(He=(function(et,at){if(at[et])return at[et];if(et===400&&at[500])return at[500];if(et===500&&at[400])return at[400];var Ht=ib[et],gt=pf(at,a0,Ht,et<400?-1:1);if(!gt)throw new Error("Could not find a matching font-weight for value "+et);return gt})(Wt.weight,He)))throw new Error("Failed to resolve a font for the rule '"+mf(Wt)+"'.");return He})(We,Nt);this.pdf.setFont(mt.ref.name,mt.ref.style)}else{var st="";(Ke==="bold"||parseInt(Ke,10)>=700||dt==="bold")&&(st="bold"),dt==="italic"&&(st+="italic"),st.length===0&&(st="normal");for(var yt="",vt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},De=0;De<Ge.length;De++){if(this.pdf.internal.getFont(Ge[De],st,{noFallback:!0,disableWarning:!0})!==void 0){yt=Ge[De];break}if(st==="bolditalic"&&this.pdf.internal.getFont(Ge[De],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yt=Ge[De],st="bold";else if(this.pdf.internal.getFont(Ge[De],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yt=Ge[De],st="normal";break}}if(yt===""){for(var lt=0;lt<Ge.length;lt++)if(vt[Ge[lt]]){yt=vt[Ge[lt]];break}}yt=yt===""?"Times":yt,this.pdf.setFont(yt,st)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(D){this.ctx.globalCompositeOperation=D}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(D){this.ctx.globalAlpha=D}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(D){this.ctx.lineDashOffset=D,be.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(D){this.ctx.lineDash=D,be.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(D){this.ctx.ignoreClearRect=!!D}})};m.prototype.setLineDash=function(E){this.lineDash=E},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){F.call(this,"fill",!1)},m.prototype.stroke=function(){F.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(E,z){if(isNaN(E)||isNaN(z))throw jt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new a(E,z));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new a(E,z)},m.prototype.closePath=function(){var E=new a(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Tt(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){E=new a(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(E.x,E.y)},m.prototype.lineTo=function(E,z){if(isNaN(E)||isNaN(z))throw jt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new a(E,z));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new a(H.x,H.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},m.prototype.quadraticCurveTo=function(E,z,H,Y){if(isNaN(H)||isNaN(Y)||isNaN(E)||isNaN(z))throw jt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new a(H,Y)),te=this.ctx.transform.applyToPoint(new a(E,z));this.path.push({type:"qct",x1:te.x,y1:te.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new a(ee.x,ee.y)},m.prototype.bezierCurveTo=function(E,z,H,Y,ee,te){if(isNaN(ee)||isNaN(te)||isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y))throw jt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var le=this.ctx.transform.applyToPoint(new a(ee,te)),ce=this.ctx.transform.applyToPoint(new a(E,z)),ve=this.ctx.transform.applyToPoint(new a(H,Y));this.path.push({type:"bct",x1:ce.x,y1:ce.y,x2:ve.x,y2:ve.y,x:le.x,y:le.y}),this.ctx.lastPoint=new a(le.x,le.y)},m.prototype.arc=function(E,z,H,Y,ee,te){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y)||isNaN(ee))throw jt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(te=!!te,!this.ctx.transform.isIdentity){var le=this.ctx.transform.applyToPoint(new a(E,z));E=le.x,z=le.y;var ce=this.ctx.transform.applyToPoint(new a(0,H)),ve=this.ctx.transform.applyToPoint(new a(0,0));H=Math.sqrt(Math.pow(ce.x-ve.x,2)+Math.pow(ce.y-ve.y,2))}Math.abs(ee-Y)>=2*Math.PI&&(Y=0,ee=2*Math.PI),this.path.push({type:"arc",x:E,y:z,radius:H,startAngle:Y,endAngle:ee,counterclockwise:te})},m.prototype.arcTo=function(E,z,H,Y,ee){throw new Error("arcTo not implemented.")},m.prototype.rect=function(E,z,H,Y){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y))throw jt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,z),this.lineTo(E+H,z),this.lineTo(E+H,z+Y),this.lineTo(E,z+Y),this.lineTo(E,z),this.lineTo(E+H,z),this.lineTo(E,z)},m.prototype.fillRect=function(E,z,H,Y){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y))throw jt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,z,H,Y),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},m.prototype.strokeRect=function(E,z,H,Y){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y))throw jt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(E,z,H,Y),this.stroke())},m.prototype.clearRect=function(E,z,H,Y){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y))throw jt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,z,H,Y))},m.prototype.save=function(E){E=typeof E!="boolean"||E;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var Y=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Y}},m.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(z),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(E){var z,H,Y,ee;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))z=0,H=0,Y=0,ee=0;else{var te=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(te!==null)z=parseInt(te[1]),H=parseInt(te[2]),Y=parseInt(te[3]),ee=1;else if((te=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)z=parseInt(te[1]),H=parseInt(te[2]),Y=parseInt(te[3]),ee=parseFloat(te[4]);else{if(ee=1,typeof E=="string"&&E.charAt(0)!=="#"){var le=new Xp(E);E=le.ok?le.toHex():"#000000"}E.length===4?(z=E.substring(1,2),z+=z,H=E.substring(2,3),H+=H,Y=E.substring(3,4),Y+=Y):(z=E.substring(1,3),H=E.substring(3,5),Y=E.substring(5,7)),z=parseInt(z,16),H=parseInt(H,16),Y=parseInt(Y,16)}}return{r:z,g:H,b:Y,a:ee,style:E}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(E,z,H,Y){if(isNaN(z)||isNaN(H)||typeof E!="string")throw jt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Y=isNaN(Y)?void 0:Y,!p.call(this)){var ee=ie(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;R.call(this,{text:E,x:z,y:H,scale:te,angle:ee,align:this.textAlign,maxWidth:Y})}},m.prototype.strokeText=function(E,z,H,Y){if(isNaN(z)||isNaN(H)||typeof E!="string")throw jt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){Y=isNaN(Y)?void 0:Y;var ee=ie(this.ctx.transform.rotation),te=this.ctx.transform.scaleX;R.call(this,{text:E,x:z,y:H,scale:te,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:Y})}},m.prototype.measureText=function(E){if(typeof E!="string")throw jt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,H=this.pdf.internal.scaleFactor,Y=z.internal.getFontSize(),ee=z.getStringUnitWidth(E)*Y/z.internal.scaleFactor;return new function(te){var le=(te=te||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return le}}),this}({width:ee*=Math.round(96*H/72*1e4)/1e4})},m.prototype.scale=function(E,z){if(isNaN(E)||isNaN(z))throw jt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new u(E,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},m.prototype.rotate=function(E){if(isNaN(E))throw jt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new u(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},m.prototype.translate=function(E,z){if(isNaN(E)||isNaN(z))throw jt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new u(1,0,0,1,E,z);this.ctx.transform=this.ctx.transform.multiply(H)},m.prototype.transform=function(E,z,H,Y,ee,te){if(isNaN(E)||isNaN(z)||isNaN(H)||isNaN(Y)||isNaN(ee)||isNaN(te))throw jt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var le=new u(E,z,H,Y,ee,te);this.ctx.transform=this.ctx.transform.multiply(le)},m.prototype.setTransform=function(E,z,H,Y,ee,te){E=isNaN(E)?1:E,z=isNaN(z)?0:z,H=isNaN(H)?0:H,Y=isNaN(Y)?1:Y,ee=isNaN(ee)?0:ee,te=isNaN(te)?0:te,this.ctx.transform=new u(E,z,H,Y,ee,te)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(E,z,H,Y,ee,te,le,ce,ve){var Se=this.pdf.getImageProperties(E),Ce=1,Pe=1,ze=1,D=1;Y!==void 0&&ce!==void 0&&(ze=ce/Y,D=ve/ee,Ce=Se.width/Y*ce/Y,Pe=Se.height/ee*ve/ee),te===void 0&&(te=z,le=H,z=0,H=0),Y!==void 0&&ce===void 0&&(ce=Y,ve=ee),Y===void 0&&ce===void 0&&(ce=Se.width,ve=Se.height);var Ee=this.ctx.transform.decompose(),dt=ie(Ee.rotate.shx),Ke=new u,we=(Ke=(Ke=(Ke=Ke.multiply(Ee.translate)).multiply(Ee.skew)).multiply(Ee.scale)).applyToRectangle(new o(te-z*ze,le-H*D,Y*Ce,ee*Pe));if(this.autoPaging){for(var Je,Te=x.call(this,we),Ge=[],We=0;We<Te.length;We+=1)Ge.indexOf(Te[We])===-1&&Ge.push(Te[We]);C(Ge);for(var Nt=Ge[0],mt=Ge[Ge.length-1],st=Nt;st<mt+1;st++){this.pdf.setPage(st);var yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],vt=st===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],$e=st===1?0:De+(st-2)*lt;if(this.ctx.clip_path.length!==0){var tn=this.path;Je=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(Je,this.posX+this.margin[3],-$e+vt+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=tn}var xt=JSON.parse(JSON.stringify(we));xt=O([xt],this.posX+this.margin[3],-$e+vt+this.ctx.prevPageLastElemOffset)[0];var ft=(st>Nt||st<mt)&&_.call(this);ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yt,lt,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",xt.x,xt.y,xt.w,xt.h,null,null,dt),ft&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(E,"JPEG",we.x,we.y,we.w,we.h,null,null,dt)};var x=function(E,z,H){var Y=[];z=z||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":Y.push(Math.floor((E.y+ee)/H)+1);break;case"arc":Y.push(Math.floor((E.y+ee-E.radius)/H)+1),Y.push(Math.floor((E.y+ee+E.radius)/H)+1);break;case"qct":var te=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);Y.push(Math.floor((te.y+ee)/H)+1),Y.push(Math.floor((te.y+te.h+ee)/H)+1);break;case"bct":var le=ke(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);Y.push(Math.floor((le.y+ee)/H)+1),Y.push(Math.floor((le.y+le.h+ee)/H)+1);break;case"rect":Y.push(Math.floor((E.y+ee)/H)+1),Y.push(Math.floor((E.y+E.h+ee)/H)+1)}for(var ce=0;ce<Y.length;ce+=1)for(;this.pdf.internal.getNumberOfPages()<Y[ce];)w.call(this);return Y},w=function(){var E=this.fillStyle,z=this.strokeStyle,H=this.font,Y=this.lineCap,ee=this.lineWidth,te=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=z,this.font=H,this.lineCap=Y,this.lineWidth=ee,this.lineJoin=te},O=function(E,z,H){for(var Y=0;Y<E.length;Y++)switch(E[Y].type){case"bct":E[Y].x2+=z,E[Y].y2+=H;case"qct":E[Y].x1+=z,E[Y].y1+=H;default:E[Y].x+=z,E[Y].y+=H}return E},C=function(E){return E.sort(function(z,H){return z-H})},F=function(E,z){var H=this.fillStyle,Y=this.strokeStyle,ee=this.lineCap,te=this.lineWidth,le=Math.abs(te*this.ctx.transform.scaleX),ce=this.lineJoin;if(this.autoPaging){for(var ve,Se,Ce=JSON.parse(JSON.stringify(this.path)),Pe=JSON.parse(JSON.stringify(this.path)),ze=[],D=0;D<Pe.length;D++)if(Pe[D].x!==void 0)for(var Ee=x.call(this,Pe[D]),dt=0;dt<Ee.length;dt+=1)ze.indexOf(Ee[dt])===-1&&ze.push(Ee[dt]);for(var Ke=0;Ke<ze.length;Ke++)for(;this.pdf.internal.getNumberOfPages()<ze[Ke];)w.call(this);C(ze);for(var we=ze[0],Je=ze[ze.length-1],Te=we;Te<Je+1;Te++){this.pdf.setPage(Te),this.fillStyle=H,this.strokeStyle=Y,this.lineCap=ee,this.lineWidth=le,this.lineJoin=ce;var Ge=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],We=Te===1?this.posY+this.margin[0]:this.margin[0],Nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=Te===1?0:Nt+(Te-2)*mt;if(this.ctx.clip_path.length!==0){var yt=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(ve,this.posX+this.margin[3],-st+We+this.ctx.prevPageLastElemOffset),G.call(this,E,!0),this.path=yt}if(Se=JSON.parse(JSON.stringify(Ce)),this.path=O(Se,this.posX+this.margin[3],-st+We+this.ctx.prevPageLastElemOffset),z===!1||Te===0){var vt=(Te>we||Te<Je)&&_.call(this);vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ge,mt,null).clip().discardPath()),G.call(this,E,z),vt&&this.pdf.restoreGraphicsState()}this.lineWidth=te}this.path=Ce}else this.lineWidth=le,G.call(this,E,z),this.lineWidth=te},G=function(E,z){if((E!=="stroke"||z||!S.call(this))&&(E==="stroke"||z||!p.call(this))){for(var H,Y,ee=[],te=this.path,le=0;le<te.length;le++){var ce=te[le];switch(ce.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:ce,deltas:[],abs:[]});break;case"lt":var ve=ee.length;if(te[le-1]&&!isNaN(te[le-1].x)&&(H=[ce.x-te[le-1].x,ce.y-te[le-1].y],ve>0)){for(;ve>=0;ve--)if(ee[ve-1].close!==!0&&ee[ve-1].begin!==!0){ee[ve-1].deltas.push(H),ee[ve-1].abs.push(ce);break}}break;case"bct":H=[ce.x1-te[le-1].x,ce.y1-te[le-1].y,ce.x2-te[le-1].x,ce.y2-te[le-1].y,ce.x-te[le-1].x,ce.y-te[le-1].y],ee[ee.length-1].deltas.push(H);break;case"qct":var Se=te[le-1].x+2/3*(ce.x1-te[le-1].x),Ce=te[le-1].y+2/3*(ce.y1-te[le-1].y),Pe=ce.x+2/3*(ce.x1-ce.x),ze=ce.y+2/3*(ce.y1-ce.y),D=ce.x,Ee=ce.y;H=[Se-te[le-1].x,Ce-te[le-1].y,Pe-te[le-1].x,ze-te[le-1].y,D-te[le-1].x,Ee-te[le-1].y],ee[ee.length-1].deltas.push(H);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(ce)}}Y=z?null:E==="stroke"?"stroke":"fill";for(var dt=!1,Ke=0;Ke<ee.length;Ke++)if(ee[Ke].arc)for(var we=ee[Ke].abs,Je=0;Je<we.length;Je++){var Te=we[Je];Te.type==="arc"?J.call(this,Te.x,Te.y,Te.radius,Te.startAngle,Te.endAngle,Te.counterclockwise,void 0,z,!dt):B.call(this,Te.x,Te.y),dt=!0}else if(ee[Ke].close===!0)this.pdf.internal.out("h"),dt=!1;else if(ee[Ke].begin!==!0){var Ge=ee[Ke].start.x,We=ee[Ke].start.y;W.call(this,ee[Ke].deltas,Ge,We),dt=!0}Y&&U.call(this,Y),z&&I.call(this)}},V=function(E){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-H;case"top":return E+z-H;case"hanging":return E+z-2*H;case"middle":return E+z/2-H;default:return E}},re=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(z,H){this.colorStops.push([z,H])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var J=function(E,z,H,Y,ee,te,le,ce,ve){for(var Se=ue.call(this,H,Y,ee,te),Ce=0;Ce<Se.length;Ce++){var Pe=Se[Ce];Ce===0&&(ve?L.call(this,Pe.x1+E,Pe.y1+z):B.call(this,Pe.x1+E,Pe.y1+z)),Z.call(this,E,z,Pe.x2,Pe.y2,Pe.x3,Pe.y3,Pe.x4,Pe.y4)}ce?I.call(this):U.call(this,le)},U=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(E,z){this.pdf.internal.out(t(E)+" "+r(z)+" m")},R=function(E){var z;switch(E.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var H,Y,ee,te=this.pdf.getTextDimensions(E.text),le=V.call(this,E.y),ce=re.call(this,le)-te.h,ve=this.ctx.transform.applyToPoint(new a(E.x,le));if(this.autoPaging){var Se=this.ctx.transform.decompose(),Ce=new u;Ce=(Ce=(Ce=Ce.multiply(Se.translate)).multiply(Se.skew)).multiply(Se.scale);for(var Pe=this.ctx.transform.applyToRectangle(new o(E.x,le,te.w,te.h)),ze=Ce.applyToRectangle(new o(E.x,ce,te.w,te.h)),D=x.call(this,ze),Ee=[],dt=0;dt<D.length;dt+=1)Ee.indexOf(D[dt])===-1&&Ee.push(D[dt]);C(Ee);for(var Ke=Ee[0],we=Ee[Ee.length-1],Je=Ke;Je<we+1;Je++){this.pdf.setPage(Je);var Te=Je===1?this.posY+this.margin[0]:this.margin[0],Ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[2],Nt=We-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],st=mt-this.margin[3],yt=Je===1?0:Ge+(Je-2)*Nt;if(this.ctx.clip_path.length!==0){var vt=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(H,this.posX+this.margin[3],-1*yt+Te),G.call(this,"fill",!0),this.path=vt}var De=O([JSON.parse(JSON.stringify(ze))],this.posX+this.margin[3],-yt+Te+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*E.scale),ee=this.lineWidth,this.lineWidth=ee*E.scale);var lt=this.autoPaging!=="text";if(lt||De.y+De.h<=We){if(lt||De.y>=Te&&De.x<=mt){var $e=lt?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||mt-De.x)[0],tn=O([JSON.parse(JSON.stringify(Pe))],this.posX+this.margin[3],-yt+Te+this.ctx.prevPageLastElemOffset)[0],xt=lt&&(Je>Ke||Je<we)&&_.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],st,Nt,null).clip().discardPath()),this.pdf.text($e,tn.x,tn.y,{angle:E.angle,align:z,renderingMode:E.renderingMode}),xt&&this.pdf.restoreGraphicsState()}}else De.y<We&&(this.ctx.prevPageLastElemOffset+=We-De.y);E.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=ee)}}else E.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*E.scale),ee=this.lineWidth,this.lineWidth=ee*E.scale),this.pdf.text(E.text,ve.x+this.posX,ve.y+this.posY,{angle:E.angle,align:z,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=ee)},B=function(E,z,H,Y){H=H||0,Y=Y||0,this.pdf.internal.out(t(E+H)+" "+r(z+Y)+" l")},W=function(E,z,H){return this.pdf.lines(E,z,H,null,null)},Z=function(E,z,H,Y,ee,te,le,ce){this.pdf.internal.out([e(s(H+E)),e(i(Y+z)),e(s(ee+E)),e(i(te+z)),e(s(le+E)),e(i(ce+z)),"c"].join(" "))},ue=function(E,z,H,Y){for(var ee=2*Math.PI,te=Math.PI/2;z>H;)z-=ee;var le=Math.abs(H-z);le<ee&&Y&&(le=ee-le);for(var ce=[],ve=Y?-1:1,Se=z;le>1e-5;){var Ce=Se+ve*Math.min(le,te);ce.push(he.call(this,E,Se,Ce)),le-=Math.abs(Ce-Se),Se=Ce}return ce},he=function(E,z,H){var Y=(H-z)/2,ee=E*Math.cos(Y),te=E*Math.sin(Y),le=ee,ce=-te,ve=le*le+ce*ce,Se=ve+le*ee+ce*te,Ce=4/3*(Math.sqrt(2*ve*Se)-Se)/(le*te-ce*ee),Pe=le-Ce*ce,ze=ce+Ce*le,D=Pe,Ee=-ze,dt=Y+z,Ke=Math.cos(dt),we=Math.sin(dt);return{x1:E*Math.cos(z),y1:E*Math.sin(z),x2:Pe*Ke-ze*we,y2:Pe*we+ze*Ke,x3:D*Ke-Ee*we,y3:D*we+Ee*Ke,x4:E*Math.cos(H),y4:E*Math.sin(H)}},ie=function(E){return 180*E/Math.PI},de=function(E,z,H,Y,ee,te){var le=E+.5*(H-E),ce=z+.5*(Y-z),ve=ee+.5*(H-ee),Se=te+.5*(Y-te),Ce=Math.min(E,ee,le,ve),Pe=Math.max(E,ee,le,ve),ze=Math.min(z,te,ce,Se),D=Math.max(z,te,ce,Se);return new o(Ce,ze,Pe-Ce,D-ze)},ke=function(E,z,H,Y,ee,te,le,ce){var ve,Se,Ce,Pe,ze,D,Ee,dt,Ke,we,Je,Te,Ge,We,Nt=H-E,mt=Y-z,st=ee-H,yt=te-Y,vt=le-ee,De=ce-te;for(Se=0;Se<41;Se++)Ke=(Ee=(Ce=E+(ve=Se/40)*Nt)+ve*((ze=H+ve*st)-Ce))+ve*(ze+ve*(ee+ve*vt-ze)-Ee),we=(dt=(Pe=z+ve*mt)+ve*((D=Y+ve*yt)-Pe))+ve*(D+ve*(te+ve*De-D)-dt),Se==0?(Je=Ke,Te=we,Ge=Ke,We=we):(Je=Math.min(Je,Ke),Te=Math.min(Te,we),Ge=Math.max(Ge,Ke),We=Math.max(We,we));return new o(Math.round(Je),Math.round(Te),Math.round(Ge-Je),Math.round(We-Te))},be=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,z,H=(E=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:z}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(qe.API),(function(n){var e=function(a){var o,u,h,f,m,y,p,S,_,x;for(u=[],h=0,f=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;f>h;h+=4)(m=(a.charCodeAt(h)<<24)+(a.charCodeAt(h+1)<<16)+(a.charCodeAt(h+2)<<8)+a.charCodeAt(h+3))!==0?(y=(m=((m=((m=((m=(m-(x=m%85))/85)-(_=m%85))/85)-(S=m%85))/85)-(p=m%85))/85)%85,u.push(y+33,p+33,S+33,_+33,x+33)):u.push(122);return(function(w,O){for(var C=O;C>0;C--)w.pop()})(u,o.length),String.fromCharCode.apply(String,u)+"~>"},t=function(a){var o,u,h,f,m,y=String,p="length",S=255,_="charCodeAt",x="slice",w="replace";for(a[x](-2),a=a[x](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),h=[],f=0,m=(a+=o="uuuuu"[x](a[p]%5||5))[p];m>f;f+=5)u=52200625*(a[_](f)-33)+614125*(a[_](f+1)-33)+7225*(a[_](f+2)-33)+85*(a[_](f+3)-33)+(a[_](f+4)-33),h.push(S&u>>24,S&u>>16,S&u>>8,S&u);return(function(O,C){for(var F=C;F>0;F--)O.pop()})(h,o[p]),y.fromCharCode.apply(y,h)},r=function(a){return a.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var u="",h=0;h<a.length;h+=2)u+=String.fromCharCode("0x"+(a[h]+a[h+1]));return u},i=function(a){for(var o=new Uint8Array(a.length),u=a.length;u--;)o[u]=a.charCodeAt(u);return(o=vu(o)).reduce(function(h,f){return h+String.fromCharCode(f)},"")};n.processDataByFilters=function(a,o){var u=0,h=a||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),u=0;u<o.length;u+=1)switch(o[u]){case"ASCII85Decode":case"/ASCII85Decode":h=t(h),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=s(h),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=r(h),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=i(h),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[u]+'" is not implemented')}return{data:h,reverseChain:f.reverse().join(" ")}}})(qe.API),(function(n){n.loadFile=function(e,t,r){return(function(s,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(u,h,f){var m=new XMLHttpRequest,y=0,p=function(S){var _=S.length,x=[],w=String.fromCharCode;for(y=0;y<_;y+=1)x.push(w(255&S.charCodeAt(y)));return x.join("")};if(m.open("GET",u,!h),m.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(m.onload=function(){m.status===200?f(p(this.responseText)):f(void 0)}),m.send(null),h&&m.status===200)return p(m.responseText)})(s,i,a)}catch{}return o})(e,t,r)},n.allowFsRead=void 0,n.loadImageFile=n.loadFile})(qe.API),(function(n){function e(){return(tt.html2canvas?Promise.resolve(tt.html2canvas):kc(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(tt.DOMPurify?Promise.resolve(tt.DOMPurify):kc(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var u=Tt(o);return u==="undefined"?"undefined":u==="string"||o instanceof String?"string":u==="number"||o instanceof Number?"number":u==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":u==="object"?"object":"unknown"},s=function(o,u){var h=document.createElement(o);for(var f in u.className&&(h.className=u.className),u.innerHTML&&u.dompurify&&(h.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)h.style[f]=u.style[f];return h},i=function o(u,h){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),m=u.firstChild;m;m=m.nextSibling)h!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||f.appendChild(o(m,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f},a=function o(u){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),h);return(f=f.setProgress(1,o,1,[o])).set(u)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,u){return o.__proto__=u||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,u){return this.then(function(){switch(u=u||(function(h){switch(r(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),u){case"string":return this.then(t).then(function(h){return this.set({src:s("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,u(this.prop.container,h)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=this.opt.jsPDF,f=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var S=f[p],_=S.src.find(function(x){return x.format==="truetype"});_&&h.addFont(_.url,S.ref.name,S.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,h.context2d.save(!0),u(this.prop.container,y)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,u,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,u):this.outputPdf(o,u)},a.prototype.outputPdf=function(o,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,u)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(r(o)!=="object")return this;var u=Object.keys(o||{}).map(function(h){if(h in a.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(u)})},a.prototype.get=function(o,u){return this.then(function(){var h=o in a.template.prop?this.prop[o]:this.opt[o];return u?u(h):h})},a.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function u(h,f){return Math.floor(h*f/72*96)}return this.then(function(){(o=o||qe.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:u(o.inner.width,o.k),height:u(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,u,h,f){return o!=null&&(this.progress.val=o),u!=null&&(this.progress.state=u),h!=null&&(this.progress.n=h),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,u,h,f){return this.setProgress(o?this.progress.val+o:null,u||null,h?this.progress.n+h:null,f?this.progress.stack.concat(f):null)},a.prototype.then=function(o,u){var h=this;return this.thenCore(o,u,function(f,m){return h.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(y){return h.updateProgress(null,f),y}).then(f,m).then(function(y){return h.updateProgress(1),y})})},a.prototype.thenCore=function(o,u,h){h=h||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),u&&(u=u.bind(f));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:a.convert(Object.assign({},f),Promise.prototype),y=h.call(m,o,u);return a.convert(y,f.__proto__)},a.prototype.thenExternal=function(o,u){return Promise.prototype.then.call(this,o,u)},a.prototype.thenList=function(o){var u=this;return o.forEach(function(h){u=u.thenCore(h)}),u},a.prototype.catch=function(o){o&&(o=o.bind(this));var u=Promise.prototype.catch.call(this,o);return a.convert(u,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,qe.getPageSize=function(o,u,h){if(Tt(o)==="object"){var f=o;o=f.orientation,u=f.unit||u,h=f.format||h}u=u||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var m,y=(""+h).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+u}var S,_=0,x=0;if(p.hasOwnProperty(y))_=p[y][1]/m,x=p[y][0]/m;else try{_=h[1],x=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",x>_&&(S=x,x=_,_=S);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",_>x&&(S=x,x=_,_=S)}return{width:x,height:_,unit:u,k:m,orientation:o}},n.html=function(o,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(zc):null;var h=new a(u);return u.worker?h:h.from(o).doCallback()}})(qe.API),qe.API.addJS=function(n){var e,t,r=(function(s){for(var i="",a=0;a<s.length;a++){var o=s[a];if(o==="("||o===")"){for(var u=0,h=a-1;h>=0&&s[h]==="\\";h--)u++;i+=u%2==0?"\\"+o:o}else i+=o}return i})(n);return this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+r+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){e!==void 0&&t!==void 0&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),i=0;i<s.length;i++){var a=s[i],o=r.exec(a);if(o!=null){var u=o[1];t.internal.newObjectDeferredBegin(u,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,f=[];for(i=0;i<h;i++){var m=t.internal.newObject();f.push(m);var y=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<f.length;i++)t.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,s,i){var a={title:s,options:i,children:[]};return r==null&&(r=this.root),r.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var s=0;s<r.children.length;s++)this.genIds_r(r.children[s])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var a=r.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var u=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var h=0;h<r.children.length;h++)this.renderItems(r.children[h])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,s){for(var i=0;i<s.children.length;i++)r.count++,this.count_r(r,s.children[i]);return r.count}}])})(qe.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,s,i,a,o){var u,h=this.decode.DCT_DECODE,f=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,u=(function(m){for(var y,p=256*m.charCodeAt(4)+m.charCodeAt(5),S=m.length,_={width:0,height:0,numcomponents:1},x=4;x<S;x+=2){if(x+=p,e.indexOf(m.charCodeAt(x+1))!==-1){y=256*m.charCodeAt(x+5)+m.charCodeAt(x+6),_={width:256*m.charCodeAt(x+7)+m.charCodeAt(x+8),height:y,numcomponents:m.charCodeAt(x+9)};break}p=256*m.charCodeAt(x+2)+m.charCodeAt(x+3)}return _})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),u.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:t,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:h,index:r,alias:s}}return f}})(qe.API),qe.API.processPNG=function(n,e,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var s,i=Wv(n,{checkCrc:!0}),a=i.width,o=i.height,u=i.channels,h=i.palette,f=i.depth;s=h&&u===1?(function(J){for(var U=J.width,I=J.height,L=J.data,R=J.palette,B=J.depth,W=!1,Z=[],ue=[],he=void 0,ie=!1,de=0,ke=0;ke<R.length;ke++){var be=xd(R[ke],4),E=be[0],z=be[1],H=be[2],Y=be[3];Z.push(E,z,H),Y!=null&&(Y===0?(de++,ue.length<1&&ue.push(ke)):Y<255&&(ie=!0))}if(ie||de>1){W=!0,ue=void 0;var ee=U*I;he=new Uint8Array(ee);for(var te=new DataView(L.buffer),le=0;le<ee;le++){var ce=Hc(te,le,B),ve=xd(R[ce],4)[3];he[le]=ve}}else de===0&&(ue=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:W?8:void 0,colorBytes:L,alphaBytes:he,needSMask:W,palette:Z,mask:ue}})(i):u===2||u===4?(function(J){for(var U=J.data,I=J.width,L=J.height,R=J.channels,B=J.depth,W=R===2?"DeviceGray":"DeviceRGB",Z=R-1,ue=I*L,he=Z,ie=ue*he,de=1*ue,ke=Math.ceil(ie*B/8),be=Math.ceil(de*B/8),E=new Uint8Array(ke),z=new Uint8Array(be),H=new DataView(U.buffer),Y=new DataView(E.buffer),ee=new DataView(z.buffer),te=!1,le=0;le<ue;le++){for(var ce=le*R,ve=0;ve<he;ve++)Nf(Y,Hc(H,ce+ve,B),le*he+ve,B);var Se=Hc(H,ce+he,B);Se<(1<<B)-1&&(te=!0),Nf(ee,Se,1*le,B)}return{colorSpace:W,colorsPerPixel:Z,sMaskBitsPerComponent:te?B:void 0,colorBytes:E,alphaBytes:z,needSMask:te}})(i):(function(J){var U=J.data,I=J.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:I,colorsPerPixel:I==="DeviceGray"?1:3,colorBytes:U instanceof Uint16Array?(function(L){for(var R=L.length,B=new Uint8Array(2*R),W=new DataView(B.buffer,B.byteOffset,B.byteLength),Z=0;Z<R;Z++)W.setUint16(2*Z,L[Z],!1);return B})(U):U,needSMask:!1}})(i);var m,y,p,S=s,_=S.colorSpace,x=S.colorsPerPixel,w=S.sMaskBitsPerComponent,O=S.colorBytes,C=S.alphaBytes,F=S.needSMask,G=S.palette,V=S.mask,re=null;return r!==qe.API.image_compression.NONE&&typeof vu=="function"?(re=(function(J){var U;switch(J){case qe.API.image_compression.FAST:U=11;break;case qe.API.image_compression.MEDIUM:U=13;break;case qe.API.image_compression.SLOW:U=14;break;default:U=12}return U})(r),m=this.decode.FLATE_DECODE,y="/Predictor ".concat(re," /Colors ").concat(x," /BitsPerComponent ").concat(f," /Columns ").concat(a),n=wf(O,Math.ceil(a*x*f/8),x,f,r),F&&(p=wf(C,Math.ceil(a*w/8),1,w,r))):(m=void 0,y=void 0,n=O,F&&(p=C)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:t,data:n,index:e,filter:m,decodeParameters:y,transparency:V,palette:G,sMask:p,predictor:re,width:a,height:o,bitsPerComponent:f,sMaskBitsPerComponent:w,colorSpace:_}}},(function(n){n.processGIF89A=function(e,t,r,s){var i=new hb(e),a=i.width,o=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:a,height:o},f=new Vc(100).encode(h,100);return n.processJPEG.call(this,f,t,r,s)},n.processGIF87A=n.processGIF89A})(qe.API),kr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:r,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},kr.prototype.parseBGR=function(){this.pos=this.offset;var n="bit"+this.bitPP,e=this.width*this.height*4;if(e>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(e);try{this[n]()}catch(t){jt.log("bit decode error:"+t)}},kr.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var u=this.palette[i>>7-o&1];this.data[a+4*o]=u.blue,this.data[a+4*o+1]=u.green,this.data[a+4*o+2]=u.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},kr.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,s=0;s<n;s++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*s*4,o=i>>4,u=15&i,h=this.palette[o];if(this.data[a]=h.blue,this.data[a+1]=h.green,this.data[a+2]=h.red,this.data[a+3]=255,2*s+1>=this.width)break;h=this.palette[u],this.data[a+4]=h.blue,this.data[a+4+1]=h.green,this.data[a+4+2]=h.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},kr.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;if(s<this.palette.length){var a=this.palette[s];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}n!==0&&(this.pos+=4-n)}},kr.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,u=(i>>10&e)/e*255|0,h=i>>15?255:0,f=r*this.width*4+4*s;this.data[f]=u,this.data[f+1]=o,this.data[f+2]=a,this.data[f+3]=h}this.pos+=n}},kr.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,u=(a>>5&t)/t*255|0,h=(a>>11)/e*255|0,f=s*this.width*4+4*i;this.data[f]=h,this.data[f+1]=u,this.data[f+2]=o,this.data[f+3]=255}this.pos+=n}},kr.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=i,this.data[a+1]=s,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},kr.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=r,this.data[o+3]=a}},kr.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,s){var i=new kr(e,!1),a=i.width,o=i.height,u={data:i.getData(),width:a,height:o},h=new Vc(100).encode(u,100);return n.processJPEG.call(this,h,t,r,s)}})(qe.API),Ef.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,s){var i=new Ef(e),a=i.width,o=i.height,u={data:i.getData(),width:a,height:o},h=new Vc(100).encode(u,100);return n.processJPEG.call(this,h,t,r,s)}})(qe.API),qe.API.processRGBA=function(n,e,t){for(var r=n.data,s=r.length,i=new Uint8Array(s/4*3),a=new Uint8Array(s/4),o=0,u=0,h=0;h<s;h+=4){var f=r[h],m=r[h+1],y=r[h+2],p=r[h+3];i[o++]=f,i[o++]=m,i[o++]=y,a[u++]=p}var S=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:S,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},qe.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},zs=qe.API,ol=zs.getCharWidthsArray=function(n,e){var t,r,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:s.metadata.Unicode.widths,u=o.fof?o.fof:1,h=e.kerning?e.kerning:s.metadata.Unicode.kerning,f=h.fof?h.fof:1,m=e.doKerning!==!1,y=0,p=n.length,S=0,_=o[0]||u,x=[];for(t=0;t<p;t++)r=n.charCodeAt(t),typeof s.metadata.widthOfString=="function"?x.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(r))+a*(1e3/i)||0)/1e3):(y=m&&Tt(h[r])==="object"&&!isNaN(parseInt(h[r][S],10))?h[r][S]/f:0,x.push((o[r]||_)/u+y)),S=r;return x},bf=zs.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return zs.processArabic&&(n=zs.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,s)/t:ol.apply(this,arguments).reduce(function(i,a){return i+a},0)},yf=function(n,e,t,r){for(var s=[],i=0,a=n.length,o=0;i!==a&&o+e[i]<t;)o+=e[i],i++;s.push(n.slice(0,i));var u=i;for(o=0;i!==a;)o+e[i]>r&&(s.push(n.slice(u,i)),o=0,u=i),o+=e[i],i++;return u!==i&&s.push(n.slice(u,i)),s},_f=function(n,e,t){t||(t={});var r,s,i,a,o,u,h,f=[],m=[f],y=t.textIndent||0,p=0,S=0,_=n.split(" "),x=ol.apply(this,[" ",t])[0];if(u=t.lineIndent===-1?_[0].length+2:t.lineIndent||0){var w=Array(u).join(" "),O=[];_.map(function(F){(F=F.split(/\s*\n/)).length>1?O=O.concat(F.map(function(G,V){return(V&&G.length?`
`:"")+G})):O.push(F[0])}),_=O,u=bf.apply(this,[w,t])}for(i=0,a=_.length;i<a;i++){var C=0;if(r=_[i],u&&r[0]==`
`&&(r=r.substr(1),C=1),y+p+(S=(s=ol.apply(this,[r,t])).reduce(function(F,G){return F+G},0))>e||C){if(S>e){for(o=yf.apply(this,[r,s,e-(y+p),e]),f.push(o.shift()),f=[o.pop()];o.length;)m.push([o.shift()]);S=s.slice(r.length-(f[0]?f[0].length:0)).reduce(function(F,G){return F+G},0)}else f=[r];m.push(f),y=S+u,p=x}else f.push(r),y+=p+S,p=x}return h=u?function(F,G){return(G?w:"")+F.join(" ")}:function(F){return F.join(" ")},m.map(h)},zs.splitTextToSize=function(n,e,t){var r,s=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var m=this.internal.getFont(f.fontName,f.fontStyle),y="Unicode";return m.metadata[y]?{widths:m.metadata[y].widths||{0:1},kerning:m.metadata[y].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/s;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=t.lineIndent;var o,u,h=[];for(o=0,u=r.length;o<u;o++)h=h.concat(_f.apply(this,[r[o],a,i]));return h},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",r={},s={},i=0;i<16;i++)r[t[i]]=e[i],s[e[i]]=t[i];var a=function(y){return"0x"+parseInt(y,10).toString(16)},o=n.__fontmetrics__.compress=function(y){var p,S,_,x,w=["{"];for(var O in y){if(p=y[O],isNaN(parseInt(O,10))?S="'"+O+"'":(O=parseInt(O,10),S=(S=a(O).slice(2)).slice(0,-1)+s[S.slice(-1)]),typeof p=="number")p<0?(_=a(p).slice(3),x="-"):(_=a(p).slice(2),x=""),_=x+_.slice(0,-1)+s[_.slice(-1)];else{if(Tt(p)!=="object")throw new Error("Don't know what to do with value type "+Tt(p)+".");_=o(p)}w.push(S+_)}return w.push("}"),w.join("")},u=n.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,S,_,x,w={},O=1,C=w,F=[],G="",V="",re=y.length-1,J=1;J<re;J+=1)(x=y[J])=="'"?p?(_=p.join(""),p=void 0):p=[]:p?p.push(x):x=="{"?(F.push([C,_]),C={},_=void 0):x=="}"?((S=F.pop())[0][S[1]]=C,_=void 0,C=S[0]):x=="-"?O=-1:_===void 0?r.hasOwnProperty(x)?(G+=r[x],_=parseInt(G,16)*O,O=1,G=""):G+=x:r.hasOwnProperty(x)?(V+=r[x],C[_]=parseInt(V,16)*O,O=1,_=void 0,V=""):V+=x;return w},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},m={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(y){var p=y.font,S=m.Unicode[p.postScriptName];S&&(p.metadata.Unicode={},p.metadata.Unicode.widths=S.widths,p.metadata.Unicode.kerning=S.kerning);var _=f.Unicode[p.postScriptName];_&&(p.metadata.Unicode.encoding=_,p.encoding=_.codePages[0])}])})(qe.API),(function(n){var e=function(t){for(var r=t.length,s=new Uint8Array(r),i=0;i<r;i++)s[i]=t.charCodeAt(i);return s};n.API.events.push(["addFont",function(t){var r=void 0,s=t.font,i=t.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(r=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(ul(o)),a.metadata=n.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(s,r)}}])})(qe),qe.API.addSvgAsImage=function(n,e,t,r,s,i,a,o){if(isNaN(e)||isNaN(t))throw jt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw jt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=s;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(tt.canvg?Promise.resolve(tt.canvg):kc(()=>import("./index.es-DRw30XQG.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(h,n,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(f)}).then(function(){m.addImage(u.toDataURL("image/jpeg",1),e,t,r,s,a,o)})},qe.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var s=0;s<this.internal.pages[r].length;s++)this.internal.pages[r][s]=this.internal.pages[r][s].replace(e,t);return this},qe.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,s,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),u=[],h=0,f=0,m=0;function y(S,_){var x,w=!1;for(x=0;x<S.length;x+=1)S[x]===_&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=o.length;for(m=0;m<p;m+=1)t[o[m]].value=t[o[m]].defaultValue,t[o[m]].explicitSet=!1}if(Tt(n)==="object"){for(s in n)if(i=n[s],y(o,s)&&i!==void 0){if(t[s].type==="boolean"&&typeof i=="boolean")t[s].value=i;else if(t[s].type==="name"&&y(t[s].valueSet,i))t[s].value=i;else if(t[s].type==="integer"&&Number.isInteger(i))t[s].value=i;else if(t[s].type==="array"){for(h=0;h<i.length;h+=1)if(r=!0,i[h].length===1&&typeof i[h][0]=="number")u.push(String(i[h]-1));else if(i[h].length>1){for(f=0;f<i[h].length;f+=1)typeof i[h][f]!="number"&&(r=!1);r===!0&&u.push([i[h][0]-1,i[h][1]-1].join(" "))}t[s].value="["+u.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,_=[];for(S in t)t[S].explicitSet===!0&&(t[S].type==="name"?_.push("/"+S+" /"+t[S].value):_.push("/"+S+" "+t[S].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},qe.API.addMetadata=function(n,e){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceUri:e??"http://jspdf.default.namespaceuri/",rawXml:typeof e=="boolean"&&e},this.internal.events.subscribe("putCatalog",fb),this.internal.events.subscribe("postPutResources",db)),this},(function(n){var e=n.API,t=e.pdfEscape16=function(i,a){for(var o,u=a.metadata.Unicode.widths,h=["","0","00","000","0000"],f=[""],m=0,y=i.length;m<y;++m){if(o=a.metadata.characterToGlyph(i.charCodeAt(m)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=i.charCodeAt(m),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(h[4-o.length],o)}return f.join("")},r=function(i){var a,o,u,h,f,m,y;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],m=0,y=(o=Object.keys(i).sort(function(p,S){return p-S})).length;m<y;m++)a=o[m],u.length>=100&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(h=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),u.push("<"+a+"><"+h+">"));return u.length&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(a){var o=a.font,u=a.out,h=a.newObject,f=a.putStream;if(o.metadata instanceof n.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,y=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),p="",S=0;S<y.length;S++)p+=String.fromCharCode(y[S]);var _=h();f({data:p,addLength1:!0,objectId:_}),u("endobj");var x=h();f({data:r(o.metadata.toUnicode),addLength1:!0,objectId:x}),u("endobj");var w=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Ks(o.fontName)),u("/FontFile2 "+_+" 0 R"),u("/FontBBox "+n.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var O=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+Ks(o.fontName)),u("/FontDescriptor "+w+" 0 R"),u("/W "+n.API.PDFObject.convert(m)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+x+" 0 R"),u("/BaseFont /"+Ks(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+O+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(a){var o=a.font,u=a.out,h=a.newObject,f=a.putStream;if(o.metadata instanceof n.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,y="",p=0;p<m.length;p++)y+=String.fromCharCode(m[p]);var S=h();f({data:y,addLength1:!0,objectId:S}),u("endobj");var _=h();f({data:r(o.metadata.toUnicode),addLength1:!0,objectId:_}),u("endobj");var x=h();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+S+" 0 R"),u("/Flags 96"),u("/FontBBox "+n.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+Ks(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=h();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Ks(o.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]);var s=function(i){var a,o=i.text||"",u=i.x,h=i.y,f=i.options||{},m=i.mutex||{},y=m.pdfEscape,p=m.activeFontKey,S=m.fonts,_=p,x="",w=0,O="",C=S[_].encoding;if(S[_].encoding!=="Identity-H")return{text:o,x:u,y:h,options:f,mutex:m};for(O=o,_=p,Array.isArray(o)&&(O=o[0]),w=0;w<O.length;w+=1)S[_].metadata.hasOwnProperty("cmap")&&(a=S[_].metadata.cmap.unicode.codeMap[O[w].charCodeAt(0)]),a||O[w].charCodeAt(0)<256&&S[_].metadata.hasOwnProperty("Unicode")?x+=O[w]:x+="";var F="";return parseInt(_.slice(1))<14||C==="WinAnsiEncoding"?F=y(x,_).split("").map(function(G){return G.charCodeAt(0).toString(16)}).join(""):C==="Identity-H"&&(F=t(x,S[_])),m.isHex=!0,{text:F,x:u,y:h,options:f,mutex:m}};e.events.push(["postProcessText",function(i){var a=i.text||"",o=[],u={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var h=0;for(h=0;h<a.length;h+=1)Array.isArray(a[h])&&a[h].length===3?o.push([s(Object.assign({},u,{text:a[h][0]})).text,a[h][1],a[h][2]]):o.push(s(Object.assign({},u,{text:a[h]})).text);i.text=o}else i.text=s(Object.assign({},u,{text:a})).text}])})(qe),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(qe.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var s,i,a,o,u,h,f,m=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),O=!1,C=0;this.__bidiEngine__={};var F=function(L){var R=L.charCodeAt(),B=R>>8,W=_[B];return W!==void 0?m[256*W+(255&R)]:B===252||B===253?"AL":w.test(B)?"L":B===8?"R":"N"},G=function(L){for(var R,B=0;B<L.length;B++){if((R=F(L.charAt(B)))==="L")return!1;if(R==="R")return!0}return!1},V=function(L,R,B,W){var Z,ue,he,ie,de=R[W];switch(de){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":O=!1;break;case"N":case"AN":break;case"EN":O&&(de="AN");break;case"AL":O=!0,de="R";break;case"WS":case"BN":de="N";break;case"CS":W<1||W+1>=R.length||(Z=B[W-1])!=="EN"&&Z!=="AN"||(ue=R[W+1])!=="EN"&&ue!=="AN"?de="N":O&&(ue="AN"),de=ue===Z?ue:"N";break;case"ES":de=(Z=W>0?B[W-1]:"B")==="EN"&&W+1<R.length&&R[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&B[W-1]==="EN"){de="EN";break}if(O){de="N";break}for(he=W+1,ie=R.length;he<ie&&R[he]==="ET";)he++;de=he<ie&&R[he]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(ie=R.length,he=W+1;he<ie&&R[he]==="NSM";)he++;if(he<ie){var ke=L[W],be=ke>=1425&&ke<=2303||ke===64286;if(Z=R[he],be&&(Z==="R"||Z==="AL")){de="R";break}}}de=W<1||(Z=R[W-1])==="B"?"N":B[W-1];break;case"B":O=!1,s=!0,de=C;break;case"S":i=!0,de="N"}return de},re=function(L,R,B){var W=L.split("");return B&&J(W,B,{hiLevel:C}),W.reverse(),R&&R.reverse(),W.join("")},J=function(L,R,B){var W,Z,ue,he,ie,de=-1,ke=L.length,be=0,E=[],z=C?p:y,H=[];for(O=!1,s=!1,i=!1,Z=0;Z<ke;Z++)H[Z]=F(L[Z]);for(ue=0;ue<ke;ue++){if(ie=be,E[ue]=V(L,H,E,ue),W=240&(be=z[ie][S[E[ue]]]),be&=15,R[ue]=he=z[be][5],W>0)if(W===16){for(Z=de;Z<ue;Z++)R[Z]=1;de=-1}else de=-1;if(z[be][6])de===-1&&(de=ue);else if(de>-1){for(Z=de;Z<ue;Z++)R[Z]=he;de=-1}H[ue]==="B"&&(R[ue]=0),B.hiLevel|=he}i&&(function(Y,ee,te){for(var le=0;le<te;le++)if(Y[le]==="S"){ee[le]=C;for(var ce=le-1;ce>=0&&Y[ce]==="WS";ce--)ee[ce]=C}})(H,R,ke)},U=function(L,R,B,W,Z){if(!(Z.hiLevel<L)){if(L===1&&C===1&&!s)return R.reverse(),void(B&&B.reverse());for(var ue,he,ie,de,ke=R.length,be=0;be<ke;){if(W[be]>=L){for(ie=be+1;ie<ke&&W[ie]>=L;)ie++;for(de=be,he=ie-1;de<he;de++,he--)ue=R[de],R[de]=R[he],R[he]=ue,B&&(ue=B[de],B[de]=B[he],B[he]=ue);be=ie}be++}}},I=function(L,R,B){var W=L.split(""),Z={hiLevel:C};return B||(B=[]),J(W,B,Z),(function(ue,he,ie){if(ie.hiLevel!==0&&f)for(var de,ke=0;ke<ue.length;ke++)he[ke]===1&&(de=x.indexOf(ue[ke]))>=0&&(ue[ke]=x[de+1])})(W,B,Z),U(2,W,R,B,Z),U(1,W,R,B,Z),W.join("")};return this.__bidiEngine__.doBidiReorder=function(L,R,B){if((function(Z,ue){if(ue)for(var he=0;he<Z.length;he++)ue[he]=he;o===void 0&&(o=G(Z)),h===void 0&&(h=G(Z))})(L,R),a||!u||h)if(a&&u&&o^h)C=o?1:0,L=re(L,R,B);else if(!a&&u&&h)C=o?1:0,L=I(L,R,B),L=re(L,R);else if(!a||o||u||h){if(a&&!u&&o^h)L=re(L,R),o?(C=0,L=I(L,R,B)):(C=1,L=I(L,R,B),L=re(L,R));else if(a&&o&&!u&&h)C=1,L=I(L,R,B),L=re(L,R);else if(!a&&!u&&o^h){var W=f;o?(C=1,L=I(L,R,B),C=0,f=!1,L=I(L,R,B),f=W):(C=0,L=I(L,R,B),L=re(L,R),C=1,f=!1,L=I(L,R,B),f=W,L=re(L,R))}}else C=0,L=I(L,R,B);else C=o?1:0,L=I(L,R,B);return L},this.__bidiEngine__.setOptions=function(L){L&&(a=L.isInputVisual,u=L.isOutputVisual,o=L.isInputRtl,h=L.isOutputRtl,f=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var s=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var a=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(a=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?a.push([t.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):a.push([t.doBidiReorder(s[o])]);r.text=a}else r.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(qe),qe.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Mi(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Eb(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new pb(this.contents),this.head=new mb(this),this.name=new wb(this),this.cmap=new l0(this),this.toUnicode={},this.hhea=new vb(this),this.maxp=new xb(this),this.hmtx=new Sb(this),this.post=new yb(this),this.os2=new bb(this),this.loca=new Lb(this),this.glyf=new Ab(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,u,h;for(h=[],a=0,o=(u=this.bbox).length;a<o;a++)e=u[a],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(r=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var s,i,a,o;for(a=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)s=e.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(s))+r*(1e3/t)||0;return a*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var Ir,Mi=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,s;for(s=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)s.push(this.writeByte(e.charCodeAt(t)));return s},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,s,i,a,o,u;return e=this.readByte(),t=this.readByte(),r=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^s)+16777216*(255^i)+65536*(255^a)+256*(255^o)+(255^u)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*s+16777216*i+65536*a+256*o+u},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,s,i;for(i=[],r=0,s=e.length;r<s;r++)t=e[r],i.push(this.writeByte(t));return i},n})(),pb=(function(){var n;function e(t){var r,s,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,s,i,a,o,u,h,f,m,y,p,S,_;for(_ in p=Object.keys(t).length,u=Math.log(2),m=16*Math.floor(Math.log(p)/u),a=Math.floor(m/u),f=16*p-m,(s=new Mi).writeInt(this.scalarType),s.writeShort(p),s.writeShort(m),s.writeShort(a),s.writeShort(f),i=16*p,h=s.pos+i,o=null,S=[],t)for(y=t[_],s.writeString(_),s.writeInt(n(y)),s.writeInt(h),s.writeInt(y.length),S=S.concat(y),_==="head"&&(o=h),h+=y.length;h%4;)S.push(0),h++;return s.write(S),r=2981146554-n(s.data),s.pos=o+8,s.writeUInt32(r),s.data},n=function(t){var r,s,i,a;for(t=c0.call(t);t.length%4;)t.push(0);for(i=new Mi(t),s=0,r=0,a=t.length;r<a;r=r+=4)s+=i.readUInt32();return 4294967295&s},e})(),gb={}.hasOwnProperty,Hr=function(n,e){for(var t in e)gb.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};Ir=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var mb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Mi).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),Pf=(function(){function n(e,t){var r,s,i,a,o,u,h,f,m,y,p,S,_,x,w,O,C;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(p=e.readUInt16(),y=p/2,e.pos+=6,i=(function(){var F,G;for(G=[],u=F=0;0<=y?F<y:F>y;u=0<=y?++F:--F)G.push(e.readUInt16());return G})(),e.pos+=2,_=(function(){var F,G;for(G=[],u=F=0;0<=y?F<y:F>y;u=0<=y?++F:--F)G.push(e.readUInt16());return G})(),h=(function(){var F,G;for(G=[],u=F=0;0<=y?F<y:F>y;u=0<=y?++F:--F)G.push(e.readUInt16());return G})(),f=(function(){var F,G;for(G=[],u=F=0;0<=y?F<y:F>y;u=0<=y?++F:--F)G.push(e.readUInt16());return G})(),s=(this.length-e.pos+this.offset)/2,o=(function(){var F,G;for(G=[],u=F=0;0<=s?F<s:F>s;u=0<=s?++F:--F)G.push(e.readUInt16());return G})(),u=w=0,C=i.length;w<C;u=++w)for(x=i[u],r=O=S=_[u];S<=x?O<=x:O>=x;r=S<=x?++O:--O)f[u]===0?a=r+h[u]:(a=o[f[u]/2+(r-S)-(y-u)]||0)!==0&&(a+=h[u]),this.codeMap[r]=65535&a}e.pos=m}return n.encode=function(e,t){var r,s,i,a,o,u,h,f,m,y,p,S,_,x,w,O,C,F,G,V,re,J,U,I,L,R,B,W,Z,ue,he,ie,de,ke,be,E,z,H,Y,ee,te,le,ce,ve,Se,Ce;switch(W=new Mi,a=Object.keys(e).sort(function(Pe,ze){return Pe-ze}),t){case"macroman":for(_=0,x=(function(){var Pe=[];for(S=0;S<256;++S)Pe.push(0);return Pe})(),O={0:0},i={},Z=0,de=a.length;Z<de;Z++)O[ce=e[s=a[Z]]]==null&&(O[ce]=++_),i[s]={old:e[s],new:O[e[s]]},x[s]=O[e[s]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(x),{charMap:i,subtable:W.data,maxGlyphID:_+1};case"unicode":for(R=[],m=[],C=0,O={},r={},w=h=null,ue=0,ke=a.length;ue<ke;ue++)O[G=e[s=a[ue]]]==null&&(O[G]=++C),r[s]={old:G,new:O[G]},o=O[G]-s,w!=null&&o===h||(w&&m.push(w),R.push(s),h=o),w=s;for(w&&m.push(w),m.push(65535),R.push(65535),I=2*(U=R.length),J=2*Math.pow(Math.log(U)/Math.LN2,2),y=Math.log(J/2)/Math.LN2,re=2*U-J,u=[],V=[],p=[],S=he=0,be=R.length;he<be;S=++he){if(L=R[S],f=m[S],L===65535){u.push(0),V.push(0);break}if(L-(B=r[L].new)>=32768)for(u.push(0),V.push(2*(p.length+U-S)),s=ie=L;L<=f?ie<=f:ie>=f;s=L<=f?++ie:--ie)p.push(r[s].new);else u.push(B-L),V.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*U+2*p.length),W.writeUInt16(0),W.writeUInt16(I),W.writeUInt16(J),W.writeUInt16(y),W.writeUInt16(re),te=0,E=m.length;te<E;te++)s=m[te],W.writeUInt16(s);for(W.writeUInt16(0),le=0,z=R.length;le<z;le++)s=R[le],W.writeUInt16(s);for(ve=0,H=u.length;ve<H;ve++)o=u[ve],W.writeUInt16(o);for(Se=0,Y=V.length;Se<Y;Se++)F=V[Se],W.writeUInt16(F);for(Ce=0,ee=p.length;Ce<ee;Ce++)_=p[Ce],W.writeUInt16(_);return{charMap:r,subtable:W.data,maxGlyphID:C+1}}},n})(),l0=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,r,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)t=new Pf(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var r,s;return t==null&&(t="macroman"),r=Pf.encode(e,t),(s=new Mi).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},n})(),vb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),bb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),yb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="post",n.prototype.parse=function(e){var t,r,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(r=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)t=e.readByte(),s.push(this.names.push(e.readString(t)));return s;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var a,o,u;for(u=[],i=a=0,o=this.file.maxp.numGlyphs;0<=o?a<o:a>o;i=0<=o?++a:--a)u.push(e.readUInt32());return u}).call(this)}},n})(),_b=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},wb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="name",n.prototype.parse=function(e){var t,r,s,i,a,o,u,h,f,m,y;for(e.pos=this.offset,e.readShort(),t=e.readShort(),o=e.readShort(),r=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(u={},i=f=0,m=r.length;f<m;i=++f)s=r[i],e.pos=s.offset,h=e.readString(s.length),a=new _b(h,s),u[y=s.nameID]==null&&(u[y]=[]),u[s.nameID].push(a);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},n})(),xb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),Sb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,r,s,i,a,o,u;for(e.pos=this.offset,this.metrics=[],t=0,o=this.file.hhea.numberOfMetrics;0<=o?t<o:t>o;t=0<=o?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,f;for(f=[],t=h=0;0<=s?h<s:h>s;t=0<=s?++h:--h)f.push(e.readInt16());return f})(),this.widths=(function(){var h,f,m,y;for(y=[],h=0,f=(m=this.metrics).length;h<f;h++)i=m[h],y.push(i.advance);return y}).call(this),r=this.widths[this.widths.length-1],u=[],t=a=0;0<=s?a<s:a>s;t=0<=s?++a:--a)u.push(this.widths.push(r));return u},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),c0=[].slice,Ab=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,r,s,i,a,o,u,h,f,m;return e in this.cache?this.cache[e]:(i=this.file.loca,t=this.file.contents,r=i.indexOf(e),(s=i.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+r,a=(o=new Mi(t.read(s))).readShort(),h=o.readShort(),m=o.readShort(),u=o.readShort(),f=o.readShort(),this.cache[e]=a===-1?new Nb(o,h,m,u,f):new kb(o,a,h,m,u,f),this.cache[e]))},n.prototype.encode=function(e,t,r){var s,i,a,o,u;for(a=[],i=[],o=0,u=t.length;o<u;o++)s=e[t[o]],i.push(a.length),s&&(a=a.concat(s.encode(r)));return i.push(a.length),{table:a,offsets:i}},n})(),kb=(function(){function n(e,t,r,s,i,a){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=s,this.xMax=i,this.yMax=a,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),Nb=(function(){function n(e,t,r,s,i){var a,o;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new Mi(c0.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),Lb=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Hr(n,Ir),n.prototype.tag="loca",n.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=4)i.push(e.readUInt32());return i}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),s=0,i=0,a=0;a<r.length;++a)if(r[a]=s,i<t.length&&t[i]==a){++i,r[a]=s;var o=this.offsets[a],u=this.offsets[a+1]-o;u>0&&(s+=u)}for(var h=new Array(4*r.length),f=0;f<r.length;++f)h[4*f+3]=255&r[f],h[4*f+2]=(65280&r[f])>>8,h[4*f+1]=(16711680&r[f])>>16,h[4*f]=(4278190080&r[f])>>24;return h},n})(),Eb=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,s,i;for(t in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)r=i[t],e[t]=s[r];return e},n.prototype.glyphsFor=function(e){var t,r,s,i,a,o,u;for(s={},a=0,o=e.length;a<o;a++)s[i=e[a]]=this.font.glyf.glyphFor(i);for(i in t=[],s)(r=s[i])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(i in u=this.glyphsFor(t))r=u[i],s[i]=r;return s},n.prototype.encode=function(e,t){var r,s,i,a,o,u,h,f,m,y,p,S,_,x,w;for(s in r=l0.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),p={0:0},w=r.charMap)p[(u=w[s]).old]=u.new;for(S in y=r.maxGlyphID,a)S in p||(p[S]=y++);return f=(function(O){var C,F;for(C in F={},O)F[O[C]]=C;return F})(p),m=Object.keys(f).sort(function(O,C){return O-C}),_=(function(){var O,C,F;for(F=[],O=0,C=m.length;O<C;O++)o=m[O],F.push(f[o]);return F})(),i=this.font.glyf.encode(a,_,p),h=this.font.loca.encode(i.offsets,_),x={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},n})();qe.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,s,i,a;if(Array.isArray(t))return"["+(function(){var o,u,h;for(h=[],o=0,u=t.length;o<u;o++)r=t[o],h.push(e.convert(r));return h})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in i=["<<"],t)a=t[s],i.push("/"+s+" "+e.convert(a));return i.push(">>"),i.join(`
`)}return""+t},e})();const Cf=[26,92,107],di=[0,0,0],Gc=[100,100,100],Pb=[200,200,200];function ji(n){return(parseFloat(n)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})+" "}function Cb(n){return n?new Date(n).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function Ib(n,e,t){const r=new qe("p","mm","a4"),s=210,i=25,a=25,o=s-i-a,u=t||{},h=u.company_name||"BECK360",f=u.owner_name||"Eugen Beck",m=u.address_line1||"Eichenweg 1",y=u.address_zip||"76275",p=u.address_city||"Ettlingen",S=u.phone||"0173-4682501",_=u.email||"rundgang@beck360.de",x=u.website||"www.beck360.de",w=u.tax_id||"31205/27003",O=u.vat_id||"DE321274049",C=u.bank_name||"VR Bank Suedpfalz",F=u.bank_iban||"DE92 5486 2500 0001 1389 95",G=u.bank_bic||"GEN0DE61SUW",V=n.type==="quote",re=V?"ANGEBOT":"RECHNUNG",J=V?"Angebotsnr.:":"Rechnungsnr.:",U=V?"Angebotsdatum:":"Rechnungsdatum:";let I=20;r.setFont("helvetica","bold"),r.setFontSize(18),r.setTextColor(...Cf),r.text("Beck360",i,I),r.setFontSize(24),r.setTextColor(...di),r.text(re,s-a,I,{align:"right"}),I+=20,r.setFontSize(7),r.setTextColor(...Gc);const L=`${h} - ${m} - ${y} ${p}`;r.text(L,i,I);const R=r.getTextWidth(L);r.setDrawColor(...Gc),r.setLineWidth(.2),r.line(i,I+.5,i+R,I+.5),I+=8,r.setFontSize(10),r.setTextColor(...di),r.setFont("helvetica","bold"),n.customer_company&&(r.text(n.customer_company,i,I),I+=5),n.customer_name&&(r.text(n.customer_name,i,I),I+=5),r.setFont("helvetica","normal"),n.customer_street&&(r.text(n.customer_street,i,I),I+=5);const B=`${n.customer_zip||""} ${n.customer_city||""}`.trim();B&&(r.text(B,i,I),I+=5);const W=120,Z=I-20,ue=s-a-W,he=18;r.setDrawColor(...Cf),r.setLineWidth(.5),r.rect(W,Z,ue,he),r.setFontSize(9),r.setTextColor(...di),r.text(`${J} ${n.invoice_number}`,W+4,Z+7),r.text(`${U} ${Cb(n.invoice_date)}`,W+4,Z+13),I=Math.max(I,Z+he+10),I+=5,r.setFontSize(10),r.setTextColor(...di),r.setFont("helvetica","normal"),r.text("Vielen Dank fuer Ihren Auftrag. Ich berechne Ihnen fuer folgende Leistungen:",i,I),I+=10;const ie={desc:i,qty:i+o*.55,price:i+o*.7,total:s-a};r.setFont("helvetica","bold"),r.setFontSize(9),r.setDrawColor(...di),r.setLineWidth(.3),r.line(i,I,s-a,I),I+=5,r.text("Bezeichnung",ie.desc,I),r.text("Menge",ie.qty,I,{align:"right"}),r.text("Einzelpreis",ie.price+15,I,{align:"right"}),r.text("Gesamt",ie.total,I,{align:"right"}),I+=2,r.line(i,I,s-a,I),I+=5,r.setFont("helvetica","normal"),r.setFontSize(9);for(const te of e){I>240&&(r.addPage(),I=20);const le=(parseFloat(te.quantity)||0)*(parseFloat(te.unit_price)||0),ce=parseFloat(te.quantity)%1===0?`${parseInt(te.quantity)} Stk.`:`${parseFloat(te.quantity).toLocaleString("de-DE")}`;r.text(te.description||"",ie.desc,I),r.text(ce,ie.qty,I,{align:"right"}),r.text(ji(te.unit_price),ie.price+15,I,{align:"right"}),r.text(ji(le),ie.total,I,{align:"right"}),I+=5,te.sub_description&&(r.setFontSize(8),r.setTextColor(...Gc),r.text(te.sub_description,ie.desc,I),r.setFontSize(9),r.setTextColor(...di),I+=5)}r.line(i,I,s-a,I),I+=8;const de=s-a-60,ke=s-a;function be(te,le,ce={}){ce.bold?r.setFont("helvetica","bold"):r.setFont("helvetica","normal"),ce.italic&&r.setFont("helvetica","italic"),r.setFontSize(ce.size||9),r.text(te,de,I),r.text(le,ke,I,{align:"right"}),I+=ce.spacing||6}if(be("Zwischensumme",ji(n.subtotal)),parseFloat(n.discount_percent)>0){const te=parseFloat(n.subtotal)-parseFloat(n.net_amount);be(`Rabatt (- ${n.discount_percent}%)`,`-${ji(te)}`)}if(be("Nettobetrag",ji(n.net_amount)),be(`${n.vat_rate} % MwSt.`,ji(n.vat_amount),{italic:!0}),be("Gesamtbetrag",ji(n.total_amount),{bold:!0,size:10}),n.status==="paid"&&be("Bezahlt",ji(n.paid_amount||n.total_amount),{bold:!0,size:10}),I+=8,n.payment_terms){I>240&&(r.addPage(),I=20),r.setFont("helvetica","normal"),r.setFontSize(9),r.setTextColor(...di);const te=r.splitTextToSize(n.payment_terms,o);r.text(te,i,I),I+=te.length*4.5+2}if(V||(r.setFontSize(9),r.text("Verwenden Sie die Rechnungsnummer als Verwendungszweck.",i,I),I+=8),n.closing_message){I>250&&(r.addPage(),I=20),r.setFontSize(9),r.setTextColor(...di);const te=r.splitTextToSize(n.closing_message,o);r.text(te,i,I),I+=te.length*4.5}const E=270;r.setDrawColor(...Pb),r.setLineWidth(.3),r.line(i,E-3,s-a,E-3),r.setFontSize(7),r.setTextColor(...di);const z=i;r.setFont("helvetica","bold"),r.text(h,z,E),r.text(f,z,E+3.5),r.setFont("helvetica","normal"),r.text(m,z,E+7),r.text(`${y} ${p}`,z,E+10.5),r.text(x,z,E+14),r.text(`Steuernummer: ${w}`,z,E+17.5),r.text(`USt-IdNr.: ${O}`,z,E+21);const H=i+55;r.setFont("helvetica","bold"),r.text("Kontakt:",H,E),r.setFont("helvetica","normal"),r.text(`Tel.: ${S}`,H,E+3.5),r.text(`E-Mail: ${_}`,H,E+7);const Y=i+110;r.setFont("helvetica","bold"),r.text("Zahlungsinformationen:",Y,E),r.setFont("helvetica","normal"),r.text(`IBAN: ${F}`,Y,E+3.5),r.text(`BIC: ${G}`,Y,E+7),r.text(C,Y,E+10.5);const ee=`${n.invoice_number}.pdf`;r.save(ee)}function Tb({id:n}){var _,x,w,O,C,F,G;const{invoice:e,items:t,loading:r,update:s}=pp(n),{settings:i}=Ru(),a=mr();if(r)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Rechnung"})}),l("div",{class:"page-body",children:l("div",{class:"loading-center",children:l("div",{class:"spinner"})})})]});if(!e)return l(bt,{children:[l("div",{class:"page-header",children:l("h1",{class:"page-title",children:"Nicht gefunden"})}),l("div",{class:"page-body",children:l("div",{class:"empty-state",children:l("div",{class:"empty-state-text",children:"Dokument nicht gefunden"})})})]});const o=e.type==="quote",u=((_=sa[e.type])==null?void 0:_.label)||"Dokument";async function h(){const{error:V}=await s({status:"sent"});V?a.error("Fehler"):a.success("Als versendet markiert")}async function f(){const{error:V}=await s({status:"paid",paid_date:new Date().toISOString().slice(0,10),paid_amount:e.total_amount});V?a.error("Fehler"):a.success("Als bezahlt markiert")}async function m(){const{data:V,error:re}=await n2(n);re?a.error("Fehler: "+re.message):(a.success("In Rechnung umgewandelt"),Ve(`/crm/invoices/${V.id}`))}async function y(){if(!confirm(`${u} "${e.invoice_number}" wirklich loeschen?`))return;const{error:V}=await i2(n);V?a.error("Fehler"):(a.success("Geloescht"),Ve("/crm/invoices"))}function p(){Ib(e,t,i)}function S(){Ve(`/crm/invoices/new?edit=${n}`)}return l(bt,{children:[l("div",{class:"page-header",children:[l("div",{style:"display:flex;align-items:center;gap:0.75rem",children:[l("button",{class:"btn btn-secondary btn-sm",onClick:()=>Ve("/crm/invoices"),children:""}),l("h1",{class:"page-title",children:e.invoice_number}),l("span",{class:"stage-badge",style:`color:${(x=Un[e.status])==null?void 0:x.color};background:${(w=Un[e.status])==null?void 0:w.color}20`,children:(O=Un[e.status])==null?void 0:O.label})]}),l("div",{style:"display:flex;gap:0.5rem;flex-wrap:wrap",children:[l("button",{class:"btn btn-primary btn-sm",onClick:p,children:"PDF herunterladen"}),e.status==="draft"&&l(bt,{children:[l("button",{class:"btn btn-secondary btn-sm",onClick:S,children:"Bearbeiten"}),l("button",{class:"btn btn-secondary btn-sm",onClick:h,children:"Als versendet markieren"}),o&&l("button",{class:"btn btn-primary btn-sm",onClick:m,children:"In Rechnung umwandeln"}),l("button",{class:"btn btn-danger btn-sm",onClick:y,children:"Loeschen"})]}),e.status==="sent"&&!o&&l("button",{class:"btn btn-primary btn-sm",onClick:f,children:"Als bezahlt markieren"})]})]}),l("div",{class:"page-body",children:l("div",{class:"detail-grid",children:[l("div",{class:"detail-main",children:[l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:u})}),l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:o?"Angebotsnr.":"Rechnungsnr."}),l("span",{class:"detail-value",children:e.invoice_number})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Typ"}),l("span",{class:"detail-value",children:u})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Datum"}),l("span",{class:"detail-value",children:An(e.invoice_date)})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:o?"Gueltig bis":"Faellig am"}),l("span",{class:"detail-value",children:An(e.due_date)})]}),e.paid_date&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Bezahlt am"}),l("span",{class:"detail-value",children:An(e.paid_date)})]}),e.converted_from_quote_id&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt aus Angebot"}),l("span",{class:"detail-value",children:l("a",{href:"#",onClick:V=>{V.preventDefault(),Ve(`/crm/invoices/${e.converted_from_quote_id}`)},children:"Angebot anzeigen"})})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Kunde"})}),l("div",{class:"form-grid",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Firma"}),l("span",{class:"detail-value",children:e.company_id?l("a",{href:"#",onClick:V=>{V.preventDefault(),Ve(`/crm/companies/${e.company_id}`)},children:e.customer_company||""}):e.customer_company||""})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Ansprechpartner"}),l("span",{class:"detail-value",children:e.customer_name||""})]}),l("div",{class:"detail-field form-group-full",children:[l("span",{class:"detail-label",children:"Adresse"}),l("span",{class:"detail-value",children:[e.customer_street,`${e.customer_zip||""} ${e.customer_city||""}`.trim()].filter(Boolean).join(", ")||""})]})]})]}),l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Positionen"})}),l("div",{class:"table-wrapper",children:l("table",{class:"line-items-table",children:[l("thead",{children:l("tr",{children:[l("th",{children:"Bezeichnung"}),l("th",{style:"text-align:right",children:"Menge"}),l("th",{style:"text-align:right",children:"Einzelpreis"}),l("th",{style:"text-align:right",children:"Gesamt"})]})}),l("tbody",{children:t.map(V=>l("tr",{children:[l("td",{children:[l("div",{children:V.description}),V.sub_description&&l("div",{style:"font-size:0.8rem;color:var(--text-muted)",children:V.sub_description})]}),l("td",{style:"text-align:right",children:V.quantity}),l("td",{style:"text-align:right",children:Kt(V.unit_price)}),l("td",{style:"text-align:right;font-weight:500",children:Kt(V.total)})]},V.id))})]})}),l("div",{class:"invoice-totals",style:"margin-top:1rem",children:[l("div",{class:"invoice-totals-row",children:[l("span",{children:"Zwischensumme"}),l("span",{children:Kt(e.subtotal)})]}),parseFloat(e.discount_percent)>0&&l("div",{class:"invoice-totals-row",children:[l("span",{children:["Rabatt (-",e.discount_percent,"%)"]}),l("span",{children:["-",Kt(e.subtotal-e.net_amount)]})]}),l("div",{class:"invoice-totals-row",children:[l("span",{children:"Nettobetrag"}),l("span",{children:Kt(e.net_amount)})]}),l("div",{class:"invoice-totals-row",children:[l("span",{children:[e.vat_rate,"% MwSt."]}),l("span",{children:Kt(e.vat_amount)})]}),l("div",{class:"invoice-totals-row",style:"font-weight:700;font-size:1.1rem;border-top:2px solid var(--border);padding-top:0.5rem",children:[l("span",{children:"Gesamtbetrag"}),l("span",{children:Kt(e.total_amount)})]}),e.status==="paid"&&l("div",{class:"invoice-totals-row",style:"font-weight:700;color:var(--success)",children:[l("span",{children:"Bezahlt"}),l("span",{children:Kt(e.paid_amount)})]})]})]}),(e.payment_terms||e.closing_message)&&l("div",{class:"card",children:[l("div",{class:"card-header",children:l("span",{class:"card-title",children:"Texte"})}),e.payment_terms&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Zahlungsbedingungen"}),l("span",{class:"detail-value",style:"white-space:pre-wrap",children:e.payment_terms})]}),e.closing_message&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Schlussnachricht"}),l("span",{class:"detail-value",style:"white-space:pre-wrap",children:e.closing_message})]})]})]}),l("div",{class:"detail-sidebar",children:l("div",{class:"card",children:[l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Status"}),l("span",{class:"detail-value",children:l("span",{class:"stage-badge",style:`color:${(C=Un[e.status])==null?void 0:C.color};background:${(F=Un[e.status])==null?void 0:F.color}20`,children:(G=Un[e.status])==null?void 0:G.label})})]}),e.deal_id&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Deal"}),l("span",{class:"detail-value",children:l("a",{href:"#",onClick:V=>{V.preventDefault(),Ve(`/crm/deals/${e.deal_id}`)},children:"Deal anzeigen"})})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Erstellt am"}),l("span",{class:"detail-value",children:An(e.created_at)})]}),l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Aktualisiert"}),l("span",{class:"detail-value",children:An(e.updated_at)})]}),e.notes&&l("div",{class:"detail-field",children:[l("span",{class:"detail-label",children:"Interne Notizen"}),l("span",{class:"detail-value",style:"white-space:pre-wrap;font-size:0.8rem",children:e.notes})]})]})})]})})]})}function Ob(){const{user:n,loading:e}=Il();return e?l("div",{class:"loading-center",style:"min-height: 100vh",children:l("div",{class:"spinner"})}):n?l(Xm,{children:l(fp,{children:[l(pd,{path:"/crm/"}),l(h2,{path:"/crm/pipeline"}),l(g2,{path:"/crm/contacts"}),l(y2,{path:"/crm/contacts/new"}),l(m2,{path:"/crm/contacts/:id"}),l(w2,{path:"/crm/companies"}),l(S2,{path:"/crm/companies/:id"}),l(k2,{path:"/crm/deals/new"}),l(A2,{path:"/crm/deals/:id"}),l(R2,{path:"/crm/invoices"}),l(F2,{path:"/crm/invoices/new"}),l(Tb,{path:"/crm/invoices/:id"}),l(I2,{path:"/crm/campaigns"}),l(T2,{path:"/crm/campaigns/new"}),l(O2,{path:"/crm/campaigns/:id"}),l(N2,{path:"/crm/settings"}),l(pd,{default:!0})]})}):l(Zm,{})}tg(l(Um,{children:l(Mm,{children:l(Ob,{})})}),document.getElementById("app"));export{Tt as _};
